<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.tianocore.org/page.cgi?id=bugzilla.dtd">

<bugzilla version="5.0.4"
          urlbase="https://bugzilla.tianocore.org/"
          
          maintainer="john.mathews@intel.com"
>

    <bug>
          <bug_id>4560</bug_id>
          
          <creation_ts>2023-09-25 00:00:16 +0000</creation_ts>
          <short_desc>[Xhci] Skip size round up for TRB when getting PCI device/host memory address</short_desc>
          <delta_ts>2023-10-26 17:21:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Highest</priority>
          <bug_severity>critical</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Gao Cheng">gao.cheng</reporter>
          <assigned_to name="Gao Cheng">gao.cheng</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gao.cheng</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21932</commentid>
    <comment_count>0</comment_count>
    <who name="Gao Cheng">gao.cheng</who>
    <bug_when>2023-09-25 00:00:16 +0000</bug_when>
    <thetext>In edk2 XHCI driver, there are two functions - UsbHcGetHostAddrForPciAddr() and UsbHcGetPciAddrForHostAddr() to perform address translations between PCI device and host memory addresses. Before the address translation, both functions will:
1.Roundup the input size to be 64B-aligned
2.Check if the memory range specified by the input address and the aligned size exceeds any XHCI memory block (in 64KB)
3.If so, a DXE_ASSERT error is generated.
However, when it comes to a TRB (regardless of Command/Event/Transfer TRB), its size is 16B and no need to be aligned to 64B. As we observed, forcing it to be 64B in this case will result in unwanted DXE_ASSER in step 3. So we propose to add one more input parameter of BOOLEAN data type to UsbHcGetHostAddrForPciAddr() and UsbHcGetPciAddrForHostAddr() to indicate if 64B size alignment and roundup is needed. For the TRB case, we need to set it to FALSE. For other cases, we can keep it as TRUE.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21933</commentid>
    <comment_count>1</comment_count>
    <who name="Gao Cheng">gao.cheng</who>
    <bug_when>2023-09-25 02:51:41 +0000</bug_when>
    <thetext>The issue is assigned to my own and confirmed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21936</commentid>
    <comment_count>2</comment_count>
    <who name="Gao Cheng">gao.cheng</who>
    <bug_when>2023-09-25 22:31:54 +0000</bug_when>
    <thetext>Already submitted the patch to edk2 for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22080</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 17:21:08 +0000</bug_when>
    <thetext>Fixed in commit f36e1ec1f0a5fd3be84913e09181d7813444b620.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4117</bug_id>
          <alias>CVE-2022-36763</alias>
          <creation_ts>2022-10-25 11:31:04 +0000</creation_ts>
          <short_desc>Heap Buffer Overflow in Tcg2MeasureGptTable()</short_desc>
          <delta_ts>2024-01-16 03:03:49 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Marc Beatove">mbeatove</reporter>
          <assigned_to>jiewen.yao</assigned_to>
          <cc>BrianM</cc>
    
    <cc>dougflick</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>ghouse.adoni.mohammed</cc>
    
    <cc>hchung1</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>john.mathews</cc>
    
    <cc>kraxel</cc>
    
    <cc>ling.yu</cc>
    
    <cc>louis.shen</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>miki.demeter</cc>
    
    <cc>rcorreadeysasi</cc>
    
    <cc>rodrigo.gonzalez.del.cueto</cc>
    
    <cc>sbrukbacher</cc>
    
    <cc>w.sheng</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19817</commentid>
    <comment_count>0</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2022-10-25 11:31:04 +0000</bug_when>
    <thetext>Tcg2MeasureGptTable() reads untrusted input from disk, and an attacker can set up a malicious GPT table that triggers an integer overflow that leads to a buffer overflow. This is due to a lack of validation of the GPT Primary Header.

```
EntryPtr = (UINT8 *)AllocatePool (PrimaryHeader-&gt;NumberOfPartitionEntries * 
                                       PrimaryHeader-&gt;SizeOfPartitionEntry);
```
In the previous line, we can see how we allocate a buffer using the `NumberOfPartitionEntries` and `SizeOfPartitionEntry` fields. None of these fields are sanitized after being read from disk previously on:

```
Status = DiskIo-&gt;ReadDisk (
                     DiskIo,
                     BlockIo-&gt;Media-&gt;MediaId,
                     1 * BlockIo-&gt;Media-&gt;BlockSize,
                     BlockIo-&gt;Media-&gt;BlockSize,
                     (UINT8 *)PrimaryHeader
                     );
```

So `EntryPtr` can point to an allocation much smaller than required.

Later, `CopyMem` is called in different occasions with `EventPtr` as target and the buffer overflow can be triggered.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19913</commentid>
    <comment_count>1</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2022-11-02 12:15:52 +0000</bug_when>
    <thetext>Possibly update functions in GPT Data eval to use SafeIntLib</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20148</commentid>
    <comment_count>2</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2022-11-30 10:28:40 +0000</bug_when>
    <thetext>Jiewen - Any update on this issue? Has this been confirmed?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20249</commentid>
    <comment_count>3</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2022-12-21 04:06:45 +0000</bug_when>
    <thetext>My team has asked me that I share with you our disclosure timeline. It will take effect from today:

We are privately disclosing this vulnerability to 
you so that you can develop a fix and manage its rollout. We do not require 
you to keep any information of this report secret, but if you make it 
public then please let us know that you did. This advisory will be kept 
private by Google for 30 days after a fix is publicly available or after 90 
days if no fix is made. After this deadline we plan to disclose this 
advisory in full at: http://github.com/google/security-research/. Please 
read more details about this policy here: https://g.co/appsecurity</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20918</commentid>
    <comment_count>4</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2023-01-25 11:46:22 +0000</bug_when>
    <thetext>Any updates?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21021</commentid>
    <comment_count>5</comment_count>
      <attachid>1321</attachid>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2023-02-10 11:39:21 +0000</bug_when>
    <thetext>Created attachment 1321
Suggested patch for bug

Attaching a suggested fix for this issue to try to speed up the process.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21024</commentid>
    <comment_count>6</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-02-10 14:09:36 +0000</bug_when>
    <thetext>Thank you for the possible patch submission. Would it be possible to set up a teams meeting to discuss these issues?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21025</commentid>
    <comment_count>7</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2023-02-10 14:24:10 +0000</bug_when>
    <thetext>Yes, could we schedule the meeting in Google meet though? Otherwise I would need to ask for a teams license and it may take a while.

When would you like to schedule the meeting? My timezone is UTC+1</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21027</commentid>
    <comment_count>8</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2023-02-10 14:53:54 +0000</bug_when>
    <thetext>I double-checked and teams is also fine.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21042</commentid>
    <comment_count>9</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-02-13 13:20:15 +0000</bug_when>
    <thetext>(In reply to Miki Demeter from comment #1)
&gt; Possibly update functions in GPT Data eval to use SafeIntLib

Both values are usual small and sanity-checking them both looks like a good idea to me.

Entry size is typically 128 bytes.  Even when considering room for future extensions a generous limit of 1024 bytes looks sensible to me.

Number of entries supported by windows is 128, so you probably wouldn&apos;t see more than that in practice.  We could allow for future grow here too and likewise apply a 1024 entries limit.

1024 * 1024 is still *way* below a 32bit integer overflow ...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21044</commentid>
    <comment_count>10</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-02-13 14:14:40 +0000</bug_when>
    <thetext>Related:
https://bugzilla.tianocore.org/show_bug.cgi?id=2168

Guess that means we should also check entry size is not smaller than 128 ..</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21046</commentid>
    <comment_count>11</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-02-13 17:59:59 +0000</bug_when>
    <thetext>CVE-2022-36763 Reserved</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21073</commentid>
    <comment_count>12</comment_count>
      <attachid>1327</attachid>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-02-15 08:41:19 +0000</bug_when>
    <thetext>Created attachment 1327
tarball with patch series

Fixes for this one and bug 4118 and bug 2168</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21074</commentid>
    <comment_count>13</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-02-15 08:46:13 +0000</bug_when>
    <thetext>Ping?  Anyone up for a somewhat coordinated handling of this?

Failing that I&apos;ll go just wait until google publishes the advisory in March
and go send the series to the edk2 devel list afterwards.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21075</commentid>
    <comment_count>14</comment_count>
      <attachid>1328</attachid>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-02-15 09:15:23 +0000</bug_when>
    <thetext>Created attachment 1328
tarball with patch series, v2

Fix both DxeTpmMeasureBootLib and DxeTpm2MeasureBootLib.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21081</commentid>
    <comment_count>15</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-02-15 12:29:46 +0000</bug_when>
    <thetext>@Gerd I have pinged the interested parties</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21082</commentid>
    <comment_count>16</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-02-15 17:42:03 +0000</bug_when>
    <thetext>@Marc can you validate that these patches do in fact address the issues cited in your PoC.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21083</commentid>
    <comment_count>17</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2023-02-16 06:15:09 +0000</bug_when>
    <thetext>I can still trigger a page fault. There is still an integer overflow in Tcg2MeasureGptTable() in line 259 when calculating `EventSize`. I would suggest using SafeIntLib here as well.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21084</commentid>
    <comment_count>18</comment_count>
      <attachid>1329</attachid>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-02-16 08:11:50 +0000</bug_when>
    <thetext>Created attachment 1329
tarball with patch series, v3</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21085</commentid>
    <comment_count>19</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2023-02-16 09:36:34 +0000</bug_when>
    <thetext>Last patch series successfully mitigate this vulnerability. I can no longer trigger a page fault.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21156</commentid>
    <comment_count>20</comment_count>
    <who name="Brian Mullen">BrianM</who>
    <bug_when>2023-03-07 10:54:02 +0000</bug_when>
    <thetext>Hi Marc, what is the public disclosure date? Has there been an update?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21166</commentid>
    <comment_count>21</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-03-09 03:30:29 +0000</bug_when>
    <thetext>See https://github.com/tianocore/edk2/security/advisories/GHSA-xvv8-66cq-prwr
and https://github.com/tianocore/edk2/security/advisories/GHSA-4hcq-p8q8-hj8j

The fixes will be included in the next stable release (2023-05).
Not fully sure what the exact public disclosure date will be.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21175</commentid>
    <comment_count>22</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2023-03-12 06:56:59 +0000</bug_when>
    <thetext>Hi Brian, we agreed on letting Tianocore set the disclosure timeline. IIRC these vulnerabilities will get disclosed when the security advisory goes public. Maybe @Miki can give more details?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22222</commentid>
    <comment_count>23</comment_count>
      <attachid>1433</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2023-12-06 17:21:49 +0000</bug_when>
    <thetext>Created attachment 1433
Patch From GHSA

This has been run through CI Locally and have been shipping / Tested on Surface</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22224</commentid>
    <comment_count>24</comment_count>
      <attachid>1435</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2023-12-06 17:35:45 +0000</bug_when>
    <thetext>Created attachment 1435
Patch From GHSA - reformatting git patch

Patch from GHSA, Tested Locally and Shipping / Testing on Surface / HyperV</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22365</commentid>
    <comment_count>25</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-01-16 03:03:49 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5264</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1321</attachid>
            <date>2023-02-10 11:39:21 +0000</date>
            <delta_ts>2023-02-10 11:39:21 +0000</delta_ts>
            <desc>Suggested patch for bug</desc>
            <filename>file_4117.txt</filename>
            <type>text/plain</type>
            <size>2670</size>
            <attacher name="Marc Beatove">mbeatove</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1327</attachid>
            <date>2023-02-15 08:41:19 +0000</date>
            <delta_ts>2023-02-15 08:41:19 +0000</delta_ts>
            <desc>tarball with patch series</desc>
            <filename>bz4117-bz4418-bz2168.tar.xz</filename>
            <type>application/octet-stream</type>
            <size>10240</size>
            <attacher name="Gerd Hoffmann">kraxel</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1328</attachid>
            <date>2023-02-15 09:15:23 +0000</date>
            <delta_ts>2023-02-15 09:15:23 +0000</delta_ts>
            <desc>tarball with patch series, v2</desc>
            <filename>bz4117-bz4418-bz2168-v2.tar.xz</filename>
            <type>application/x-xz</type>
            <size>20480</size>
            <attacher name="Gerd Hoffmann">kraxel</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1329</attachid>
            <date>2023-02-16 08:11:50 +0000</date>
            <delta_ts>2023-02-16 08:11:50 +0000</delta_ts>
            <desc>tarball with patch series, v3</desc>
            <filename>bz4117-bz4418-bz2168-v3.tar.xz</filename>
            <type>application/x-xz</type>
            <size>30720</size>
            <attacher name="Gerd Hoffmann">kraxel</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1433</attachid>
            <date>2023-12-06 17:21:49 +0000</date>
            <delta_ts>2023-12-06 17:35:45 +0000</delta_ts>
            <desc>Patch From GHSA</desc>
            <filename>4117.patch</filename>
            <type>application/octet-stream</type>
            <size>73174</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1435</attachid>
            <date>2023-12-06 17:35:45 +0000</date>
            <delta_ts>2023-12-06 17:35:45 +0000</delta_ts>
            <desc>Patch From GHSA - reformatting git patch</desc>
            <filename>4117.patch</filename>
            <type>text/plain</type>
            <size>63876</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4630</bug_id>
          
          <creation_ts>2023-12-28 09:53:43 +0000</creation_ts>
          <short_desc>CryptoPkg: Gcc build error of MbedtlsLib Rsa</short_desc>
          <delta_ts>2024-01-08 20:24:59 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to name="yi1.li@intel.com">yi1.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22293</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-12-28 09:53:43 +0000</bug_when>
    <thetext>Edk2/CryptoPkg/Library/MbedTlsLib/mbedtls/library/bignum.c:1208: undefined reference to `__udivti3&apos;

We encountered similar issues when upgrading openssl3.0:
https://github.com/tianocore/edk2/commit/4b5faa5775bf75bbc36ea513736876da515989eb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22294</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-12-30 09:09:20 +0000</bug_when>
    <thetext>Disabling UDBL also an optional way.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22299</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-01 21:35:56 +0000</bug_when>
    <thetext>Change Importance to High because this issue blocked Gcc build.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22303</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-02 21:40:24 +0000</bug_when>
    <thetext>yi1.li@intel.com: please provide the solution first to resolve it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22337</commentid>
    <comment_count>4</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-08 20:24:59 +0000</bug_when>
    <thetext>fixed by: https://github.com/tianocore/edk2/commit/e7152e6186d31bc138fbd2592e07886005177aab</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4118</bug_id>
          <alias>CVE-2022-36764</alias>
          <creation_ts>2022-10-25 12:23:47 +0000</creation_ts>
          <short_desc>Heap Buffer Overflow in Tcg2MeasurePeImage()</short_desc>
          <delta_ts>2024-01-16 03:03:40 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Marc Beatove">mbeatove</reporter>
          <assigned_to>jiewen.yao</assigned_to>
          <cc>dougflick</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>ghouse.adoni.mohammed</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>john.mathews</cc>
    
    <cc>kevin.davis</cc>
    
    <cc>kraxel</cc>
    
    <cc>ling.yu</cc>
    
    <cc>louis.shen</cc>
    
    <cc>mbeatove</cc>
    
    <cc>miki.demeter</cc>
    
    <cc>rcorreadeysasi</cc>
    
    <cc>rodrigo.gonzalez.del.cueto</cc>
    
    <cc>w.sheng</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19819</commentid>
    <comment_count>0</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2022-10-25 12:23:47 +0000</bug_when>
    <thetext>The `Tcg2MeasurePeImage()` function, which as stated in code comments receives untrusted input, calls to `GetDevicePathSize()` to get the size (uint32) of the “FilePath”:
```
FilePathSize = (UINT32)GetDevicePathSize (FilePath);
```

This size is later used for computing the `EventSize` which is then used for performing an allocation:
```
EventSize = sizeof (*ImageLoad) - sizeof (ImageLoad-&gt;DevicePath) + FilePathSize;
EventPtr  = AllocateZeroPool (EventSize + sizeof (EFI_TCG2_EVENT)
                 - sizeof (Tcg2Event-&gt;Event));
 if (EventPtr == NULL) {
   return EFI_OUT_OF_RESOURCES;
 }
// (...)
```

Between the call to `GetDevicePathSize()` and the allocation no checks are performed on `EventSize`, which means that the allocation size can overflow, and `AllocateZeroPool()` can return a very small allocation for a very big `FilePathSize`.

Later on the code `FilePathSize` is used again for copying memory into the allocated buffer, also without further checks on `FilePathSize`:
```
CopyMem (ImageLoad-&gt;DevicePath, FilePath, FilePathSize);
```

This means, the responsibility for checking that the `EventSize` variable doesn’t overflow when `FilePathSize` is added, is on the `GetDevicePathSize()` function.

`GetDevicePathSize()` calls `IsDevicePathValid()` which does the following:
- Sets the `MaxSize` variable (max value we can return) to `MAX_UINTN`.
- In a loop we sum up the size of the nodes and check that we don’t exceed the limit, which is not a problem because the limit is high enough. Also, even if the limit was `MAX_UINT32` we could still exploit this, because we don’t have to exceed `MaxSize - END_DEVICE_PATH_LENGTH` (4), and in `Tcg2MeasurePeImage()` we calculate `EventSize` by doing: `sizeof (*ImageLoad) - sizeof (ImageLoad-&gt;DevicePath) + FilePathSize` which is `0x24 - 4 + FilePathSize`, so `GetDevicePathSize()` could return up to 0xfffffffb which is more than enough for overflowing.
- Finally, near the end of the loop it checks that we don’t exceed the maximum amount of nodes by checking the `PcdMaximumDevicePathNodeCount` PCD, and in case is set to zero it skips this check.

So the return value from `GetDevicePathSize()` should be checked to ensure that it will not overflow when calculating the size for the allocation.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19914</commentid>
    <comment_count>1</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2022-11-02 12:18:11 +0000</bug_when>
    <thetext>Check for possible use of SafeIntLib</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20149</commentid>
    <comment_count>2</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2022-11-30 10:29:22 +0000</bug_when>
    <thetext>Jiewen - Any update on this issue? Has this issue been confirmed?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20251</commentid>
    <comment_count>3</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2022-12-21 04:07:19 +0000</bug_when>
    <thetext>My team has asked me that I share with you our disclosure timeline. It will take effect from today:

We are privately disclosing this vulnerability to 
you so that you can develop a fix and manage its rollout. We do not require 
you to keep any information of this report secret, but if you make it 
public then please let us know that you did. This advisory will be kept 
private by Google for 30 days after a fix is publicly available or after 90 
days if no fix is made. After this deadline we plan to disclose this 
advisory in full at: http://github.com/google/security-research/. Please 
read more details about this policy here: https://g.co/appsecurity</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20917</commentid>
    <comment_count>4</comment_count>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2023-01-25 11:45:39 +0000</bug_when>
    <thetext>Any updates?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21022</commentid>
    <comment_count>5</comment_count>
      <attachid>1322</attachid>
    <who name="Marc Beatove">mbeatove</who>
    <bug_when>2023-02-10 11:40:11 +0000</bug_when>
    <thetext>Created attachment 1322
Suggested patch for bug

Attaching a suggested fix for this issue to try to speed up the process.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21040</commentid>
    <comment_count>6</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-02-13 12:58:37 +0000</bug_when>
    <thetext>(In reply to Miki Demeter from comment #1)
&gt; Check for possible use of SafeIntLib

Should do the trick.

if (SafeUint32Add(sizeof (*ImageLoad) - sizeof (ImageLoad-&gt;DevicePath),
                  FilePathSize,
                  &amp;EventSize) != RETURN_SUCCESS) {
    return EFI_OUT_OF_RESOURCES;
}

This looks serious to me.  Might be exploitable.

We have less than half of the 90 days granted by google left, which implies a disclosure date not later than mid-march.  Or be really fast with it and land
the fix in stable 2023-02.

Jiewen?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21047</commentid>
    <comment_count>7</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-02-13 18:00:26 +0000</bug_when>
    <thetext>CVE-2022-36764 Reserved</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22223</commentid>
    <comment_count>8</comment_count>
      <attachid>1434</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2023-12-06 17:30:08 +0000</bug_when>
    <thetext>Created attachment 1434
Patch from GHSA

CI ran locally, and have been shipping/testing on Surface / Hyper V</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22225</commentid>
    <comment_count>9</comment_count>
      <attachid>1436</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2023-12-06 17:39:15 +0000</bug_when>
    <thetext>Created attachment 1436
Patch From GHSA - reformatting git patch

Ran CI Locally, Tested Locally, Shipping/Tested on Surface / HyperV</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22364</commentid>
    <comment_count>10</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-01-16 03:03:40 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5264</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1322</attachid>
            <date>2023-02-10 11:40:11 +0000</date>
            <delta_ts>2023-02-10 11:40:11 +0000</delta_ts>
            <desc>Suggested patch for bug</desc>
            <filename>file_4118.txt</filename>
            <type>text/plain</type>
            <size>841</size>
            <attacher name="Marc Beatove">mbeatove</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1434</attachid>
            <date>2023-12-06 17:30:08 +0000</date>
            <delta_ts>2023-12-06 17:39:15 +0000</delta_ts>
            <desc>Patch from GHSA</desc>
            <filename>4118.patch</filename>
            <type>text/plain</type>
            <size>71930</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1436</attachid>
            <date>2023-12-06 17:39:15 +0000</date>
            <delta_ts>2023-12-06 17:39:15 +0000</delta_ts>
            <desc>Patch From GHSA - reformatting git patch</desc>
            <filename>4118.patch</filename>
            <type>text/plain</type>
            <size>29604</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4632</bug_id>
          
          <creation_ts>2024-01-01 21:34:06 +0000</creation_ts>
          <short_desc>CryptoPkg: stdint.h included multiple times error</short_desc>
          <delta_ts>2024-01-11 07:32:52 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to>wenxing.hou</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22297</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-01 21:34:06 +0000</bug_when>
    <thetext>Should move those define to CryptoPkg\Library\Include\CrtLibSupport.h.


In file included from /opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/MbedTlsLib/EcSm2Null.c:11:
In file included from /opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/MbedTlsLib/mbedtls/include/mbedtls/ecp.h:40:
In file included from /opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/MbedTlsLib/mbedtls/include/mbedtls/bignum.h:29:
/opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/Include/stdint.h:11:17: error: redefinition of typedef &apos;int8_t&apos; is a C11 feature [-Werror,-Wtypedef-redefinition]
typedef INT8    int8_t;
                ^
/opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/MbedTlsLib/mbedtls/include/mbedtls/check_config.h:35:10: note: &apos;/opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/Include/stdint.h&apos; included multiple times, additional include site here
#include 
         ^
/opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/MbedTlsLib/mbedtls/include/mbedtls/bignum.h:29:10: note: &apos;/opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/Include/stdint.h&apos; included multiple times, additional include site here</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22298</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-01 21:34:47 +0000</bug_when>
    <thetext>Change Importance to High because this issue blocked Gcc build.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22304</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-02 21:41:07 +0000</bug_when>
    <thetext>yi1.li@intel.com: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22326</commentid>
    <comment_count>3</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-04 20:25:25 +0000</bug_when>
    <thetext>fixed by: https://github.com/tianocore/edk2/pull/5217</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22344</commentid>
    <comment_count>4</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-09 23:31:40 +0000</bug_when>
    <thetext>Re-opened due to regression.
Previous solution will break openssl build due to CRT header may be included before opensslconf header.

/tmp/k/Edk2/CryptoPkg/Library/OpensslLib/openssl/include/openssl/e_os2.h:223:14: error: redefinition of typedef &apos;int8_t&apos; is a C11 feature [-Werror,-Wtypedef-redefinition]
  typedef INT8 int8_t;
  ^
  /tmp/k/Edk2/CryptoPkg/Library/Include/CrtLibSupport.h:431:16: note: previous definition is here
  typedef INT8   int8_t;
  ^
  In file included from /tmp/k/Edk2/CryptoPkg/Library/BaseCryptLib/Bn/CryptBn.c:9:
  In file included from /tmp/k/Edk2/CryptoPkg/Library/OpensslLib/openssl/include/openssl/bn.h:20:
  /tmp/k/Edk2/CryptoPkg/Library/OpensslLib/openssl/include/openssl/e_os2.h:224:15: error: redefinition of typedef &apos;uint8_t&apos; is a C11 feature [-Werror,-Wtypedef-redefinition]</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22350</commentid>
    <comment_count>5</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-11 07:32:52 +0000</bug_when>
    <thetext>fixed by: e7cfdc5f14b408e85fcbcb335aae7c15bbce4dfb</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4552</bug_id>
          
          <creation_ts>2023-09-17 23:35:32 +0000</creation_ts>
          <short_desc>MdeModulePkg/Bus/Pci/XhciDxe: Need to abort the command for command timeout</short_desc>
          <delta_ts>2023-10-26 17:17:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to name="Xianglei Cai">xianglei.cai</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>more.shih</cc>
    
    <cc>xianglei.cai</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch>https://github.com/tianocore/edk2/pull/4863</cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21915</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-09-17 23:35:32 +0000</bug_when>
    <thetext>xHCI controller will disable slot when set address not successfully. But it may cause system hang if directly disable slot after command transfer timeout. According to xHCI spec 4.6, need to abort the command after command timeout.

Xianglei will work on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21969</commentid>
    <comment_count>1</comment_count>
    <who name="Xianglei Cai">xianglei.cai</who>
    <bug_when>2023-10-10 03:59:22 +0000</bug_when>
    <thetext>code change has merged in: https://github.com/tianocore/edk2/pull/4863</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22077</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 17:17:34 +0000</bug_when>
    <thetext>commit d11f0ea045f598e08b414eeba4f8a74ac1b4ca0b</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4414</bug_id>
          
          <creation_ts>2023-04-17 21:19:20 +0000</creation_ts>
          <short_desc>Create DEBUG_MANAGEABILITY error report level</short_desc>
          <delta_ts>2023-04-22 00:47:22 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21370</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-17 21:19:20 +0000</bug_when>
    <thetext>Create DEBUG_MANAGEABILITY error report level that can be used by RedfishPkg/RedfishClientPkg (under process)/ManageabilityPkg to output the detailed messages of transport payload.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21389</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-22 00:47:22 +0000</bug_when>
    <thetext>Fixed at ed2ff315.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4471</bug_id>
          
          <creation_ts>2023-05-29 02:28:26 +0000</creation_ts>
          <short_desc>SPI related header files update</short_desc>
          <delta_ts>2024-04-23 21:34:18 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>AbdulLateef.Attar</cc>
    
    <cc>Brit.Chesley</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21588</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-29 02:28:26 +0000</bug_when>
    <thetext>Define bitmaps of Attributes in SpiConfiguration.h, SpiHc.h, and SpiIo.h accordingly.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21595</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 21:42:39 +0000</bug_when>
    <thetext>abner.chang@amd.com: you can process the code first.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22888</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-04-09 02:08:58 +0000</bug_when>
    <thetext>The related drivers are also provided.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22943</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-04-23 21:25:57 +0000</bug_when>
    <thetext>@ git commit 6780b3ab.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22946</commentid>
    <comment_count>4</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-04-23 21:34:18 +0000</bug_when>
    <thetext>Commit at 7dec5667-6780b3ab</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4472</bug_id>
          
          <creation_ts>2023-05-29 03:21:28 +0000</creation_ts>
          <short_desc>Add SPI NOR FLash Serial Flash Discoverable Parameters (SFDP) Header file</short_desc>
          <delta_ts>2024-04-23 21:26:46 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>AbdulLateef.Attar</cc>
    
    <cc>Brit.Chesley</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21589</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-29 03:21:28 +0000</bug_when>
    <thetext>Add Industry standard SPI NOR Flash Serial Flash Discoverable Parameters (SFDP) Header file under MdePkg/Include/IndustryStandard.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21594</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 21:37:16 +0000</bug_when>
    <thetext>Abner will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22893</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-04-09 21:15:15 +0000</bug_when>
    <thetext>The related drivers are also provided.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22944</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-04-23 21:26:46 +0000</bug_when>
    <thetext>Commit at 7dec5667-6780b3ab</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4473</bug_id>
          
          <creation_ts>2023-05-29 03:24:45 +0000</creation_ts>
          <short_desc>Implement SPI NOR Flash JEDEC Serial Flash Discoverable Parameters (SFDP) SMM/DXE driver</short_desc>
          <delta_ts>2024-04-23 21:27:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>AbdulLateef.Attar</cc>
    
    <cc>Brit.Chesley</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21590</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-29 03:24:45 +0000</bug_when>
    <thetext>Implement SPI NOR Flash JEDEC Serial Flash Discoverable Parameters (SFDP) SMM/DXE driver to support SPI NOR flash part that is JEDEC SFDP spec compatible.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21596</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 21:43:30 +0000</bug_when>
    <thetext>abner.chang@amd.com will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22894</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-04-09 21:15:41 +0000</bug_when>
    <thetext>The related drivers are also provided.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22945</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-04-23 21:27:26 +0000</bug_when>
    <thetext>Commit at 7dec5667-6780b3ab</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4856</bug_id>
          
          <creation_ts>2024-09-27 06:38:26 +0000</creation_ts>
          <short_desc>Fixing Descriptor Misalignment in USB Configuration Handling</short_desc>
          <delta_ts>2024-12-07 02:37:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>Aniket.Surekar</reporter>
          <assigned_to>Aniket.Surekar</assigned_to>
          <cc>Aniket.Surekar</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>karunakar_poosapalli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23413</commentid>
    <comment_count>0</comment_count>
      <attachid>1540</attachid>
    <who name="">Aniket.Surekar</who>
    <bug_when>2024-09-27 06:38:26 +0000</bug_when>
    <thetext>Created attachment 1540
Fixing Descriptor Misalignment in USB Configuration Handling Patch

The issue is not locating  the expected interface descriptor and endpoint descriptor arises because the configDesc (USB_CONFIG_DESCRIPTOR) and IfDesc (USB_INTERFACE_DESCRIPTOR) are being incremented by their structure sizes instead of their actual descriptor lengths. Specifically:
-&gt;The configuration descriptor (configDesc) should be incremented by its actual length.
-&gt;The interface descriptor (IfDesc) should be incremented by its actual length .
However, the current implementation increments configDesc and InterfaceDesc are being incremented by their structure sizes instead of their actual descriptor lengths.. This incorrect increment leads to a misalignment, making it impossible to correctly access the subsequent interface and endpoint descriptors.

[Suggested Solution]
To resolve this, update the code to increment the pointers by the actual lengths of the descriptors. This ensures proper access to all descriptors in the USB configuration.

Attached is the suggested solution patch - Edk_Xhci_Usb.zip</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23480</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-10-23 20:45:36 +0000</bug_when>
    <thetext>Aniket.Surekar@Dell.com: please create edk2 pull request to make this change.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23541</commentid>
    <comment_count>2</comment_count>
    <who name="">Aniket.Surekar</who>
    <bug_when>2024-11-27 23:46:08 +0000</bug_when>
    <thetext>These changes address an issue where multiple third-party EFTPOS USB devices caused the system to hang in preboot after being connected to the SUT.

Detail analysis:

Analysis of the Issue: (same analysis is applicable for End point descriptor)
The issue occurs because the Interface/Endpoint Descriptor does not receive the expected value, and the length of the interface descriptor is being read as 0 (9th byte of data is 0x0 mentioned in hex dump snap). Consequently, the system hangs in a while loop.




IfDesc = (USB INTEREACE DESCRIPTOR *)(ConfigDesc + 1);
Tor (Index = 0; Index &lt; ConfigDesc-&gt;NominterTaces; Index++)

while ((IfDesc-&gt;DescriptorType != USB_DESC_TYPE_INTERFACE) | | (IfDesc-&gt;AlternateSetting != 0))
{

/ConfigDesc structure size is 9
byte

IfDesc - (USB_INTERFACE_DESCRIPTOR *)((UINTN)IfDesc + IfDesc-&gt;Length);




The root cause is that the configDesc (USB_CONFIG_DESCRIPTOR) structure has a fixed length of 9 bytes. However, recent logs from the dump show that a third-party USB device reports a configuration length of 0x0A (10 bytes). In the code, the length is incremented by 9 bytes, causing the interface descriptor to be incorrectly updated from 9 bytes instead of 10 bytes. This mismatch results in the interface descriptor and End Point descriptor type and length being incorrect.

Snap hex dump of config/interface/end point descriptor 



Config Desc Lenght

0xUA 0x02 0x34 0x00 0x01 0x01 0x00 0x60 0x01 0x00 0x0A 0x04 0x00 0x00 0x04 0xDC
OXAO UXBU OXUU 0X00 0x08 0x05 0x81 0x03 0x10 0x00 0X0A 0x00 0x08 0x05 0x01 0x03
0x10 0x00 0x0A 0x00 0x08 0x05 0x82 0x02 0x40 0x00 0x0A 0x00 0x08 0x05 0x02 0x02
0x40 0x00 0x0A 0x00



So fix as mentioned :
Update the code to increment the pointers by the actual descriptor lengths,
ensuring proper access to all descriptors in the USB configuration.


-IfDesc = (USB_INTERFACE_DESCRIPTOR *) (ConfigDesc + 1);
+IfDesc = (USB_INTERFACE_DESCRIPTOR *)((UINTN)ConfigDesc + ConfigDesc-&gt;Length);</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23543</commentid>
    <comment_count>3</comment_count>
    <who name="">Aniket.Surekar</who>
    <bug_when>2024-12-01 07:31:25 +0000</bug_when>
    <thetext>Created Pull request for the same :https://github.com/tianocore/edk2/pull/6442</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23554</commentid>
    <comment_count>4</comment_count>
    <who name="">Aniket.Surekar</who>
    <bug_when>2024-12-06 01:18:04 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/6442 PR got merged so closing this ticket</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23557</commentid>
    <comment_count>5</comment_count>
    <who name="">Aniket.Surekar</who>
    <bug_when>2024-12-07 02:37:32 +0000</bug_when>
    <thetext>
Changes merged commit ID 
333e9638ad29828f4cac64ad966b0e7f8c9b0c66</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1540</attachid>
            <date>2024-09-27 06:38:26 +0000</date>
            <delta_ts>2024-09-27 06:38:26 +0000</delta_ts>
            <desc>Fixing Descriptor Misalignment in USB Configuration Handling Patch</desc>
            <filename>Edk_Xhci_Usb.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>77944</size>
            <attacher>Aniket.Surekar</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4211</bug_id>
          
          <creation_ts>2022-12-23 04:34:08 +0000</creation_ts>
          <short_desc>MdeModulePkg/Bus/Pci/UhciDxe: Coverity scan flags multiple issues</short_desc>
          <delta_ts>2023-10-30 11:48:46 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Ranbir Singh">saini.ranbirs</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>john.mathews</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20275</commentid>
    <comment_count>0</comment_count>
      <attachid>1073</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-23 04:34:08 +0000</bug_when>
    <thetext>Created attachment 1073
HTML files reflecting the issues

3 issues have been captured by Coverity scan for MdeModulePkg/Bus/Pci/UhciDxe.

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20276</commentid>
    <comment_count>1</comment_count>
      <attachid>1074</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-23 04:37:48 +0000</bug_when>
    <thetext>Created attachment 1074
Proposed patch to resolve the issues pointed by Coverity

The Coverity reports are self-explanatory at all the 3 points.

The function UhciConvertPollRate has a check

    ASSERT (Interval != 0);

but this comes into play only in DEBUG mode. In Release mode, there is
no handling if the Interval parameter value is ZERO. To avoid shifting
by a negative amount later in the code flow in this undesirable case,
it is better to handle it as well by simply returning ZERO.

The functions UsbHcGetPciAddressForHostMem and UsbHcFreeMem do have

    ASSERT ((Block != NULL));

statements after for loop, but these are applicable only in DEBUG mode.
In RELEASE mode, if for whatever reasons there is no match inside for
loop and the loop exits because of Block != NULL; condition, then there
is no &quot;Block&quot; NULL pointer check afterwards and the code proceeds to do
dereferencing &quot;Block&quot; which will lead to CRASH.

Hence, for safety add NULL pointer checks always.

With the changes added as reflected by patch, Coverity scan does not reflect the same BAD_SHIFT and FORWARD_NULL issues at the points as observed originally.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20453</commentid>
    <comment_count>2</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-04 02:13:42 +0000</bug_when>
    <thetext>Patch sent to EDK2 mail list for code review with mail subject as -

[PATCH] MdeModulePkg/Bus/Pci/UhciDxe: Fix various Coverity issues</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20766</commentid>
    <comment_count>3</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 06:37:52 +0000</bug_when>
    <thetext>(In reply to Ranbir Singh from comment #1)
&gt; Created attachment 1074 [details]
&gt; Proposed patch to resolve the issues pointed by Coverity
&gt; 
&gt; The Coverity reports are self-explanatory at all the 3 points.
&gt; 
&gt; The function UhciConvertPollRate has a check
&gt; 
&gt;     ASSERT (Interval != 0);
&gt; 
&gt; but this comes into play only in DEBUG mode. In Release mode, there is
&gt; no handling if the Interval parameter value is ZERO. To avoid shifting
&gt; by a negative amount later in the code flow in this undesirable case,
&gt; it is better to handle it as well by simply returning ZERO.
&gt; 
&gt; The functions UsbHcGetPciAddressForHostMem and UsbHcFreeMem do have
&gt; 
&gt;     ASSERT ((Block != NULL));
&gt; 
&gt; statements after for loop, but these are applicable only in DEBUG mode.
&gt; In RELEASE mode, if for whatever reasons there is no match inside for
&gt; loop and the loop exits because of Block != NULL; condition, then there
&gt; is no &quot;Block&quot; NULL pointer check afterwards and the code proceeds to do
&gt; dereferencing &quot;Block&quot; which will lead to CRASH.
&gt; 
&gt; Hence, for safety add NULL pointer checks always.
&gt; 
&gt; With the changes added as reflected by patch, Coverity scan does not reflect
&gt; the same BAD_SHIFT and FORWARD_NULL issues at the points as observed
&gt; originally.

Making this patch as obsolete and updating a newer patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20767</commentid>
    <comment_count>4</comment_count>
      <attachid>1220</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 06:39:41 +0000</bug_when>
    <thetext>Created attachment 1220
Proposed patch to resolve the Bad_Shift issue pointed by Coverity for MdeModulePkg.

Please consider this patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20768</commentid>
    <comment_count>5</comment_count>
      <attachid>1221</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 06:41:51 +0000</bug_when>
    <thetext>Created attachment 1221
Proposed patch to resolve the Forward_Null issue pointed by Coverity for MdeModulePkg.

Please consider this patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21930</commentid>
    <comment_count>6</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-09-22 03:48:44 +0000</bug_when>
    <thetext>Patch series sent at:

https://edk2.groups.io/g/devel/message/107788 - [PATCH v2 0/2] MdeModulePkg/Bus/Pci/UhciDxe: Fix issues pointed by Coverity

https://edk2.groups.io/g/devel/message/107789 - [PATCH v2 1/2] MdeModulePkg/Bus/Pci/UhciDxe: Fix BAD_SHIFT Coverity issue

https://edk2.groups.io/g/devel/message/107790 - [PATCH v2 2/2] MdeModulePkg/Bus/Pci/UhciDxe: Fix FORWARD_NULL Coverity issues

Series has been merged via:

PR - https://github.com/tianocore/edk2/pull/4856

Commits:
https://github.com/tianocore/edk2/commit/e9f5d8c0e066da55b3f79dfdbf4df5fc97ca5916
https://github.com/tianocore/edk2/commit/28a267af4024c329e58121ccd9bf5f4f7aabc0f4</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1073</attachid>
            <date>2022-12-23 04:34:08 +0000</date>
            <delta_ts>2022-12-23 04:34:08 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>MdeModulePkg - UhciDxe Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>33338</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1074</attachid>
            <date>2022-12-23 04:37:48 +0000</date>
            <delta_ts>2023-01-24 06:38:09 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity</desc>
            <filename>0001-MdeModulePkg-Bus-Pci-UhciDxe-Fix-Coverity-issues.patch</filename>
            <type>text/plain</type>
            <size>2417</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1220</attachid>
            <date>2023-01-24 06:39:41 +0000</date>
            <delta_ts>2023-01-24 06:39:41 +0000</delta_ts>
            <desc>Proposed patch to resolve the Bad_Shift issue pointed by Coverity for MdeModulePkg.</desc>
            <filename>0001-MdeModulePkg-Bus-Pci-UhciDxe-Fix-BAD_SHIFT-Coverity-.patch</filename>
            <type>text/plain</type>
            <size>1300</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1221</attachid>
            <date>2023-01-24 06:41:51 +0000</date>
            <delta_ts>2023-01-24 06:41:51 +0000</delta_ts>
            <desc>Proposed patch to resolve the Forward_Null issue pointed by Coverity for MdeModulePkg.</desc>
            <filename>0002-MdeModulePkg-Bus-Pci-UhciDxe-Fix-FORWARD_NULL-Coveri.patch</filename>
            <type>text/plain</type>
            <size>1713</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4631</bug_id>
          
          <creation_ts>2024-01-01 01:19:34 +0000</creation_ts>
          <short_desc>Fix the hardcoded TLS cofiguration data in Httpsupport.c when initial TLS sesssion for HTTPs</short_desc>
          <delta_ts>2024-01-30 20:45:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>igork</cc>
    
    <cc>nicklew</cc>
    
    <cc>saloni.kasbekar</cc>
    
    <cc>zachary.clark-williams</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>Other</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22295</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-01-01 01:19:34 +0000</bug_when>
    <thetext>TLS configuration data below is hardcoded in TlsConfigureSession function, this results HTTP application is not able to provide its own TLS configuration.

  //
  // TlsConfigData initialization
  //
  HttpInstance-&gt;TlsConfigData.ConnectionEnd       = EfiTlsClient;
  HttpInstance-&gt;TlsConfigData.VerifyMethod        = EFI_TLS_VERIFY_PEER;
  HttpInstance-&gt;TlsConfigData.VerifyHost.Flags    = EFI_TLS_VERIFY_FLAG_NONE;
  HttpInstance-&gt;TlsConfigData.VerifyHost.HostName = HttpInstance-&gt;RemoteHost;
  HttpInstance-&gt;TlsConfigData.SessionState        = EfiTlsSessionNotStarted;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22296</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-01-01 01:22:38 +0000</bug_when>
    <thetext>Patch set was sent to the mailing list, https://edk2.groups.io/g/devel/message/113004.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22305</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-02 21:43:20 +0000</bug_when>
    <thetext>abner.chang@amd.com will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22448</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-01-30 20:45:11 +0000</bug_when>
    <thetext>Fixed at 0abd598e-84664809</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4255</bug_id>
          
          <creation_ts>2023-01-05 05:12:18 +0000</creation_ts>
          <short_desc>MdeModulePkg/Universal/SetupBrowserDxe - Part 2: Coverity scan flags issues</short_desc>
          <delta_ts>2023-01-09 05:44:52 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4254</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20498</commentid>
    <comment_count>0</comment_count>
      <attachid>1130</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-05 05:12:18 +0000</bug_when>
    <thetext>Created attachment 1130
HTML files reflecting the coverity issues.

13 issues have been captured by Coverity scan for the MdeModulePkg/Universal/SetupBrowserDxe. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20543</commentid>
    <comment_count>1</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-09 05:44:52 +0000</bug_when>
    <thetext>To be handled in 4254

*** This bug has been marked as a duplicate of bug 4254 ***</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1130</attachid>
            <date>2023-01-05 05:12:18 +0000</date>
            <delta_ts>2023-01-05 05:12:18 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues.</desc>
            <filename>MdeModulePkg-SetupBrowserDxe-CoverityIssues_2.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>508730</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4342</bug_id>
          
          <creation_ts>2023-02-10 14:43:39 +0000</creation_ts>
          <short_desc>[OpenSSL] Update OpenSSL version to version 1.1.1t to include CVE fix</short_desc>
          <delta_ts>2023-03-29 02:25:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Miki Demeter">miki.demeter</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>BrianM</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>lelia.c.barlow</cc>
    
    <cc>w.sheng</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21026</commentid>
    <comment_count>0</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-02-10 14:43:39 +0000</bug_when>
    <thetext>Context: There was a set of new OpenSSL CVEs publicly announced on 07 February 2023. Of the 8 new CVEs announced, 4 affect the OpenSSL 1.1.1 branch:

CVE-2023-0286 X.400 address type confusion in X.509 GeneralName [HIGH severity] 

CVE-2023-0215 Use-after-free following BIO_new_NDEF [MODERATE severity] 

CVE-2022-4450 Double free after calling PEM_read_bio_ex [MODERATE severity] 

CVE-2022-4304 Timing Oracle in RSA Decryption [MODERATE severity] 

 Request update to latest version</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21056</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-02-14 21:52:33 +0000</bug_when>
    <thetext>jiewen.yao@intel.com: who will contribute the patch for it?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21096</commentid>
    <comment_count>2</comment_count>
      <attachid>1330</attachid>
    <who name="Sheng Wei">w.sheng</who>
    <bug_when>2023-02-21 23:59:55 +0000</bug_when>
    <thetext>Created attachment 1330
Patch of update openssl to 1.1.1t</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21097</commentid>
    <comment_count>3</comment_count>
    <who name="Sheng Wei">w.sheng</who>
    <bug_when>2023-02-22 00:00:22 +0000</bug_when>
    <thetext>I will prepare the patch of update openssl to 1.1.1t</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21122</commentid>
    <comment_count>4</comment_count>
    <who name="Brian Mullen">BrianM</who>
    <bug_when>2023-02-28 15:52:19 +0000</bug_when>
    <thetext>Which release will this be included in?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21130</commentid>
    <comment_count>5</comment_count>
    <who name="Brian Mullen">BrianM</who>
    <bug_when>2023-03-01 12:46:24 +0000</bug_when>
    <thetext>Will not make it into 022022 release label. Next opportunity will be the 052022 label.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21158</commentid>
    <comment_count>6</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-03-07 18:17:04 +0000</bug_when>
    <thetext>Any updates on when this will be merged to the Main branch of edk2?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21287</commentid>
    <comment_count>7</comment_count>
    <who name="Sheng Wei">w.sheng</who>
    <bug_when>2023-03-29 02:25:19 +0000</bug_when>
    <thetext>Patch has been merged.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1330</attachid>
            <date>2023-02-21 23:59:55 +0000</date>
            <delta_ts>2023-02-21 23:59:55 +0000</delta_ts>
            <desc>Patch of update openssl to 1.1.1t</desc>
            <filename>0001-CryptoPkg-OpensslLib-Upgrade-OpenSSL-to-1.1.1t.patch</filename>
            <type>application/octet-stream</type>
            <size>648307</size>
            <attacher name="Sheng Wei">w.sheng</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4322</bug_id>
          
          <creation_ts>2023-01-19 05:58:51 +0000</creation_ts>
          <short_desc>NetworkPkg/HttpBootDxe: Coverity scan flags REVERSE_INULL issue</short_desc>
          <delta_ts>2023-01-25 10:51:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20728</commentid>
    <comment_count>0</comment_count>
      <attachid>1206</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-19 05:58:51 +0000</bug_when>
    <thetext>Created attachment 1206
HTML files reflecting the coverity issues.

1 REVERSE_INULL issue has been captured by Coverity scan for NetworkPkg/HttpBootDxe

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20914</commentid>
    <comment_count>1</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-25 10:51:24 +0000</bug_when>
    <thetext>Not an issue</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1206</attachid>
            <date>2023-01-19 05:58:51 +0000</date>
            <delta_ts>2023-01-19 05:58:51 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues.</desc>
            <filename>NetworkPkg-HttpBootDxe-CoverityIssues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>41763</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4842</bug_id>
          
          <creation_ts>2024-09-03 21:53:27 +0000</creation_ts>
          <short_desc>CryptoPkg: should update openssl to 3.0.15 due to CVE-2024-6119</short_desc>
          <delta_ts>2024-09-27 02:53:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to name="yi1.li@intel.com">yi1.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>lelia.c.barlow</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23361</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-09-03 21:53:27 +0000</bug_when>
    <thetext>https://www.cve.org/CVERecord?id=CVE-2024-6119

Applications performing certificate name checks (e.g., TLS clients checking
server certificates) may attempt to read an invalid memory address when
comparing the expected name with an `otherName` subject alternative name of an
X.509 certificate. This may result in an exception that terminates the
application program.

Note that basic certificate chain validation (signatures, dates, ...) is not
affected, the denial of service can occur only when the application also
specifies an expected DNS name, Email address or IP address.

///
TlsSetVerifyHost () will enable X509 Host name/IpAddr verification, and then call into the affected OpenSSL code during the handshake process.
///

The FIPS modules in 3.3, 3.2, 3.1 and 3.0 are not affected by this issue.
OpenSSL 1.1.1 and 1.0.2 are also not affected by this issue.

OpenSSL 3.3, 3.2, 3.1 and 3.0 are vulnerable to this issue.

OpenSSL 3.3 users should upgrade to OpenSSL 3.3.2

OpenSSL 3.2 users should upgrade to OpenSSL 3.2.3

OpenSSL 3.1 users should upgrade to OpenSSL 3.1.7

OpenSSL 3.0 users should upgrade to OpenSSL 3.0.15</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23362</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-09-04 20:35:17 +0000</bug_when>
    <thetext>please go ahead</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23412</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-09-27 02:53:32 +0000</bug_when>
    <thetext>pushed:
https://github.com/tianocore/edk2/commit/c13f9de56d743d7435421bc3e6f0756defe81471
https://github.com/tianocore/edk2/commit/3ed4f43f83c1f9ef6033a889d0c50378165623a5</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4260</bug_id>
          
          <creation_ts>2023-01-05 12:54:13 +0000</creation_ts>
          <short_desc>UefiCpuPkg/Universal/Acpi/S3Resume2Pei: Coverity scan flags FORWARD_NULL issue</short_desc>
          <delta_ts>2023-01-09 01:25:51 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4227</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20508</commentid>
    <comment_count>0</comment_count>
      <attachid>1135</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-05 12:54:13 +0000</bug_when>
    <thetext>Created attachment 1135
HTML files reflecting the coverity issues.

1 FORWARD_NULL issue has been captured by Coverity scan for the UefiCpuPkg/Universal/Acpi/S3Resume2Pei. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20535</commentid>
    <comment_count>1</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-09 01:23:42 +0000</bug_when>
    <thetext>Duplicate ticket</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20536</commentid>
    <comment_count>2</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-09 01:25:51 +0000</bug_when>
    <thetext>

*** This bug has been marked as a duplicate of bug 4227 ***</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1135</attachid>
            <date>2023-01-05 12:54:13 +0000</date>
            <delta_ts>2023-01-05 12:54:13 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues.</desc>
            <filename>UefiCpuPkg-Acpi-S3Resume2Pei.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>19248</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4581</bug_id>
          
          <creation_ts>2023-10-30 01:29:18 +0000</creation_ts>
          <short_desc>Remove IpmiCommandLib from IpmiFeaturePkg</short_desc>
          <delta_ts>2023-11-27 21:53:30 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>IpmiFeaturePkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>chasel.chiu</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>lisa.huang</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22102</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-10-30 01:29:18 +0000</bug_when>
    <thetext>Remove IpmiCommandLib from IpmiFeaturePkg as the IPMI command support in ManageabilityPkg has the same functionalities with newly added support.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22111</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-31 20:37:18 +0000</bug_when>
    <thetext>Abner takes it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22192</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-11-27 21:52:24 +0000</bug_when>
    <thetext>Fixed at 899a9dc9 on edk2-platform repo.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22193</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-11-27 21:53:30 +0000</bug_when>
    <thetext>Fixed at 899a9dc9 on edk2-platform repo.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4277</bug_id>
          
          <creation_ts>2023-01-09 07:53:49 +0000</creation_ts>
          <short_desc>SecurityPkg/Library/HashLibBaseCryptoRouter: Coverity scan flags CHECKED_RETURN issue</short_desc>
          <delta_ts>2023-01-23 04:40:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4225</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="Veeresh Sangolli">veeresh.sangolli</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>saini.ranbirs</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20548</commentid>
    <comment_count>0</comment_count>
      <attachid>1150</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-09 07:53:49 +0000</bug_when>
    <thetext>Created attachment 1150
HTML files reflecting the coverity issues.

1 CHECKED_RETURN issue has been captured by Coverity scan for the SecurityPkg/Library/HashLibBaseCryptoRouter. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20600</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-10 21:54:07 +0000</bug_when>
    <thetext>please take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20747</commentid>
    <comment_count>2</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-23 04:40:04 +0000</bug_when>
    <thetext>To be handled in 4225

*** This bug has been marked as a duplicate of bug 4225 ***</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1150</attachid>
            <date>2023-01-09 07:53:49 +0000</date>
            <delta_ts>2023-01-09 07:53:49 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues.</desc>
            <filename>SecurityPkg-HashLibBaseCryptoRoute-CoverityIssues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>13139</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4616</bug_id>
          
          <creation_ts>2023-12-07 21:24:56 +0000</creation_ts>
          <short_desc>mbedtls crypto SHA384 buffer misuse</short_desc>
          <delta_ts>2023-12-08 03:27:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>jiewen.yao</reporter>
          <assigned_to>wenxing.hou</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22237</commentid>
    <comment_count>0</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-12-07 21:24:56 +0000</bug_when>
    <thetext>MBedTLS crypto implementation - https://github.com/tianocore/edk2/blob/master/CryptoPkg/Library/BaseCryptLibMbedTls/Hash/CryptSha512.c

Sha384Final() expect to have input buffer 48 bytes for SHA384 hash.

However, it calls mbedtls_sha512_finish_ret() which expects 64 bytes output buffer.

========
int mbedtls_sha512_finish_ret( mbedtls_sha512_context *ctx,
                               unsigned char output[64] );
========

Sha384Final() should have a 64 bytes local buffer then copy to 48bytes output.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22238</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-12-07 21:26:54 +0000</bug_when>
    <thetext>This bug is triggered from https://github.com/DMTF/libspdm/issues/2467.

We need fix it ASAP.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22239</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-12-07 22:03:06 +0000</bug_when>
    <thetext>Wenxing working on it</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22240</commentid>
    <comment_count>3</comment_count>
    <who name="">wenxing.hou</who>
    <bug_when>2023-12-08 01:38:32 +0000</bug_when>
    <thetext>I think both Sha384Final and Sha384HashAll are OK in EDKII.  Because in the current EDKII use mbedtls v3.3.0.

Taking Sha384Final as an example:
the Sha384Final call mbedtls_sha512_finish_ret.  
However, the mbedtls_sha512_finish_ret is defined to mbedtls_sha512_finish in the mbedtls 3.3.0.

#define mbedtls_sha512_finish_ret     mbedtls_sha512_finish


 * \param output   The SHA-384 or SHA-512 checksum result.
 *                 This must be a writable buffer of length \c 64 bytes
 *                 for SHA-512, \c 48 bytes for SHA-384.
 *
 * \return         \c 0 on success.
 * \return         A negative error code on failure.
 */
int mbedtls_sha512_finish( mbedtls_sha512_context *ctx,
                           unsigned char *output );</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22241</commentid>
    <comment_count>4</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-12-08 03:27:14 +0000</bug_when>
    <thetext>Got it. It seems false alarm.
Closing.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4285</bug_id>
          
          <creation_ts>2023-01-10 01:19:35 +0000</creation_ts>
          <short_desc>NetworkPkg/Dhcp4Dxe: Coverity scan flags FORWARD_NULL issue</short_desc>
          <delta_ts>2023-01-10 05:22:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4257</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20559</commentid>
    <comment_count>0</comment_count>
      <attachid>1157</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-10 01:19:35 +0000</bug_when>
    <thetext>Created attachment 1157
HTML files reflecting the coverity issues.

1 FORWARD_NULL issue has been captured by Coverity scan for the NetworkPkg/Dhcp4Dxe. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20567</commentid>
    <comment_count>1</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-10 05:22:08 +0000</bug_when>
    <thetext>To be taken care in 4257.

*** This bug has been marked as a duplicate of bug 4257 ***</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1157</attachid>
            <date>2023-01-10 01:19:35 +0000</date>
            <delta_ts>2023-01-10 01:19:35 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues.</desc>
            <filename>NetworkPkg-Dhcp4Dxe-CoverityIssues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>23141</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4777</bug_id>
          
          <creation_ts>2024-05-21 03:30:26 +0000</creation_ts>
          <short_desc>Initial commit of AMD cross platform/board generic encapsulated software architecture</short_desc>
          <delta_ts>2024-05-29 21:41:25 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>AmdPlatforms</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>AbdulLateef.Attar</cc>
    
    <cc>duke.zhai</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>eric.xing</cc>
    
    <cc>gaoliming</cc>
    
    <cc>Igniculus.Fu</cc>
    
    <cc>ken.yao</cc>
    
    <cc>paul.grimes</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23049</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-05-21 03:30:26 +0000</bug_when>
    <thetext>Initial commit of AMD generic encapsulated software architecture that provides the basic definitions and protocols for the follow-up AMD server open board project.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23068</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-29 20:55:52 +0000</bug_when>
    <thetext>Abner will take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23079</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-05-29 21:41:25 +0000</bug_when>
    <thetext>@4f32c348</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4213</bug_id>
          
          <creation_ts>2022-12-23 08:19:49 +0000</creation_ts>
          <short_desc>IPMI Redfish host interface</short_desc>
          <delta_ts>2023-04-01 21:27:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>igork</cc>
    
    <cc>nickle.wang</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
    
    <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20279</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-12-23 08:19:49 +0000</bug_when>
    <thetext>Updates IPMI for supporting Redfish Host interface Credential bootstrapping spec and building up SMBIOS 42 record for the USB NIC host interface exposed by BMC.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20436</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:46:55 +0000</bug_when>
    <thetext>Abner is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21298</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-01 21:27:56 +0000</bug_when>
    <thetext>Resolved at f8fb208a</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4214</bug_id>
          
          <creation_ts>2022-12-23 08:21:39 +0000</creation_ts>
          <short_desc>IPMI Redfish host interface</short_desc>
          <delta_ts>2023-04-01 21:25:06 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>IpmiFeaturePkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>igork</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20280</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-12-23 08:21:39 +0000</bug_when>
    <thetext>Updates IPMI for supporting Redfish Host interface Credential bootstrapping spec and building up SMBIOS 42 record for the USB NIC host interface exposed by BMC.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20435</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:44:38 +0000</bug_when>
    <thetext>Abner is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21297</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-01 21:25:06 +0000</bug_when>
    <thetext>Resoved at 857a342e</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4336</bug_id>
          
          <creation_ts>2023-02-07 11:05:58 +0000</creation_ts>
          <short_desc>Rename IpmiSubmitCommand defined in IPMI Transport protocol</short_desc>
          <delta_ts>2023-03-02 20:31:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>IpmiFeaturePkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>High</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>AbdulLateef.Attar</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>isaac.w.oram</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20996</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-02-07 11:05:58 +0000</bug_when>
    <thetext>Rename IpmiSubmitCommand defined in IPMI Transport protocol (IPMI_TRANSPORT) to IpmiSendCommand because the naming of this function is confusing with IpmiSubmitCommand defined in IPMI Protocol (IPMI_PROTOCOL).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21060</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-02-14 21:59:32 +0000</bug_when>
    <thetext>Abner is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21141</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-03-02 20:31:19 +0000</bug_when>
    <thetext>Per to discussion, just keep the old version of IPMI implementation. Create a new one under the proposed ManageabilityPkg on edk2-platforms..</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4611</bug_id>
          
          <creation_ts>2023-12-03 21:44:37 +0000</creation_ts>
          <short_desc>[BaseLib][RiscV64]InternalSwitchStack has a bug that cannot pass context to EntryPoint</short_desc>
          <delta_ts>2024-01-11 11:41:50 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>critical</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>yangcheng.work</reporter>
          <assigned_to>yangcheng.work</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22215</commentid>
    <comment_count>0</comment_count>
    <who name="">yangcheng.work</who>
    <bug_when>2023-12-03 21:44:37 +0000</bug_when>
    <thetext>In the implementation of the InternalSwitchStack function of BaseLib&apos;s RiscV64 architecture, LongJump is used to transfer control to a function that uses a new stack. Context1 and Context1 are expected to be passed to the new function.

VOID
EFIAPI
InternalSwitchStack (
  IN      SWITCH_STACK_ENTRY_POINT  EntryPoint,
  IN      VOID                      *Context1    OPTIONAL,
  IN      VOID                      *Context2    OPTIONAL,
  IN      VOID                      *NewStack,
  IN      VA_LIST                   Marker
  )
{
  BASE_LIBRARY_JUMP_BUFFER  JumpBuffer;

  JumpBuffer.RA = (UINTN)EntryPoint;
  JumpBuffer.SP = (UINTN)NewStack - sizeof (VOID *);
  JumpBuffer.S0 = (UINT64)(UINTN)Context1;
  JumpBuffer.S1 = (UINT64)(UINTN)Context2;
  LongJump (&amp;JumpBuffer, (UINTN)-1);
  ASSERT (FALSE);
}

In previous versions, this method worked, because in the implementation of LongJump, the contents of Context1 and Context2 were mistakenly passed to the new function using the a0 and a1 registers. However, this method no longer works after the bug in LongJump was fixed two months ago.（https://github.com/tianocore/edk2/commit/ea628f28e59849ee7b91e6660c0ecd1a5c6e0884），LongJump now uses a0 to pass return values instead of arguments.

    .globl  InternalLongJump
InternalLongJump:
    REG_L ra,  0*SZREG(a0)
    REG_L s0,  1*SZREG(a0)
    REG_L s1,  2*SZREG(a0)
    REG_L s2,  3*SZREG(a0)
    REG_L s3,  4*SZREG(a0)
    REG_L s4,  5*SZREG(a0)
    REG_L s5,  6*SZREG(a0)
    REG_L s6,  7*SZREG(a0)
    REG_L s7,  8*SZREG(a0)
    REG_L s8,  9*SZREG(a0)
    REG_L s9,  10*SZREG(a0)
    REG_L s10, 11*SZREG(a0)
    REG_L s11, 12*SZREG(a0)
    REG_L sp,  13*SZREG(a0)
    mv    a0, a1
    ret

Therefore, the HandOffToDxeCore function and the PeiCheckAndSwitchStack function that use the SwitchStack function will not be able to correctly pass parameters to the new function.

I think we can use separate assembly function instead of LongJump function like InternalSwitchStack function in Arm. If my idea works I can submit code to fix the problem. Or does anyone have better suggestions?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22317</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-02 22:00:48 +0000</bug_when>
    <thetext>yangcheng.work@foxmail.com: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22318</commentid>
    <comment_count>2</comment_count>
    <who name="">yangcheng.work</who>
    <bug_when>2024-01-02 22:33:23 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #1)
&gt; yangcheng.work@foxmail.com: please work on it.
I fixed the bug and the message on https://edk2.groups.io/g/devel/message/113057, Please help me review it, thx.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22352</commentid>
    <comment_count>3</comment_count>
    <who name="">yangcheng.work</who>
    <bug_when>2024-01-11 11:41:50 +0000</bug_when>
    <thetext>This issue has been fixed in this patch(https://edk2.groups.io/g/devel/message/113624), change the status of the issue</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4399</bug_id>
          
          <creation_ts>2023-04-03 21:06:38 +0000</creation_ts>
          <short_desc>Implement edk2 PLDM protocol</short_desc>
          <delta_ts>2023-04-25 21:55:59 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>ManageabilityPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21305</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-03 21:06:38 +0000</bug_when>
    <thetext>Implement edk2 PLDM protocol that creates the PLDM message and delivers the message through a selected manageability transport interface.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21419</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:54:13 +0000</bug_when>
    <thetext>Abner has worked on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21422</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-25 21:55:59 +0000</bug_when>
    <thetext>Fixed at 32fd108b on edk2-platforms</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4217</bug_id>
          
          <creation_ts>2022-12-26 14:04:29 +0000</creation_ts>
          <short_desc>NetworkPkg: Coverity flagged issues in edk2-stable202208</short_desc>
          <delta_ts>2022-12-28 04:54:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4218</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20289</commentid>
    <comment_count>0</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2022-12-26 14:04:29 +0000</bug_when>
    <thetext>HTML files reflecting the issues

4 issues have been captured by Coverity scan for the FatPkg. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20310</commentid>
    <comment_count>1</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-28 04:54:24 +0000</bug_when>
    <thetext>Over-riden by 4218

*** This bug has been marked as a duplicate of bug 4218 ***</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4400</bug_id>
          
          <creation_ts>2023-04-03 21:10:54 +0000</creation_ts>
          <short_desc>Add MCTP manageability transport interface</short_desc>
          <delta_ts>2023-04-25 21:57:39 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>ManageabilityPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21306</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-03 21:10:54 +0000</bug_when>
    <thetext>Add MCTP manageability transport interface for upper layer protocol such as PLDM.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21417</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:53:03 +0000</bug_when>
    <thetext>Abner is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21423</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-25 21:57:39 +0000</bug_when>
    <thetext>Fixed at 0525ec8e on edk2-platform</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4218</bug_id>
          
          <creation_ts>2022-12-26 14:22:27 +0000</creation_ts>
          <short_desc>NetworkPkg/HttpDxe: Coverity scan flags NULL_RETURNS issues</short_desc>
          <delta_ts>2023-01-02 06:39:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20290</commentid>
    <comment_count>0</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2022-12-26 14:22:27 +0000</bug_when>
    <thetext>HTML files reflecting the issues

4 issues have been captured by Coverity scan for the FatPkg. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20291</commentid>
    <comment_count>1</comment_count>
      <attachid>1082</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2022-12-26 14:24:07 +0000</bug_when>
    <thetext>Created attachment 1082
HTML files reflecting the coverity issues.

HTML files reflecting the issues

4 issues have been captured by Coverity scan for the NetworkPkg. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20311</commentid>
    <comment_count>2</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-28 04:54:24 +0000</bug_when>
    <thetext>*** Bug 4217 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20312</commentid>
    <comment_count>3</comment_count>
      <attachid>1097</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-28 05:05:26 +0000</bug_when>
    <thetext>Created attachment 1097
HTML files reflecting the coverity issues

updated attachment with missing links correction</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20313</commentid>
    <comment_count>4</comment_count>
      <attachid>1098</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-28 05:39:53 +0000</bug_when>
    <thetext>Created attachment 1098
HTML files reflecting the issues

The earlier files were having broken link issues. Consider this attachment only.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20317</commentid>
    <comment_count>5</comment_count>
      <attachid>1101</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-28 09:16:57 +0000</bug_when>
    <thetext>Created attachment 1101
Proposed patch to resolve the issues pointed by Coverity

If PacketOut is NULL, even then

    NetbufAllocSpace (PacketOut, (UINT32)BufferOutSize, NET_BUF_TAIL);

is getting called which further calls macro

    NET_CHECK_SIGNATURE (Nbuf, NET_BUF_SIGNATURE);

Nbuf receives the value of PacketOut. This macro is defined as

#define NET_CHECK_SIGNATURE(PData, SIGNATURE) \
  ASSERT (((PData) != NULL) &amp;&amp; ((PData)-&gt;Signature == (SIGNATURE)))

but this ASSERT comes into play only in DEBUG mode. In Release mode,
there is no handling if the Nbuf value is NULL and the code proceeds
to unconditionally dereference &quot;Nbuf&quot; which will lead to CRASH.

Hence, for safety add NULL pointer checks always wrt PacketOut and
return EFI_OUT_OF_RESOURCES if PacketOut value is NULL.

With the changes added as reflected by patch, Coverity scan does not reflect the same 4 NULL_RETURNS issues at the points as observed originally.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20361</commentid>
    <comment_count>6</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-02 06:39:04 +0000</bug_when>
    <thetext>To be seen later</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1082</attachid>
            <date>2022-12-26 14:24:07 +0000</date>
            <delta_ts>2022-12-28 05:05:26 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues.</desc>
            <filename>NetworkPkg-HttpDxe-CoverityIssues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>106723</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1097</attachid>
            <date>2022-12-28 05:05:26 +0000</date>
            <delta_ts>2022-12-28 05:39:53 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues</desc>
            <filename>NetworkPkg - HttpDxe Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>202426</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1098</attachid>
            <date>2022-12-28 05:39:53 +0000</date>
            <delta_ts>2022-12-28 05:39:53 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>NetworkPkg - HttpDxe Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>194842</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1101</attachid>
            <date>2022-12-28 09:16:57 +0000</date>
            <delta_ts>2022-12-28 09:16:57 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity</desc>
            <filename>0001-NetworkPkg-HttpDxe-Fix-NULL_RETURNS-Coverity-issues.patch</filename>
            <type>text/plain</type>
            <size>2894</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4401</bug_id>
          
          <creation_ts>2023-04-03 21:13:49 +0000</creation_ts>
          <short_desc>Add PLDM SMBIOS transfer protocol</short_desc>
          <delta_ts>2023-04-25 21:52:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>ManageabilityPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21307</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-03 21:13:49 +0000</bug_when>
    <thetext>Add PLDM SMBIOS transfer protocol to deliver SMBIOS table to BMC.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21416</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:52:14 +0000</bug_when>
    <thetext>Fix it at Edk2 697e594fad518f288e97a9923168d5bea8a1787a</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4220</bug_id>
          
          <creation_ts>2022-12-27 03:49:56 +0000</creation_ts>
          <short_desc>MdeModulePkg/Bus/Pci/NvmExpressPei: Coverity scan flags DEADCODE issue</short_desc>
          <delta_ts>2023-09-20 07:09:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="Ranbir Singh">saini.ranbirs</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>saini.ranbirs</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20296</commentid>
    <comment_count>0</comment_count>
      <attachid>1085</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2022-12-27 03:49:56 +0000</bug_when>
    <thetext>Created attachment 1085
HTML files reflecting the issues

1 issue has been captured by Coverity scan for MdeModulePkg/Bus/Pci/NvmExpressPei

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.

File - edk2/MdeModulePkg/Bus/Pci/NvmExpressPei/NvmExpressPeiS3.c

The code can reach line 65 only through the else path at line 53. The else path already has the same check at line 55 and hence the duplicate code lines are totally redundant.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20299</commentid>
    <comment_count>1</comment_count>
      <attachid>1088</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-27 06:53:19 +0000</bug_when>
    <thetext>Created attachment 1088
Proposed patch to resolve the issues pointed by Coverity</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20433</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:43:21 +0000</bug_when>
    <thetext>veeresh.sangolli@dellteam.com: please send the patch to edk2 mail list for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20458</commentid>
    <comment_count>3</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-04 02:32:31 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #2)
&gt; veeresh.sangolli@dellteam.com: please send the patch to edk2 mail list for
&gt; code review.

Patch sent to EDK2 mail list for code review with mail subject as -

[PATCH] MdeModulePkg/Bus/Pci/NvmExpressPei: Fix DEADCODE Coverity issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20785</commentid>
    <comment_count>4</comment_count>
      <attachid>1236</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 07:39:02 +0000</bug_when>
    <thetext>Created attachment 1236
Proposed patch to resolve the Deadcode issue pointed by Coverity for MdeModulePkg

Please consider this patch to resolve Deadcode issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20855</commentid>
    <comment_count>5</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-25 07:27:23 +0000</bug_when>
    <thetext>(In reply to Veeresh Sangolli from comment #4)
&gt; Created attachment 1236 [details]
&gt; Proposed patch to resolve the Deadcode issue pointed by Coverity for
&gt; MdeModulePkg
&gt; 
&gt; Please consider this patch to resolve Deadcode issue.

The code can reach line 65 only through the else path above at line 53.
The else path already has the same NULL check at line 55 and hence the
duplicate code lines are totally redundant which can be deleted.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21921</commentid>
    <comment_count>6</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-09-20 07:09:14 +0000</bug_when>
    <thetext>
1 patch has been merged via:


PR - https://github.com/tianocore/edk2/pull/4843

Commit - https://github.com/tianocore/edk2/commit/4317b4824bc881fe6079d04b7ee5b0f6bddf62ca</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1085</attachid>
            <date>2022-12-27 03:49:56 +0000</date>
            <delta_ts>2022-12-27 03:49:56 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>MdeModulePkg-NvmExpressPei-CoverityIssues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>3507</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1088</attachid>
            <date>2022-12-27 06:53:19 +0000</date>
            <delta_ts>2023-01-24 07:37:00 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity</desc>
            <filename>0001-MdeModulePkg-Bus-Pci-NvmExpressPei-Fix-DEADCODE-Cove.patch</filename>
            <type>text/plain</type>
            <size>1169</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1236</attachid>
            <date>2023-01-24 07:39:02 +0000</date>
            <delta_ts>2023-01-24 07:39:02 +0000</delta_ts>
            <desc>Proposed patch to resolve the Deadcode issue pointed by Coverity for MdeModulePkg</desc>
            <filename>0001-MdeModulePkg-Bus-Pci-NvmExpressPei-Fix-DEADCODE-Cove.patch</filename>
            <type>text/plain</type>
            <size>1240</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4458</bug_id>
          
          <creation_ts>2023-05-18 04:39:59 +0000</creation_ts>
          <short_desc>BIOS ASSERT failed when Fv FSP-S use FFS3</short_desc>
          <delta_ts>2023-06-02 05:21:23 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ming Tan">ming.tan</reporter>
          <assigned_to name="Ming Tan">ming.tan</assigned_to>
          <cc>chinni.b.duggapu</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2WrapperPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21568</commentid>
    <comment_count>0</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2023-05-18 04:39:59 +0000</bug_when>
    <thetext>If Fv FSP-S use FFS3, then BIOS will ASSERT failed with following error:
Assert Error: PEI_ASSERT!: [DebugServicePei] e:\xxx\Edk2\MdePkg\Library\PeiServicesLib\PeiServicesLib.c (670): CompareGuid (&amp;(((EFI_FIRMWARE_VOLUME_HEADER *)FvInfo)-&gt;FileSystemGuid), &amp;gEfiFirmwareFileSystem2Guid)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21569</commentid>
    <comment_count>1</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2023-05-18 04:43:46 +0000</bug_when>
    <thetext>I will submit patch for this issue.

diff --git a/IntelFsp2WrapperPkg/FspsWrapperPeim/FspsWrapperPeim.c b/IntelFsp2WrapperPkg/FspsWrapperPeim/FspsWrapperPeim.c

index 091ddb697a..08fe0fdb7e 100644

--- a/IntelFsp2WrapperPkg/FspsWrapperPeim/FspsWrapperPeim.c

+++ b/IntelFsp2WrapperPkg/FspsWrapperPeim/FspsWrapperPeim.c

@@ -438,7 +438,7 @@ FspsWrapperInitDispatchMode (

   // FSP-S Wrapper running in Dispatch mode and reports FSP-S FV to PEI dispatcher.

   //

   PeiServicesInstallFvInfoPpi (

-    NULL,

+    &amp;((EFI_FIRMWARE_VOLUME_HEADER *)(UINTN)PcdGet32 (PcdFspsBaseAddress))-&gt;FileSystemGuid,

     (VOID *)(UINTN)PcdGet32 (PcdFspsBaseAddress),

     (UINT32)((EFI_FIRMWARE_VOLUME_HEADER *)(UINTN)PcdGet32 (PcdFspsBaseAddress))-&gt;FvLength,

     NULL,</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21632</commentid>
    <comment_count>2</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2023-06-02 05:21:23 +0000</bug_when>
    <thetext>The patch is merged.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4459</bug_id>
          
          <creation_ts>2023-05-19 05:48:28 +0000</creation_ts>
          <short_desc>Passowrd description string need update</short_desc>
          <delta_ts>2023-08-01 05:36:01 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>UserAuthFeaturePkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Susovan Mohapatra">susovan.mohapatra</reporter>
          <assigned_to name="Susovan Mohapatra">susovan.mohapatra</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21570</commentid>
    <comment_count>0</comment_count>
      <attachid>1367</attachid>
    <who name="Susovan Mohapatra">susovan.mohapatra</who>
    <bug_when>2023-05-19 05:48:28 +0000</bug_when>
    <thetext>Created attachment 1367
Highlighted the string.

The system only supports the admin user. This eliminates a series of issues from prior systems.

As seen within the text below(attachment), the password must meet complexity requirements and be between 8 and 32 characters.

Once a password is setup, the user can clear the password by entering the old password and then setting with new password without a value.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21605</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 21:56:56 +0000</bug_when>
    <thetext>susovan.mohapatra@intel.com: is the highlighted string new added? Will you contribute the patch to edk2 mail list?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21790</commentid>
    <comment_count>2</comment_count>
    <who name="Susovan Mohapatra">susovan.mohapatra</who>
    <bug_when>2023-08-01 05:36:01 +0000</bug_when>
    <thetext>This is a false flag. The feature works as is. Closing the bug.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1367</attachid>
            <date>2023-05-19 05:48:28 +0000</date>
            <delta_ts>2023-05-19 05:48:28 +0000</delta_ts>
            <desc>Highlighted the string.</desc>
            <filename>PasswordHelpString.png</filename>
            <type>image/png</type>
            <size>184061</size>
            <attacher name="Susovan Mohapatra">susovan.mohapatra</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4759</bug_id>
          
          <creation_ts>2024-04-19 08:59:51 +0000</creation_ts>
          <short_desc>PACKAGE_GUID duplication in Intel silicon folders</short_desc>
          <delta_ts>2024-05-03 03:39:01 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>IntelSiliconPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Paul Lohr">paul.a.lohr</reporter>
          <assigned_to name="Dora Hsueh">dorax.hsueh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>paul.a.lohr</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22931</commentid>
    <comment_count>0</comment_count>
    <who name="Paul Lohr">paul.a.lohr</who>
    <bug_when>2024-04-19 08:59:51 +0000</bug_when>
    <thetext>See list.  all should be unique.

Find all &quot;F245E276-44A0-46b3-AEB5-9898BBCF008D&quot;, Subfolders, &quot;c:\Lohr\Builds\Gen4Ext\Edk2Platforms&quot;, &quot;*.*&quot;
File c:\Lohr\Builds\Gen4Ext\Edk2Platforms\Silicon\Intel\AlderlakeSiliconPkg\SiPkg.dec
  13 16:PACKAGE_GUID = F245E276-44A0-46b3-AEB5-9898BBCF008D
File c:\Lohr\Builds\Gen4Ext\Edk2Platforms\Silicon\Intel\CoffeelakeSiliconPkg\SiPkg.dec
  14 21:PACKAGE_GUID      = F245E276-44A0-46b3-AEB5-9898BBCF008D
File c:\Lohr\Builds\Gen4Ext\Edk2Platforms\Silicon\Intel\KabylakeSiliconPkg\SiPkg.dec
  15 16:PACKAGE_GUID = F245E276-44A0-46b3-AEB5-9898BBCF008D
File c:\Lohr\Builds\Gen4Ext\Edk2Platforms\Silicon\Intel\TigerlakeSiliconPkg\SiPkg.dec
  14 16:PACKAGE_GUID = F245E276-44A0-46b3-AEB5-9898BBCF008D</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22952</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-04-24 20:40:42 +0000</bug_when>
    <thetext>dorax.hsueh@intel.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22997</commentid>
    <comment_count>2</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-05-03 03:39:01 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2-platforms/pull/138
PR merged on WW18.5</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4434</bug_id>
          
          <creation_ts>2023-05-02 04:19:56 +0000</creation_ts>
          <short_desc>Add IPMI SSIF definitions</short_desc>
          <delta_ts>2023-05-14 21:29:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21460</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-02 04:19:56 +0000</bug_when>
    <thetext>Add IPMI SSIF definitions according to IPMI spec.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21461</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-02 04:20:30 +0000</bug_when>
    <thetext>Tinh Nguyen &lt;tinhnguyen@amperemail.onmicrosoft.com&gt; from Ampere is working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21538</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 21:57:39 +0000</bug_when>
    <thetext>Tinh has sent the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21565</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-14 21:29:14 +0000</bug_when>
    <thetext>Merge at https://github.com/tianocore/edk2/pull/4390</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4695</bug_id>
          
          <creation_ts>2024-02-18 19:33:58 +0000</creation_ts>
          <short_desc>Remove the dependency of MinPlatform in ManageabilityPkg</short_desc>
          <delta_ts>2024-04-30 03:53:06 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>ManageabilityPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>AbdulLateef.Attar</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>nicklew</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22626</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-02-18 19:33:58 +0000</bug_when>
    <thetext>Currently, we leverage MinPlatform edk2 metafiles to include edk2 fundamental libraries and drivers. This creates a dependency between ManagabilityPkg and MinPlatform package, which is unnecessary.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22714</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 21:57:16 +0000</bug_when>
    <thetext>abner.chang@amd.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22990</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-04-30 03:53:06 +0000</bug_when>
    <thetext>Commit at 4c9c38bc</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4557</bug_id>
          
          <creation_ts>2023-09-21 05:50:26 +0000</creation_ts>
          <short_desc>CodeFirst - MADT GIC flags for non-coherent components</short_desc>
          <delta_ts>2023-11-10 04:28:41 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Souvik Chakravarty">Souvik.Chakravarty</reporter>
          <assigned_to name="Souvik Chakravarty">Souvik.Chakravarty</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>lorenzo.pieralisi</cc>
    
    <cc>Souvik.Chakravarty</cc>
          
          <cf_industrystandardspecifications>ACPI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21924</commentid>
    <comment_count>0</comment_count>
      <attachid>1411</attachid>
    <who name="Souvik Chakravarty">Souvik.Chakravarty</who>
    <bug_when>2023-09-21 05:50:26 +0000</bug_when>
    <thetext>Created attachment 1411
CodeFirst - MADT GIC flags for non-coherent components

To enable non-coherent GIC components, introduce a new GIC CPU Interface, GICR and GIC ITS flag to allow the firmware to describe Redistributors and ITSes as non-coherent observers.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21925</commentid>
    <comment_count>1</comment_count>
    <who name="Souvik Chakravarty">Souvik.Chakravarty</who>
    <bug_when>2023-09-21 05:57:30 +0000</bug_when>
    <thetext>ASWG ECR: https://mantis.uefi.org/mantis/view.php?id=2422</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21937</commentid>
    <comment_count>2</comment_count>
      <attachid>1413</attachid>
    <who name="Souvik Chakravarty">Souvik.Chakravarty</who>
    <bug_when>2023-09-26 07:11:49 +0000</bug_when>
    <thetext>Created attachment 1413
CodeFirst - MADT GIC flags for non-coherent components_v2

Minor editorial change to specify GICC Interface Structure explicitly in changes proposed for Table 5.37.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21998</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 22:46:51 +0000</bug_when>
    <thetext>Souvik Chakravarty takes it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22020</commentid>
    <comment_count>4</comment_count>
    <who name="">lorenzo.pieralisi</who>
    <bug_when>2023-10-19 03:57:12 +0000</bug_when>
    <thetext>Patches posted and discussion going on on linux mailing lists, current
proposed bindings should be fit for purpose.

https://lore.kernel.org/linux-arm-kernel/86v8b5mc5v.wl-maz@kernel.org</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22147</commentid>
    <comment_count>5</comment_count>
    <who name="Souvik Chakravarty">Souvik.Chakravarty</who>
    <bug_when>2023-11-10 04:28:41 +0000</bug_when>
    <thetext>It has been approved in ASWG. Hence closing this now.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1411</attachid>
            <date>2023-09-21 05:50:26 +0000</date>
            <delta_ts>2023-09-26 07:11:49 +0000</delta_ts>
            <desc>CodeFirst - MADT GIC flags for non-coherent components</desc>
            <filename>CodeFirst_MADT GIC Flags for non-coherent components_v1.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>29575</size>
            <attacher name="Souvik Chakravarty">Souvik.Chakravarty</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1413</attachid>
            <date>2023-09-26 07:11:49 +0000</date>
            <delta_ts>2023-09-26 07:11:49 +0000</delta_ts>
            <desc>CodeFirst - MADT GIC flags for non-coherent components_v2</desc>
            <filename>CodeFirst_MADT GIC Flags for non-coherent components_v2.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>29531</size>
            <attacher name="Souvik Chakravarty">Souvik.Chakravarty</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4199</bug_id>
          
          <creation_ts>2022-12-21 08:07:13 +0000</creation_ts>
          <short_desc>FatPkg/EnhancedFatDxe: Coverity scan flags multiple issues</short_desc>
          <delta_ts>2023-01-06 02:26:33 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>FatPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20252</commentid>
    <comment_count>0</comment_count>
      <attachid>1059</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2022-12-21 08:07:13 +0000</bug_when>
    <thetext>Created attachment 1059
HTML files reflecting the issues

3 issues have been captured by Coverity scan for the FatPkg. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20253</commentid>
    <comment_count>1</comment_count>
      <attachid>1060</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2022-12-21 08:10:52 +0000</bug_when>
    <thetext>Created attachment 1060
Proposed patch to resolve the issues pointed by Coverity for FatPkg


Please review the changes in the attached patch for the proposed resolutions and help them to consider for the merge if approved.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20254</commentid>
    <comment_count>2</comment_count>
      <attachid>1061</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2022-12-21 08:17:38 +0000</bug_when>
    <thetext>Created attachment 1061
Proposed patch to resolve the issues pointed by Coverity for FatPkg</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20255</commentid>
    <comment_count>3</comment_count>
      <attachid>1061</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2022-12-21 08:24:14 +0000</bug_when>
    <thetext>Comment on attachment 1061
Proposed patch to resolve the issues pointed by Coverity for FatPkg

With the attached changes, Coverity scan does not reflect the same issues as observed originally.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20360</commentid>
    <comment_count>4</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-02 06:34:35 +0000</bug_when>
    <thetext>To be seen later</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1059</attachid>
            <date>2022-12-21 08:07:13 +0000</date>
            <delta_ts>2023-01-06 02:26:33 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>FatPkg - Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>47127</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1060</attachid>
            <date>2022-12-21 08:10:52 +0000</date>
            <delta_ts>2022-12-21 08:17:38 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity for FatPkg</desc>
            <filename>0001-FatPkg-Fix-EnhancedFatDxe-driver-coverity-issues.patch</filename>
            <type>text/plain</type>
            <size>2360</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1061</attachid>
            <date>2022-12-21 08:17:38 +0000</date>
            <delta_ts>2022-12-21 08:17:38 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity for FatPkg</desc>
            <filename>0001-FatPkg-Fix-EnhancedFatDxe-driver-coverity-issues.patch</filename>
            <type>text/plain</type>
            <size>2413</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4075</bug_id>
          
          <creation_ts>2022-09-21 04:06:25 +0000</creation_ts>
          <short_desc>CryptoPkg: RsaGetPrivateKeyFromPem() crashed in Libfuzzer test</short_desc>
          <delta_ts>2022-09-26 07:54:25 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19600</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2022-09-21 04:06:25 +0000</bug_when>
    <thetext>Used Libfuzzer (clang+llvm-11.0.0) as the fuzzer,based on HBFA.

Test case: https://github.com/liyi77/edk2-staging/blob/HBFA/HBFA/UefiHostFuzzTestCasePkg/TestCase/CryptoPkg/Pem/TestPem.c

Log:
/home/liyi4/wpa3fuzz/Build/UefiHostFuzzTestCryptoPkg/DEBUG_LIBFUZZER/X64/TestPem: Running 1 inputs 1 time(s) each.
Running: /home/liyi4/wpa3fuzz/TlsSetKeySeed/crash2
=================================================================
==13339==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x603000000471 at pc 0x000000557b67 bp 0x7fffffffce20 sp 0x7fffffffce18
READ of size 1 at 0x603000000471 thread T0
    #0 0x557b66 in AsciiStrnLenS /home/liyi4/wpa3fuzz/edk2-staging/HBFA/UefiHostTestPkg/Library/BaseLibHost/SafeString.c:1772:10
    #1 0x591427 in OBJ_obj2txt /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/objects/obj_dat.c:486:17
    #2 0x6109e2 in i2t_ASN1_OBJECT /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/asn1/a_object.c:182:12
    #3 0x6a3d9b in EVP_PKCS82PKEY /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/evp/evp_pkey.c:37:9
    #4 0x599a52 in PEM_read_bio_PrivateKey /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/pem/pem_pkey.c:45:15
    #5 0x594477 in PEM_read_bio_RSAPrivateKey /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/pem/pem_all.c:67:13
    #6 0x54fb17 in RsaGetPrivateKeyFromPem /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/BaseCryptLib/Pem/CryptPem.c:116:17
    #7 0x54dea0 in RunTestHarness /home/liyi4/wpa3fuzz/edk2-staging/HBFA/UefiHostFuzzTestCasePkg/TestCase/CryptoPkg/Pem/TestPem.c:72:7
    #8 0x54dbf7 in LLVMFuzzerTestOneInput /home/liyi4/wpa3fuzz/edk2-staging/HBFA/UefiHostFuzzTestPkg/Library/ToolChainHarnessLib/ToolChainHarnessLib.c:138:3
    #9 0x4586e1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/liyi4/wpa3fuzz/Build/UefiHostFuzzTestCryptoPkg/DEBUG_LIBFUZZER/X64/TestPem+0x4586e1)
    #10 0x443e52 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) (/home/liyi4/wpa3fuzz/Build/UefiHostFuzzTestCryptoPkg/DEBUG_LIBFUZZER/X64/TestPem+0x443e52)
    #11 0x449906 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/liyi4/wpa3fuzz/Build/UefiHostFuzzTestCryptoPkg/DEBUG_LIBFUZZER/X64/TestPem+0x449906)
    #12 0x4725c2 in main (/home/liyi4/wpa3fuzz/Build/UefiHostFuzzTestCryptoPkg/DEBUG_LIBFUZZER/X64/TestPem+0x4725c2)
    #13 0x7ffff7a6d082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16
    #14 0x41e51d in _start (/home/liyi4/wpa3fuzz/Build/UefiHostFuzzTestCryptoPkg/DEBUG_LIBFUZZER/X64/TestPem+0x41e51d)

0x603000000471 is located 0 bytes to the right of 17-byte region [0x603000000460,0x603000000471)
allocated by thread T0 here:
    #0 0x51e24d in malloc (/home/liyi4/wpa3fuzz/Build/UefiHostFuzzTestCryptoPkg/DEBUG_LIBFUZZER/X64/TestPem+0x51e24d)
    #1 0x57ffdf in CRYPTO_malloc /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/mem.c:222:11
    #2 0x655290 in BN_bn2dec /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/bn/bn_print.c:73:11
    #3 0x59140a in OBJ_obj2txt /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/objects/obj_dat.c:483:21
    #4 0x6109e2 in i2t_ASN1_OBJECT /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/asn1/a_object.c:182:12
    #5 0x6a3d9b in EVP_PKCS82PKEY /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/evp/evp_pkey.c:37:9
    #6 0x599a52 in PEM_read_bio_PrivateKey /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/pem/pem_pkey.c:45:15
    #7 0x594477 in PEM_read_bio_RSAPrivateKey /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/pem/pem_all.c:67:13
    #8 0x54fb17 in RsaGetPrivateKeyFromPem /home/liyi4/wpa3fuzz/edk2/CryptoPkg/Library/BaseCryptLib/Pem/CryptPem.c:116:17
    #9 0x54dea0 in RunTestHarness /home/liyi4/wpa3fuzz/edk2-staging/HBFA/UefiHostFuzzTestCasePkg/TestCase/CryptoPkg/Pem/TestPem.c:72:7</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19601</commentid>
    <comment_count>1</comment_count>
      <attachid>1026</attachid>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2022-09-21 04:07:36 +0000</bug_when>
    <thetext>Created attachment 1026
crash seed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19602</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2022-09-21 04:08:11 +0000</bug_when>
    <thetext>The root cause is the inappropriate implementation of BIO_snprintf():
https://github.com/tianocore/edk2/blob/2c17d676e402d75a3a674499342f7ddaccf387bd/CryptoPkg/Library/BaseCryptLib/SysCall/CrtWrapper.c#L489-L498 
For the crashed case, RsaGetPrivateKeyFromPem() will:
1)malloc a piece of memory S,
(edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/bn/bn_print.c:73:11)

2)and use BIO_snprintf() to print a NULL-terminated string to S,
(edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/bn/bn_print.c:104:11)

3)finally call strlen(S) to get length.
(edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/objects/obj_dat.c:486:17)

Due to BIO_snprintf() does nothing but just return a good status 0, program will consider this string to be written successfully, then strlen() will heap-buffer-overflow.

There are two solution choice:
	1. Add true implementation to OpensslLib, but this will increase the 8kb DXE driver binary size.
	https://github.com/tianocore/edk2/pull/3361
	2. Fake BIO_snprintf() need to return error status -1.
https://github.com/tianocore/edk2/pull/3360</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19610</commentid>
    <comment_count>3</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2022-09-22 03:52:14 +0000</bug_when>
    <thetext>&gt; There are two solution choice:
&gt; 	1. Add true implementation to OpensslLib, but this will increase the 8kb
&gt; DXE driver binary size.
&gt; 	https://github.com/tianocore/edk2/pull/3361
&gt; 	2. Fake BIO_snprintf() need to return error status -1.
&gt; https://github.com/tianocore/edk2/pull/3360

Solution 1 need to turn on SSE when use GCC, it will be huge impact.

Recommend solution2.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19612</commentid>
    <comment_count>4</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2022-09-23 00:36:41 +0000</bug_when>
    <thetext>Patch sent.
https://edk2.groups.io/g/devel/message/94119</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19630</commentid>
    <comment_count>5</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2022-09-26 07:54:25 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3401</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1026</attachid>
            <date>2022-09-21 04:07:36 +0000</date>
            <delta_ts>2022-09-21 04:07:36 +0000</delta_ts>
            <desc>crash seed</desc>
            <filename>crash2</filename>
            <type>application/octet-stream</type>
            <size>2531</size>
            <attacher name="yi1.li@intel.com">yi1.li</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4561</bug_id>
          
          <creation_ts>2023-09-26 21:45:41 +0000</creation_ts>
          <short_desc>Consolidate IpmiCommandLib.h as there are three instance on tianocore</short_desc>
          <delta_ts>2023-10-30 01:09:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>ManageabilityPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>AbdulLateef.Attar</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21938</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-09-26 21:45:41 +0000</bug_when>
    <thetext>Currently, there are three instances of IpmiCommandLib.h on tianocore.
One is defined in MdeModulePkg, one is under edk2-platform ManageabilityPkg, and another is on edk2-platform IpmiFeaturePkg. Evaluate to use only one instance on MdeModulePkg and remove others.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21997</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 22:46:18 +0000</bug_when>
    <thetext>Abner will update the maintainer for IPMI module.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22098</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-10-30 01:09:36 +0000</bug_when>
    <thetext>At edk2-platforms commit a4851e8f and ada70acd.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4418</bug_id>
          
          <creation_ts>2023-04-20 09:11:39 +0000</creation_ts>
          <short_desc>Use Highest Python version on Linux edksetup.sh</short_desc>
          <delta_ts>2023-06-18 21:16:38 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chen Yuwei">yuwei.chen</reporter>
          <assigned_to name="Chen Yuwei">yuwei.chen</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>yuwei.chen</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21382</commentid>
    <comment_count>0</comment_count>
    <who name="Chen Yuwei">yuwei.chen</who>
    <bug_when>2023-04-20 09:11:39 +0000</bug_when>
    <thetext>In Linux system, edksetup.sh will be executed to set up the environment.
It will config the python command with SetupPython3 function.
The current behavior of this function is use the python version which &quot;python&quot; linked with which does not support the multiple python version.

There have a scenario:
BuildReport.py is using the f-strings function, which requires at least python3.6.
If the &quot;python&quot; is linked to the python34, build will shows error.

Reproduce way:
On systems with multiple python installations, there may be a mix of “pythonVv” commands and a “python” command available and the current algorithm may not select the highest version.

Reproduce case:  “python34” command and “python” command present, “python” is higher version than 3.4, but the “python34” is selected.

This issue need be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21383</commentid>
    <comment_count>1</comment_count>
    <who name="Chen Yuwei">yuwei.chen</who>
    <bug_when>2023-04-20 09:13:42 +0000</bug_when>
    <thetext>Assign to Reporter. Have confirmed the issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21670</commentid>
    <comment_count>2</comment_count>
    <who name="Chen Yuwei">yuwei.chen</who>
    <bug_when>2023-06-18 21:16:38 +0000</bug_when>
    <thetext>This issue have been fixed after the &apos;SHA-1: e6447d2a08f5ca585816d093e79a01dad3781f98&apos; patch is merged.
Close the issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4444</bug_id>
          
          <creation_ts>2023-05-05 01:13:15 +0000</creation_ts>
          <short_desc>Clone IpmiCommandLib from IpmiFeaturePkg to Manageability</short_desc>
          <delta_ts>2023-05-25 03:44:27 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>ManageabilityPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>isaac.w.oram</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21479</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-05 01:13:15 +0000</bug_when>
    <thetext>Clone IpmiCommandLib from IpmiFeaturePkg to ManageabilityPkg in order to consolidate edk2 system manageability support in one place.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21516</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-09 03:25:52 +0000</bug_when>
    <thetext>Fixed at 72bd7626 and 80b0c04d.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21582</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-25 03:44:27 +0000</bug_when>
    <thetext>Fix at b6a5124e-748929b8</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4355</bug_id>
          
          <creation_ts>2023-03-02 20:42:29 +0000</creation_ts>
          <short_desc>Add header file for MCTP spec</short_desc>
          <delta_ts>2023-04-01 21:22:27 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>isaac.w.oram</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21145</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-03-02 20:42:29 +0000</bug_when>
    <thetext>Lack of industry-standard MCTP definition</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21155</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-03-07 09:36:24 +0000</bug_when>
    <thetext>Abner takes it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21295</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-01 21:22:27 +0000</bug_when>
    <thetext>Resolved at @2c93253c</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4204</bug_id>
          
          <creation_ts>2022-12-22 11:35:31 +0000</creation_ts>
          <short_desc>MdeModulePkg/Bus/Ata/AtaAtapiPassThru: Coverity scan flags multiple issues</short_desc>
          <delta_ts>2023-08-02 00:18:09 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ranbir Singh">saini.ranbirs</reporter>
          <assigned_to name="Ranbir Singh">saini.ranbirs</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20262</commentid>
    <comment_count>0</comment_count>
      <attachid>1067</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 11:35:31 +0000</bug_when>
    <thetext>Created attachment 1067
HTML files reflecting the issues

3 issues has been captured by Coverity scan for MdeModulePkg/Bus/Ata/AtaAtapiPassThru.

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20263</commentid>
    <comment_count>1</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 11:48:20 +0000</bug_when>
    <thetext>
For 1. UNINIT - edk2/MdeModulePkg/Bus/Ata/AtaAtapiPassThru/AhciMode.c

Please analyze the validity of the UNINIT access scenario which the Coverity reflects under the given set of Task structure field value combinations.

For 3. UNUSED_VALUE - edk2/MdeModulePkg/Bus/Ata/AtaAtapiPassThru/IdeMode.c

The return value from SetDriveParameters is stored in Status variable but no use has been made wrt the return Status value. Please analyze what to do with Status here? like ...

      if (EFI_ERROR (Status)) {
        // ??? What to do ?
        // ; Nothing to do
        // OR
        // return Status;
      }

If nothing to be done, then one option is to not to store return value from SetDriveParameters in Status. Other option is to leave a blank statement with comment saying Nothing to do.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20268</commentid>
    <comment_count>2</comment_count>
      <attachid>1068</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 22:54:39 +0000</bug_when>
    <thetext>Created attachment 1068
Proposed patch to resolve the SIGN_EXTENSION issue pointed by Coverity

The comments about the issue in the Coverity report are self-explanatory wrt 

2. SIGN_EXTENSION - edk2/MdeModulePkg/Bus/Ata/AtaAtapiPassThru/AtaAtapiPassThru.c

Line number 1348 does contain a typecast with UINT32, but it is after all the operations (16-bit left shift followed by OR&apos;ing) are over. To avoid any SIGN_EXTENSION, typecast the intermediate result after 16-bit left shift operation immediately with UINT32.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20269</commentid>
    <comment_count>3</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 22:56:42 +0000</bug_when>
    <thetext>With the changes as attached in patch in Comment 2, Coverity scan does not reflect the same SIGN_EXTENSION issue as observed originally.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20292</commentid>
    <comment_count>4</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-26 22:46:44 +0000</bug_when>
    <thetext>(In reply to Ranbir Singh from comment #1)
&gt; For 1. UNINIT - edk2/MdeModulePkg/Bus/Ata/AtaAtapiPassThru/AhciMode.c
&gt; 
&gt; Please analyze the validity of the UNINIT access scenario which the Coverity
&gt; reflects under the given set of Task structure field value combinations.
&gt; 
&gt; For 3. UNUSED_VALUE - edk2/MdeModulePkg/Bus/Ata/AtaAtapiPassThru/IdeMode.c
&gt; 
&gt; The return value from SetDriveParameters is stored in Status variable but no
&gt; use has been made wrt the return Status value. Please analyze what to do
&gt; with Status here? like ...
&gt; 
&gt;       if (EFI_ERROR (Status)) {
&gt;         // ??? What to do ?
&gt;         // ; Nothing to do
&gt;         // OR
&gt;         // return Status;
&gt;       }
&gt; 
&gt; If nothing to be done, then one option is to not to store return value from
&gt; SetDriveParameters in Status. Other option is to leave a blank statement
&gt; with comment saying Nothing to do.

Removing the return value storage would also lead to CHECKED_RETURNS coverity issue. Hence, the option is to leave a blank statement with comment saying Nothing to do as shown below

       if (EFI_ERROR (Status)) {
         ; // Nothing to do
       }

OR if makes sense in the given scenario, then use

       if (EFI_ERROR (Status)) {
         return Status;
       }</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20434</commentid>
    <comment_count>5</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:43:53 +0000</bug_when>
    <thetext>Ranbir.Singh3@Dell.com: please send the patch to edk2 mail list for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20450</commentid>
    <comment_count>6</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-04 02:10:12 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #5)
&gt; Ranbir.Singh3@Dell.com: please send the patch to edk2 mail list for code
&gt; review.

Patch sent to EDK2 mail list with mail subject as -

[PATCH] MdeModulePkg/Bus/Ata/AtaAtapiPassThru: Fix SIGN_EXTENSION Coverity issue

Please note that the patch contains the fix only wrt SIGN_EXTENSION issue. For the other issues reflected in HTML files attached to this ticket namely UNINIT - someone more adept should analyze it and UNUSED_VALUE - needs finalization wrt approach the community / author wants to take here. I have mentioned few options wrt how to deal UNUSED_VALUE issue as 

Leave a blank statement with comment saying Nothing to do as

       if (EFI_ERROR (Status)) {
         ; // Nothing to do
       }

OR if it makes sense in the given scenario, then use

       if (EFI_ERROR (Status)) {
         return Status;
       }

OR leave the code as it is and ignore this Coverity warning as WON&apos;T FIX.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20759</commentid>
    <comment_count>7</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 04:57:07 +0000</bug_when>
    <thetext>(In reply to Ranbir Singh from comment #6)
&gt; (In reply to gaoliming from comment #5)
&gt; &gt; Ranbir.Singh3@Dell.com: please send the patch to edk2 mail list for code
&gt; &gt; review.
&gt; 
&gt; Patch sent to EDK2 mail list with mail subject as -
&gt; 
&gt; [PATCH] MdeModulePkg/Bus/Ata/AtaAtapiPassThru: Fix SIGN_EXTENSION Coverity
&gt; issue
&gt; 
&gt; Please note that the patch contains the fix only wrt SIGN_EXTENSION issue.
&gt; For the other issues reflected in HTML files attached to this ticket namely
&gt; UNINIT - someone more adept should analyze it and UNUSED_VALUE - needs
&gt; finalization wrt approach the community / author wants to take here. I have
&gt; mentioned few options wrt how to deal UNUSED_VALUE issue as 
&gt; 
&gt; Leave a blank statement with comment saying Nothing to do as
&gt; 
&gt;        if (EFI_ERROR (Status)) {
&gt;          ; // Nothing to do
&gt;        }
&gt; 
&gt; OR if it makes sense in the given scenario, then use
&gt; 
&gt;        if (EFI_ERROR (Status)) {
&gt;          return Status;
&gt;        }
&gt; 
&gt; OR leave the code as it is and ignore this Coverity warning as WON&apos;T FIX.

Marking this patch as obsolete and updating a new updated patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20760</commentid>
    <comment_count>8</comment_count>
      <attachid>1216</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 05:00:13 +0000</bug_when>
    <thetext>Created attachment 1216
Proposed patch to resolve the Sign_extension issue pointed by Coverity for MdeModulePkg..

Please consider this patch for resolving sign_extension issue pointed by coverity.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20761</commentid>
    <comment_count>9</comment_count>
      <attachid>1217</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 05:02:23 +0000</bug_when>
    <thetext>Created attachment 1217
Proposed patch to resolve the Unused_value issue pointed by Coverity for MdeModulePkg..

Please consider this patch for resolving Unused_value issue pointed by coverity.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21796</commentid>
    <comment_count>10</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-08-02 00:18:09 +0000</bug_when>
    <thetext>
2 patches have been merged via: PR - https://github.com/tianocore/edk2/pull/4707

Commits:
  
 - https://github.com/tianocore/edk2/commit/c7c1170a4568ecc0f63e14ca6a844d40f47519a9
 - https://github.com/tianocore/edk2/commit/d11968fcc56cbbffef7d906048b00faea9415447</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1067</attachid>
            <date>2022-12-22 11:35:31 +0000</date>
            <delta_ts>2022-12-22 11:35:31 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>MdeModulePkg - AtaAtapiPassThru Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>116440</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1068</attachid>
            <date>2022-12-22 22:54:39 +0000</date>
            <delta_ts>2023-01-24 04:57:49 +0000</delta_ts>
            <desc>Proposed patch to resolve the SIGN_EXTENSION issue pointed by Coverity</desc>
            <filename>0001-MdeModulePkg-AtaAtapiPassThru-Fix-SIGN_EXTENSION-Cov.patch</filename>
            <type>text/plain</type>
            <size>1511</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1216</attachid>
            <date>2023-01-24 05:00:13 +0000</date>
            <delta_ts>2023-01-24 05:00:13 +0000</delta_ts>
            <desc>Proposed patch to resolve the Sign_extension issue pointed by Coverity for MdeModulePkg..</desc>
            <filename>0001-MdeModulePkg-Bus-Ata-AtaAtapiPassThru-Fix-SIGN_EXTEN.patch</filename>
            <type>text/plain</type>
            <size>1590</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1217</attachid>
            <date>2023-01-24 05:02:23 +0000</date>
            <delta_ts>2023-01-24 05:02:23 +0000</delta_ts>
            <desc>Proposed patch to resolve the Unused_value issue pointed by Coverity for MdeModulePkg..</desc>
            <filename>0002-MdeModulePkg-Bus-Ata-AtaAtapiPassThru-Fix-UNUSED_VAL.patch</filename>
            <type>text/plain</type>
            <size>1507</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4110</bug_id>
          
          <creation_ts>2022-10-18 23:16:58 +0000</creation_ts>
          <short_desc>CryptoPkg: Should implement BIO_snprintf for X509 time check</short_desc>
          <delta_ts>2023-10-18 01:50:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to name="yi1.li@intel.com">yi1.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19789</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2022-10-18 23:16:58 +0000</bug_when>
    <thetext>Openssl will use BIO_snprintf to print time string when converting time_t to ASN1_time. Currently edk2 code just give it a NULL implement in CrtWrapper.c, so getting current time in X509 time check will be fail.

Test branch:
https://github.com/liyi77/edk2/pull/6

Trace:
TlsLibUnitTestHost.exe!BIO_snprintf(char * buf, unsigned __int64 n, const char * format, ...) Line 96 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\TlsLib\SysCall\UnitTestHostCrtWrapper.c:96)
TlsLibUnitTestHost.exe!asn1_time_from_tm(asn1_string_st * s, tm * ts, int type) Line 302 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\asn1\a_time.c:302)
TlsLibUnitTestHost.exe!ASN1_TIME_adj(asn1_string_st * s, int t, int offset_day, long offset_sec) Line 338 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\asn1\a_time.c:338)
TlsLibUnitTestHost.exe!X509_time_adj_ex(asn1_string_st * s, int offset_day, long offset_sec, int * in_tm) Line 1946 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_vfy.c:1946)
TlsLibUnitTestHost.exe!X509_time_adj(asn1_string_st * s, long offset_sec, int * in_tm) Line 1927 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_vfy.c:1927)
TlsLibUnitTestHost.exe!X509_cmp_time(const asn1_string_st * ctm, int * cmp_time) Line 1902 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_vfy.c:1902)
TlsLibUnitTestHost.exe!x509_check_cert_time(x509_store_ctx_st * ctx, x509_st * x, int depth) Line 1710 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_vfy.c:1710)
TlsLibUnitTestHost.exe!X509_STORE_CTX_get1_issuer(x509_st * * issuer, x509_store_ctx_st * ctx, x509_st * x) Line 695 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_lu.c:695)
TlsLibUnitTestHost.exe!get_issuer(x509_st * * issuer, x509_store_ctx_st * ctx, x509_st * cert) Line 2922 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_vfy.c:2922)
TlsLibUnitTestHost.exe!build_chain(x509_store_ctx_st * ctx) Line 3071 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_vfy.c:3071)
TlsLibUnitTestHost.exe!verify_chain(x509_store_ctx_st * ctx) Line 220 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_vfy.c:220)
TlsLibUnitTestHost.exe!X509_verify_cert(x509_store_ctx_st * ctx) Line 303 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_vfy.c:303)
TlsLibUnitTestHost.exe!ssl_add_cert_chain(ssl_st * s, wpacket_st * pkt, cert_pkey_st * cpk) Line 961 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\ssl\statem\statem_lib.c:961)
TlsLibUnitTestHost.exe!ssl3_output_cert_chain(ssl_st * s, wpacket_st * pkt, cert_pkey_st * cpk) Line 1015 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\ssl\statem\statem_lib.c:1015)
TlsLibUnitTestHost.exe!tls_construct_server_certificate(ssl_st * s, wpacket_st * pkt) Line 3812 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\ssl\statem\statem_srvr.c:3812)
TlsLibUnitTestHost.exe!write_state_machine(ssl_st * s) Line 843 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\ssl\statem\statem.c:843)
TlsLibUnitTestHost.exe!state_machine(ssl_st * s, int server) Line 443 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\ssl\statem\statem.c:443)
TlsLibUnitTestHost.exe!ossl_statem_accept(ssl_st * s) Line 256 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\ssl\statem\statem.c:256)
TlsLibUnitTestHost.exe!SSL_do_handshake(ssl_st * s) Line 3716 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\OpensslLib\openssl\ssl\ssl_lib.c:3716)
TlsLibUnitTestHost.exe!TlsDoHandshake(void * Tls, unsigned char * BufferIn, unsigned __int64 BufferInSize, unsigned char * BufferOut, unsigned __int64 * BufferOutSize) Line 116 (d:\Workspace\tianocore\edk2\CryptoPkg\Library\TlsLib\TlsProcess.c:116)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19790</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2022-10-18 23:18:17 +0000</bug_when>
    <thetext>I will take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19832</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-25 21:47:03 +0000</bug_when>
    <thetext>Yi, please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21988</commentid>
    <comment_count>3</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-10-18 01:50:24 +0000</bug_when>
    <thetext>Implicitly fixed in openssl3.0 upgrade.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4053</bug_id>
          
          <creation_ts>2022-09-09 05:25:45 +0000</creation_ts>
          <short_desc>Add a new feature to enable LoongArch prot for EDKII</short_desc>
          <delta_ts>2022-10-19 22:49:52 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
    
    <cf_package>CryptoPkg</cf_package>
    
    <cf_package>FatPkg</cf_package>
    
    <cf_package>FmpDevicePkg</cf_package>
    
    <cf_package>MdeModulePkg</cf_package>
    
    <cf_package>MdePkg</cf_package>
    
    <cf_package>NetworkPkg</cf_package>
    
    <cf_package>SecurityPkg</cf_package>
    
    <cf_package>ShellPkg</cf_package>
    
    <cf_package>UnitTestFrameworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19540</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-09-09 05:25:45 +0000</bug_when>
    <thetext>UEFI V2.10 already supports LoongArch, let&apos;s enable it in EDKII.

Modified packages:
BaseTools
MdePkg
MdeModulePkg
FatPkg
FmpDevicePkg
NetworkPkg
CrytoPkg
SecurityPkg
ShellPkg
UnitTestFramworkPkg
.azurepiplines
.pytool

LoongArch EDKII reop URL: https://github.com/loongson/edk2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19556</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-12 21:44:59 +0000</bug_when>
    <thetext>lichao@loongson.cn is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19687</commentid>
    <comment_count>2</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-09-30 20:58:47 +0000</bug_when>
    <thetext>All of LoongArch patched have been approved. Request merge.

LoongArch repo URL: https://github.com/loongson/edk2/tree/LoongArch
CI results: https://dev.azure.com/kilaterlee/LoongArch_edk2/_build/results?buildId=75&amp;view=results</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19793</commentid>
    <comment_count>3</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-10-19 22:49:52 +0000</bug_when>
    <thetext>TianoCore EDK2 has already merged them, so it is closed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4209</bug_id>
          
          <creation_ts>2022-12-22 23:50:06 +0000</creation_ts>
          <short_desc>MdeModulePkg/Bus/Ata/AtaBusDxe: Coverity scan flags SIGN_EXTENSION issue</short_desc>
          <delta_ts>2023-09-20 07:08:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ranbir Singh">saini.ranbirs</reporter>
          <assigned_to name="Ranbir Singh">saini.ranbirs</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20270</commentid>
    <comment_count>0</comment_count>
      <attachid>1069</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 23:50:06 +0000</bug_when>
    <thetext>Created attachment 1069
HTML files reflecting the issues

1 issue has been captured by Coverity scan for MdeModulePkg/Bus/Ata/AtaBusDxe.

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20271</commentid>
    <comment_count>1</comment_count>
      <attachid>1070</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 23:55:38 +0000</bug_when>
    <thetext>Created attachment 1070
Proposed patch to resolve the SIGN_EXTENSION issue pointed by Coverity

The comments about the issue in the Coverity report are self-explanatory wrt 

2. SIGN_EXTENSION - edk2/MdeModulePkg/Bus/Ata/AtaBusDxe/AtaPassThruExecute.c

Line number 365 does contain a typecast with UINT32, but it is after all the operations (16-bit left shift followed by OR&apos;ing) are over. To avoid any SIGN_EXTENSION, typecast the intermediate result after 16-bit left shift operation immediately with UINT32.

With these changes, Coverity scan does not reflect the same SIGN_EXTENSION issue as observed originally.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20438</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:48:37 +0000</bug_when>
    <thetext>Ranbir.Singh3@Dell.com: please send the patch to edk2 mail list for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20451</commentid>
    <comment_count>3</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-04 02:10:58 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #2)
&gt; Ranbir.Singh3@Dell.com: please send the patch to edk2 mail list for code
&gt; review.

Patch sent to EDK2 mail list with mail subject as -

[PATCH] MdeModulePkg/Bus/Ata/AtaBusDxe: Fix SIGN_EXTENSION Coverity issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20762</commentid>
    <comment_count>4</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 06:29:08 +0000</bug_when>
    <thetext>(In reply to Ranbir Singh from comment #3)
&gt; (In reply to gaoliming from comment #2)
&gt; &gt; Ranbir.Singh3@Dell.com: please send the patch to edk2 mail list for code
&gt; &gt; review.
&gt; 
&gt; Patch sent to EDK2 mail list with mail subject as -
&gt; 
&gt; [PATCH] MdeModulePkg/Bus/Ata/AtaBusDxe: Fix SIGN_EXTENSION Coverity issue

Making this patch as obsolete and updating the new updated patch after few changes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20763</commentid>
    <comment_count>5</comment_count>
      <attachid>1218</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 06:32:19 +0000</bug_when>
    <thetext>Created attachment 1218
Proposed patch to resolve the Sign_extension issue pointed by Coverity for MdeModulePkg.

Please consider this patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21920</commentid>
    <comment_count>6</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-09-20 07:08:14 +0000</bug_when>
    <thetext>
1 patch has been merged via:

PR - https://github.com/tianocore/edk2/pull/4841

Commit - https://github.com/tianocore/edk2/commit/4fb69c2bee3006b08ca2abba58843f7573e0c5c6</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1069</attachid>
            <date>2022-12-22 23:50:06 +0000</date>
            <delta_ts>2022-12-22 23:50:06 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>MdeModulePkg - AtaBusDxe Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>17862</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1070</attachid>
            <date>2022-12-22 23:55:38 +0000</date>
            <delta_ts>2023-01-24 06:29:34 +0000</delta_ts>
            <desc>Proposed patch to resolve the SIGN_EXTENSION issue pointed by Coverity</desc>
            <filename>0001-MdeModulePkg-AtaBusDxe-Fix-SIGN_EXTENSION-Coverity-i.patch</filename>
            <type>text/plain</type>
            <size>1503</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1218</attachid>
            <date>2023-01-24 06:32:19 +0000</date>
            <delta_ts>2023-01-24 06:32:19 +0000</delta_ts>
            <desc>Proposed patch to resolve the Sign_extension issue pointed by Coverity for MdeModulePkg.</desc>
            <filename>0001-MdeModulePkg-Bus-Ata-AtaBusDxe-Fix-SIGN_EXTENSION-Co.patch</filename>
            <type>text/plain</type>
            <size>1583</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4420</bug_id>
          
          <creation_ts>2023-04-23 10:12:58 +0000</creation_ts>
          <short_desc>RedfishPkg uses DEBUG_MANAGEABILITY debug error level</short_desc>
          <delta_ts>2023-10-30 01:11:35 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21392</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-23 10:12:58 +0000</bug_when>
    <thetext>RedfishPkg uses DEBUG_MANAGEABILITY debug error level for detailed debug information.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21405</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:41:04 +0000</bug_when>
    <thetext>Abner will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22100</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-10-30 01:11:35 +0000</bug_when>
    <thetext>At edk2 commit d15d2667</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4566</bug_id>
          
          <creation_ts>2023-10-10 23:07:04 +0000</creation_ts>
          <short_desc>Use the base SortLib for Redfish modules only</short_desc>
          <delta_ts>2023-10-18 22:05:49 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>igork</cc>
    
    <cc>nicklew</cc>
    
    <cc>npham</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21973</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-10-10 23:07:04 +0000</bug_when>
    <thetext>The small footprint of base SortLib is used by Redfish modules in Redfish.dsc.inc. However, the reference of base SortLib may override the full version of SortLib used by the platform. Update Redfish module to use base SortLib by the means of module scoped subelement &lt;LibraryClass&gt;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21991</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-10-18 22:05:49 +0000</bug_when>
    <thetext>Fix at 95c9f470</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4421</bug_id>
          
          <creation_ts>2023-04-23 10:14:14 +0000</creation_ts>
          <short_desc>ManageabilityPkg uses DEBUG_MANAGEABILITY debug error level</short_desc>
          <delta_ts>2023-10-30 01:11:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>ManageabilityPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21393</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-23 10:14:14 +0000</bug_when>
    <thetext>ManageabilityPkg uses DEBUG_MANAGEABILITY debug error level for the detailed debug information.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21404</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:40:38 +0000</bug_when>
    <thetext>Abner will fix it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22099</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-10-30 01:11:00 +0000</bug_when>
    <thetext>At edk2-platforms commit 406291d3</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4620</bug_id>
          
          <creation_ts>2023-12-09 18:29:40 +0000</creation_ts>
          <short_desc>RELEASE CLANGPDB OVMF will not compile</short_desc>
          <delta_ts>2024-10-20 04:46:16 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Mike Beaton">mjsbeaton</reporter>
          <assigned_to name="Mike Beaton">mjsbeaton</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22254</commentid>
    <comment_count>0</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2023-12-09 18:29:40 +0000</bug_when>
    <thetext>RELEASE CLANGPDB OVMF will not compile, giving the following error:

```
/home/mjsbeaton/OpenSource/edk2/OvmfPkg/VirtioSerialDxe/VirtioSerial.c:28:22: error: variable &apos;EventNames&apos; is not needed and will not be emitted [-Werror,-Wunneeded-internal-declaration]
STATIC CONST CHAR8  *EventNames[] = {
                     ^
1 error generated.
```

The error can be &apos;fixed&apos; (and the version of OVMF then compiles and runs) by removing the STATIC in the reported line; but the error seems bogus (since the reference to the array has been optimised away due to the setting of debug Pcds in the RELEASE build).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22313</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-02 21:57:01 +0000</bug_when>
    <thetext>mjsbeaton@gmail.com: align to CLANGDRAWF and disable this warning in the release build.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23318</commentid>
    <comment_count>2</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-08-14 02:31:22 +0000</bug_when>
    <thetext>Apologies, I only recently saw that this was assigned to me.

We offered a different, and we felt preferable, patch here https://edk2.groups.io/g/devel/message/112510 on 2023-12-14 (the idea being to re-enable the warning, and modify the DEBUG macro so that the warning is not triggered).

In attempting to replicate the issue now (by building OvmfPkg in CLANGDWARF and CLANGPDB, at the commit immediately before d3225577123767fd09c91201d27e9c91663ae132) I am no longer seeing any errors - which may mean that clang has been updated and this is no longer an issue (so -Wno-unneeded-internal-declaration can be removed from CLANGDWARF_WARNING_OVERRIDES even without other changes).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23466</commentid>
    <comment_count>3</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-10-20 04:46:16 +0000</bug_when>
    <thetext>Fixed by https://github.com/tianocore/edk2/commit/ae83c6b7fd83a5906e016a32027c1bcd792a624e.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4396</bug_id>
          
          <creation_ts>2023-04-01 21:29:45 +0000</creation_ts>
          <short_desc>Add header file for PLDM specification</short_desc>
          <delta_ts>2023-04-22 00:48:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21299</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-01 21:29:45 +0000</bug_when>
    <thetext>Add header file for DMTF PLDM specification.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21390</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-22 00:48:03 +0000</bug_when>
    <thetext>Fixed at 45f5341f</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4711</bug_id>
          
          <creation_ts>2024-02-25 21:15:13 +0000</creation_ts>
          <short_desc>Refine REST JSON C Structure DXE driver</short_desc>
          <delta_ts>2024-03-05 21:54:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>igork</cc>
    
    <cc>nicklew</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22649</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-02-25 21:15:13 +0000</bug_when>
    <thetext>This driver shouldn&apos;t have a dependency on Redfish package or Redfish terminology.
Remove the references of &quot;Redfish&quot; from this driver.
Also, the debug parameter is missing for DEBUG macro in this driver.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22699</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 21:48:36 +0000</bug_when>
    <thetext>Abner: please add PR or commit id here.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22707</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-03-05 21:54:11 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/5408
Commit ID:74b5309</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4449</bug_id>
          
          <creation_ts>2023-05-06 01:12:33 +0000</creation_ts>
          <short_desc>Introduce EDKII Redfish Platform Config Protocol</short_desc>
          <delta_ts>2023-05-09 03:26:10 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21496</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-06 01:12:33 +0000</bug_when>
    <thetext>Introduce EDKII Redfish Platform Config Protocol as the interface between UEFI platform configuration and Redfish property to map EDK2 HII questions to the properties defined in Redfish schema.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21517</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-05-09 03:26:10 +0000</bug_when>
    <thetext>Fixed at 72bd7626 and 80b0c04d.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4137</bug_id>
          
          <creation_ts>2022-11-03 06:07:55 +0000</creation_ts>
          <short_desc>Regression in 202202: Virtual machines with VFIO devices hang early during startup</short_desc>
          <delta_ts>2022-11-18 06:37:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>pshirshov</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>kraxel</cc>
    
    <cc>pshirshov</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
    
    <cf_release_observed>edk2-stable202002</cf_release_observed>
    
    <cf_release_observed>edk2-stable202005</cf_release_observed>
    
    <cf_release_observed>edk2-stable202008</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19922</commentid>
    <comment_count>0</comment_count>
    <who name="">pshirshov</who>
    <bug_when>2022-11-03 06:07:55 +0000</bug_when>
    <thetext>I&apos;m using a qemu/kvm/libvirtd virtual machine with Nvidia card under VFIO and software TPM to run Windows 11.

Since release 202202 the VM hangs early during startup before GPU gets initalized and displays anything. If I add virtual video (QXL), my VFIO GPU gets initialized and the VM hangs after displaying TianoCore logo.

More details here: https://github.com/NixOS/nixpkgs/issues/164064</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20034</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-15 21:48:32 +0000</bug_when>
    <thetext>Include OvmfPkg Maintainers to give more comments.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20045</commentid>
    <comment_count>2</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2022-11-16 02:58:43 +0000</bug_when>
    <thetext>Can you attach a firmware log?

qemu-system-x86_64 \
  -chardev file,id=firmware,path=/tmp/firmware.log \
  -device isa-debugcon,iobase=0x402,chardev=firmware</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20047</commentid>
    <comment_count>3</comment_count>
    <who name="">pshirshov</who>
    <bug_when>2022-11-16 09:36:59 +0000</bug_when>
    <thetext>Well, there isn&apos;t much:


Running on QEMU (q35)
Relocating init from 0x000df6a0 to 0x007b86c0 (size 55456)
Found QEMU fw_cfg
QEMU fw_cfg DMA interface supported
Moving pm_base to 0x600
boot order:
1: /pci@i0cf8/pci-bridge@2,3/pci144d,a808@0
2: HALT
Found 15 PCI devices (max PCI bus is 00)
Running option rom at c000:0003</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20048</commentid>
    <comment_count>4</comment_count>
    <who name="">pshirshov</who>
    <bug_when>2022-11-16 09:39:38 +0000</bug_when>
    <thetext>Just in case, I&apos;m passing through RTX 3090 and I have

❯ lspci -nnk | grep 4c
4c:00.0 VGA compatible controller [0300]: NVIDIA Corporation GA102 [GeForce RTX 3090] [10de:2204] (rev a1)
4c:00.1 Audio device [0403]: NVIDIA Corporation GA102 High Definition Audio Controller [10de:1aef] (rev a1)

and my full qemu commandline is:

root       40067  0.0  0.0  11000  4644 ?        S    14:38   0:00 /nix/store/wqw8p691vv9f0sm94b73d9dj1nzr7aj5-swtpm-0.7.3/bin/swtpm socket --ctrl type=unixio,path=/run/libvirt/qemu/swtpm/2-win11-swtpm.sock,mode=0600 --tpmstate dir=/var/lib/libvirt/swtpm/ab6f42d8-a814-4784-b0ae-dea91828f3d4/tpm2,mode=0600 --log file=/var/log/swtpm/libvirt/qemu/win11-swtpm.log --terminate --tpm2
root       40085 72.3 19.0 34516748 25152720 ?   RLl  14:38   0:02 /run/libvirt/nix-emulators/qemu-system-x86_64 -name guest=win11,debug-threads=on -S -object {&quot;qom-type&quot;:&quot;secret&quot;,&quot;id&quot;:&quot;masterKey0&quot;,&quot;format&quot;:&quot;raw&quot;,&quot;file&quot;:&quot;/var/lib/libvirt/qemu/domain-2-win11/master-key.aes&quot;} -blockdev {&quot;driver&quot;:&quot;file&quot;,&quot;filename&quot;:&quot;/run/libvirt/nix-ovmf/OVMF_CODE.fd&quot;,&quot;node-name&quot;:&quot;libvirt-pflash0-storage&quot;,&quot;auto-read-only&quot;:true,&quot;discard&quot;:&quot;unmap&quot;} -blockdev {&quot;node-name&quot;:&quot;libvirt-pflash0-format&quot;,&quot;read-only&quot;:true,&quot;driver&quot;:&quot;raw&quot;,&quot;file&quot;:&quot;libvirt-pflash0-storage&quot;} -blockdev {&quot;driver&quot;:&quot;file&quot;,&quot;filename&quot;:&quot;/var/lib/libvirt/qemu/nvram/win11_VARS.fd&quot;,&quot;node-name&quot;:&quot;libvirt-pflash1-storage&quot;,&quot;auto-read-only&quot;:true,&quot;discard&quot;:&quot;unmap&quot;} -blockdev {&quot;node-name&quot;:&quot;libvirt-pflash1-format&quot;,&quot;read-only&quot;:false,&quot;driver&quot;:&quot;raw&quot;,&quot;file&quot;:&quot;libvirt-pflash1-storage&quot;} -machine pc-q35-6.2,usb=off,vmport=off,dump-guest-core=off,memory-backend=pc.ram,pflash0=libvirt-pflash0-format,pflash1=libvirt-pflash1-format -accel kvm -cpu host,migratable=on,hypervisor=off,aes=off,hv-time=on,hv-relaxed=on,hv-vapic=on,hv-spinlocks=0x1fff,hv-vendor-id=Dell,kvm=off -m 32768 -object {&quot;qom-type&quot;:&quot;memory-backend-ram&quot;,&quot;id&quot;:&quot;pc.ram&quot;,&quot;size&quot;:34359738368} -overcommit mem-lock=off -smp 4,sockets=1,dies=1,cores=4,threads=1 -uuid ab6f42d8-a814-4784-b0ae-dea91828f3d4 -no-user-config -nodefaults -chardev socket,id=charmonitor,fd=29,server=on,wait=off -mon chardev=charmonitor,id=monitor,mode=control -rtc base=localtime,driftfix=slew -global kvm-pit.lost_tick_policy=delay -no-hpet -no-shutdown -global ICH9-LPC.disable_s3=1 -global ICH9-LPC.disable_s4=1 -boot strict=on -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:16,&quot;chassis&quot;:1,&quot;id&quot;:&quot;pci.1&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;multifunction&quot;:true,&quot;addr&quot;:&quot;0x2&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:17,&quot;chassis&quot;:2,&quot;id&quot;:&quot;pci.2&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;addr&quot;:&quot;0x2.0x1&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:18,&quot;chassis&quot;:3,&quot;id&quot;:&quot;pci.3&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;addr&quot;:&quot;0x2.0x2&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:19,&quot;chassis&quot;:4,&quot;id&quot;:&quot;pci.4&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;addr&quot;:&quot;0x2.0x3&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:20,&quot;chassis&quot;:5,&quot;id&quot;:&quot;pci.5&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;addr&quot;:&quot;0x2.0x4&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:21,&quot;chassis&quot;:6,&quot;id&quot;:&quot;pci.6&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;addr&quot;:&quot;0x2.0x5&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:22,&quot;chassis&quot;:7,&quot;id&quot;:&quot;pci.7&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;addr&quot;:&quot;0x2.0x6&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:23,&quot;chassis&quot;:8,&quot;id&quot;:&quot;pci.8&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;addr&quot;:&quot;0x2.0x7&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:24,&quot;chassis&quot;:9,&quot;id&quot;:&quot;pci.9&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;multifunction&quot;:true,&quot;addr&quot;:&quot;0x3&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:25,&quot;chassis&quot;:10,&quot;id&quot;:&quot;pci.10&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;addr&quot;:&quot;0x3.0x1&quot;} -device {&quot;driver&quot;:&quot;pcie-root-port&quot;,&quot;port&quot;:8,&quot;chassis&quot;:11,&quot;id&quot;:&quot;pci.11&quot;,&quot;bus&quot;:&quot;pcie.0&quot;,&quot;addr&quot;:&quot;0x1&quot;} -device {&quot;driver&quot;:&quot;pcie-pci-bridge&quot;,&quot;id&quot;:&quot;pci.12&quot;,&quot;bus&quot;:&quot;pci.5&quot;,&quot;addr&quot;:&quot;0x0&quot;} -device {&quot;driver&quot;:&quot;qemu-xhci&quot;,&quot;p2&quot;:15,&quot;p3&quot;:15,&quot;id&quot;:&quot;usb&quot;,&quot;bus&quot;:&quot;pci.2&quot;,&quot;addr&quot;:&quot;0x0&quot;} -device {&quot;driver&quot;:&quot;virtio-serial-pci&quot;,&quot;id&quot;:&quot;virtio-serial0&quot;,&quot;bus&quot;:&quot;pci.3&quot;,&quot;addr&quot;:&quot;0x0&quot;} -device {&quot;driver&quot;:&quot;ide-cd&quot;,&quot;bus&quot;:&quot;ide.0&quot;,&quot;id&quot;:&quot;sata0-0-0&quot;} -netdev tap,fd=34,vhost=on,vhostfd=28,id=hostnet0 -device {&quot;driver&quot;:&quot;virtio-net-pci&quot;,&quot;netdev&quot;:&quot;hostnet0&quot;,&quot;id&quot;:&quot;net0&quot;,&quot;mac&quot;:&quot;52:54:00:9f:9c:89&quot;,&quot;bus&quot;:&quot;pci.1&quot;,&quot;addr&quot;:&quot;0x0&quot;} -netdev tap,fd=36,vhost=on,vhostfd=37,id=hostnet1 -device {&quot;driver&quot;:&quot;virtio-net-pci&quot;,&quot;netdev&quot;:&quot;hostnet1&quot;,&quot;id&quot;:&quot;net1&quot;,&quot;mac&quot;:&quot;52:54:00:d7:c6:48&quot;,&quot;bus&quot;:&quot;pci.7&quot;,&quot;addr&quot;:&quot;0x0&quot;} -chardev pty,id=charserial0 -device {&quot;driver&quot;:&quot;isa-serial&quot;,&quot;chardev&quot;:&quot;charserial0&quot;,&quot;id&quot;:&quot;serial0&quot;,&quot;index&quot;:0} -chardev spicevmc,id=charchannel0,name=vdagent -device {&quot;driver&quot;:&quot;virtserialport&quot;,&quot;bus&quot;:&quot;virtio-serial0.0&quot;,&quot;nr&quot;:1,&quot;chardev&quot;:&quot;charchannel0&quot;,&quot;id&quot;:&quot;channel0&quot;,&quot;name&quot;:&quot;com.redhat.spice.0&quot;} -chardev socket,id=chrtpm,path=/run/libvirt/qemu/swtpm/2-win11-swtpm.sock -tpmdev emulator,id=tpm-tpm0,chardev=chrtpm -device {&quot;driver&quot;:&quot;tpm-crb&quot;,&quot;tpmdev&quot;:&quot;tpm-tpm0&quot;,&quot;id&quot;:&quot;tpm0&quot;} -device {&quot;driver&quot;:&quot;virtio-keyboard-pci&quot;,&quot;id&quot;:&quot;input1&quot;,&quot;bus&quot;:&quot;pci.6&quot;,&quot;addr&quot;:&quot;0x0&quot;} -audiodev {&quot;id&quot;:&quot;audio1&quot;,&quot;driver&quot;:&quot;spice&quot;} -spice port=5900,addr=127.0.0.1,disable-ticketing=on,image-compression=off,seamless-migration=on -chardev spicevmc,id=charredir0,name=usbredir -device {&quot;driver&quot;:&quot;usb-redir&quot;,&quot;chardev&quot;:&quot;charredir0&quot;,&quot;id&quot;:&quot;redir0&quot;,&quot;bus&quot;:&quot;usb.0&quot;,&quot;port&quot;:&quot;2&quot;} -chardev spicevmc,id=charredir1,name=usbredir -device {&quot;driver&quot;:&quot;usb-redir&quot;,&quot;chardev&quot;:&quot;charredir1&quot;,&quot;id&quot;:&quot;redir1&quot;,&quot;bus&quot;:&quot;usb.0&quot;,&quot;port&quot;:&quot;3&quot;} -device {&quot;driver&quot;:&quot;vfio-pci&quot;,&quot;host&quot;:&quot;0000:01:00.0&quot;,&quot;id&quot;:&quot;hostdev0&quot;,&quot;bootindex&quot;:1,&quot;bus&quot;:&quot;pci.4&quot;,&quot;addr&quot;:&quot;0x0&quot;} -device {&quot;driver&quot;:&quot;vfio-pci&quot;,&quot;host&quot;:&quot;0000:47:00.0&quot;,&quot;id&quot;:&quot;hostdev1&quot;,&quot;bus&quot;:&quot;pci.9&quot;,&quot;multifunction&quot;:true,&quot;addr&quot;:&quot;0x0&quot;} -device {&quot;driver&quot;:&quot;vfio-pci&quot;,&quot;host&quot;:&quot;0000:47:00.1&quot;,&quot;id&quot;:&quot;hostdev2&quot;,&quot;bus&quot;:&quot;pci.9&quot;,&quot;addr&quot;:&quot;0x0.0x1&quot;} -device {&quot;driver&quot;:&quot;vfio-pci&quot;,&quot;host&quot;:&quot;0000:47:00.3&quot;,&quot;id&quot;:&quot;hostdev3&quot;,&quot;bus&quot;:&quot;pci.9&quot;,&quot;addr&quot;:&quot;0x0.0x3&quot;} -device {&quot;driver&quot;:&quot;vfio-pci&quot;,&quot;host&quot;:&quot;0000:4c:00.0&quot;,&quot;id&quot;:&quot;hostdev4&quot;,&quot;bus&quot;:&quot;pci.10&quot;,&quot;multifunction&quot;:true,&quot;addr&quot;:&quot;0x0&quot;} -device {&quot;driver&quot;:&quot;vfio-pci&quot;,&quot;host&quot;:&quot;0000:4c:00.1&quot;,&quot;id&quot;:&quot;hostdev5&quot;,&quot;bus&quot;:&quot;pci.10&quot;,&quot;addr&quot;:&quot;0x0.0x1&quot;} -chardev file,id=firmware,path=/tmp/firmware.log -deviceisa-debugcon,iobase=0x402,chardev=firmware -sandbox on,obsolete=deny,elevateprivileges=deny,spawn=deny,resourcecontrol=deny -object {&quot;qom-type&quot;:&quot;memory-backend-file&quot;,&quot;id&quot;:&quot;shmmem-shmem0&quot;,&quot;mem-path&quot;:&quot;/dev/shm/looking-glass&quot;,&quot;size&quot;:268435456,&quot;share&quot;:true} -device {&quot;driver&quot;:&quot;ivshmem-plain&quot;,&quot;id&quot;:&quot;shmem0&quot;,&quot;memdev&quot;:&quot;shmmem-shmem0&quot;,&quot;bus&quot;:&quot;pci.12&quot;,&quot;addr&quot;:&quot;0x1&quot;} -object {&quot;qom-type&quot;:&quot;memory-backend-file&quot;,&quot;id&quot;:&quot;shmmem-shmem1&quot;,&quot;mem-path&quot;:&quot;/dev/shm/scream-ivshmem&quot;,&quot;size&quot;:2097152,&quot;share&quot;:true} -device {&quot;driver&quot;:&quot;ivshmem-plain&quot;,&quot;id&quot;:&quot;shmem1&quot;,&quot;memdev&quot;:&quot;shmmem-shmem1&quot;,&quot;bus&quot;:&quot;pci.12&quot;,&quot;addr&quot;:&quot;0x2&quot;} -msg timestamp=on

(I&apos;m using libvirtd)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20052</commentid>
    <comment_count>5</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2022-11-17 03:32:43 +0000</bug_when>
    <thetext>(In reply to pshirshov from comment #3)
&gt; Well, there isn&apos;t much:
&gt; 
&gt; 
&gt; Running on QEMU (q35)
&gt; Relocating init from 0x000df6a0 to 0x007b86c0 (size 55456)
&gt; Found QEMU fw_cfg
&gt; QEMU fw_cfg DMA interface supported
&gt; Moving pm_base to 0x600
&gt; boot order:
&gt; 1: /pci@i0cf8/pci-bridge@2,3/pci144d,a808@0
&gt; 2: HALT
&gt; Found 15 PCI devices (max PCI bus is 00)
&gt; Running option rom at c000:0003

That is seabios not ovmf.
I&apos;ve meant to append the command line args to your qemu command line.

Doing it with libvirt works like this:

&lt;domain type=&apos;kvm&apos; xmlns:qemu=&apos;http://libvirt.org/schemas/domain/qemu/1.0&apos;&gt;
  &lt;name&gt;fedora-org-unified&lt;/name&gt;
  [ ... ]
  &lt;/devices&gt;
  &lt;qemu:commandline&gt;
    &lt;qemu:arg value=&apos;-chardev&apos;/&gt;
    &lt;qemu:arg value=&apos;file,id=firmware,path=/tmp/firmware.log&apos;/&gt;
    &lt;qemu:arg value=&apos;-device&apos;/&gt;
    &lt;qemu:arg value=&apos;isa-debugcon,iobase=0x402,chardev=firmware&apos;/&gt;
  &lt;/qemu:commandline&gt;
&lt;/domain&gt;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20053</commentid>
    <comment_count>6</comment_count>
    <who name="">pshirshov</who>
    <bug_when>2022-11-17 04:15:42 +0000</bug_when>
    <thetext>&gt; Doing it with libvirt works like this:

That&apos;s precisely what I did.

&gt; That is seabios not ovmf.

Nope, you may check my commandline:

-blockdev {&quot;driver&quot;:&quot;file&quot;,&quot;filename&quot;:&quot;/run/libvirt/nix-ovmf/OVMF_CODE.fd&quot;,&quot;node-name&quot;:&quot;libvirt-pflash0-storage&quot;,&quot;auto-read-only&quot;:true,&quot;discard&quot;:&quot;unmap&quot;}

OVMF is built with CSM support though: https://github.com/NixOS/nixpkgs/blob/nixos-unstable/pkgs/applications/virtualization/OVMF/default.nix#L51

 OVMFFull = callPackage ../applications/virtualization/OVMF {
    secureBoot = true;
    csmSupport = true;
    httpSupport = true;
    tpmSupport = true;
  };</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20055</commentid>
    <comment_count>7</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2022-11-17 08:06:10 +0000</bug_when>
    <thetext>(In reply to pshirshov from comment #3)
&gt; Well, there isn&apos;t much:

&gt; Running option rom at c000:0003

This is seabios (as csm) trying to run the option rom of the assigned pci device.
With that being the last log line it is quite likely that the option rom crashed.

I&apos;m wondering why we don&apos;t see any messages from ovmf in the logs, we should have both ovmf and seabios logging there.

Also can you attach a log from a successfull boot with an older version?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20056</commentid>
    <comment_count>8</comment_count>
    <who name="">pshirshov</who>
    <bug_when>2022-11-17 10:37:02 +0000</bug_when>
    <thetext>The log is even shorter with the old working version: 

Running on QEMU (q35)
Relocating init from 0x000df620 to 0x007b8660 (size 55552)
Found QEMU fw_cfg
QEMU fw_cfg DMA interface supported
Moving pm_base to 0x600
boot order:
1: /pci@i0cf8/pci-bridge@2,3/pci144d,a808@0
2: HALT
Found 15 PCI devices (max PCI bus is 00)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20057</commentid>
    <comment_count>9</comment_count>
    <who name="">pshirshov</who>
    <bug_when>2022-11-17 10:56:50 +0000</bug_when>
    <thetext>Ok, I&apos;ve rebuilt OVMF w/o CSM support and now my VMs work.

The firmware log is now empty.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20059</commentid>
    <comment_count>10</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2022-11-18 03:57:42 +0000</bug_when>
    <thetext>(In reply to pshirshov from comment #8)
&gt; The log is even shorter with the old working version: 

And specifically the line about running the option rom is *not* there.

I&apos;d highly recommend to just not build with CSM.  There is little reason to do so (for virtual machines it is trivial to switch firmware, so if you don&apos;t want UEFI just use seabios directly).  CSM mode conflicts with some UEFI features such as secure boot.  Most linux distros build without CSM.  So this is not used and tested much ...

(In reply to pshirshov from comment #9)
&gt; Ok, I&apos;ve rebuilt OVMF w/o CSM support and now my VMs work.

q.e.d. ;)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20060</commentid>
    <comment_count>11</comment_count>
    <who name="">pshirshov</who>
    <bug_when>2022-11-18 06:37:14 +0000</bug_when>
    <thetext>Yeah, thank you for the hints.

For some reason NixOS builds it with CSM support, though it worked flawlessly for years until recent changes. Many people experienced the same problem and haven&apos;t found a solution so far :)

But whatever, it works so I&apos;m closing this issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4397</bug_id>
          
          <creation_ts>2023-04-01 21:31:30 +0000</creation_ts>
          <short_desc>Add header file for PLDM SMBIOS Transfer specification</short_desc>
          <delta_ts>2023-04-22 00:48:20 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21300</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-01 21:31:30 +0000</bug_when>
    <thetext>Add header file for DMTF PLDM SMBIOS Transfer specification</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21391</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-22 00:48:20 +0000</bug_when>
    <thetext>Fixed at 697e594f</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4216</bug_id>
          
          <creation_ts>2022-12-26 08:13:15 +0000</creation_ts>
          <short_desc>Not an issue</short_desc>
          <delta_ts>2023-01-02 01:32:39 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WORKSFORME</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Ranbir Singh">saini.ranbirs</reporter>
          <assigned_to name="Ranbir Singh">saini.ranbirs</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20285</commentid>
    <comment_count>0</comment_count>
      <attachid>1080</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-26 08:13:15 +0000</bug_when>
    <thetext>Created attachment 1080
HTML files reflecting the issues

15 issues have been captured by Coverity scan for MdeModulePkg/Bus/Pci/PciBusDxe.

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20286</commentid>
    <comment_count>1</comment_count>
      <attachid>1081</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-26 08:17:28 +0000</bug_when>
    <thetext>Created attachment 1081
Proposed patch to resolve the issues pointed by Coverity

The function PciHotPlugRequestNotify in

    MdeModulePkg/Bus/Pci/PciBusDxe/PciEnumerator.c

has two if blocks towards the end of function both containing return.
Due to the parameter checks ensured at the beginning of the function,
one of the two if blocks is bound to come in execution flow. Hence,
the return EFI_SUCCESS; at line 2112 is redundant/deadcode. To fix it,
either of line 2109 or 2112 can be deleted.

The function UpdatePciInfo in

    MdeModulePkg/Bus/Pci/PciBusDxe/PciEnumeratorSupport.c

has switch-case code in which there are fall through from
case 32: to case 64:. While this is seeemingly intentional, it is not
evident to any static analyzer tool. Just adding

    // No break; here as this is an intentional fallthrough.

as explicit comment in between makes Coverity happy.

The function PciHostBridgeResourceAllocator in

    MdeModulePkg/Bus/Pci/PciBusDxe/PciLib.c has

is not making use of the generic approach as is used in one of the
other function - DumpResourceMap. As a result, we see the warning as
reported by Coverity e.g.
(30) Event address_of:	Taking address with &quot;&amp;IoBridge&quot; yields a
     singleton pointer.
(31) Event callee_ptr_arith:	Passing &quot;&amp;IoBridge&quot; to function
     &quot;FindResourceNode&quot; which uses it as an array. This might corrupt
     or misinterpret adjacent memory locations.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20287</commentid>
    <comment_count>2</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-26 08:19:19 +0000</bug_when>
    <thetext>With the changes added as reflected by patch, Coverity scan does not reflect the same DEADCODE, MISSING_BREAK and ARRAY_VS_SINGLETON issues at the points as observed originally.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20288</commentid>
    <comment_count>3</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-26 08:55:57 +0000</bug_when>
    <thetext>For various UNUSED_VALUE issues

The return value from a function call is stored in Status variable but no use has been made wrt the return Status value. The return Status is not at all analyzed and the values gets over-written by another function call / directly either below that or somewhere earlier due to it being part of the loop.

If nothing to be done, then one option is to not to store return value from the function call in Status. So for UNUSED_VALUE in edk2/MdeModulePkg/Bus/Pci/PciBusDxe/PciDeviceSupport.c file in the function DeRegisterPciDevice

547             gBS-&gt;UninstallMultipleProtocolInterfaces (
548  	                        Handle,
549  	                        &amp;gEfiLoadFile2ProtocolGuid,
550  	                        &amp;PciIoDevice-&gt;LoadFile2,
551  	                        NULL
552  	                        );

instead of 

547             Status = gBS-&gt;UninstallMultipleProtocolInterfaces (
548  	                        Handle,
549  	                        &amp;gEfiLoadFile2ProtocolGuid,
550  	                        &amp;PciIoDevice-&gt;LoadFile2,
551  	                        NULL
552  	                        );

Other option is to Status check like below and leave a blank statement with comment saying Nothing to do -

      if (EFI_ERROR (Status)) {
        // ??? What to do ?
        // ; Nothing to do
        // OR
        // return Status;
      }

OR return Status; if that makes sense in the given scenario.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20293</commentid>
    <comment_count>4</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-26 22:50:16 +0000</bug_when>
    <thetext>For UNUSED_VALUE issues, removing the return value storage in Status would also lead to CHECKED_RETURN coverity issue.

Hence, the options are

Leave a blank statement with comment saying Nothing to do as shown below

       if (EFI_ERROR (Status)) {
         ; // Nothing to do
       }

OR if it makes sense in the given scenario, then use

       if (EFI_ERROR (Status)) {
         return Status;
       }

OR leave the code ass it is and ignore the Coverity warning.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20319</commentid>
    <comment_count>5</comment_count>
      <attachid>1103</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-28 10:41:52 +0000</bug_when>
    <thetext>Created attachment 1103
HTML files reflecting the issues

updated with correct html files</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20322</commentid>
    <comment_count>6</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-28 22:21:34 +0000</bug_when>
    <thetext>To be seen later.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1080</attachid>
            <date>2022-12-26 08:13:15 +0000</date>
            <delta_ts>2022-12-28 10:41:52 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>MdeModulePkg - PciBusDxe Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>431811</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1081</attachid>
            <date>2022-12-26 08:17:28 +0000</date>
            <delta_ts>2022-12-26 08:17:28 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity</desc>
            <filename>0001-MdeModulePkg-Bus-Pci-PciBusDxe-Fix-Coverity-issues.patch</filename>
            <type>text/plain</type>
            <size>6623</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1103</attachid>
            <date>2022-12-28 10:41:52 +0000</date>
            <delta_ts>2022-12-28 10:41:52 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>MdeModulePkg - PciBusDxe Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>426570</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4367</bug_id>
          
          <creation_ts>2023-03-12 21:53:42 +0000</creation_ts>
          <short_desc>UefiPayloadPkg: Startup IPI exception in DXE phase caused by wrong MAX_LOGICAL_PROCESSORS value in UefiPayloadPkg.dsc</short_desc>
          <delta_ts>2023-03-14 07:59:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Xiaoqiang Zhang">xiaoqiang.zhang</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>guo.dong</cc>
    
    <cc>james.lu</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21177</commentid>
    <comment_count>0</comment_count>
    <who name="Xiaoqiang Zhang">xiaoqiang.zhang</who>
    <bug_when>2023-03-12 21:53:42 +0000</bug_when>
    <thetext>Issue: 
For GNR FSP API mode, when FSP does not output mCpuInitMpLibHobGuid HOB,
the code will wakeup all APs and calculate the processor count in DXE phase. But when processor thread number is above 256, will encounter Startup IPI exception in DXE phase. 
Same issue happened in GNR FSP dispatch mode without mCpuInitMpLibHobGuid HOB case.

Root cause:
MAX_LOGICAL_PROCESSORS value in UefiPayloadPkg.dsc is 256, when the actual processor thread number is above 256, will encounter data overflow exception.

Solution:
Align MAX_LOGICAL_PROCESSORS value with GNR platform side value 1024</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21188</commentid>
    <comment_count>1</comment_count>
    <who name="Xiaoqiang Zhang">xiaoqiang.zhang</who>
    <bug_when>2023-03-14 07:59:14 +0000</bug_when>
    <thetext>Fixed by https://bugzilla.tianocore.org/show_bug.cgi?id=4372</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4832</bug_id>
          
          <creation_ts>2024-08-19 03:13:43 +0000</creation_ts>
          <short_desc>New MAT logic causes some EfiRuntimeServicesCode regions to not have attributes set because they are not part of loaded images</short_desc>
          <delta_ts>2024-09-02 05:22:41 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>Windows</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>sachinganesh</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>felixp</cc>
    
    <cc>gaoliming</cc>
    
    <cc>osde</cc>
    
    <cc>tabeebe</cc>
    
    <cc>vdhanaraj</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23329</commentid>
    <comment_count>0</comment_count>
      <attachid>1536</attachid>
    <who name="">sachinganesh</who>
    <bug_when>2024-08-19 03:13:43 +0000</bug_when>
    <thetext>Created attachment 1536
Logs and Images with and without the SplitRecord() change

In edk2-stable202402, the MAT logic was improved and moved to ImagePropertiesRecordLib (https://github.com/tianocore/edk2/pull/4900). As a part of this change, SplitRecord() function was modified to exclude the portions which are not part of loaded images. (https://github.com/tianocore/edk2/pull/4900/commits/1b42c762c7a1706652509ac55a7ff8b2e0fd98c3)

This causes some EfiRuntimeServicesCode regions to not have attributes set because they are not part of loaded images.

As an effect of this, NX Protection shows up as absent in Microsoft Device Guard and Credential Guard hardware readiness tool - https://www.microsoft.com/en-us/download/details.aspx?id=53337.

This further leads to failure in Windows Hardware Lab Kit tests.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23331</commentid>
    <comment_count>1</comment_count>
    <who name="">sachinganesh</who>
    <bug_when>2024-08-20 01:46:34 +0000</bug_when>
    <thetext>Hi Oliver,

Could you provide an update here once the patch has been put through.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23356</commentid>
    <comment_count>2</comment_count>
    <who name="">sachinganesh</who>
    <bug_when>2024-09-02 05:22:41 +0000</bug_when>
    <thetext>Fixed as part of https://github.com/tianocore/edk2/pull/6089</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1536</attachid>
            <date>2024-08-19 03:13:43 +0000</date>
            <delta_ts>2024-08-19 03:13:43 +0000</delta_ts>
            <desc>Logs and Images with and without the SplitRecord() change</desc>
            <filename>edk2_SplitRecord_logs.7z</filename>
            <type>application/octet-stream</type>
            <size>592791</size>
            <attacher>sachinganesh</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4398</bug_id>
          
          <creation_ts>2023-04-03 21:04:43 +0000</creation_ts>
          <short_desc>Add edk2 MCTP protocol</short_desc>
          <delta_ts>2023-04-25 21:55:27 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>ManageabilityPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Normal</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21304</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-03 21:04:43 +0000</bug_when>
    <thetext>Implement edk2 MCTP protocol that creates the MCTP message and delivers the message through a selected manageability transport interface.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21418</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:54:00 +0000</bug_when>
    <thetext>Abner has worked on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21421</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-25 21:55:27 +0000</bug_when>
    <thetext>Fixed at dbb236e2.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4312</bug_id>
          
          <creation_ts>2023-01-17 08:23:45 +0000</creation_ts>
          <short_desc>MdeModulePkg/Bus/Scsi/ScsiDiskDxe: Coverity scan flag UNUSED_VALUE issues</short_desc>
          <delta_ts>2023-01-25 11:03:02 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Low</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20702</commentid>
    <comment_count>0</comment_count>
      <attachid>1192</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-17 08:23:45 +0000</bug_when>
    <thetext>Created attachment 1192
HTML files reflecting the coverity issues.

6 UNUSED_VALUE issues have been captured by Coverity scan for the MdeModulePkg/Bus/Scsi/ScsiDiskDxe. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20916</commentid>
    <comment_count>1</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-25 11:03:02 +0000</bug_when>
    <thetext>Issues are already fixed in Edk2</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1192</attachid>
            <date>2023-01-17 08:23:45 +0000</date>
            <delta_ts>2023-01-17 08:23:45 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues.</desc>
            <filename>MdeModulePkg-ScsiDiskDxe-CoverityIssues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>392709</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4201</bug_id>
          
          <creation_ts>2022-12-22 04:06:22 +0000</creation_ts>
          <short_desc>MdeModulePkg/Bus/Ata/AhciPei: Coverity scan flags DEADCODE issue</short_desc>
          <delta_ts>2023-06-02 02:36:35 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Low</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ranbir Singh">saini.ranbirs</reporter>
          <assigned_to name="Ranbir Singh">saini.ranbirs</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20258</commentid>
    <comment_count>0</comment_count>
      <attachid>1064</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 04:06:22 +0000</bug_when>
    <thetext>Created attachment 1064
HTML files reflecting the issues

1 issue has been captured by Coverity scan for MdeModulePkg/Bus/Ata/AhciPei.

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.

File - edk2/MdeModulePkg/Bus/Ata/AhciPei/AhciPeiS3.c

The code can reach line 69 only through the else path at line 57. The else path already has the same check at line 59 and hence the duplicate code lines are totally redundant.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20259</commentid>
    <comment_count>1</comment_count>
      <attachid>1065</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 04:08:26 +0000</bug_when>
    <thetext>Created attachment 1065
Proposed patch to resolve the issues pointed by Coverity


Redundant code can simply be deleted. Please review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20348</commentid>
    <comment_count>2</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-02 02:00:26 +0000</bug_when>
    <thetext>
With the changes as reflected by the attached patch, Coverity scan does not reflect the same DEADCODE issue as observed originally.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20427</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:38:14 +0000</bug_when>
    <thetext>Ranbir: please send the patch to edk2 mail list for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20449</commentid>
    <comment_count>4</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-04 01:59:14 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #3)
&gt; Ranbir: please send the patch to edk2 mail list for code review.

Patch sent to EDK2 mail list with mail subject as -

[PATCH] MdeModulePkg/Bus/Ata/AhciPei: Fix DEADCODE Coverity issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20757</commentid>
    <comment_count>5</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 04:52:18 +0000</bug_when>
    <thetext>(In reply to Ranbir Singh from comment #4)
&gt; (In reply to gaoliming from comment #3)
&gt; &gt; Ranbir: please send the patch to edk2 mail list for code review.
&gt; 
&gt; Patch sent to EDK2 mail list with mail subject as -
&gt; 
&gt; [PATCH] MdeModulePkg/Bus/Ata/AhciPei: Fix DEADCODE Coverity issue

Marking this patch as obsolete and uploading a new updated patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20758</commentid>
    <comment_count>6</comment_count>
      <attachid>1215</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 04:53:44 +0000</bug_when>
    <thetext>Created attachment 1215
Proposed patch to resolve the issues pointed by Coverity

Please consider this patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21629</commentid>
    <comment_count>7</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-06-02 02:36:35 +0000</bug_when>
    <thetext>
Patch merged as - 

 https://github.com/tianocore/edk2/commit/ae6e470252d9312dce20d0b21e7f622c4ca9ad0a</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1064</attachid>
            <date>2022-12-22 04:06:22 +0000</date>
            <delta_ts>2022-12-22 04:06:22 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>MdeModulePkg - AhciPei Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>3930</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1065</attachid>
            <date>2022-12-22 04:08:26 +0000</date>
            <delta_ts>2023-01-24 04:52:42 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity</desc>
            <filename>0001-MdeModulePkg-Bus-Ata-AhciPei-Fix-Coverity-issues.patch</filename>
            <type>text/plain</type>
            <size>887</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1215</attachid>
            <date>2023-01-24 04:53:44 +0000</date>
            <delta_ts>2023-01-24 04:53:44 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity</desc>
            <filename>0001-MdeModulePkg-Bus-Ata-AhciPei-Fix-DEADCODE-Coverity-i.patch</filename>
            <type>text/plain</type>
            <size>1153</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4284</bug_id>
          
          <creation_ts>2023-01-09 12:35:57 +0000</creation_ts>
          <short_desc>SecurityPkg/VariableAuthenticated/SecureBootConfigDxe: Coverity scan flags DEADCODE issue</short_desc>
          <delta_ts>2023-01-10 06:23:25 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4266</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Low</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20555</commentid>
    <comment_count>0</comment_count>
      <attachid>1156</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-09 12:35:57 +0000</bug_when>
    <thetext>Created attachment 1156
HTML files reflecting the coverity issues.

1 DEADCODE issue has been captured by Coverity scan for the SecurityPkg/VariableAuthenticated/SecureBootConfigDxe. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20571</commentid>
    <comment_count>1</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-10 06:23:25 +0000</bug_when>
    <thetext>To be seen in 4266

*** This bug has been marked as a duplicate of bug 4266 ***</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1156</attachid>
            <date>2023-01-09 12:35:57 +0000</date>
            <delta_ts>2023-01-09 12:35:57 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues.</desc>
            <filename>SecurityPkg-VariableAuthenticated-SecureBootConfigDxe-CoverityIssues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>70011</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4242</bug_id>
          
          <creation_ts>2023-01-03 01:54:22 +0000</creation_ts>
          <short_desc>IntelSiliconPkg: Add FVI_SMBIOS_TYPE definition in IndustryStandard/FirmwareVersionInfo.h</short_desc>
          <delta_ts>2023-01-06 01:50:46 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>IntelSiliconPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Low</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Hunter Chang">hunter.chang</reporter>
          <assigned_to name="Hunter Chang">hunter.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20371</commentid>
    <comment_count>0</comment_count>
    <who name="Hunter Chang">hunter.chang</who>
    <bug_when>2023-01-03 01:54:22 +0000</bug_when>
    <thetext>Add FVI_SMBIOS_TYPE definition in IndustryStandard/FirmwareVersionInfo.h</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20372</commentid>
    <comment_count>1</comment_count>
    <who name="Hunter Chang">hunter.chang</who>
    <bug_when>2023-01-03 02:13:53 +0000</bug_when>
    <thetext>Define a macro for SmbiosFeaturePkg usage which named INTEL_FVI_SMBIOS_TYPE and initialized to 0xDD in IndustryStandard/FirmwareVersionInfo.h</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20510</commentid>
    <comment_count>2</comment_count>
    <who name="Hunter Chang">hunter.chang</who>
    <bug_when>2023-01-06 01:50:46 +0000</bug_when>
    <thetext>The patch has been added in master branch

https://github.com/tianocore/edk2-platforms/commit/045a4e5d13552084d6db0d566f2931ea5c92b516</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4286</bug_id>
          
          <creation_ts>2023-01-10 03:50:05 +0000</creation_ts>
          <short_desc>MdeModulePkg/Universal/SetupBrowserDxe: Coverity scan flags multiple issues</short_desc>
          <delta_ts>2023-01-10 04:10:22 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4254</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Low</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Veeresh Sangolli">veeresh.sangolli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>saini.ranbirs</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20560</commentid>
    <comment_count>0</comment_count>
      <attachid>1158</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-10 03:50:05 +0000</bug_when>
    <thetext>Created attachment 1158
HTML files reflecting the coverity issues.

3 issues have been captured by Coverity scan for the MdeModulePkg/Universal/SetupBrowserDxe. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20562</commentid>
    <comment_count>1</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-10 04:10:22 +0000</bug_when>
    <thetext>To be handled in 4254

*** This bug has been marked as a duplicate of bug 4254 ***</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1158</attachid>
            <date>2023-01-10 03:50:05 +0000</date>
            <delta_ts>2023-01-10 03:50:05 +0000</delta_ts>
            <desc>HTML files reflecting the coverity issues.</desc>
            <filename>MdeModulePkg-SetupBrowserDxe-CoverityIssues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>116090</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4162</bug_id>
          
          <creation_ts>2022-11-21 10:47:36 +0000</creation_ts>
          <short_desc>Deferring EOI until after RestoreTPL() causes system time to stop</short_desc>
          <delta_ts>2022-12-23 12:00:59 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          <see_also>https://bugzilla.tianocore.org/show_bug.cgi?id=2815</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>regression</keywords>
          <priority>Lowest</priority>
          <bug_severity>critical</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Brown">mcb30</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>afish</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>igor.druzhinin</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>pbonzini</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
    
    <cf_release_observed>edk2-stable202008</cf_release_observed>
    
    <cf_release_observed>edk2-stable202011</cf_release_observed>
    
    <cf_release_observed>edk2-stable202102</cf_release_observed>
    
    <cf_release_observed>edk2-stable202105</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20070</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-21 10:47:36 +0000</bug_when>
    <thetext>Commit 239b50a86 (&quot;OvmfPkg: End timer interrupt later to avoid stack overflow under load&quot;) deferred the call to SendApicEoi() until after the call to RestoreTPL(), in order to avoid the potential stack underflow as described in bug 2815.

This has the unwanted side effect that any callbacks invoked as a result of RestoreTPL() will now run before the EOI is sent to the APIC.  Until the callbacks return, no further timer interrupts will be raised and the system time value in mEfiSystemTime will remain unchanging.

If any callbacks invoked by RestoreTPL() include a timeout loop based on mEfiSystemTime (e.g. via SetTimer() and CheckEvent()), this loop will never time out and the system will appear to hang.

This situation can be reproduced by e.g. attaching a USB network card connected via an xHCI USB controller.  The &quot;system poll timer&quot; callback to MnpSystemPoll() will eventually cause the following sequence of events:

- Hardware timer interrupt occurs
- TimerInterruptHandler() in LocalApicTimerDxe is called
- TimerInterruptHandler() calls RaiseTPL(TPL_HIGH_LEVEL)
- TimerInterruptHandler() calls RestoreTPL() before sending EOI
- RestoreTPL() triggers a call to MnpSystemPoll()
- MnpSystemPoll() ends up calling through to XhcExecTransfer() to poll the USB device
- XhcExecTransfer() enters a loop waiting for the transfer to complete or time out
- XhcExecTransfer() uses CheckEvent() to check for the timeout condition
- Since EOI has not been sent, no further timer interrupts will occur and so CheckEvent() always returns EFI_NOT_READY and XhcExecTransfer() waits indefinitely in its timeout loop
- User sees a totally stuck system that is unresponsive to any input other than a hard reset


This problem does not affect EHCI or UHCI controllers since they do not rely on SetTimer()/CheckEvent() to check for timeout.


The code pattern in LocalApicTimerDxe&apos;s TimerInterruptHandler() looks highly dubious: it is surprising to see an interrupt handler itself enabling and disabling interrupts.  I am unclear what the proper fix for this ought to be.

I&apos;m happy to code up a fix if someone can tell me what the correct approach should be.

Thanks,

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20071</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-22 05:17:36 +0000</bug_when>
    <thetext>I&apos;ve been staring at this for hours now. Here&apos;s what I can say.

I think I was wrong to ACK commit 239b50a86 (the patch for bug#2815).
That commit effectively disables interrupt nesting. (The patch does not
interfere with interrupt delivery, but it prevents interrupt generation,
by delaying EOI.)

However, interrupt nesting -- as I now think I understand -- is a
necessity for edk2

(1) UEFI drivers and a running UEFI application, taken all together, do
    not follow the &quot;one central main loop + non-interruptible, quick ISR
    + bottom halves&quot; style. The drivers&apos; timer notifications must be
    processed orthogonally to the application being aware or not. This
    is only possible if TPL_CALLBACK notification functions of the
    drivers actually interrupt the TPL_APPLICATION code of the
    application. For that, the TPL_CALLBACK notification functions, such
    as MnpSystemPoll() --&gt; XhcExecTransfer(), have to run in interrupt
    handler context.

(2) In turn, TPL_CALLBACK notification functions (running in interrupt
    handler context, as stated above), such as XhcExecTransfer(), are
    permitted to call the CreateEvent(), SetTimer() and CheckEvent()
    boot services, per UEFI spec / TPL restrictions.

(3) In turn, those boot services rely on timer interrupts being
    generated and delivered while they are being used, for example in a
    polling loop, such as the one seen in XhcExecTransfer().

Ergo, timer interrupts must be generated and delivered while other stuff
is happening in interrupt handler context (such as a TPL_CALLBACK
notification running).

This statement happens to be the definition of interrupt nesting -- the
handler itself ought to be, ultimately, interruptible and reentrant.

Specifically, MnpSystemPoll() is queued at TPL_CALLBACK, hence its
callee XhcExecTransfer() too executes at TPL_CALLBACK -- still in
interrupt handler context (there is no other context to run
MnpSystemPoll() in). At TPL_CALLBACK, XhcExecTransfer() is permitted to
use CreateEvent(), SetTimer() and CheckEvent(). CheckEvent() will only
work if timer interrupts are being generated and delivered while
XhcExecTransfer() is looping.

Therefore we should revert commit 239b50a86, and fix the interrupt storm
(or interrupt burst) described in bug#2815 differently.

Here&apos;s how the interrupt storm / burst mis-behaves, as far as I can
guesstimate. Namely, with commit 239b50a86 *reverted*:

(a) When the first interrupt of the delayed burst is delivered, we most
    likely interrupt TPL_APPLICATION code. Therefore in
    TimerInterruptHandler() [OvmfPkg/8254TimerDxe/Timer.c], we call
    &quot;CoreRaiseTpl (TPL_HIGH_LEVEL)&quot; against TPL_APPLICATION.

(b) This manually disables interrupt delivery (somewhat needlessly I
    think, because we&apos;re already in interrupt context). It also sets
    &quot;gEfiCurrentTpl&quot; to TPL_HIGH_LEVEL, and returns TPL_APPLICATION.

(c) We signal EOI -- interrupts can now be generated again, but not
    delivered just yet.

(d) There is likely a timer event notification function that we queue.
    (Said function is probably &quot;way overdue&quot;, because the timer
    interrupts in question have been significantly delayed in the first
    place, due to Xen descheduling the vCPU for a long time.)

(e) TimerInterruptHandler() calls CoreRestoreTpl() with
    NewTpl=TPL_APPLICATION.

(f) In CoreRestoreTpl(), we see that there is at least one TPL_CALLBACK
    function queued (from step (d)), so we set &quot;PendingTpl&quot; to
    TPL_CALLBACK. Because NewTpl (TPL_APPLICATION) is less than
    PendingTpl (TPL_CALLBACK), we proceed to dispatching the function as
    follows.

(g) We set &quot;gEfiCurrentTpl&quot; to TPL_CALLBACK.

(h) Because interrupt nesting is necessary for the sake of boot services
    working inside callbacks, we reenable interrupt delivery, in
    preparation for calling the the queued notification function.

(i) The second interrupt of the burst is delivered immediately, before
    we can advance to calling the notification function.

(j) We enter TimerInterruptHandler() asynchronously, on a new stack
    frame.

(k) From TimerInterruptHandler(), we call CoreRaiseTpl (TPL_HIGH_LEVEL)
    again.

(l) This disables interrupt delivery (needlessly, similarly to step
    (b)), sets &quot;gEfiCurrentTpl&quot; to TPL_HIGH_LEVEL, and returns
    TPL_CALLBACK (!!!). Note the return value difference with step (b).

(m) We signal EOI.

(n) The timer event notification function, which we failed to actually
    dispatch after step (h), is still pending (still overdue), therefore
    we queue it again (or at least we &quot;mark it&quot; as pending,
    idempotently; doesn&apos;t matter).

(o) TimerInterruptHandler() calls CoreRestoreTpl() with
    NewTpl=TPL_CALLBACK.

(p) In CoreRestoreTpl(), while we see that there is still at least one
    TPL_CALLBACK function queued (and so we set &quot;PendingTpl&quot; to
    TPL_CALLBACK again), NewTpl is now TPL_CALLBACK, therefore we break
    out of the loop that handles the different task priority level
    queues, don&apos;t reenable interrupt delivery, and don&apos;t try to dispatch
    anything. This seems correct!

(q) We set &quot;gEfiCurrentTpl&quot; to TPL_CALLBACK.

(r) At the end of CoreRestoreTpl(), we reenable interrupt delivery --
    and the third interrupt of the burst enters TimerInterruptHandler()
    on a new frame.

    I think this is the problem!

    This is what commit 239b50a86 attempts to defuse, by keeping
    interrupt *generation* disabled, by delaying the EOI. After
    CoreRestoreTpl() returns, commit 239b50a86 re-disables interrupt
    delivery -- effectively undoing step (r) under the protection of the
    *withheld* EOI --, and then commit 239b50a86 finally signals the
    EOI. Interrupt delivery is then reenabled by IRET (refer to
    &lt;https://bugzilla.tianocore.org/show_bug.cgi?id=2815#c7&gt;).

    Instead, CoreRestoreTpl() should just *not* re-enable interrupt
    delivery here. It should only return to TimerInterruptHandler(), and
    allow TimerInterruptHandler() to complete. When that happened, we&apos;d
    execute an IRET, and that would reenable interrupt delivery
    simultaneously with popping the frame off the stack. We&apos;d
    subsequently return to just after step (h), with interrupt delivery
    enabled. That&apos;s where the entire burst would be coalesced (repeat
    the sequence from (i) through (q), many times), and after the final
    interrupt of the burst, proceed to dispatching the queued
    notification function.

So here&apos;s my opinion / proposal:

(i) In CoreRaiseTpl(), when the TPL is raised from below HIGH to HIGH,
    and we&apos;re about to disable interrupts, we should check *and record*
    whether we&apos;re already running in an interrupt handler context. Put
    differently, if interrupt delivery is already disabled, then don&apos;t
    try to disable it again; instead, just remember the fact, in a new
    global variable.

(ii) In CoreRestoreTpl(), the CoreDispatchEventNotifies() must be
     correctly *bracketed* by unmasking and re-masking interrupt
     delivery. The unmasking is already there, but the re-masking is
     missing. If we enter the loop with interrupt delivery turned off,
     we must exit the loop the same way.

(iii) At the very end of CoreRestoreTpl(), we must only unmask
      (re-enable) interrupt delivery if we&apos;re not already in interrupt
      handler context. That is, if we recorded, in step (i), that
      interrupts had been disabled before the TPL was going to be raised
      to HIGH, then do not reenable interrupt delivery here either, when
      lowering the TPL from HIGH.

gCpu-&gt;GetInterruptState() can be used to determine if interrupt delivery
is already disabled.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20073</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-22 05:42:25 +0000</bug_when>
    <thetext>(Small, tangential correction: commit 239b50a86370 does interfere with both interrupt generation and interrupt delivery. The goal of the commit is to *undo* the final interrupt delivery enablement in RestoreTPL. The commit works as follows: first, EOI is delayed until after RestoreTPL, therefore, even though RestoreTPL still enables delivery at the end, there is nothing to deliver because nothing is generated by the interrupt controller. Second, after RestoreTPL returns, interrupt delivery is immediately disabled. Third, the EOI is sent. This ordering of steps #2 and #3 ensures that there is no window when an interrupt could be generated, but would not be masked, and hence be delivered.

The regression is that delaying the EOI until after RestoreTPL kills timer interrupts for notification functions called from within RestoreTPL, even though those notification functions depend on timer interrupts, whenever they call CheckEvent(), for example.

Therefore the right approach is not to &quot;undo&quot; RestoreTPL&apos;s final interrupt delivery enablement, from TimerInterruptHandler() -- instead, modify RestoreTPL *itself* so that the delivery reenablement step in question only be done in case we&apos;re not already in interrupt context. If we&apos;re already in interrupt context, then the IRET -- which follows upon TimerInterruptHandler() returning -- will reenable interrupt delivery *without* the risk of recursively entering TimerInterruptHandler().)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20074</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-22 05:55:57 +0000</bug_when>
    <thetext>FWIW this reminds me slightly of spin_lock_irqsave() in the Linux kernel:

https://www.kernel.org/doc/html/v5.0/kernel-hacking/locking.html#hard-irq-context

&gt;| spin_lock_irqsave() (include/linux/spinlock.h) is a variant which saves
&gt;| whether interrupts were on or off in a flags word, which is passed to
&gt;| spin_unlock_irqrestore(). This means that the same code can be used inside
&gt;| an hard irq handler (where interrupts are already off) and in softirqs
&gt;| (where the irq disabling is required).

IMO that&apos;s what we want from the RaiseTPL and RestoreTPL boot services. They should work both when normal driver code raises the TPL to HIGH (and therefore explicit interrupt disabling is needed), and when the low-level timer interrupt handler raises the TPL to HIGH in interrupt context (and therefore interrupt delivery is managed externally to RaiseTPL/RestoreTPL).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20075</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-22 10:50:15 +0000</bug_when>
    <thetext>Laszlo: thank you very much for the extremely detailed analysis!  I agree completely that it does feel very similar to spin_lock_irqsave().  Since we can&apos;t viably change the API for RaiseTPL()/RestoreTPL(), I&apos;m trying to think through the potential implications of holding the necessary flags variable in a single global, to convince myself that it&apos;s provably safe to do so.

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20076</commentid>
    <comment_count>5</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-22 11:50:50 +0000</bug_when>
    <thetext>I _think_ that a global flag (&quot;mRaisedFromIsr&quot;) cannot work, given the following possible sequence of events:

- Hardware interrupt occurs

- ISR calls RaiseTPL() to raise to TPL_HIGH_LEVEL.  RaiseTPL() records the global flag mRaisedFromIsr=TRUE based on gCpu-&gt;GetInterruptState().

- ISR calls RestoreTPL() to restore back to TPL_APPLICATION.  As part of this a callback is invoked at TPL_CALLBACK.

- The callback chooses (for some reason) to call RaiseTPL() to raise to TPL_HIGH_LEVEL.  RaiseRPL() overwrites the global flag mRaisedFromIsr=FALSE, since it has been called with interrupts (temporarily) enabled.

At this point, all record of the original mRaisedFromIsr=TRUE state has been lost.

Using a global counter instead of a boolean has similar problems: we don&apos;t have the ability to correctly pair the interrupt-restoring behaviour of each RestoreTPL() with its originating RaiseTPL() invocation.

Changing the return value from RaiseTPL() to include an &quot;interrupts-enabled&quot; bit would work but would be a breaking API change and so is not permissible.

Trying to think of a viable approach...

Thanks,

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20082</commentid>
    <comment_count>6</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-23 12:10:38 +0000</bug_when>
    <thetext>My current thinking is this:

- At the point that TimerInterruptHandler() calls RestoreTPL(), it records in a static variable (e.g. &quot;RestoringTPL&quot;) the TPL that it is attempting to restore back down to.

- When a nested interrupt occurs, this gives us a way for the new (inner) interrupt to know the TPL that the old (outer) interrupt was attempting to restore back down to.

- At the start of TimerInterruptHandler(), we compare OriginalTPL against RestoringTPL.

- If these are equal, then we know that the inner interrupt occurred during the outer interrupt handler&apos;s call to RestoreTPL() but _after_ all notifications had been dispatched by the outer interrupt&apos;s call to RestoreTPL().  This is the situation that arises from step (r) in Laszlo&apos;s breakdown of events, and the situation that we could prevent if RaiseTPL()/RestoreTPL() allowed for an extra parameter to handle the saved interrupts-enabled flag.

So, I think this allows us to at least cleanly detect the situation that we&apos;re trying to avoid.  What I&apos;m not sure about is how to then deal with it.  We could choose to deliberately defer the EOI for the inner interrupt until after the inner interrupt&apos;s call to RestoreTPL().  But I&apos;m not yet convinced that this works.

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20084</commentid>
    <comment_count>7</comment_count>
    <who name="Paolo Bonzini">pbonzini</who>
    <bug_when>2022-11-23 14:19:19 +0000</bug_when>
    <thetext>This is a mess and is all because edk2 tries to mimic Windows IRQL without using the APIC&apos;s interrupt priority mechanism.

The problem is that there are _two_ interrupts enabled flags, namely the processor IF flag and gEfiCurrentTpl, and RaiseTPL only considers the latter.

In other words, there is an implicit &quot;RaiseTPL (TPL_HIGH_LEVEL)&quot; just because you&apos;re running with IF=0, and the problem that you want to do the &quot;RestoreTPL&quot; work after IRET, at IF=1.

On Windows, the interrupt handler would be able immediately set IF=1, because it can rely on the APIC&apos;s TPR to block further lower-priority interrupts.  And there would be no need for an explicit RaiseTPL(), because the current TPL is just the APIC&apos;s TPR rather than a global variable.

Also, on Windows raising an event would send an IPI to self (with a vector such that the TPR becomes either TPL_CALLBACK or TPL_NOTIFY).  The IPI would be processed after the EOI lowers the TPR, like this:

   /* TPR is high, preventing recursive interrupts */
   STI
   ...
   send IPI
   ...
   CLI
   send EOI
   /* TPR is low, but IF=0 so IPI is delayed until after IRET */
   IRET

So the Disable interrupts/EOI sequence does make sense, but RestoreTPL must somehow delay the event work until after the IRET in order to avoid exploding the stack.

Well, pre-APIC Windows NT did it so it must be possible.  But I think it requires some black magic in the IDT handlers.

For sure RaiseTPL() must be changed to ignore gEfiCurrentTpl and return TPL_HIGH_LEVEL if IF=0.  Then the RaiseTPL/RestoreTPL pair in TimerInterruptHandler becomes a glorified nop, and there is no need to disable the interrupts in TimerInterruptHandler before sending EOI.

To ensure the events are processed after interrupts are re-enabled, you could patch the return address of the IRET.  That is, the sequence would be

   /* in IDT handler */
   save all registers
   call handler
     /* IF=0 is high, preventing recursive interrupts */
     ...
     CoreNotifyEvent()
     ...
     send EOI

   /* back to IDT handler */
   oldTpl = RaiseTpl(TPL_HIGH_LEVEL);
   if any events for TPL &lt;= oldTpl
     mangle stack to return to EventProcessingTrampoline after IRET
   else
     RestoreTpl(oldTpl);

   restore all registers
   IRET

EventProcessingTrampoline:
   save all registers
   fetch oldTpl from stack frame
   RestoreTPL(oldTpl)
   restore all registers
   RET                    ; RET 4 on 32-bit, RET 8 on 64-bit

The stack mangling could be something like:
- pick the SS:RSP from the IRET frame
- push oldTpl onto that SS:RSP
- push the RIP from the IRET frame onto that SS:RSP
- change the RIP in the IRET frame to EventProcessingTrampoline

With some care because SS:RSP could point onto the very stack you&apos;re running on, i.e. something like (don&apos;t quote me on the order of the five fields):

  SS             oldTpl
  RSP            RIP
  RFLAGS    =&gt;   SS
  CS             RSP
  RIP            RFLAGS
                 CS
                 EventProcessingTrampoline


IIRC it&apos;s more complicated on 32-bit though because SS:SP is not always pushed. But maybe edk2 is always ring 0? If so it&apos;s not that big of a complication, as it would be just

  EFLAGS         oldTpl
  CS      =&gt;     EIP
  EIP            EFLAGS
                 CS
                 EventProcessingTrampoline</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20085</commentid>
    <comment_count>8</comment_count>
    <who name="Paolo Bonzini">pbonzini</who>
    <bug_when>2022-11-23 15:23:20 +0000</bug_when>
    <thetext>&gt; For sure RaiseTPL() must be changed to ignore gEfiCurrentTpl and return
&gt; TPL_HIGH_LEVEL if IF=0.

This is not even necessary if RaiseTPL() is moved in the IDT handler.  Then all that&apos;s needed is an HasEventForTPL() function:


   /* in IDT handler */
   save all registers
   oldTpl = RaiseTpl(TPL_HIGH_LEVEL);
   call handler
     send EOI

   /* back to IDT handler with IF=0 */
   if HasEventsForTpl(oldTpl)
     mangle stack to return to EventProcessingTrampoline after IRET
   else
     RestoreTpl(oldTpl);

   restore all registers
   IRET</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20086</commentid>
    <comment_count>9</comment_count>
    <who name="Paolo Bonzini">pbonzini</who>
    <bug_when>2022-11-23 15:41:16 +0000</bug_when>
    <thetext>Hmm, not entirely: RestoreTpl must not enable interrupts even if oldTpl &lt; TPL_HIGH_LEVEL. So there has to be a &quot;PrepareRestoreTplFromInterruptHandler&quot; function exported by MdeModulePkg/Core/Dxe/Event/Tpl.c, like

/* Highest interrupts-enabled TPL.  */
#define TPL_AFTER_INTERRUPT_LEVEL (TPL_HIGH_LEVEL - 1)

BOOL
EFIAPI
CorePrepareRestoreTplFromInterruptHandler (
  IN EFI_TPL NewTpl
  )
{
  EFI_TPL     OldTpl;
  EFI_TPL     PendingTpl;

  OldTpl = gEfiCurrentTpl;
  ASSERT(OldTpl == TPL_HIGH_LEVEL);
  if (NewTpl &gt; OldTpl) {
    DEBUG ((EFI_D_ERROR, &quot;FATAL ERROR - RestoreTpl from interrupt handler with NewTpl(0x%x) &gt; OldTpl(0x%x)\n&quot;, NewTpl, OldTpl));
    ASSERT (FALSE);
  }
  ASSERT (VALID_TPL (NewTpl));

  if (NewTpl == TPL_HIGH_LEVEL) {
    /* Cannot have any events.  */
    return FALSE;
  }

  if (gEventPending != 0) {
    PendingTpl = (UINTN) HighBitSet64 (gEventPending);
    if (PendingTpl &gt; NewTpl) {
      /* Keep a pretty high TPL until events are processed.  Interrupt state will
         be restored by caller.  */
      gEfiCurrentTpl = TPL_AFTER_INTERRUPT_LEVEL;
      return TRUE;
    }
  }
  gEfiCurrentTpl = NewTpl;
  /* Interrupt state will be restored by caller */
  return FALSE;
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20087</commentid>
    <comment_count>10</comment_count>
    <who name="Paolo Bonzini">pbonzini</who>
    <bug_when>2022-11-23 15:53:37 +0000</bug_when>
    <thetext>As to how to implement it: a new protocol (gEfiInterruptEventProtocolGuid?) containing nothing but the new function could be exposed by DxeMain.inf.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20088</commentid>
    <comment_count>11</comment_count>
    <who name="Paolo Bonzini">pbonzini</who>
    <bug_when>2022-11-23 16:03:30 +0000</bug_when>
    <thetext>Okay, this should be the last update:

&gt; Hmm, not entirely: RestoreTpl must not enable interrupts even if oldTpl &lt; 
&gt; TPL_HIGH_LEVEL. So there has to be a &quot;PrepareRestoreTplFromInterruptHandler&quot; 
&gt; function exported by MdeModulePkg/Core/Dxe/Event/Tpl.c, like

Better: RestoreTpl must enable interrupts if oldTpl &lt; TPL_HIGH_LEVEL, but the interrupt handler must not.  So


   /* back to IDT handler with IF=0 */
   if HasEventsForTpl(oldTpl)
     mangle stack to return to EventProcessingTrampoline after IRET
   else
     RestoreTpl(oldTpl);

must become

   /* back to IDT handler with IF=0 */
   if (PrepareRestoreTplFromInterruptHandler(oldTpl))
     /* TRUE = Tpl is still high (TPL_AFTER_INTERRUPT_LEVEL) because there
        are events to process.  Interrupts will be enabled by IRET.  */
     mangle stack to return to EventProcessingTrampoline after IRET
   else
     /* FALSE = Tpl has been restored, interrupts will be enabled by IRET.  */
     ;

(followed by restoring all registers and IRET).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20091</commentid>
    <comment_count>12</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-24 07:28:37 +0000</bug_when>
    <thetext>Paolo: thank you for also for such a detailed response.

I am not sure that I completely understand how this approach solves the problem.  In particular:

- Anything that would mimic the APIC interrupt priority mechanism cannot work.  UEFI design requires that the callbacks triggered from a timer interrupt are themselves allowed to wait on events triggered by further timer interrupts (i.e. by further instances of the exact same interrupt).

- Completing the event processing after IRET reduces the stack consumption per nested interrupt, but still leaves it greater than zero.  The stack exhaustion problem would be alleviated rather than solved.

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20092</commentid>
    <comment_count>13</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-24 11:05:41 +0000</bug_when>
    <thetext>Here is my proposed fix (after reverting 239b50a86):


--- a/OvmfPkg/LocalApicTimerDxe/LocalApicTimerDxe.c
+++ b/OvmfPkg/LocalApicTimerDxe/LocalApicTimerDxe.c
@@ -58,7 +58,10 @@ TimerInterruptHandler (
   IN EFI_SYSTEM_CONTEXT  SystemContext
   )
 {
-  EFI_TPL  OriginalTPL;
+  STATIC UINTN    RestoreTPLPending = 0;
+  STATIC EFI_TPL  TargetTPL = 0;
+  EFI_TPL         OldTargetTPL;
+  EFI_TPL         OriginalTPL;
 
   OriginalTPL = gBS-&gt;RaiseTPL (TPL_HIGH_LEVEL);
 
@@ -71,7 +74,51 @@ TimerInterruptHandler (
     mTimerNotifyFunction (mTimerPeriod);
   }
 
-  gBS-&gt;RestoreTPL (OriginalTPL);
+  //
+  // This is unfortunately messy.  UEFI requires us to support nested
+  // timer interrupts, but provides no way for RestoreTPL() to avoid
+  // re-enabling interrupts.  In a virtual machine, it is possible for
+  // a large burst of timer interrupts to arrive.  We must prevent
+  // such a burst from leading to stack underrun, while continuing to
+  // allow nested timer interrupts to occur.
+  //
+  // Since nested interrupts are permitted, we may be invoked as an
+  // inner interrupt handler while the outer interrupt handler is
+  // still inside its call to RestoreTPL().
+  //
+  // If the TPL at which we were invoked is higher than the target TPL
+  // for the outer handler&apos;s call to RestoreTPL(), then the outer
+  // handler&apos;s call to RestoreTPL() is still dispatching event
+  // notifications.  In this circumstance we must call RestoreTPL() to
+  // allow more event notifications to be dispatched, since those
+  // callbacks may themselves be waiting upon events.  We cannot avoid
+  // creating a new stack frame for this inner call to RestoreTPL(),
+  // but the total number of such stack frames is intrinsically
+  // limited by the number of distinct TPLs.
+  //
+  // If the TPL at which we were invoked is equal to the target TPL
+  // for the outer handler&apos;s call to RestoreTPL(), then the outer
+  // handler&apos;s call to RestoreTPL() must have finished dispatching all
+  // event notifications, and the interrupt therefore occurred at the
+  // point that RestoreTPL() was about to return to the outer handler.
+  // In this circumstance, we must not call RestoreTPL() here since
+  // doing so could lead to stack exhaustion.  Instead, we return from
+  // the ISR at TPL_HIGH_LEVEL and set a flag to trigger the outer
+  // handler into performing the deferred call to RestoreTPL().
+  //
+  ASSERT (OriginalTPL &gt;= TargetTPL);
+  if (OriginalTPL == TargetTPL) {
+    RestoreTPLPending |= (UINTN)(1 &lt;&lt; OriginalTPL);
+  } else {
+    OldTargetTPL = TargetTPL;
+    TargetTPL = OriginalTPL;
+    do {
+      RestoreTPLPending &amp;= ~(UINTN)(1 &lt;&lt; OriginalTPL);
+      gBS-&gt;RestoreTPL (OriginalTPL);
+      DisableInterrupts ();
+    } while (RestoreTPLPending &amp; (UINTN)(1 &lt;&lt; OriginalTPL));
+    TargetTPL = OldTargetTPL;
+  }</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20093</commentid>
    <comment_count>14</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-24 11:26:51 +0000</bug_when>
    <thetext>I have tested this suggested patch by simulating an interrupt storm (via calling gBS-&gt;Stall() inside TimerInterruptHandler()), and it does correctly limit the total stack consumption.

As far as I can tell, it is safe for us to defer the call to RestoreTPL() under the conditions described in the patch.  There will be a short period of time during which we are executing with the TPL at TPL_HIGH_LEVEL but with interrupts enabled, but this period can logically cover only the return from the outer RestoreTPL() to TimerInterruptHandler().  During this brief window, the only thing that could possibly interrupt the flow of execution would be another timer interrupt, which will gracefully do (almost) nothing when invoked from TPL_HIGH_LEVEL anyway.

@Laszlo @Paolo: any comments on my suggested fix?

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20094</commentid>
    <comment_count>15</comment_count>
    <who name="Paolo Bonzini">pbonzini</who>
    <bug_when>2022-11-24 12:40:58 +0000</bug_when>
    <thetext>&gt; - Anything that would mimic the APIC interrupt priority mechanism cannot work.  UEFI 
&gt; design requires that the callbacks triggered from a timer interrupt are themselves 
&gt; allowed to wait on events triggered by further timer interrupts (i.e. by further 
&gt; instances of the exact same interrupt).

That should be okay because callbacks are invoked from their TPL.  Remember that the event processing loop is nothing but a fancy split of RestoreTpl(oldTpl) in two phases - first enabling interrupts and setting Tpl to TPL_HIGH_LEVEL-1, and then after IRET dispatching the pending events all the way down to oldTpl.  All that matters is the correct sequence of CLI, then EOI, then IRET (enabling further interrupts), then dispatch.

&gt; - Completing the event processing after IRET reduces the stack consumption per nested 
&gt; interrupt, but still leaves it greater than zero.  The stack exhaustion problem would be 
&gt; alleviated rather than solved.

That should also be fine because the each further instance of the event execution code would have a higher TPL than the previous one.  The maximum nesting would be

  interrupted code
    execute events with oldTpl = TPL_CALLBACK
      execute events with oldTpl = TPL_NOTIFY
        execute events with oldTpl = TPL_HIGH_LEVEL - 1

Since there are no events with a high-enough TPL, the inner TimerInterruptHandler would not trigger another execute-events code.

That said, I will look at your patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20095</commentid>
    <comment_count>16</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-24 13:33:06 +0000</bug_when>
    <thetext>(In reply to Paolo Bonzini from comment #15)
&gt; That should be okay because callbacks are invoked from their TPL.  Remember
&gt; that the event processing loop is nothing but a fancy split of
&gt; RestoreTpl(oldTpl) in two phases - first enabling interrupts and setting Tpl
&gt; to TPL_HIGH_LEVEL-1, and then after IRET dispatching the pending events all
&gt; the way down to oldTpl.  All that matters is the correct sequence of CLI,
&gt; then EOI, then IRET (enabling further interrupts), then dispatch.

Other than some rearrangement of the stack contents, I think that gives the same sequence of events as EOI, STI (enable interrupts), then dispatch, then IRET (which will harmlessly enable the already enabled interrupts)?  Which I think is essentially the same as the pre-239b50a86 behaviour.

&gt; That should also be fine because the each further instance of the event
&gt; execution code would have a higher TPL than the previous one.  The maximum
&gt; nesting would be
&gt; 
&gt;   interrupted code
&gt;     execute events with oldTpl = TPL_CALLBACK
&gt;       execute events with oldTpl = TPL_NOTIFY
&gt;         execute events with oldTpl = TPL_HIGH_LEVEL - 1
&gt; 
&gt; Since there are no events with a high-enough TPL, the inner
&gt; TimerInterruptHandler would not trigger another execute-events code.

I think I must be misunderstanding something, sorry.

If the event processing is rearranged to come after the IRET, then the stack must have been rearranged to contain more information than was present when the interrupt occurred.  (It needs to contain at least the OriginalTPL value and the original return address, as per your example.)

In the case of an interrupt storm:

a) timer interrupt occurs

b) CPU creates new stack frame for the interrupt

c) TimerInterruptHandler() issues EOI

d) TimerInterruptHandler() rearranges the stack frame to allow for EventProcessingTrampoline to be invoked after IRET.  This rearrangement consumes additional stack space.

e) TimerInterruptHandler() returns via IRET to EventProcessingTrampoline.

f) timer interrupt occurs immediately after IRET

g) go to step (b) but with the additional stack space not yet released

I don&apos;t see how the stack underrun is prevented in this scenario?

&gt; That said, I will look at your patch.

Thank you, much appreciated!

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20096</commentid>
    <comment_count>17</comment_count>
    <who name="Paolo Bonzini">pbonzini</who>
    <bug_when>2022-11-24 13:41:03 +0000</bug_when>
    <thetext>tl;dr: your patch is scary af but seems to be fine. :)  You can skip my answers if you wish and jump to the discussion of your patch.

If I understood your patch correctly, your patch in the nested event case does something similar to what I intended:

      TargetTPL == 0
      ...
      OldTargetTPL = 0
      TargetTPL = TPL_APPLICATION
      RestoreTPLPending &amp;= ~(1 &lt;&lt; TPL_APPLICATION)
      gBS-&gt;RestoreTPL (TPL_APPLICATION);
        EnableInterrupts();
        dispatch a TPL_CALLBACK event
          ... schedule a TPL_NOTIFY event ...
          inner TimerInterruptHandler
            RaiseTPL(TPL_HIGH_LEVEL);  // returns TPL_NOTIFY
            ...
            OldTargetTPL = TPL_APPLICATION
            TargetTPL = TPL_CALLBACK
            RestoreTPL(TPL_CALLBACK);
              ... dispatch TPL_NOTIFY event ...
            DisableInterrupts();
            TargetTPL = TPL_APPLICATION;
            IRET re-enables interrupts
          ... finishes dispatching TPL_CALLBACK event ...
      DisableInterrupts();
      checks again
      TargetTPL = 0;
      IRET

Instead, this is the hand-off case:

      TargetTPL == 0
      ...
      OldTargetTPL = 0
      TargetTPL = TPL_APPLICATION
      RestoreTPLPending &amp;= ~(1 &lt;&lt; TPL_APPLICATION)
      gBS-&gt;RestoreTPL (TPL_APPLICATION);
        EnableInterrupts();
        gEfiCurrentTpl = TPL_APPLICATION;         // the last assignment before returning
      inner TimerInterruptHandler
        OriginalTPL = RaiseTPL(TPL_HIGH_LEVEL);   // OriginalTPL == TargetTPL, so no event was being dispatched
        sees OriginalTPL == TargetTPL
          RestoreTPLPending |= (1 &lt;&lt; TPL_APPLICATION);
        IRET                                                    (1)
      DisableInterrupts();                                      (2)
      loop executes again!
      gBS-&gt;RestoreTPL (TPL_APPLICATION);
        EnableInterrupts();
      DisableInterrupts();
      checks again
      TargetTPL = 0;
      IRET

The good: it&apos;s important that the outer RestoreTPL() was about to return, because it means it was not dispatching any event.  Thus, skipping the inner RestoreTPL() thus will not cause a priority inversion.

The ugly: between (1) and (2) you have interrupts enabled but gEfiCurrentTpl == TPL_HIGH_LEVEL.  In theory this is a serious invariant violation that could mess things up royally, because CoreRaiseTpl(TPL_HIGH_LEVEL) in the interrupt handler will *not* disable interrupts.  But the only thing that can happen is that another interrupts comes, and before the handler is entered the process will helpfully clear IF=0 and restore the invariant.  Pfew.

So that&apos;s why I called it scary stuff, :) it would be nicer if it were possible to modify the flags on the interrupt frame and keep IF=0 after the IRET at (1).  But I don&apos;t think that&apos;s possible, and it seems to work.  Only needs a lot of comments and somebody else going after my thoughts here.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20097</commentid>
    <comment_count>18</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-24 16:22:44 +0000</bug_when>
    <thetext>(In reply to Paolo Bonzini from comment #17)
&gt; The ugly: between (1) and (2) you have interrupts enabled but gEfiCurrentTpl
&gt; == TPL_HIGH_LEVEL.  In theory this is a serious invariant violation that
&gt; could mess things up royally, because CoreRaiseTpl(TPL_HIGH_LEVEL) in the
&gt; interrupt handler will *not* disable interrupts.  But the only thing that
&gt; can happen is that another interrupts comes, and before the handler is
&gt; entered the process will helpfully clear IF=0 and restore the invariant. 
&gt; Pfew.
&gt; 
&gt; So that&apos;s why I called it scary stuff, :) it would be nicer if it were
&gt; possible to modify the flags on the interrupt frame and keep IF=0 after the
&gt; IRET at (1).  But I don&apos;t think that&apos;s possible, and it seems to work.  Only
&gt; needs a lot of comments and somebody else going after my thoughts here.

I totally agree that it would be much if we could modify the inner interrupt stack frame to set IF=0 in the stored EFLAGS to avoid violating the invariant.

From digging through ExceptionHandlerAsm.nasm, it looks as though modifying SystemContext-&gt;Rflags might work for this.  I&apos;ll give it a try.

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20098</commentid>
    <comment_count>19</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-24 16:55:53 +0000</bug_when>
    <thetext>&gt; From digging through ExceptionHandlerAsm.nasm, it looks as though modifying
&gt; SystemContext-&gt;Rflags might work for this.  I&apos;ll give it a try.

It does work.  :)

Working on an updated patch now...

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20099</commentid>
    <comment_count>20</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-24 18:29:14 +0000</bug_when>
    <thetext>Here&apos;s the updated code, which now maintains the invariant that interrupts are always disabled when at TPL_HIGH_LEVEL, and is structured to provide an abstraction that can be shared between LocalApicTimerDxe and 8254TimerDxe:

//
// State shared between all invocations of a nested interrupt handler.
//
typedef struct {
  //
  // Target TPL for the innermost in-progress call to RestoreTPL().
  //
  EFI_TPL  TargetTPL;
  //
  // Bitmap used to by an inner interrupt handler to defer a call to
  // RestoreTPL() to the outer interrupt handler.
  //
  UINTN  RestoreTPLPending;
} NESTED_INTERRUPT_STATE;

/**
  Raise the task priority level to TPL_HIGH_LEVEL from within a nested
  interrupt handler.

  @param  None.

  @return The previous task priority level

**/
EFI_TPL
EFIAPI
NestedInterruptRaiseTPL (
  VOID
  )
{
  EFI_TPL OriginalTPL;

  //
  // Raise TPL and assert that we were called from within an interrupt
  // handler (i.e. with TPL below TPL_HIGH_LEVEL but with interrupts
  // disabled).
  //
  ASSERT (GetInterruptState() == FALSE);
  OriginalTPL = gBS-&gt;RaiseTPL (TPL_HIGH_LEVEL);
  ASSERT (OriginalTPL &lt; TPL_HIGH_LEVEL);

  return OriginalTPL;
}

/**
  Lower the task priority to the previous value from within a nested
  interrupt handler.  To avoid stack exhaustion, this call may (when
  provably safe to do so) defer the actual lowering to be performed by
  an outer interrupt handler.

  @param OriginalTPL           Previous TPL from NestedInterruptRaiseTPL().

  @param SystemContext         A pointer to the system context when the
                               interrupt occurred.

  @param NestedInterruptState  A pointer to the state shared between all
                               invocations of the nested interrupt handler.

**/
VOID
EFIAPI
NestedInterruptRestoreTPL (
  IN EFI_TPL                     OriginalTPL,
  IN OUT EFI_SYSTEM_CONTEXT      SystemContext,
  IN OUT NESTED_INTERRUPT_STATE  *NestedInterruptState
  )
{
  IA32_EFLAGS32  InterruptsEnabledFlag;
  UINTN          *IretFlags;
  UINTN          TPLPendingFlag;
  EFI_TPL        OldTargetTPL;

  //
  // Construct constant for IF flag (without using a C99 initializer).
  //
  InterruptsEnabledFlag.UintN = 0;
  InterruptsEnabledFlag.Bits.IF = 1;

  //
  // Locate flags that will be restored by IRET within system context.
  //
#if defined (MDE_CPU_IA32)
  IretFlags = &amp;SystemContext.SystemContextIa32-&gt;Eflags;
#elif defined (MDE_CPU_X64)
  IretFlags = &amp;SystemContext.SystemContextX64-&gt;Rflags;
#else
  #error &quot;Unsupported CPU&quot;
#endif

  //
  // This is unfortunately messy.  UEFI requires us to support nested
  // interrupts, but provides no way for an interrupt handler to call
  // RestoreTPL() without implicitly re-enabling interrupts.  In a
  // virtual machine, it is possible for a large burst of interrupts
  // to arrive.  We must prevent such a burst from leading to stack
  // underrun, while continuing to allow nested interrupts to occur.
  //
  // Since nested interrupts are permitted, an interrupt handler may
  // be invoked as an inner interrupt handler while the outer
  // interrupt handler is still inside its call to RestoreTPL().
  //
  // If the TPL at which this interrupt occurred is higher than the
  // target TPL for the outer handler&apos;s call to RestoreTPL(), then the
  // outer handler&apos;s call to RestoreTPL() is still dispatching event
  // notifications.  In this circumstance we must call RestoreTPL() to
  // allow more event notifications to be dispatched, since those
  // callbacks may themselves be waiting upon events.  We cannot avoid
  // creating a new stack frame for this inner call to RestoreTPL(),
  // but the total number of such stack frames is intrinsically
  // limited by the number of distinct TPLs.
  //
  // If the TPL at which this interrupt occurred is equal to the
  // target TPL for the outer handler&apos;s call to RestoreTPL(), then the
  // outer handler&apos;s call to RestoreTPL() must have finished
  // dispatching all event notifications, and the interrupt therefore
  // occurred at the point that RestoreTPL() was about to return to
  // the outer handler.  In this circumstance, we must not call
  // RestoreTPL() here since doing so could lead to stack exhaustion.
  // Instead, we return from the ISR at TPL_HIGH_LEVEL with interrupts
  // still disabled and set a flag to trigger the outer handler into
  // performing the deferred call to RestoreTPL().
  //
  ASSERT (OriginalTPL &gt;= NestedInterruptState-&gt;TargetTPL);
  TPLPendingFlag = (UINTN)(1U &lt;&lt; OriginalTPL);
  if (OriginalTPL == NestedInterruptState-&gt;TargetTPL) {
    ASSERT (*IretFlags &amp; InterruptsEnabledFlag.UintN);
    *IretFlags &amp;= ~InterruptsEnabledFlag.UintN;
    NestedInterruptState-&gt;RestoreTPLPending |= TPLPendingFlag;
  } else {
    OldTargetTPL = NestedInterruptState-&gt;TargetTPL;
    NestedInterruptState-&gt;TargetTPL = OriginalTPL;
    do {
      NestedInterruptState-&gt;RestoreTPLPending &amp;= ~TPLPendingFlag;
      gBS-&gt;RestoreTPL (OriginalTPL);
      DisableInterrupts();
    } while (NestedInterruptState-&gt;RestoreTPLPending &amp; TPLPendingFlag);
    NestedInterruptState-&gt;TargetTPL = OldTargetTPL;
  }
}
  
/**
  Interrupt Handler.

  @param InterruptType    The type of interrupt that occurred
  @param SystemContext    A pointer to the system context when the interrupt occurred
**/
VOID
EFIAPI
TimerInterruptHandler (
  IN EFI_EXCEPTION_TYPE  InterruptType,
  IN EFI_SYSTEM_CONTEXT  SystemContext
  )
{
  STATIC NESTED_INTERRUPT_STATE  NestedInterruptState;
  EFI_TPL                        OriginalTPL;

  OriginalTPL = NestedInterruptRaiseTPL();

  SendApicEoi();

  if (mTimerNotifyFunction != NULL) {
    //
    // @bug : This does not handle missed timer interrupts
    //
    mTimerNotifyFunction (mTimerPeriod);
  }

  NestedInterruptRestoreTPL (OriginalTPL, SystemContext, &amp;NestedInterruptState);
}



@Laszlo @Paolo: any feedback would be very welcome!

Thanks,

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20100</commentid>
    <comment_count>21</comment_count>
    <who name="Paolo Bonzini">pbonzini</who>
    <bug_when>2022-11-24 18:34:12 +0000</bug_when>
    <thetext>Yes, that should work and is as beautiful as it can be I guess.  Would you like someone else to come up with a patch?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20101</commentid>
    <comment_count>22</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-24 19:50:07 +0000</bug_when>
    <thetext>(In reply to Paolo Bonzini from comment #21)
&gt; Yes, that should work and is as beautiful as it can be I guess.  Would you
&gt; like someone else to come up with a patch?

Thank you!

I&apos;m happy to put together the patch series.  Where within the EDK2 tree should NestedInterruptRestoreTPL() and NestedInterruptRaiseTPL() live so that they can be used by both LocalApicTimerDxe and 8254TimerDxe?

Thanks,

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20102</commentid>
    <comment_count>23</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-25 02:48:59 +0000</bug_when>
    <thetext>Hi Michael,

It&apos;s great if the problem can be solved in OvmfPkg, without touching core edk2 code.

I suggest introducing a new library class, and instance, for that. I think you could call it NestedInterruptTplLib.

I&apos;ve tried to locate an existent commit that (a) is minimal and (b) shows, structurally speaking, how to introduce a new library class (= declaration) with a single instance (= implementation).

I&apos;ve come up with commit 77874ceebb11 (&quot;OvmfPkg: add library to track boot option loading/starting on the console&quot;, 2019-02-25); I recommend following the structure of that. Some comments:

patch#1: revert 239b50a86

patch#2:

- OvmfPkg/OvmfPkg.dec: declare the new library class in the [LibraryClasses] section, referencing the new lib class header file

- OvmfPkg/*.dsc: do not modify these files just yet

- OvmfPkg/Include/Library/NestedInterruptTplLib.h: place the new header file here. Be sure to add #include guards, #include the proper dependencies (just so the function prototypes are self-contained).

- OvmfPkg/Library/NestedInterruptTplLib/NestedInterruptTplLib.inf: you can mostly follow &quot;PlatformBmPrintScLib.inf&quot; here. INF_VERSION should be set to the highest version currently documented in the edk2 INF file spec. FILE_GUID should be generated afresh with &quot;uuidgen&quot;. The [Packages] section must contain &quot;MdePkg/MdePkg.dec&quot;, but other than that, keep it minimal -- only add packages whose header files and library classes you actually depend on. [LibraryClasses] should again be minimal -- it generally matches the lib class #includes from &quot;NestedInterruptTplLib.h&quot;. The [Pcd], [Protocols] and [Guids] sections you don&apos;t need I think. [Depex.common.DXE_DRIVER] is required; AFAICT you can just set it to TRUE.

- OvmfPkg/Library/NestedInterruptTplLib/NestedInterruptTplLib.c: this is where the function definitions (= implementation) should go.

patch#3:

- make use of NestedInterruptTplLib in LocalApicTimerDxe and 8254TimerDxe. This means extending their #include directives (C source), and also their [LibraryClasses] sections (INF file). If possible, keep both the #include directives and the [LibraryClasses] sections alphabetically sorted.

- OvmfPkg/*.dsc: locate all those platform DSC files that include either LocalApicTimerDxe or 8254TimerDxe. In these DSC files, resolve the new lib class to the new (sole) lib instance. Because the library instance is going to suit DXE_DRIVER modules only, it&apos;s best to add the lib class resolution to the [LibraryClasses.common.DXE_DRIVER] section of each affected DSC file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20103</commentid>
    <comment_count>24</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-25 02:50:42 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #23)

&gt; patch#2:
&gt; 
&gt; - OvmfPkg/OvmfPkg.dec: declare the new library class in the [LibraryClasses]
&gt; section, referencing the new lib class header file

keep this section lexicographically ordered too, if possible, pls</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20104</commentid>
    <comment_count>25</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-25 08:59:52 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #23)
&gt; I&apos;ve tried to locate an existent commit that (a) is minimal and (b) shows,
&gt; structurally speaking, how to introduce a new library class (= declaration)
&gt; with a single instance (= implementation).
&gt; 
&gt; I&apos;ve come up with commit 77874ceebb11 (&quot;OvmfPkg: add library to track boot
&gt; option loading/starting on the console&quot;, 2019-02-25); I recommend following
&gt; the structure of that.

Thank you so much; that&apos;s incredibly helpful.  I&apos;ll pull something together now following your instructions.

I&apos;m guessing that ArmPkg/Drivers/TimerDxe/TimerDxe.c may need a similar fix, since the underlying stack underrun problem is not x86-specific (or even VM-specific, though it&apos;s much more easily triggerable in a VM).  Would this suggest placing NestedInterruptTplLib outside of OvmfPkg?  And, if so, where ought it to go?

Thanks,

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20105</commentid>
    <comment_count>26</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-25 09:57:10 +0000</bug_when>
    <thetext>Normally if you want to share code (library or driver) between OvmfPkg and ArmVirtPkg, then you put the component (library or driver) under OvmfPkg, and just consume it from ArmVirtPkg. ArmVirtPkg is welcome to consume components from OvmfPkg. The reverse dependency is not allowed.

However, this question is trickier than that. If we do not consider ARM / AARCH64, then the patch set is contained under OvmfPkg, so it only affects virtual hardware. Put differently, the virtual machine platforms (DSC files) under OvmfPkg all use such Timer DXE_DRIVER modules that also exist under OvmfPkg -- in other words, the IA32/X64 VM platforms all use VM-specific timer drivers.

But that&apos;s not the case with ArmVirtPkg. The DSC files there use &quot;ArmPkg/Drivers/TimerDxe/TimerDxe.inf&quot;, but that driver is included by some physical firmware platforms too (in the &quot;edk2-platforms&quot; tree, for example). So you cannot modify ArmPkg/Drivers/TimerDxe as easily as you can the two TimerDxe drivers under OvmfPkg, for two reasons: (a) the changes will affect real ARM / AARCH64 hardware, where the original issue may never happen in practice, (b) ArmPkg content -- where the TimerDxe driver in question lives -- is not allowed to depend on OvmfPkg, for example on a new library under OvmfPkg.

Problem (b) is easy to solve. For such cases, we put components (libraries, drivers, GUID definitions, PCDs etc) under EmbeddedPkg. All of ArmPkg, ArmVirtPkg, and OvmfPkg are permitted to depend on EmbeddedPkg.

Therefore, *if* you intend to modify ArmPkg/Drivers/TimerDxe as well, then the new library should go under EmbeddedPkg. Furthermore, the patch modifying ArmPkg/Drivers/TimerDxe needs to stand alone; separate from the patch that rebases the timer drivers in OvmfPkg to the new library.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20106</commentid>
    <comment_count>27</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-25 10:18:20 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #26)

&gt; If we do not consider ARM / AARCH64, then the patch set is contained
&gt; under OvmfPkg, so it only affects virtual hardware. Put differently,
&gt; the virtual machine platforms (DSC files) under OvmfPkg all use such
&gt; Timer DXE_DRIVER modules that also exist under OvmfPkg -- in other
&gt; words, the IA32/X64 VM platforms all use VM-specific timer drivers.

Small correction there -- the bhyve platform firmware
&quot;OvmfPkg/Bhyve/BhyveX64.dsc&quot; does consume a phys hardware oriented timer
driver: &quot;PcAtChipsetPkg/HpetTimerDxe/HpetTimerDxe.inf&quot;. I don&apos;t know if
that driver is affected too, but if it is, and you intend to modify it,
then the new library belongs under PcAtChipsetPkg (if you steer clear of
ARM/AARCH64), or else MdeModulePkg (if you want to consume the library
from both ARM/AARCH64 and IA32/X64).

... For completeness (?), I think edk2 contains the following timer
drivers (i.e., DXE_DRIVER modules producing
&quot;gEfiTimerArchProtocolGuid&quot;):

  ArmPkg/Drivers/TimerDxe/TimerDxe.inf
  EmulatorPkg/TimerDxe/Timer.inf
  OvmfPkg/8254TimerDxe/8254Timer.inf
  OvmfPkg/LocalApicTimerDxe/LocalApicTimerDxe.inf
  PcAtChipsetPkg/HpetTimerDxe/HpetTimerDxe.inf

I&apos;d suggest modifying only those in which you can reproduce the symptom
(and test the fix). It&apos;s always possible to move a library to a
different package, for broader consumption.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20107</commentid>
    <comment_count>28</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-25 10:32:17 +0000</bug_when>
    <thetext>So, to provide a rudimentary map:

  Timer drivers modified in addition
  to those under OvmfPkg
  -----------------------------------
  ArmPkg  EmulatorPkg  PcAtChipsetPkg  Library to be placed under package
  ------  -----------  --------------  -----------------------------------
       0            0               0  OvmfPkg
       0            0               1  PcAtChipsetPkg
       0            1               0  EmbeddedPkg
       0            1               1  MdeModulePkg
       1            0               0  EmbeddedPkg
       1            0               1  MdeModulePkg
       1            1               0  EmbeddedPkg
       1            1               1  MdeModulePkg</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20108</commentid>
    <comment_count>29</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-11-25 11:40:31 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #27)
&gt; I&apos;d suggest modifying only those in which you can reproduce the symptom
&gt; (and test the fix). It&apos;s always possible to move a library to a
&gt; different package, for broader consumption.

Thank you once again for such detailed help!

I&apos;ve created a PR to fix only OvmfPkg/LocalApicTimerDxe and OvmgPkg/8254TimerDxe for now, on the basis that those are the two drivers where nested interrupts are currently broken.  Once it gets merged, I&apos;ll talk to some people at ARM to find out if there&apos;s any appetite for fixing the potential stack underrun in ArmPkg/TimerDxe.

The PR is at https://github.com/tianocore/edk2/pull/3662 and is currently awaiting CI results.

Thanks,

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20111</commentid>
    <comment_count>30</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-28 07:10:03 +0000</bug_when>
    <thetext>The logic boggles my mind. In trying to explain it to myself, I&apos;ve

(a) renamed some variables -- I&apos;ve done this because &quot;target&quot;, &quot;original&quot;, and &quot;oldtarget&quot; were way too obscure for me

(b) replaced the

  if (...) { ... } else { ... }

in the interrupt handler with

  if (...) { ...; return; }
  ...

because I think the nesting of the second branch there -- where we loop -- is really detrimental to understanding; it suggests that something else is coming after the first banch. My understanding is helped by seeing that the first branch terminates the function right there.

(c) I&apos;ve rearranged the ASSERT a bit, just to highlight the TPL ordering / relationships

(d) when a bit-and is evaluated in a boolean context, edk2 requires an explicit comparison against zero; so I&apos;ve updated the controlling expression in the do { ... } while (...).

Now, the names are inane, sorry about them; again this is just for explaining the logic to myself.

VOID
EFIAPI
NestedInterruptRestoreTPL (
  IN EFI_TPL                     TplToRestoreNow,
  IN OUT EFI_SYSTEM_CONTEXT      SystemContext,
  IN OUT NESTED_INTERRUPT_STATE  *NestedInterruptState
  )
{
  UINTN    TplToRestoreNowBit;
  EFI_TPL  LowerTplWhoseRestorationHasBeenInterrupted;

  TplToRestoreNowBit = (UINTN)(1U &lt;&lt; TplToRestoreNow);

  if (TplToRestoreNow ==
      NestedInterruptState-&gt;HighestTplBeingRestored) {
    DisableInterruptsOnIret (SystemContext);
    NestedInterruptState-&gt;TplsToRestoreLaterMask |= TplToRestoreNowBit;
    return;
  }

  ASSERT (TplToRestoreNow &gt;
          NestedInterruptState-&gt;HighestTplBeingRestored);

  LowerTplWhoseRestorationHasBeenInterrupted =
    NestedInterruptState-&gt;HighestTplBeingRestored;
  NestedInterruptState-&gt;HighestTplBeingRestored = TplToRestoreNow;

  do {
    NestedInterruptState-&gt;TplsToRestoreLaterMask &amp;= TplToRestoreNowBit;
    gBS-&gt;RestoreTPL (TplToRestoreNow);
    DisableInterrupts ();
  } while ((NestedInterruptState-&gt;TplsToRestoreLaterMask &amp;
            TplToRestoreNowBit) != 0);

  NestedInterruptState-&gt;HighestTplBeingRestored =
    LowerTplWhoseRestorationHasBeenInterrupted;
}


Now, I think the patch needs some more comments / a bit longer commit message than currently visible at PR#3662, with branch nestedinterrupttpllib @ 5c1718b26a95, so that mere mortals like myself can understand it:

(1) the DisableInterruptsOnIret() and DisableInterrupts() calls need more explanation.

(1.1) My understanding of DisableInterrupts() is that it protects the &quot;TplsToRestoreLaterMask&quot; manipulation just gBS-&gt;RestoreTPL() returns, with interrupts enabled. We don&apos;t want the &quot;short path&quot; to queue another restoration right after we&apos;ve determined there is nothing queued. That seems reasonable, but it deserves a comment (not to mention if there is a different reason, or a different reason *too*, for the DisableInterrupts() call).

(1.2) The DisableInterruptsOnIret() call is somewhat explained in comments 17 and 18; that reasoning should be boiled down to a code comment. Namely (IIUC), in the &quot;short branch&quot;, at the time of calling DisableInterruptsOnIret(), the current TPL *from which* we&apos;re about to restore, is &quot;HIGH&quot;, and we must not exit the interrupt handler with the current TPL being HIGH *and* interrupts being enabled.

Perhaps this could be expressed (*in addition* to the comment) with

  ASSERT (gBS-&gt;RaiseTPL (TPL_HIGH_LEVEL) == TPL_HIGH_LEVEL);

(2) For a human, following recursive entries is easy, but following recursive *returns* is darn hard. (Cf. the COMEFROM statement.) By my count, the gBS-&gt;RestoreTPL() call in the function may return from three separate paths:

- from the short branch, after which we&apos;re going to loop
- from a genuinely nested TPL restoration (dispatched handlers justifiedly interrupted)
- with handlers dispatched or not, but nothing interrupted

I could be wrong about these possibilities very easily, so I suggest to spell them out in the code.

Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20112</commentid>
    <comment_count>31</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-11-28 07:12:53 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #30)

&gt; (2) For a human, following recursive entries is easy, but following
&gt; recursive *returns* is darn hard. (Cf. the COMEFROM statement.) By my count,
&gt; the gBS-&gt;RestoreTPL() call in the function may return from three separate
&gt; paths:
&gt; 
&gt; - from the short branch, after which we&apos;re going to loop
&gt; - from a genuinely nested TPL restoration (dispatched handlers justifiedly
&gt; interrupted)
&gt; - with handlers dispatched or not, but nothing interrupted
&gt; 
&gt; I could be wrong about these possibilities very easily, so I suggest to
&gt; spell them out in the code.

Sorry, so that was (2.1); (2.2) would be:

- please include some example call trees, similar to Paolo&apos;s from comment 17, in the commit message. Thinking about the recursive returns makes me feel extremely dumb, like my gourd is filled with sand. :)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20185</commentid>
    <comment_count>32</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-12-05 11:27:18 +0000</bug_when>
    <thetext>@Laszlo: Thank you for the in-depth review and feedback.  I&apos;ve updated the code to follow a structure closer to that which you suggested.

In the process of doing so, I&apos;ve proved to myself that we don&apos;t need the per-TPL bitmask, and replaced it with a single boolean flag.

I&apos;ve expanded on the existing comments, and added &quot;DEFERRAL INVOCATION POINT&quot; and &quot;DEFERRAL RETURN POINT&quot; comments to explain the control flow that takes place in the complicated case (when we return from an inner handler without calling RestoreTPL()).

I haven&apos;t added an ASSERT(gBS-&gt;RaiseTPL(TPL_HIGH_LEVEL) == TPL_HIGH_LEVEL) because it feels wrong to me to have an assertion that looks as though it has a significant side-effect, and I can&apos;t find any other examples of EDK2 assertions that call boot services methods.  I&apos;m happy to defer to your judgement if you would still prefer this to be added.

I&apos;ve added sample call trees to the commit message as requested.

Thank you again, and please let me know your thoughts on the updated PR!  :)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20192</commentid>
    <comment_count>33</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2022-12-06 03:57:29 +0000</bug_when>
    <thetext>Hi Michael,

many thanks for addressing my comments; I think your point about not adding the ASSERT() is valid / justified. I think the patch set should be posted upstream now. I might be able to read through the patches at that point again (not sure); unfortunately right now I must content myself with your comment 32 here, as I&apos;m so badly out of time that it&apos;s inexplicable even to myself :/ I don&apos;t want you to wait for me, so please feel free to post the patches upstream.

Laszlo</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20200</commentid>
    <comment_count>34</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-12-09 05:27:49 +0000</bug_when>
    <thetext>Finally managed to fix my outbound mail configuration and get it sent upstream: https://edk2.groups.io/g/devel/message/97173

Thanks,

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20281</commentid>
    <comment_count>35</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2022-12-23 12:00:59 +0000</bug_when>
    <thetext>Merged upstream via https://github.com/tianocore/edk2/pull/3829</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4000</bug_id>
          
          <creation_ts>2022-07-19 06:07:16 +0000</creation_ts>
          <short_desc>EDK2 can&apos;t enumerate bus for all root bridge instances when one root bridge instance meet bus resource OUT_OF_RESOURCE.</short_desc>
          <delta_ts>2022-08-29 05:09:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>critical</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="NongFoster">foster.nong</reporter>
          <assigned_to name="NongFoster">foster.nong</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>foster.nong</cc>
    
    <cc>gaoliming</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19264</commentid>
    <comment_count>0</comment_count>
    <who name="NongFoster">foster.nong</who>
    <bug_when>2022-07-19 06:07:16 +0000</bug_when>
    <thetext>When one root bridge instance meet bus resource OUT_OF_RESOURCE during bus scan,
the Status will not be EFI_SUCCESS, and below code will make it exit the whole root bridge instances bus scan.

    //
    // Enumerate all the buses under this root bridge
    //
    Status = PciRootBridgeEnumerator (
               PciResAlloc,
               RootBridgeDev
               );

    if ((gPciHotPlugInit != NULL) &amp;&amp; FeaturePcdGet (PcdPciBusHotplugDeviceSupport)) {
      InsertTailList (&amp;RootBridgeList, &amp;(RootBridgeDev-&gt;Link));
    } else {
      DestroyRootBridge (RootBridgeDev);
    }

    if (EFI_ERROR (Status)) {
      return Status;
    }</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19265</commentid>
    <comment_count>1</comment_count>
    <who name="NongFoster">foster.nong</who>
    <bug_when>2022-07-19 06:14:24 +0000</bug_when>
    <thetext>there is a proposal, which suggest move it behind of  NotifyPhase (PciResAlloc, EfiPciHostBridgeEndBusAllocation). Then Platform BIOS have a chance to check if system meet bus resource OUT_OF_RESOURCE in EfiPciHostBridgeEndBusAllocation event. And do the relative bus rebalance to handle the bus resource OUT_OF_RESOURCE.  

//
  // Notify the bus allocation phase is finished for the first time
  //
  NotifyPhase (PciResAlloc, EfiPciHostBridgeEndBusAllocation);

//
// check the status here...(new)
//
    if (EFI_ERROR (Status)) {
      return Status;
    }</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19282</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-07-19 21:48:53 +0000</bug_when>
    <thetext>Ray: can you help evaluate the proposal for this issue?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19287</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-07-19 21:55:24 +0000</bug_when>
    <thetext>Foster will take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19308</commentid>
    <comment_count>4</comment_count>
    <who name="Ray Ni">ray.ni</who>
    <bug_when>2022-07-20 02:52:57 +0000</bug_when>
    <thetext>I think it&apos;s a good proposal.
Old logic just exits when bus allocation fails for any root bridge.
New proposal tries the bus allocation on every root bridge no matter whether it succeeds or not.

Platform specific handler of “EfiPciHostBridgeEndBusAllocation” could use PciRootBridge-&gt;Configure() to get the actual BUS allocation status for every root bridge.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19447</commentid>
    <comment_count>5</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-29 05:09:31 +0000</bug_when>
    <thetext>Merge at bd06717863ed6cba979fe5300433619aba340403</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4350</bug_id>
          
          <creation_ts>2023-02-24 22:47:22 +0000</creation_ts>
          <short_desc>Random stack corruption in RiscVVirtQemu firmware</short_desc>
          <delta_ts>2023-03-02 01:50:01 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>critical</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sunil V L">sunilvl</reporter>
          <assigned_to name="Sunil V L">sunilvl</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21117</commentid>
    <comment_count>0</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2023-02-24 22:47:22 +0000</bug_when>
    <thetext>RiscVVirtQemu build fails to boot under some configurations.


RELEASE build will fail to boot correctly with 1 or 2 GiB

DEBUG  build will fail to boot correctly with 1 GiB

 

This is what happens – so the thing boots up with no I/O at all.
 

InstallProtocolInterface: BC62157E-3E33-4FEC-9920-2D3B36D750DF 1BF2D0598

ProtectUefiImageCommon - 0xBF2D0240

  - 0x00000001BFCE7000 - 0x000000000002A400

QemuFwCfgInitialize: No &apos;qemu,fw-cfg-mmio&apos; compatible DT node found (Status == Not Found)

InstallProtocolInterface: 665E3FF6-46CC-11D4-9A38-0090273FC14D 1BFD10048

Loading driver 4110465D-5FF3-4F4B-B580-24ED0D06747A</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21125</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-02-28 21:39:37 +0000</bug_when>
    <thetext>The patch has been sent for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21133</commentid>
    <comment_count>2</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2023-03-02 01:50:01 +0000</bug_when>
    <thetext>Fix for this issue is merged as part the PR: https://github.com/tianocore/edk2/pull/4084</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4511</bug_id>
          
          <creation_ts>2023-07-25 16:17:47 +0000</creation_ts>
          <short_desc>Cache Disable should not be set by default in CR0 after ResetVector in x64 build</short_desc>
          <delta_ts>2023-10-26 16:06:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Rahul Kumar">rahul.r.kumar</reporter>
          <assigned_to name="Rahul Kumar">rahul.r.kumar</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>eric.dong</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
    
    <cf_releases_to_fix>edk2-stable202305</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21774</commentid>
    <comment_count>0</comment_count>
    <who name="Rahul Kumar">rahul.r.kumar</who>
    <bug_when>2023-07-25 16:17:47 +0000</bug_when>
    <thetext>With 64 bit build we are seeing the CD in control register CR 0 set. This causes the NEM to disabled for some specific bios profiles</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22015</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 23:18:23 +0000</bug_when>
    <thetext>rahul.r.kumar@intel.com: please provide the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22062</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:06:08 +0000</bug_when>
    <thetext>Fixed in commit e8aa4c6546ad5b04a1100fa2618e424f58e354f5.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4869</bug_id>
          
          <creation_ts>2024-10-24 04:08:39 +0000</creation_ts>
          <short_desc>MdePkg:Update Return Error Macro in Base.h to reduce potential code size increasing</short_desc>
          <delta_ts>2024-11-19 01:59:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Victor Hsu">victorx.hsu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23494</commentid>
    <comment_count>0</comment_count>
      <attachid>1554</attachid>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2024-10-24 04:08:39 +0000</bug_when>
    <thetext>Created attachment 1554
This mail thread describes the potential code size increasing caused by current RETURN_ERROR macro

Current RETURN_ERROR macro might be result in code size increasing</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23496</commentid>
    <comment_count>1</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2024-10-24 04:39:53 +0000</bug_when>
    <thetext>PR https://github.com/tianocore/edk2/pull/6372 is waiting for code review</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23532</commentid>
    <comment_count>2</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2024-11-19 01:59:03 +0000</bug_when>
    <thetext>PR sent</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23533</commentid>
    <comment_count>3</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2024-11-19 01:59:36 +0000</bug_when>
    <thetext>wont fix</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1554</attachid>
            <date>2024-10-24 04:08:39 +0000</date>
            <delta_ts>2024-10-24 04:08:39 +0000</delta_ts>
            <desc>This mail thread describes the potential code size increasing caused by current RETURN_ERROR macro</desc>
            <filename>Question about commit Update return error macro in base.h.msg</filename>
            <type>application/octet-stream</type>
            <size>527872</size>
            <attacher name="Victor Hsu">victorx.hsu</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4873</bug_id>
          
          <creation_ts>2024-11-11 20:36:46 +0000</creation_ts>
          <short_desc>[MdeModulePkg|UEFIPayLoadPkg] Func SetPageTablePoolReadOnly not covering the 5-level-Paging case</short_desc>
          <delta_ts>2024-12-06 04:02:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ning Feng">ning.feng</reporter>
          <assigned_to name="Ning Feng">ning.feng</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>yanggang.uefi</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
    
    <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23528</commentid>
    <comment_count>0</comment_count>
    <who name="Ning Feng">ning.feng</who>
    <bug_when>2024-11-11 20:36:46 +0000</bug_when>
    <thetext>Due to SetPageTablePoolReadOnly not covering the 5-level-paging case.
After enable the 5 level paging, we found the real protection region is larger than 4G, but the real page table region is below 4G, that is unexpected.

Solusion: refine SetPageTablePoolReadOnly to support 5 level paging.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23529</commentid>
    <comment_count>1</comment_count>
    <who name="Ning Feng">ning.feng</who>
    <bug_when>2024-11-11 20:41:03 +0000</bug_when>
    <thetext>confirmed the bug and preparing the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23530</commentid>
    <comment_count>2</comment_count>
    <who name="Ning Feng">ning.feng</who>
    <bug_when>2024-11-12 01:27:46 +0000</bug_when>
    <thetext>patch at here:https://edk2.groups.io/g/devel/topic/109530632?p=%2C%2C%2C20%2C0%2C0%2C0%3A%3Arecentpostdate%2C%2C%2C20%2C2%2C0%2C0&amp;allview=1</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23556</commentid>
    <comment_count>3</comment_count>
    <who name="Ning Feng">ning.feng</who>
    <bug_when>2024-12-06 04:02:19 +0000</bug_when>
    <thetext>patch merged into edk main, close the issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4232</bug_id>
          
          <creation_ts>2022-12-28 08:45:52 +0000</creation_ts>
          <short_desc>Update 2.3.7 (RISC-V Platforms) for tighter/concise language</short_desc>
          <delta_ts>2023-03-28 17:06:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>andrei.warkentin</reporter>
          <assigned_to>andrei.warkentin</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>UEFI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20314</commentid>
    <comment_count>0</comment_count>
      <attachid>1099</attachid>
    <who name="">andrei.warkentin</who>
    <bug_when>2022-12-28 08:45:52 +0000</bug_when>
    <thetext>Created attachment 1099
ECR proposal

Revise 2.3.7 (RISC-V Platforms) to avoid conflating specific implementation choices and platform firmware requirements with generic UEFI requirements on all RISC-V implementations (e.g removing language about Machine mode behavior). Augment with language consistent with existing implementations and other accepted calling convention norms for other architectures. Defer to external documentation where possible (e.g. ABI, privileged spec, etc) and avoid overly verbose/descriptive sections that aren’t requirements and that with time will amount to a maintenance burden (e.g. the language today prevents VM implementations of UEFI).

Attaching the proposed edits in docx format. The changes are annotated with comments for clarity.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20315</commentid>
    <comment_count>1</comment_count>
      <attachid>1100</attachid>
    <who name="">andrei.warkentin</who>
    <bug_when>2022-12-28 08:47:23 +0000</bug_when>
    <thetext>Created attachment 1100
ECR proposal

Updated bugzilla ref in the doc</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20316</commentid>
    <comment_count>2</comment_count>
    <who name="">andrei.warkentin</who>
    <bug_when>2022-12-28 08:56:57 +0000</bug_when>
    <thetext>
To summarize, the ECR proposal removes requirements on Machine Mode behavior, as UEFI Boot Services (e.g. from the perspective of EFI drivers, applications, OS loaders) concern only with Supervisor mode. The Machine Mode parts may be interesting as an /implementation suggestion/ in the PI spec, but don&apos;t belong in the UEFI spec. The proposal also gets rid of text that is not an actual requirement, e.g. verbose descriptions of various parts of RISC-V architecture. The proposal also adds in some of the &quot;obvious&quot; requirements that are consistent across all UEFI architectures, and adds in calling convention clarifications based on current UEFI implementations seen (with Tiano, U-Boot, e.g. around LP64 ABI, RVC, etc)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20431</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:42:17 +0000</bug_when>
    <thetext>andrei.warkentin@intel.com: please take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20655</commentid>
    <comment_count>4</comment_count>
      <attachid>1173</attachid>
    <who name="">andrei.warkentin</who>
    <bug_when>2023-01-12 22:46:16 +0000</bug_when>
    <thetext>Created attachment 1173
Updated based on feedback</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20656</commentid>
    <comment_count>5</comment_count>
      <attachid>1174</attachid>
    <who name="">andrei.warkentin</who>
    <bug_when>2023-01-12 22:47:09 +0000</bug_when>
    <thetext>Created attachment 1174
Updated based on feedback</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21219</commentid>
    <comment_count>6</comment_count>
    <who name="">andrei.warkentin</who>
    <bug_when>2023-03-21 17:29:42 +0000</bug_when>
    <thetext>Based on existing feedback, I&apos;ll take this to USWG in a few days. If there&apos;s anything else anyone wanted to share back - say now or forever hold your peace :-).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21280</commentid>
    <comment_count>7</comment_count>
    <who name="">andrei.warkentin</who>
    <bug_when>2023-03-28 17:06:36 +0000</bug_when>
    <thetext>Filed USWG Mantis 2376 to finish up with ratification.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1099</attachid>
            <date>2022-12-28 08:45:52 +0000</date>
            <delta_ts>2022-12-28 08:47:23 +0000</delta_ts>
            <desc>ECR proposal</desc>
            <filename>UpdateRISCVCallingConventions.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>57264</size>
            <attacher>andrei.warkentin</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1100</attachid>
            <date>2022-12-28 08:47:23 +0000</date>
            <delta_ts>2023-01-12 22:47:09 +0000</delta_ts>
            <desc>ECR proposal</desc>
            <filename>UpdateRISCVCallingConventions.docx</filename>
            <type>application/octet-stream</type>
            <size>56271</size>
            <attacher>andrei.warkentin</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1173</attachid>
            <date>2023-01-12 22:46:16 +0000</date>
            <delta_ts>2023-01-12 22:47:09 +0000</delta_ts>
            <desc>Updated based on feedback</desc>
            <filename>UpdateRISCVCallingConventions_v3.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>60898</size>
            <attacher>andrei.warkentin</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1174</attachid>
            <date>2023-01-12 22:47:09 +0000</date>
            <delta_ts>2023-01-12 22:47:09 +0000</delta_ts>
            <desc>Updated based on feedback</desc>
            <filename>UpdateRISCVCallingConventions_v3.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>60898</size>
            <attacher>andrei.warkentin</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4463</bug_id>
          
          <creation_ts>2023-05-23 13:37:36 +0000</creation_ts>
          <short_desc>AARCH64 MMU Interface Reports Every Page as EFI_MEMORY_RP</short_desc>
          <delta_ts>2023-06-07 12:39:50 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Oliver Smith-Denny">osde</reporter>
          <assigned_to name="Oliver Smith-Denny">osde</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ArmPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21575</commentid>
    <comment_count>0</comment_count>
    <who name="Oliver Smith-Denny">osde</who>
    <bug_when>2023-05-23 13:37:36 +0000</bug_when>
    <thetext>Recently, EDK2 updated so that ARM would use TT_AF (the access flag in the page table) to represent EFI_MEMORY_RP (read protected memory). This enforces an access flag fault when software attempts to read a page without the access flag set. This is one option allowed by the Arm ARM; previously EDK2 was using TT_AF in the other allowed way, which used TT_AF as an accessed bit, i.e. a page would not have this bit set unless the page had been accessed.

I have a local change up for review on the mailing list to properly sync the GCD with the page table on ARM, as is done on the x86 side, but was never added to the Arm side as the fix for x86 did not target Arm. This allowed all memory regions to have the capability of setting EFI_MEMORY_RP as an attribute in the GCD, which they did not have previously. When Arm&apos;s CpuDxe syncs with the GCD, it attempts to set all ranges of System Memory as EFI_MEMORY_RP by default, because that is how they start out in the page table (this is a change in behavior on the upstream side, previously the access flag is set for all ranges). Because the Capabilities of each GCD range now supports EFI_MEMORY_RP getting set, it would also get marked in the GCD as EFI_MEMORY_RP. Previously, the Arm implementation would silently drop the EFI_MEMORY_RP bit being passed in as an attribute to set because it was not in the capability set of the GCD region.

When the USB stack runs on platforms that use NonDiscoverablePciDeviceIo to manage the MMIO allocations, NonCoherentPciIoAllocateBuffer gets a new page, saves off the existing GCD descriptor, which contains EFI_MEMORY_RP for this range, updates the region in the GCD (which in turn updates the page table) to not include EFI_MEMORY_RP (implicitly when setting a cacheability attribute). When the memory is freed through NonCoherentPciIoFreeBuffer, the saved off GCD descriptor is fetched and it resets the memory range to have the old memory attributes, which includes EFI_MEMORY_RP. When SetMemorySpaceAttributes() is called, the GCD is updated to the old value, but this time it sees that an attribute (EFI_MEMORY_RP) is being added, so it calls into CpuDxe to update the page table, causing the actual page to get TT_AF set to 0.

When freeing a memory pool, the core code attempts to read the page (to set some metadata about the status of the pool, return it to the free list, etc.), which then triggers the access flag fault.

This did not fail on debug builds, because in debug builds we set the CLEAR_MEMORY_ENABLED bit, which, on every conversion of memory type (say in allocating a page) and on every pool allocate and free, causes us to call CLEAR_MEMORY_ENABLED(), which clears the EFI_MEMORY_RP bit (setting the TT_AF flag), so that future accesses of this do not get an access flag fault. We should also be unsetting the RP bit on every free, likely, as the core code will fail when attempting to give it out.

The issue is in Arm&apos;s MMU mgmt code, specifically GetNextEntryAttribute where it has EntryAttribute = Entry &amp; TT_ATTR_INDX_MASK, which evaluates to 00011100, but TT_AF is BIT10 (1000000000) so it always gets masked off which in the old implementation worked, because we were only using it to tell if a page had been accessed, so the GCD didn&apos;t need to know about it. This should be TT_ATTRIBUTE_MASK so that we pick up TT_AF as well as the RO and XP equivalent bits in the page table entry that we were missing on initial GCD/page table syncing prior to this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21603</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 21:53:20 +0000</bug_when>
    <thetext>Oliver: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21641</commentid>
    <comment_count>2</comment_count>
    <who name="Oliver Smith-Denny">osde</who>
    <bug_when>2023-06-07 12:39:50 +0000</bug_when>
    <thetext>Fixed in commit: https://github.com/tianocore/edk2/commit/647cd40cf6658f52e0c6d4c356620a4dedd425ba.

See the mailing list discussion: https://edk2.groups.io/g/devel/topic/patch_v1_1_1_armpkg/99095992?p=,,,20,0,0,0::recentpostdate/sticky,,,20,2,0,99095992,previd%3D1686155814900024740,nextid%3D1686118768369681933&amp;previd=1686155814900024740&amp;nextid=1686118768369681933.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4521</bug_id>
          
          <creation_ts>2023-08-09 16:27:30 +0000</creation_ts>
          <short_desc>ArmVirtQemu Has Access Flag Fault When Booting with HeapGuard GuardAlignedToTail</short_desc>
          <delta_ts>2024-01-02 17:37:33 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Oliver Smith-Denny">osde</reporter>
          <assigned_to name="Oliver Smith-Denny">osde</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21815</commentid>
    <comment_count>0</comment_count>
    <who name="Oliver Smith-Denny">osde</who>
    <bug_when>2023-08-09 16:27:30 +0000</bug_when>
    <thetext>ArmVirtQemu gets an access flag fault when attempting to boot with heap guard enabled for pools and set to GuardAlignedToTail.

This is because on ARM64, the RUNTIME_PAGE_ALLOCATION_GRANULARITY is 64k (whereas on other architectures it is 4k). So when small runtime pools are allocated, they get a minimum of 16 pages allocated. HeapGuard then puts the pool head at (Memory + EFI_PAGES_TO_SIZE(NumberOfPages) - AllocatedSize) which for small allocations means that there are multiple empty pages before the pool head.

When this pool goes to get freed, HeapGuard simply returns that the memory address to free from is (PoolHead &amp; ~EFI_PAGE_MASK), which assumes that the pool head has been allocated in the first page. It then tries to free the 16 pages from the last page, which is invalid and it runs into the Tail Guard when it does a DEBUG_CLEAR_MEMORY of the memory it thinks it should free, hence the access flag fault.

HeapGuard can remove its assumption that the allocated pool head will be in the first page of memory allocated and this issue is resolved. However, I will also start a discussion on the mailing list about the reason the runtime page allocation granularity is 64k on ARM64.

I am sending out a patch for the HeapGuard fix now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21816</commentid>
    <comment_count>1</comment_count>
    <who name="Oliver Smith-Denny">osde</who>
    <bug_when>2023-08-09 16:28:03 +0000</bug_when>
    <thetext>This is not restricted to ArmVirtQemu, but could affect all ARM64 hardware.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22012</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 23:11:45 +0000</bug_when>
    <thetext>osde@linux.microsoft.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22301</commentid>
    <comment_count>3</comment_count>
    <who name="Oliver Smith-Denny">osde</who>
    <bug_when>2024-01-02 17:37:33 +0000</bug_when>
    <thetext>This is fixed in this comit: https://github.com/tianocore/edk2/pull/4751/commits/8efb59152a784c9c9718f5ddee5a83464a54aeff</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4378</bug_id>
          
          <creation_ts>2023-03-17 16:55:10 +0000</creation_ts>
          <short_desc>VU#892082: Tiancore EDK2 UEFI TCG2 reference implementation vulnerable to memory</short_desc>
          <delta_ts>2024-02-29 23:01:38 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Brian Mullen">BrianM</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>BrianM</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>john.mathews</cc>
    
    <cc>miki.demeter</cc>
    
    <cc>sean.brogan</cc>
    
    <cc>vincent.zimmer</cc>
    
    <cc>weihao.cai</cc>
    
    <cc>yngweijs</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21210</commentid>
    <comment_count>0</comment_count>
    <who name="Brian Mullen">BrianM</who>
    <bug_when>2023-03-17 16:55:10 +0000</bug_when>
    <thetext>https://kb.cert.org/vince/comm/case/988/

One of the core modules that support TPM, as part of this reference implementation is TCG2, which implements to TCG EFI Protocol Specification. An input validation vulnerability was found in the TCG2 implementation that allows for elevation of privilege in the DXE phase to SMM mode (Ring-2). This lack of validation of commbuffer can be used to access memory in an inappropriate manner and potentially corrupt memory. For more detailed description, please read the attached PDF file and the related Proof of Concept code provided by the security researcher.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21211</commentid>
    <comment_count>1</comment_count>
      <attachid>1340</attachid>
    <who name="Brian Mullen">BrianM</who>
    <bug_when>2023-03-20 18:23:42 +0000</bug_when>
    <thetext>Created attachment 1340
Vuln details</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21256</commentid>
    <comment_count>2</comment_count>
    <who name="Sean Brogan">sean.brogan</who>
    <bug_when>2023-03-23 15:16:23 +0000</bug_when>
    <thetext>Initial review of this code and write up indicates that this api is only available before EndOfDxe.  Most systems do not lock SMRAM before EndOfDxe and the design of traditional SMM code loading is to allow DXE code to access SMRAM at this time.  Therefore, I do not see any additional privilege gained by this.  I agree that for correctness the pointer should be checked but I don&apos;t see this a vulnerability.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21268</commentid>
    <comment_count>3</comment_count>
    <who name="Vincent Zimmer">vincent.zimmer</who>
    <bug_when>2023-03-27 21:01:43 +0000</bug_when>
    <thetext>I agree.

 

That’s consistent w/ the guidance we provide in the threat model, too, for SMM https://edk2-docs.gitbook.io/edk-ii-secure-coding-guide/appendix_threat_model_for_edk_ii/asset_management_mode
&quot;The management mode code must lock the management mode after it is constructed, no later than 3rd part code running.&quot;

Namely if you can load SMM handlers prior to SmmLock you can do all kinds of other damage.  This TCG SMM handler is loaded during the PI TCB (prior to running 3rd party code). 

For other reports that contravened the threat model we did responses in the past like

https://edk2-docs.gitbook.io/security-advisory/overflow_in_processing_of_authvarkeydatabase</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21269</commentid>
    <comment_count>4</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-03-27 21:03:27 +0000</bug_when>
    <thetext>Agree with Sean.

Before EndOfDxe, SMM don&apos;t need check the commbuffer, because the whole DXE environment is trusted and DXE environment need load SMM and provide SMM driver to run.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21319</commentid>
    <comment_count>5</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-04-05 12:43:08 +0000</bug_when>
    <thetext>Tiraged 20200405 - opened to public</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21329</commentid>
    <comment_count>6</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-04-05 16:24:46 +0000</bug_when>
    <thetext>Moving to unassigned</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22674</commentid>
    <comment_count>7</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-02-29 19:53:11 +0000</bug_when>
    <thetext>*** Bug 4715 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22675</commentid>
    <comment_count>8</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-02-29 20:01:50 +0000</bug_when>
    <thetext>No security issue.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1340</attachid>
            <date>2023-03-20 18:23:42 +0000</date>
            <delta_ts>2023-03-20 18:23:42 +0000</delta_ts>
            <desc>Vuln details</desc>
            <filename>EDK2-Tcg2smm-vulnreport.pdf</filename>
            <type>application/pdf</type>
            <size>176346</size>
            <attacher name="Brian Mullen">BrianM</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4877</bug_id>
          
          <creation_ts>2024-12-04 18:09:13 +0000</creation_ts>
          <short_desc>BrotliCustomDecompressLib is not buildable</short_desc>
          <delta_ts>2024-12-11 10:47:49 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Phil Noh">phil.noh</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>phil.noh</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23549</commentid>
    <comment_count>0</comment_count>
    <who name="Phil Noh">phil.noh</who>
    <bug_when>2024-12-04 18:09:13 +0000</bug_when>
    <thetext>Brotli decompression library is supported in EDK2 core. Currently it is not buildable when linking it to DxeIpl driver. The result is also checked on edk2 master branch. I think that it could be related to updating Brotli submodule (v1.0.9) on the previous commit (1193aa2).

e.g.
MdeModulePkg/Core/DxeIplPeim/DxeIpl.inf {
  &lt;LibraryClasses&gt;
NULL|MdeModulePkg/Library/LzmaCustomDecompressLib/LzmaCustomDecompressLib.inf      
NULL|MdeModulePkg/Library/BrotliCustomDecompressLib/BrotliCustomDecompressLib.inf
  
}

We have fixed the build errors with the following updates and verified the functional status in POST.

1. Update BrotliCustomDecompressLib.inf to build the source files additionally

  brotli/c/common/context.c
  brotli/c/common/platform.c
  brotli/c/common/constants.c
  brotli/c/common/shared_dictionary.c

2. Add the header files newly to support building the third-party Brotli

  intrin.h
  memory.h

For review, I plan to make a PR that covers the updates.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23552</commentid>
    <comment_count>1</comment_count>
    <who name="Phil Noh">phil.noh</who>
    <bug_when>2024-12-05 12:47:16 +0000</bug_when>
    <thetext>The updates to fix the build errors have been committed. The PR is as follows.

https://github.com/tianocore/edk2/pull/6510</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23561</commentid>
    <comment_count>2</comment_count>
    <who name="Phil Noh">phil.noh</who>
    <bug_when>2024-12-11 10:47:49 +0000</bug_when>
    <thetext>The PR has been merged to EDK2 master after review.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4492</bug_id>
          
          <creation_ts>2023-06-28 11:57:02 +0000</creation_ts>
          <short_desc>MAT Logic Incorrectly Reports Runtime Images</short_desc>
          <delta_ts>2023-11-27 19:41:59 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>tabeebe</reporter>
          <assigned_to>tabeebe</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>tabeebe</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21698</commentid>
    <comment_count>0</comment_count>
    <who name="">tabeebe</who>
    <bug_when>2023-06-28 11:57:02 +0000</bug_when>
    <thetext>MAT installation logic incorrectly breaks up the EFI memory map when at least one image with more than one code section is loaded resulting in at least one garbage entry and at least one missing entry. The garbage entry is usually filtered out when actually installing the MAT, but occasionally the byte pattern in the garbage entry passes the filter resulting in a boot failure.

The full description of the issue is below:

To create the MAT, we call into a function CoreGetMemoryMapWithSeparatedImageSection() which will get the memory map (and thus its required size) but update that size to be the size of the map plus the amount of extra space necessary to break up the memory map. The extra space in this case is indicated by a field called CodeSegmentMax which is set to be the most number of code segments found in a single image loaded. Let’s say we found an image with 2 code sections, making CodeSegmentMax = 2. With two code segments, here are a couple of ways an image could be laid out:

Image 1: Data | Code | Data
Image 2: Data | Code | Data | Code | Data

So, if a single memory map descriptor is the same address range as a singe image, that one map descriptor could become at most 5, leading to the calculation (2 * CodeSegmentMax + 1) * NumberOfImageRecords.

After returning the required pool size (MemoryMapSize) the next call will be with a pool of that size. When we call into get the memory map, MemoryMapSize will be updated to be the actual size of the memory map and we make sure that size is what we expect before calling into SplitTable(). Within SplitTable(), MemoryMapSize is equal to the size of the actual memory map fetched, but the buffer containing the memory map is much larger as described above. We set IndexOld to be the last descriptor in the memory map fetched from CoreGetMemoryMap() and IndexNew to the last descriptor in the entire buffer. We work our way backwards through the descriptors generated from CoreGetMemoryMap() and write new descriptors to the end of the entire buffer. We call into GetMaxSplitRecord() which calculates how many images might be contained in a single memory map descriptor. Let’s say one descriptor range maps to one loaded image which has 2 code sections, so GetMaxSplitRecord() will return 4 (we subtract 1 because IndexNew is already pointing to a valid descriptor).

Let’s zoom into those 5 currently empty descriptors:

| | | | | |
^
IndexNew

Let’s say the code/data sections are laid out like #2 shown above. We call into SplitRecord() which will get the image covering the original descriptor range then call into SetNewRecord() to start populating the descriptors. There’s a stray portion of SplitRecord() which makes sure there isn’t any lingering memory that hasn’t been covered by one of the new descriptors which we can ignore in this case. In the case of #2 above, we will write 4 descriptors but only return the value 3.

When we get back to SplitTable(), MaxSplitRecordCount = 4 and RealSplitRecordCount = 3 and those 5 descriptors look like this:

| d1 | c1 | c2 | d2 | |
^
IndexNew

We then do a mem copy with a destination of IndexNew + MaxSplitRecordCount – RealSplitRecordCount = IndexNew + 1 and a source of IndexNew and a length of 3 which would result in the following:

| d1 | d1 | c1 | c2 | |
^
IndexNew

And this is clearly not right because we have a duplicated the first data section and overwritten the last data section. Index 0 will be overwritten, but Index 4 is now a garbage memory descriptor which will be captured when we copy all the new records to the front of the buffer and update memory map size to be the new number of entries.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21724</commentid>
    <comment_count>1</comment_count>
    <who name="">tabeebe</who>
    <bug_when>2023-07-18 14:49:48 +0000</bug_when>
    <thetext>Patch series to fix issue: https://edk2.groups.io/g/devel/message/107021</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21725</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:11:16 +0000</bug_when>
    <thetext>tabeebe@microsoft.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21966</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-07 01:39:19 +0000</bug_when>
    <thetext>this is a new feature</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22191</commentid>
    <comment_count>4</comment_count>
    <who name="">tabeebe</who>
    <bug_when>2023-11-27 19:41:59 +0000</bug_when>
    <thetext>The patch series fixing this has been committed: https://edk2.groups.io/g/devel/topic/patch_v5_00_16_add/102834905?p=,,,20,0,0,0::recentpostdate/sticky,,,20,2,0,102834905,previd%3D1701131402637906389,nextid%3D1701109118252471488&amp;previd=1701131402637906389&amp;nextid=1701109118252471488</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4354</bug_id>
          
          <creation_ts>2023-03-02 20:40:03 +0000</creation_ts>
          <short_desc>Add definition for IPMI KCS</short_desc>
          <delta_ts>2023-04-01 21:23:06 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>isaac.w.oram</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21144</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-03-02 20:40:03 +0000</bug_when>
    <thetext>Lack of industry-standard definitions of IPMI KCS.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21154</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-03-07 09:36:00 +0000</bug_when>
    <thetext>Abner takes it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21296</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-01 21:23:06 +0000</bug_when>
    <thetext>Resolved at 69e59545</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4422</bug_id>
          
          <creation_ts>2023-04-24 12:30:35 +0000</creation_ts>
          <short_desc>CVE-2023-0464 - OpenSSL vulnerability</short_desc>
          <delta_ts>2023-06-07 12:58:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Security Issues</product>
          <component>Security Issue</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Brian Mullen">BrianM</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>jian.j.wang</cc>
    
    <cc>kraxel</cc>
    
    <cc>louis.shen</cc>
    
    <cc>miki.demeter</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21395</commentid>
    <comment_count>0</comment_count>
    <who name="Brian Mullen">BrianM</who>
    <bug_when>2023-04-24 12:30:35 +0000</bug_when>
    <thetext>https://nvd.nist.gov/vuln/detail/CVE-2023-0464

A security vulnerability has been identified in all supported versions of OpenSSL related to the verification of X.509 certificate chains that include policy constraints. Attackers may be able to exploit this vulnerability by creating a malicious certificate chain that triggers exponential use of computational resources, leading to a denial-of-service (DoS) attack on affected systems. Policy processing is disabled by default but can be enabled by passing the `-policy&apos; argument to the command line utilities or by calling the `X509_VERIFY_PARAM_set1_policies()&apos; function.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21399</commentid>
    <comment_count>1</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-04-25 09:24:01 +0000</bug_when>
    <thetext>I don&apos;t think edk2 crypto code enables policies anywhere.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21400</commentid>
    <comment_count>2</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-04-25 17:05:31 +0000</bug_when>
    <thetext>As investigated by the crypto package maintainers:
Jian J Wang &lt;jian.j.wang@intel.com&gt;

&lt;snip&gt;
My personal opinion is there’s NO impact. Following is my analysis.
 
According to the CVE description, ‘policy’ processing is disabled by default.

Policy processing is disabled by default but can be enabled by passing the &apos;-policy&apos; argument to the command line utilities or by calling the &apos;X509 VERIFY PARAM set1 policies(&apos; function.
 
For PKCS7, the X509 default parameter is used (NULL is passed in CryptoPkg\Library\BaseCryptLib\Pk\CryptPkcs7VerifyCommon.c)
Image
 
 
In X509_STORE_CTX_init(), ‘default’ parameter is used (CryptoPkg\Library\OpensslLib\openssl\crypto\x509\x509_vfy.c)
Image
 
For X509 verify, no policy parameter is set (CryptoPkg\Library\BaseCryptLib\Pk\CryptX509.c)
Image
 
&lt;/snip</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21642</commentid>
    <comment_count>3</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-06-07 12:58:21 +0000</bug_when>
    <thetext>Determined there is no TianoCore Exposure added to third-party security advisories</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4867</bug_id>
          
          <creation_ts>2024-10-15 01:02:37 +0000</creation_ts>
          <short_desc>CryptoPkg: Add MM_STANDALONE support in Driver and BaseCryptLibOnProtocolPpi</short_desc>
          <delta_ts>2024-11-05 03:48:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>sountharyan</reporter>
          <assigned_to>sountharyan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>gayathrit</cc>
    
    <cc>kanagavels</cc>
    
    <cc>prarthanasv</cc>
    
    <cc>srinivasanm</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23450</commentid>
    <comment_count>0</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-10-15 01:02:37 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

We are requested to add MM_STANDALONE support in CryptoPkg Driver and BaseCryptLibOnProtocolPpi. Kindly provide your comments.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23459</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-10-17 22:00:48 +0000</bug_when>
    <thetext>If it does not affect the legacy DXE_SMM_DRIVER, please go ahead</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23460</commentid>
    <comment_count>2</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-10-17 23:21:27 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

Can we expect the changes in Next EDK2 tag?

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23461</commentid>
    <comment_count>3</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-10-18 00:19:49 +0000</bug_when>
    <thetext>Currently there is no resource specified for CryptoPkg. If needed, you can submit a patch and maintainers will review it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23464</commentid>
    <comment_count>4</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-10-18 09:30:05 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

Changes has been shared. Kindly verify.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23478</commentid>
    <comment_count>5</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-10-23 20:42:32 +0000</bug_when>
    <thetext>sountharyan@ami.com: please create pull reqeust to make this change.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23508</commentid>
    <comment_count>6</comment_count>
    <who name="Kanagavel Subramani">kanagavels</who>
    <bug_when>2024-10-30 15:31:55 +0000</bug_when>
    <thetext>Hi gaoliming@byosoft.com.cn

Pull request created to merge the MM_STANDALONE support.
https://github.com/tianocore/edk2/pull/6388

Thanks,
Kanagavel</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23510</commentid>
    <comment_count>7</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-11-05 03:48:26 +0000</bug_when>
    <thetext>pushed: https://github.com/tianocore/edk2/commit/6f17fe30bffd0f6f72d61737e1c7c89e8138fdc0</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4092</bug_id>
          
          <creation_ts>2022-10-04 16:23:58 +0000</creation_ts>
          <short_desc>Duplicate library header in IntelFsp2WrapperPkg.dec.</short_desc>
          <delta_ts>2022-10-05 00:17:33 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2WrapperPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19697</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-04 16:23:58 +0000</bug_when>
    <thetext>This breaking coding style rule.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19698</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-04 16:24:13 +0000</bug_when>
    <thetext>working on the fix.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19712</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-05 00:17:33 +0000</bug_when>
    <thetext>
Patch series have been merged:
https://github.com/tianocore/edk2/commit/f054beec548eb3cc718b35be20efa9d344fe7097
https://github.com/tianocore/edk2/commit/1bd2ff18664b9564a5802d0ac153b5023f2fa41e</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4713</bug_id>
          
          <creation_ts>2024-02-26 09:30:04 +0000</creation_ts>
          <short_desc>SecurityPkg/SecureBootConfigDxe: Should not call HiiGetBrowserData() in FORM_OPEN action callback</short_desc>
          <delta_ts>2024-04-07 05:32:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ming Tan">ming.tan</reporter>
          <assigned_to name="Ming Tan">ming.tan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22653</commentid>
    <comment_count>0</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2024-02-26 09:30:04 +0000</bug_when>
    <thetext>Refer to UEFI_Spec_2_10_Aug29.pdf page 1694

In section 35.5.4 for EFI_BROWSER_ACTION_FORM_OPEN:
NOTE: EFI_FORM_BROWSER2_PROTOCOL.BrowserCallback() cannot be used with
this browser action because question values have not been retrieved yet.

So should not call HiiGetBrowserData() and HiiSetBrowserData() in FORM_OPEN
call back function.

Another bug related this: https://bugzilla.tianocore.org/show_bug.cgi?id=943
But this bug only focus on the SecurityPkg\VariableAuthenticated\SecureBootConfigDxe\SecureBootConfigImpl.c.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22654</commentid>
    <comment_count>1</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2024-02-26 10:12:13 +0000</bug_when>
    <thetext>A patch is submitted: https://edk2.groups.io/g/devel/message/115966
A PR is created: https://github.com/tianocore/edk2/pull/5411</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22879</commentid>
    <comment_count>2</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2024-04-07 05:32:11 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/commit/ee28bea4c0779d3874dbe0a5d6ade549295d7d8b fix it.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4572</bug_id>
          
          <creation_ts>2023-10-25 02:18:17 +0000</creation_ts>
          <short_desc>TDVF: TdVmCall needs handle the retry results for MapGPA</short_desc>
          <delta_ts>2023-11-17 02:54:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>cepingx.sun</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>min.m.xu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22036</commentid>
    <comment_count>0</comment_count>
    <who name="">cepingx.sun</who>
    <bug_when>2023-10-25 02:18:17 +0000</bug_when>
    <thetext>According to section 3.2 of the GHCI documentation, if the result is &quot;TDG.VP.VMCALL_RETRY&quot; for TDG.VP.VMCALL&lt;MapGPA&gt;, TD must retry the mapping for the pages in the region starting at the GPA specified in r11. 

However, currently TDVF only handles successful results of MapGPA, and other results always return failure. It is needs to handle the Retry results before return failure.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22040</commentid>
    <comment_count>1</comment_count>
    <who name="">cepingx.sun</who>
    <bug_when>2023-10-26 02:15:11 +0000</bug_when>
    <thetext>Updated: GHCI(TDX Guest-Hypervisor Communication Interface)
Link:https://cdrdv2.intel.com/v1/dl/getContent/726790</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22145</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-11-09 18:31:15 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5026</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22162</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-11-17 02:54:32 +0000</bug_when>
    <thetext>Commit range 616f0d503707..8a4100464341.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4425</bug_id>
          
          <creation_ts>2023-04-25 03:14:19 +0000</creation_ts>
          <short_desc>Unable to run acpidump.efi in UEFI Shell</short_desc>
          <delta_ts>2023-05-06 01:04:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Yanbo Huang">yanbo.huang</reporter>
          <assigned_to>gaoliming</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jianfeng.zhou</cc>
    
    <cc>xueshengfeng</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21398</commentid>
    <comment_count>0</comment_count>
    <who name="Yanbo Huang">yanbo.huang</who>
    <bug_when>2023-04-25 03:14:19 +0000</bug_when>
    <thetext>The commit MdePkg/PeCoffLib: Capture DLL characteristics fields in image context (SHA-1: d6457b3090fea2e26f94e8419f77455945bc4c41) will bring one error that run acpidump.efi in UEFI Shell will return Unsupported.

The data struct EFI_IMAGE_DEBUG_DIRECTORY_ENTRY:
typedef struct {
  UINT32    Characteristics;
  UINT32    TimeDateStamp;
  UINT16    MajorVersion;
  UINT16    MinorVersion;
  UINT32    Type;
  UINT32    SizeOfData;
  UINT32    RVA;         ///&lt; The address of the debug data when loaded, relative to the image base.
  UINT32    FileOffset;  ///&lt; The file pointer to the debug data.
} EFI_IMAGE_DEBUG_DIRECTORY_ENTRY;
This code assumes that field &apos;SizeOfData&apos; is always 0, while the field &apos;SizeOfData&apos; might be non-zero.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21401</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:38:39 +0000</bug_when>
    <thetext>Liming and Ard will investigate this problem. 

Yanbo: how do you generate acpidump.efi image?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21427</commentid>
    <comment_count>2</comment_count>
      <attachid>1356</attachid>
    <who name="Yanbo Huang">yanbo.huang</who>
    <bug_when>2023-04-25 22:06:46 +0000</bug_when>
    <thetext>Created attachment 1356
acpidump.efi</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21429</commentid>
    <comment_count>3</comment_count>
    <who name="Yanbo Huang">yanbo.huang</who>
    <bug_when>2023-04-25 22:11:36 +0000</bug_when>
    <thetext>Liming: acpidump.efi attached, we use previously generated file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21434</commentid>
    <comment_count>4</comment_count>
    <who name="xueshengfeng">xueshengfeng</who>
    <bug_when>2023-04-26 10:15:46 +0000</bug_when>
    <thetext>The root cause is that in PeCoffLoaderGetImageInfo function, When access the debug directory Entry, the pointer may exceed the length of this table in some cases.

Details as following,
For the Acpidump.efi tool, the size of debug directory Table is 0xA0, it includes one debug directory entry (the size is 0x1c) and the debug data (the size is 0x73). 
The debug data just followed the debug directory.

So when access the debug directory Entry, the pointer may exceed the length of this table in this case:

        for (Index = 0; Index &lt; DebugDirectoryEntry-&gt;Size; Index += sizeof (EFI_IMAGE_DEBUG_DIRECTORY_ENTRY)) {
          //
          // Read next debug directory entry
          //
          Size     = sizeof (EFI_IMAGE_DEBUG_DIRECTORY_ENTRY);
          ReadSize = Size;
          Status   = ImageContext-&gt;ImageRead (
                                     ImageContext-&gt;Handle,
                                     DebugDirectoryEntryFileOffset + Index,
                                     &amp;Size,
                                     &amp;DebugEntry
                                     );
          if (RETURN_ERROR (Status) || (Size != ReadSize)) {
            ImageContext-&gt;ImageError = IMAGE_ERROR_IMAGE_READ;
            if (Size != ReadSize) {
              Status = RETURN_UNSUPPORTED;
            }

            return Status;
          }

We need to add code to check this case and don’t continue to process, 

The commit of 17cae21c24f5b3e9a383f39edcb876f12d0f51fd just expose this issue,  
before this patch, it will only access the first debug directory entry if it return success.
After this patch, it will loop the whole debug directory table, the pointer may exceed the length of this table in some cases</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21439</commentid>
    <comment_count>5</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-26 23:29:08 +0000</bug_when>
    <thetext>The attached EFI image is not valid PE/COFF image. Its debug entry is not correct. Can you rebuild AcpiDump application on the latest Edk2 source, and try again?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21441</commentid>
    <comment_count>6</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-27 01:56:16 +0000</bug_when>
    <thetext>The attached image should be generated based on old edk2 code base (before 2018). The wrong debug entry generated in EFI image is introduced by edk2 GenFw tool. But, GenFw tool issue has been fixed on edk2 60e85a39fe49071683f3ac5e208f1582511d26bf

Revision: 60e85a39fe49071683f3ac5e208f1582511d26bf
Author: Ard Biesheuvel &lt;ard.biesheuvel@linaro.org&gt;
Date: 2017/7/6 2:33:59
Message:
BaseTools/GenFw: disregard payload in PE debug directory entry size</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21465</commentid>
    <comment_count>7</comment_count>
    <who name="Jianfeng Zhou">jianfeng.zhou</who>
    <bug_when>2023-05-02 19:46:31 +0000</bug_when>
    <thetext>1) acpidump.efi in the attachment is built by GCC without EDK2
2) the SizeOfData of the debug directory entry is non-zero, the data need to be skipped before reading next debug directory entry</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21473</commentid>
    <comment_count>8</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-04 03:26:36 +0000</bug_when>
    <thetext>jianfeng.zhou@intel.com: can you give the detail step to generate acpidump.efi image? I would like to generate the attached image, then I can confirm whether my patch fixes this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21474</commentid>
    <comment_count>9</comment_count>
    <who name="Jianfeng Zhou">jianfeng.zhou</who>
    <bug_when>2023-05-04 03:36:24 +0000</bug_when>
    <thetext>steps for building acpidump.efi:
1) git clone https://github.com/acpica/acpica
2) cd acpica
3) make OS=efi

the acpidump.efi built on my host has no debug directory entry.

the acpidump.efi in the attachment was built by unknown engineer several years ago.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21495</commentid>
    <comment_count>10</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-06 01:04:08 +0000</bug_when>
    <thetext>It has been resolved at edk2 94c802e108a082d6f74c854bea8bd98fe7808453</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1356</attachid>
            <date>2023-04-25 22:06:46 +0000</date>
            <delta_ts>2023-04-25 22:06:46 +0000</delta_ts>
            <desc>acpidump.efi</desc>
            <filename>acpidump.efi</filename>
            <type>application/octet-stream</type>
            <size>41504</size>
            <attacher name="Yanbo Huang">yanbo.huang</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4250</bug_id>
          
          <creation_ts>2023-01-04 06:38:04 +0000</creation_ts>
          <short_desc>work around QEMU regression regarding the CPU hotplug register block</short_desc>
          <delta_ts>2023-01-20 09:25:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          <see_also>https://bugzilla.tianocore.org/show_bug.cgi?id=4324</see_also>
    
    <see_also>https://bugzilla.tianocore.org/show_bug.cgi?id=4234</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Laszlo Ersek">laszlo.ersek</assigned_to>
          <cc>ardb</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>kraxel</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20477</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-04 06:38:04 +0000</bug_when>
    <thetext>In QEMU v5.1.0, the CPU hotplug register block misbehaves: the
negotiation protocol is (effectively) broken such that it suggests that
switching from the legacy interface to the modern interface works, but
in reality the switch never happens. The symptom has been witnessed when
using TCG acceleration; KVM seems to mask the issue. The issue persists
with the following (latest) stable QEMU releases: v5.2.0, v6.2.0,
v7.2.0. Currently there is no stable release that addresses the problem.

The QEMU bug confuses the Present and Possible counting in function
PlatformMaxCpuCountInitialization(), in
&quot;OvmfPkg/Library/PlatformInitLib/Platform.c&quot;. OVMF ends up with
Present=0 Possible=1. This in turn further confuses MpInitLib in
UefiCpuPkg (hence firmware-time multiprocessing will be broken). Worse,
CPU hot(un)plug with SMI will be summarily broken in
OvmfPkg/CpuHotplugSmm, which (considering the privilege level of SMM) is
not that great.

The ask is to try to detect the issue in
PlatformMaxCpuCountInitialization(), and print an error message and
*hang* if the issue is present. Since this is not a bug in OVMF, but a
prospective workaround for a QEMU bug, this BZ is being filed as an RFE.

The problem was originally reported by Ard [0]. We analyzed it at [1]
and [2]. A QEMU patch was sent at [3].

&gt;| [0] https://bugzilla.tianocore.org/show_bug.cgi?id=4234#c2
&gt;|
&gt;| [1] https://bugzilla.tianocore.org/show_bug.cgi?id=4234#c3
&gt;|
&gt;| [2] IO port write width clamping differs between TCG and KVM
&gt;|     http://mid.mail-archive.com/aaedee84-d3ed-a4f9-21e7-d221a28d1683@redhat.com
&gt;|     https://lists.gnu.org/archive/html/qemu-devel/2023-01/msg00199.html
&gt;|
&gt;| [3] acpi: cpuhp: fix guest-visible maximum access size to the legacy reg block
&gt;|     http://mid.mail-archive.com/20230104090138.214862-1-lersek@redhat.com
&gt;|     https://lists.gnu.org/archive/html/qemu-devel/2023-01/msg00278.html</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20478</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-04 06:43:35 +0000</bug_when>
    <thetext>Working on a patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20487</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-04 10:14:03 +0000</bug_when>
    <thetext>[PATCH 0/1] OvmfPkg/PlatformInitLib: catch QEMU&apos;s CPU hotplug reg block regression
Message-Id: &lt;20230104151234.286030-1-lersek@redhat.com&gt;
https://listman.redhat.com/archives/edk2-devel-archive/2023-January/057243.html
https://edk2.groups.io/g/devel/message/97945</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20630</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-12 02:51:25 +0000</bug_when>
    <thetext>The QEMU patch has been merged as commit dab30fbef389 (&quot;acpi: cpuhp: fix guest-visible maximum access size to the legacy reg block&quot;, 2023-01-08).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20631</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-12 03:30:12 +0000</bug_when>
    <thetext>[PATCH v2] OvmfPkg/PlatformInitLib: catch QEMU&apos;s CPU hotplug reg block regression
http://mid.mail-archive.com/20230112082845.128463-1-lersek@redhat.com
https://edk2.groups.io/g/devel/message/98336
https://listman.redhat.com/archives/edk2-devel-archive/2023-January/057634.html</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20640</commentid>
    <comment_count>5</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-12 13:37:29 +0000</bug_when>
    <thetext>Reassigning to Gerd (feel free to close as WONTFIX) and removing myself from the CC list.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20729</commentid>
    <comment_count>6</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-19 06:03:22 +0000</bug_when>
    <thetext>[PATCH v3 0/2] OvmfPkg/PlatformInitLib: catch QEMU&apos;s CPU hotplug reg block regression
http://mid.mail-archive.com/20230119110131.91923-1-lersek@redhat.com
https://listman.redhat.com/archives/edk2-devel-archive/2023-January/058184.html
https://edk2.groups.io/g/devel/message/98886</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20736</commentid>
    <comment_count>7</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-20 07:58:04 +0000</bug_when>
    <thetext>Related CI patch from Ard:

[RFC PATCH] OvmfPkg/PlatformCI VS2019: Enable temporary workaround for cpuhp bugfix
http://mid.mail-archive.com/20230119134302.1524569-1-ardb@kernel.org
https://listman.redhat.com/archives/edk2-devel-archive/2023-January/058197.html
https://edk2.groups.io/g/devel/message/98899</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20737</commentid>
    <comment_count>8</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-20 08:46:35 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #7)
&gt; Related CI patch from Ard:
&gt;
&gt; [RFC PATCH] OvmfPkg/PlatformCI VS2019: Enable temporary workaround for cpuhp bugfix
&gt; http://mid.mail-archive.com/20230119134302.1524569-1-ardb@kernel.org
&gt; https://listman.redhat.com/archives/edk2-devel-archive/2023-January/058197.html
&gt; https://edk2.groups.io/g/devel/message/98899

(In reply to Laszlo Ersek from comment #6)
&gt; [PATCH v3 0/2] OvmfPkg/PlatformInitLib: catch QEMU&apos;s CPU hotplug reg block regression
&gt; http://mid.mail-archive.com/20230119110131.91923-1-lersek@redhat.com
&gt; https://listman.redhat.com/archives/edk2-devel-archive/2023-January/058184.html
&gt; https://edk2.groups.io/g/devel/message/98886

Both merged in commit range 51411435d559..bf5678b58026, via
&lt;https://github.com/tianocore/edk2/pull/3935&gt;.

PlatformCI_OvmfPkg_Windows_VS2019_PR:

&gt;| PlatformCpuCountBugCheck: Present=0 Possible=1
&gt;| PlatformCpuCountBugCheck: Broken CPU hotplug register block found. Update QEMU to version 8+, or
&gt;| PlatformCpuCountBugCheck: to a stable release with commit dab30fbef389 backported. Refer to
&gt;| PlatformCpuCountBugCheck: &lt;https://bugzilla.tianocore.org/show_bug.cgi?id=4250&gt;.
&gt;| PlatformCpuCountBugCheck: Consequences of the QEMU bug may include, but are not limited to:
&gt;| PlatformCpuCountBugCheck: - all firmware logic, dependent on the CPU hotplug register block,
&gt;| PlatformCpuCountBugCheck:   being confused, for example, multiprocessing-related logic;
&gt;| PlatformCpuCountBugCheck: - guest OS data loss, including filesystem corruption, due to crash or
&gt;| PlatformCpuCountBugCheck:   hang during ACPI S3 resume;
&gt;| PlatformCpuCountBugCheck: - SMM privilege escalation, by a malicious guest OS or 3rd partty UEFI
&gt;| PlatformCpuCountBugCheck:   agent, against the platform firmware.
&gt;| PlatformCpuCountBugCheck: These symptoms need not necessarily be limited to the QEMU user
&gt;| PlatformCpuCountBugCheck: attempting to hot(un)plug a CPU.
&gt;| PlatformCpuCountBugCheck: The firmware will now stop (hang) deliberately, in order to prevent the
&gt;| PlatformCpuCountBugCheck: above symptoms.
&gt;| PlatformCpuCountBugCheck: You can forcibly override the hang, *at your own risk*, with the
&gt;| PlatformCpuCountBugCheck: following *experimental* QEMU command line option:
&gt;| PlatformCpuCountBugCheck:   -fw_cfg name=opt/org.tianocore/X-Cpuhp-Bugcheck-Override,string=yes
&gt;| PlatformCpuCountBugCheck: Please only report such bugs that you can reproduce *without* the
&gt;| PlatformCpuCountBugCheck: override.
&gt;| Select Item: 0x19
&gt;| Select Item: 0x2C
&gt;| PlatformCpuCountBugCheck: &quot;opt/org.tianocore/X-Cpuhp-Bugcheck-Override&quot; active. You&apos;ve been warned.
&gt;| PlatformMaxCpuCountInitialization: BootCpuCount=1 MaxCpuCount=1</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4752</bug_id>
          
          <creation_ts>2024-04-15 02:24:49 +0000</creation_ts>
          <short_desc>[TDVF] Move TdTcg2Dxe and HashLibTdx from SecurityPkg to OvmfPkg</short_desc>
          <delta_ts>2024-04-16 23:14:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22907</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2024-04-15 02:24:49 +0000</bug_when>
    <thetext>HashLibTdx and TdTcg2Dxe are designed for Intel TDX enlightened OVMF. They&apos;re more reasonable to be put in OvmfPkg than in SecurityPkg.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22909</commentid>
    <comment_count>1</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2024-04-15 03:52:19 +0000</bug_when>
    <thetext>SecTpmMeasurementLibTdx is also designef for Intel TDX enlightened OVMF and is not used anymore. So it shall be deleted.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22917</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-04-16 23:14:03 +0000</bug_when>
    <thetext>merged https://github.com/tianocore/edk2/pull/5566</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4602</bug_id>
          
          <creation_ts>2023-11-20 22:01:15 +0000</creation_ts>
          <short_desc>Redfish communication between BIOS and BMC does not happen if IPv4 installed after RestEx</short_desc>
          <delta_ts>2023-11-21 09:40:06 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Igor Kulchytskyy">igork</reporter>
          <assigned_to name="Igor Kulchytskyy">igork</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22171</commentid>
    <comment_count>0</comment_count>
    <who name="Igor Kulchytskyy">igork</who>
    <bug_when>2023-11-20 22:01:15 +0000</bug_when>
    <thetext>On some systems if an external network card used, then IPv4 protocol installed after IPv6 and RestEx protocol. In that case RedfishDiscoverDxe module does not call acquire function and BIOS BMC communication failed.
Support function of RedfishDiscoverDxe module should wait until all required protocols installed - IPv4, IPv6 and RestEx.
Other optimization should be done to reduce the unnecessary calls for the unsupported protocols.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22174</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-11-21 09:38:54 +0000</bug_when>
    <thetext>Patch has been provided.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22175</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-11-21 09:40:06 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5052 will be merged for this issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4452</bug_id>
          
          <creation_ts>2023-05-08 06:05:46 +0000</creation_ts>
          <short_desc>Implement EFI memory attributes protocol for ARM platforms</short_desc>
          <delta_ts>2023-05-09 23:05:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Ard Biesheuvel">ardb</reporter>
          <assigned_to name="Ard Biesheuvel">ardb</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ArmPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21509</commentid>
    <comment_count>0</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-05-08 06:05:46 +0000</bug_when>
    <thetext>Implement the UEFI memory attributes protocol for ARM platforms, which permits OS loaders to manage write and execute permissions on memory regions without the need to manipulate the page tables directly.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21529</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 21:48:05 +0000</bug_when>
    <thetext>This one has been fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21549</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 23:05:24 +0000</bug_when>
    <thetext>Fix in edk2 997c6967b00cdd797fe787567a28a7565aafd301..16e0969ef775b898ac700f3261d76030b8ab9ef0</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4139</bug_id>
          
          <creation_ts>2022-11-05 15:33:38 +0000</creation_ts>
          <short_desc>Building PcdValueInit.exe app with VS generates vcxxx.pdb in root of project</short_desc>
          <delta_ts>2022-11-08 17:48:12 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>bob.c.feng</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>yuwei.chen</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19944</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-05 15:33:38 +0000</bug_when>
    <thetext>When an EDK II build processed a structured PCD, it generates, builds, and executes a PcdValueInit application to determine the structured PCD value.

When the PcdValueInit application is built on Windows with VS compiler,
it generates a vcxxx.pdb file in the root of the edk2 repository.

For example, the following build command for the CryptoPkg that uses
a structured PCD generates vcxxx.pdb in the root of the local edk2 repo.

build -a IA32 -n 5 -t VS2019 -p CryptoPkg\CryptoPkg.dsc -m CryptoPkg\Library\OpensslLib\OpensslLib.inf genc

The debug information for the PcdValueInit application should be generated
in the build output directory for this application which is in the path:

Build\CryptoPkg\All\DEBUG_VS2019\PcdValueInit

The C files in this application are built with the /Zi flag that generates
the application PDB in a separate file.

One solution is to use the /Z7 flag instead that embeds the symbol information
in the obj/exe.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19945</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-05 15:35:57 +0000</bug_when>
    <thetext>The CFLAGS settings for building tool applications are in the file:

BaseTools/Source/C/Makefiles/ms.common

The recommended change is:

-CFLAGS = $(CFLAGS) /nologo /Zi /c /O2 /MT /W4 /WX /D _CRT_SECURE_NO_DEPRECATE /D _CRT_NONSTDC_NO_DEPRECATE
+CFLAGS = $(CFLAGS) /nologo /Z7 /c /O2 /MT /W4 /WX /D _CRT_SECURE_NO_DEPRECATE /D _CRT_NONSTDC_NO_DEPRECATE

There are no issues with building tools with embedded symbol information.  This is not done for FW components
to minimize the size of FW images.  Tools that execute in the host build environment do not have these
same size restrictions.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19946</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-05 16:36:23 +0000</bug_when>
    <thetext>Email review patch

https://edk2.groups.io/g/devel/message/95978</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19972</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-08 17:48:12 +0000</bug_when>
    <thetext>Commit:

https://github.com/tianocore/edk2/commit/0be81a4d83810cdb018d293bc264f489e7664043

PR:

https://github.com/tianocore/edk2/pull/3598</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4786</bug_id>
          
          <creation_ts>2024-06-11 16:21:38 +0000</creation_ts>
          <short_desc>UefiPayloadPkg boot to support FDT as input data</short_desc>
          <delta_ts>2024-08-28 11:19:06 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>linus.liu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23106</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2024-06-11 16:21:38 +0000</bug_when>
    <thetext>Currently UPL boot will only take hob as input data but hob is not widely used so in UPL spec community we decide to support FDT which has been used by different OS and boot loaders.

Relevant UPL spec update is under reviewing and code implementation PR is also under reviewing.

Spec: https://github.com/UniversalPayload/spec/pull/6
PR: https://github.com/tianocore/edk2/pull/5669</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23107</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2024-06-11 16:22:35 +0000</bug_when>
    <thetext>team is working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23108</commentid>
    <comment_count>2</comment_count>
      <attachid>1518</attachid>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2024-06-12 06:28:02 +0000</bug_when>
    <thetext>Created attachment 1518
FDT</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23145</commentid>
    <comment_count>3</comment_count>
      <attachid>1520</attachid>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2024-06-20 21:53:19 +0000</bug_when>
    <thetext>Created attachment 1520
FDT_update_Serial_Node</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23181</commentid>
    <comment_count>4</comment_count>
      <attachid>1524</attachid>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2024-07-07 22:12:58 +0000</bug_when>
    <thetext>Created attachment 1524
FDT_Roll_back_Serial_port_to_PCI_node</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23228</commentid>
    <comment_count>5</comment_count>
      <attachid>1525</attachid>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2024-07-15 21:26:31 +0000</bug_when>
    <thetext>Created attachment 1525
add_lpss_serilal_node</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23240</commentid>
    <comment_count>6</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2024-07-17 20:16:24 +0000</bug_when>
    <thetext>The updated UPL spec has published to cover FDT detail: https://universalpayload.github.io/spec/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23307</commentid>
    <comment_count>7</comment_count>
      <attachid>1533</attachid>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2024-08-08 22:29:55 +0000</bug_when>
    <thetext>Created attachment 1533
FDT_IsIsaCompatible_False</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23308</commentid>
    <comment_count>8</comment_count>
      <attachid>1534</attachid>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2024-08-08 22:31:54 +0000</bug_when>
    <thetext>Created attachment 1534
FDT_IsIsaCompatible_True</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23317</commentid>
    <comment_count>9</comment_count>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2024-08-13 02:20:54 +0000</bug_when>
    <thetext>[Add FDT support]
Change history

*08/11
-1. BusBase should be within Base and Limit.

*08/09
-1 . Update Build BuildFdtForSerial method condition.

*08/08
-1 update feedback UNIVERSAL_PAYLOAD_SERIAL_PORT_PARENT_DEVICE_INFO
-IsIsaCompatible
-2. remove UniversalPayloadBase.h
-3. remove gUniversalPayloadDeviceTreeGuid

*08/05
-1 Create BuildFdtLib.

*08/04
-1 add gUniversalPayloadSerialPortParentDeviceInfoGuid for Seial port.

*07/31
-1 .remove unused pcd, function prototypes , header file and package.
-2. add PcdFDTPageSize for allocate FDT memory size.
-3. Fix the system can&apos;t boot to OS due to add wrong node.

*07/15

add BuildFdtForSerialLpss() and BuildFdtForSerial for serial
add PcdPchBus for serial device node
*07/04
-1 roll back espi node solution.

*06/25
-1. move out index-- to for loop.
-2 . limit Depth == 1 to parse memory node ,
or will parse the nodes under reserved memory node.
-3. Remove Reserved memory - GUID property.

*06/24
-1. skip EFI_RESOURCE_SYSTEM_MEMORY hob when copy hobs

*06/20
-1. only support frambuffer format - rgb/bgr
-2. get dynamic grphic device name for GraphicsDev hob init.
-3 . add espi node.
-4. move serial node under espi node.

*06/13
-1. replace upl-params mode &apos;s &quot;addr-width&quot; instead of &quot;addr_width&quot;
-2. Sync UNIVERSAL_PAYLOAD_PCI_ROOT_BRIDGES-&gt;ResourceAssigned
with PciEnumDone, and config PciEnumDone as False for Client.
-3. update index before for loop.

*06/12
-1. Per feedback, init Fdt as NULL and return EFI_UNSUPPORTED
when Fdt wasn&apos;t available in BuildFitLoadablesFvHob.
-2. Add SizeOfIoSpace PCD
-3. Disable if (Depth != 1) restricted.
-4. Remove unused gUniversalPayloadBaseGuid
and gUniversalPayloadDeviceTreeGuid
-5. Init RootBridge index with RootBridgeCount -1
-6. Add framebuffer node -display filed
-7. Remove serial PCD in PcdsPatchableInModule.X64,
use PcdsPatchableInModule.common
-8. Correct the address value of the SMBIOS table.
-9. Use memory type to detect and init pci rb memory.
-10. Update serial node format.
-11. Add Gma device node.
-12. Fill out GraphicsDev with gma node.

*05/30
-1. Update feedback serial mode format update..

*05/22
-1. Remove SmmRelocationLib in dsc file.

*05/15
-1. remove code for NumberOfBytes -= MinimalNeededSize.
-2. Clean PciRootBridgeInfo before using it.

*05/13
-1. Remove EndOfPeiPpiNotifyCallback.

*05/06
-1. Remove PrintLib
-2. Remove unused Guids
-3. modify the sequence of gReadyToPayloadSignalPpi call back.
-4. change gEfiReadyToPayloadPpiGuid to gUplReadyToPayloadPpiGuid.
-5. correct the MemoryBottom value.

*04/24
-1. Fix IA32 build error

*0416
-1. Correct DMARegData index.
-2. Fix the system can&apos;t enter windows
-3. PcdPciReservedPMemBase duplicate to Uefipayloadpkg.
-4. SUPPORTED_ARCHITECTURES remove IA32.
-5. Update pci-rb address for PCD/PCH.
-6. Fix Coding style of define.
-7. Fix CI build error.
-8. Fix root-bridge count=1 cause the system assert.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23335</commentid>
    <comment_count>10</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2024-08-21 10:04:15 +0000</bug_when>
    <thetext>UPL spec FDT section is ready: https://universalpayload.github.io/spec/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23349</commentid>
    <comment_count>11</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2024-08-28 11:10:49 +0000</bug_when>
    <thetext>Changes have been merged by this PR: https://github.com/tianocore/edk2/pull/6095
We will close rest of the PRs as they were all incorporated to the final PR above.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23350</commentid>
    <comment_count>12</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2024-08-28 11:19:06 +0000</bug_when>
    <thetext>Resolved by PR: https://github.com/tianocore/edk2/pull/6095</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1518</attachid>
            <date>2024-06-12 06:28:02 +0000</date>
            <delta_ts>2024-06-12 06:28:02 +0000</delta_ts>
            <desc>FDT</desc>
            <filename>fdt.log</filename>
            <type>application/octet-stream</type>
            <size>24444</size>
            <attacher name="Linus Liu">linus.liu</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1520</attachid>
            <date>2024-06-20 21:53:19 +0000</date>
            <delta_ts>2024-06-20 21:53:19 +0000</delta_ts>
            <desc>FDT_update_Serial_Node</desc>
            <filename>FDT0620_1.log</filename>
            <type>application/octet-stream</type>
            <size>25011</size>
            <attacher name="Linus Liu">linus.liu</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1524</attachid>
            <date>2024-07-07 22:12:58 +0000</date>
            <delta_ts>2024-07-07 22:12:58 +0000</delta_ts>
            <desc>FDT_Roll_back_Serial_port_to_PCI_node</desc>
            <filename>FDT0705.log</filename>
            <type>application/octet-stream</type>
            <size>24992</size>
            <attacher name="Linus Liu">linus.liu</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1525</attachid>
            <date>2024-07-15 21:26:31 +0000</date>
            <delta_ts>2024-07-15 21:26:31 +0000</delta_ts>
            <desc>add_lpss_serilal_node</desc>
            <filename>fdt0712.log</filename>
            <type>application/octet-stream</type>
            <size>25889</size>
            <attacher name="Linus Liu">linus.liu</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1533</attachid>
            <date>2024-08-08 22:29:55 +0000</date>
            <delta_ts>2024-08-08 22:29:55 +0000</delta_ts>
            <desc>FDT_IsIsaCompatible_False</desc>
            <filename>FDT_IsIsaCompatible_False.log</filename>
            <type>application/octet-stream</type>
            <size>33902</size>
            <attacher name="Linus Liu">linus.liu</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1534</attachid>
            <date>2024-08-08 22:31:54 +0000</date>
            <delta_ts>2024-08-08 22:31:54 +0000</delta_ts>
            <desc>FDT_IsIsaCompatible_True</desc>
            <filename>FDT_IsIsaCompatible_True.log</filename>
            <type>application/octet-stream</type>
            <size>34262</size>
            <attacher name="Linus Liu">linus.liu</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4013</bug_id>
          
          <creation_ts>2022-08-05 04:08:04 +0000</creation_ts>
          <short_desc>Update the SMBIOS version  by UPL</short_desc>
          <delta_ts>2022-08-21 22:21:44 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Kasim Liu">kasimx.liu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19361</commentid>
    <comment_count>0</comment_count>
    <who name="Kasim Liu">kasimx.liu</who>
    <bug_when>2022-08-05 04:08:04 +0000</bug_when>
    <thetext>To get the gUniversalPayloadSmbios3TableGuid HOB by UPL created, then update the Smbios version</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19370</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-09 21:37:00 +0000</bug_when>
    <thetext>Kasim: what means UPL? Can you provide more detail about this issue?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19414</commentid>
    <comment_count>2</comment_count>
    <who name="Kasim Liu">kasimx.liu</who>
    <bug_when>2022-08-21 22:21:44 +0000</bug_when>
    <thetext>It&apos;s resolved by https://github.com/tianocore/edk2/pull/3188.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4482</bug_id>
          
          <creation_ts>2023-06-12 10:45:39 +0000</creation_ts>
          <short_desc>Update OpenSSL 1.1.1t to 1.1.1u</short_desc>
          <delta_ts>2023-07-28 00:42:40 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Miki Demeter">miki.demeter</reporter>
          <assigned_to name="Sheng Wei">w.sheng</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>lelia.c.barlow</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21655</commentid>
    <comment_count>0</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-06-12 10:45:39 +0000</bug_when>
    <thetext>To address CVE-2023-2650 we need to update to OpenSSL 1.1.1u</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21748</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:40:53 +0000</bug_when>
    <thetext>w.sheng@intel.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21780</commentid>
    <comment_count>2</comment_count>
    <who name="Sheng Wei">w.sheng</who>
    <bug_when>2023-07-27 22:40:56 +0000</bug_when>
    <thetext>patch is merged.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21781</commentid>
    <comment_count>3</comment_count>
    <who name="Sheng Wei">w.sheng</who>
    <bug_when>2023-07-28 00:42:40 +0000</bug_when>
    <thetext>Here is the patch link.
https://github.com/tianocore/edk2/commit/b2de9ec5a759aa4a7ac029cda9079dce077bf856</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4337</bug_id>
          
          <creation_ts>2023-02-07 21:44:54 +0000</creation_ts>
          <short_desc>Add SMM Base HOB for SmBase relocation</short_desc>
          <delta_ts>2023-05-06 02:44:53 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="jiaxinwu">jiaxin.wu</reporter>
          <assigned_to name="jiaxinwu">jiaxin.wu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiaxin.wu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20999</commentid>
    <comment_count>0</comment_count>
    <who name="jiaxinwu">jiaxin.wu</who>
    <bug_when>2023-02-07 21:44:54 +0000</bug_when>
    <thetext>Background:

Existing SMBASE Relocation is in the PiSmmCpuDxeSmm driver, which will relocate the SMBASE of each processor by setting the SMBASE field in the saved state map (at offset 7EF8h) to a new value. The RSM instruction reloads the internal SMBASE register with the value in SMBASE field when each time it exits SMM. All subsequent SMI requests will use the new SMBASE to find the starting address for the SMI handler (at SMBASE + 8000h). 

Due to the default SMBASE for all x86 processors is 0x30000, the APs&apos; 1st SMI for rebase has to be executed one by one to avoid the CPUs over-writing each other&apos;s SMM Save State Area (see existing SmmRelocateBases() function), which means the next AP has to wait for the previous AP to finish its 1st SMI, then it can call into its 1st SMI for rebase via Smi Ipi command, thus leading the existing SMBASE Relocation has to be running in series. Besides, it needs very complex code to handle the AP exit semaphore (mRebased[Index]), which will hook return address of SMM Save State so that semaphore code can be executed immediately after AP exits SMM for SMBASE relocation (see existing SemaphoreHook() function). 

This is the request to add the new SMM Base HOB for any PEI module to do the SmBase relocation ahead of PiSmmCpuDxeSmm driver and store the relocated SmBase address in array for each Processors. When the SMBASE relocation happens in a PEI module, the PEI module shall produce the SMM_BASE_HOB in HOB database which tells the PiSmmCpuDxeSmm driver (runs at a later phase) about the new SMBASE for each CPU thread. PiSmmCpuDxeSmm driver installs the SMI handler at the SMM_BASE_HOB.SmBase[Index]+0x8000 for CPU thread Index. When the HOB doesn&apos;t exist, PiSmmCpuDxeSmm driver shall relocate and program the new SMBASE itself (keep existing SMBASE Relocation way).

With above SMM Base Hob support, PiSmmCpuDxeSmm does not need the RSM instruction to do the SMBASE Relocation. SMBASE Register for each processors have already been programmed and all SMBASE address have recorded in SMM Base Hob. So the same default SMBASE Address (0x30000) will not be used, thus the CPUs over-writing each other&apos;s SMM Save State Area will not happen in PiSmmCpuDxeSmm driver. This way makes the first SMI init can be executed in parallel and save boot time on multi-core system. Besides, Semaphore Hook code logic is also not required, which will greatly simplify the SMBASE Relocation flow.

Note:
This is the new way that firmware can program the SMBASE independently of the RSM instruction. The PEI code performing this logic will not be open sourced, similarly to other things that are kept binary-only in the FSP. Due to the register difference in different vender, and it has not been documented in the Intel SDM yet, we need a new binary-only interface for SMM Base HOB.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21000</commentid>
    <comment_count>1</comment_count>
    <who name="jiaxinwu">jiaxin.wu</who>
    <bug_when>2023-02-07 22:01:24 +0000</bug_when>
    <thetext>SMBASE relocation process needs to program the vender specific hardware interface to set SMBASE, it should be in thread scope. It&apos;s doable to program the hardware interface using DXE MP service protocol in CpuSmm driver&apos;s entry point. But, considering the standalone MM environment where the CpuMm driver runs in a isolated environment and it cannot invoke any DXE or PEI MP service, we recommend to put the hardware interface programming in a separate PEI module instead of in the PiSmmCpuDxeSmm driver.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21498</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-06 02:44:53 +0000</bug_when>
    <thetext>Fix in Edk2 7b8c5a8eb42a404cad208e972f977ffacb1c8446</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4812</bug_id>
          
          <creation_ts>2024-07-15 03:15:55 +0000</creation_ts>
          <short_desc>MdePkg/BaseLib: Optimize LOONGARCH64 csr usage</short_desc>
          <delta_ts>2024-09-04 21:32:57 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>qiandongyan</reporter>
          <assigned_to>qiandongyan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23226</commentid>
    <comment_count>0</comment_count>
    <who name="">qiandongyan</who>
    <bug_when>2024-07-15 03:15:55 +0000</bug_when>
    <thetext>When the Select is out of support, use method break exception
instead of method return -1, avoid unknown errors caused by untimely
detection.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23372</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-09-04 20:49:59 +0000</bug_when>
    <thetext>qiandongyan@loongson.cn: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23377</commentid>
    <comment_count>2</comment_count>
    <who name="">qiandongyan</who>
    <bug_when>2024-09-04 21:32:57 +0000</bug_when>
    <thetext>This issue has been fixed: https://github.com/tianocore/edk2/pull/5915</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4036</bug_id>
          
          <creation_ts>2022-08-29 03:55:01 +0000</creation_ts>
          <short_desc>CryptoPkg: Add AeadAesGcm support</short_desc>
          <delta_ts>2022-09-23 04:49:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="qi1.zhang@intel.com">qi1.zhang</reporter>
          <assigned_to name="qi1.zhang@intel.com">qi1.zhang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19443</commentid>
    <comment_count>0</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-08-29 03:55:01 +0000</bug_when>
    <thetext>CryptoPkg: Add AeadAesGcm support</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19444</commentid>
    <comment_count>1</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-08-29 03:56:45 +0000</bug_when>
    <thetext>Add AeadAesGcmEncrypt() and AeadAesGcmDecrypt()</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19619</commentid>
    <comment_count>2</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-09-23 04:49:19 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3388</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4661</bug_id>
          
          <creation_ts>2024-01-31 22:29:13 +0000</creation_ts>
          <short_desc>Refine Crypto macro define for CRYPTO_PROTOCOL_SUPPORT</short_desc>
          <delta_ts>2024-02-01 22:00:02 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>mars_cc_lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22486</commentid>
    <comment_count>0</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2024-01-31 22:29:13 +0000</bug_when>
    <thetext>There is potential build problem when CRYPTO_PROTOCOL_SUPPORT is set to TRUE and CRYPTO_DRIVER_EXTERNAL_SUPPORT is set to TRUE.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22487</commentid>
    <comment_count>1</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2024-01-31 22:35:30 +0000</bug_when>
    <thetext>will add CRYPTO_DRIVER_EXTERNAL_SUPPORT == FALSE to remove gEfiCryptoPkgTokenSpaceGuid definition.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22499</commentid>
    <comment_count>2</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2024-02-01 21:59:48 +0000</bug_when>
    <thetext>The PR had merged. 
close this bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22500</commentid>
    <comment_count>3</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2024-02-01 22:00:02 +0000</bug_when>
    <thetext>https://bugzilla.tianocore.org/show_bug.cgi?id=4661</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4372</bug_id>
          
          <creation_ts>2023-03-14 05:05:21 +0000</creation_ts>
          <short_desc>Correct-MAX_LOGICAL_PROCESSORS-value</short_desc>
          <delta_ts>2023-03-17 04:52:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>mars_cc_lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21186</commentid>
    <comment_count>0</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-03-14 05:05:21 +0000</bug_when>
    <thetext>Correct-MAX_LOGICAL_PROCESSORS-value to 1024</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21187</commentid>
    <comment_count>1</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-03-14 05:05:36 +0000</bug_when>
    <thetext>I&apos;m working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21209</commentid>
    <comment_count>2</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-03-17 04:52:43 +0000</bug_when>
    <thetext>Had implemented the change. 
link: https://github.com/tianocore/edk2/pull/4141</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4188</bug_id>
          
          <creation_ts>2022-12-09 16:01:43 +0000</creation_ts>
          <short_desc>BinToPcd.py - xdrlib is deprecated in Python 3.11; removal in Python 3.13</short_desc>
          <delta_ts>2023-08-07 12:35:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>bob.c.feng</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>joeyvagedes</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20201</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-12-09 16:01:43 +0000</bug_when>
    <thetext>BinToPcd.py - https://github.com/tianocore/edk2/blob/master/BaseTools/Scripts/BinToPcd.py

---

Imports xdrlib:

import sys
import argparse
import re
import xdrlib  &lt;----- import here

---

Python deprecation statement: https://docs.python.org/3/library/xdrlib.html

Deprecated since version 3.11, will be removed in version 3.13: The xdrlib module is deprecated (see PEP 594 for details).

---

The deprecated modules table does not list an immediate replacement: https://peps.python.org/pep-0594/#deprecated-modules</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20238</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-12-20 21:47:20 +0000</bug_when>
    <thetext>Mike will take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20246</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-12-20 22:05:47 +0000</bug_when>
    <thetext>Great info on xdrlib being deprecated.

The following PCD used for capsule update depends on the XDR
format.

    PcdFmpDevicePkcs7CertBufferXdr

The BinToPcd tool should be updated to remove its dependency on
xdrlib and replaced with a simple algorithm to generated
the required output.  Only the Varible-length Opaque Data
encoding is required:

    https://www.rfc-editor.org/rfc/rfc4506#page-9

This is 4-byte length, followed by data bytes, followed by
zero padding to a 4-byte aligned total length.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21694</commentid>
    <comment_count>3</comment_count>
      <attachid>1380</attachid>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-06-27 12:14:52 +0000</bug_when>
    <thetext>Created attachment 1380
Fuzz to compare old and new xdr pack logic.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21695</commentid>
    <comment_count>4</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-06-27 12:15:36 +0000</bug_when>
    <thetext>Michael Kenney, I will be submitting a patch to resolve this. I implemented custom logic to mimic the xdrlib logic for our needs.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21807</commentid>
    <comment_count>5</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-08-07 12:34:52 +0000</bug_when>
    <thetext>This was closed via https://github.com/tianocore/edk2/pull/4708</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21808</commentid>
    <comment_count>6</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-08-07 12:35:45 +0000</bug_when>
    <thetext>his was merged via https://github.com/tianocore/edk2/pull/4708</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1380</attachid>
            <date>2023-06-27 12:14:52 +0000</date>
            <delta_ts>2023-06-27 12:14:52 +0000</delta_ts>
            <desc>Fuzz to compare old and new xdr pack logic.</desc>
            <filename>xdrfuzz.py</filename>
            <type>text/x-python</type>
            <size>2005</size>
            <attacher name="Joey Vagedes">joeyvagedes</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4836</bug_id>
          
          <creation_ts>2024-08-22 13:08:12 +0000</creation_ts>
          <short_desc>Add error log messages if RngDxe/Hash2CryptoDxe not being installed causes Network failures</short_desc>
          <delta_ts>2024-08-22 13:19:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Saloni Kasbekar">saloni.kasbekar</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23338</commentid>
    <comment_count>0</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-08-22 13:08:12 +0000</bug_when>
    <thetext>RngDxe/Hash2CryptoDxe not being installed by the platform causes Network failures. It is hard to debug this due to lack of error messages.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23339</commentid>
    <comment_count>1</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-08-22 13:19:03 +0000</bug_when>
    <thetext>The failures are due to DEPEX. Cannot execute debug messages if DEPEX is not met.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4063</bug_id>
          
          <creation_ts>2022-09-15 09:06:07 +0000</creation_ts>
          <short_desc>IntelFsp2Pkg: NvsBufferPtr is missing in Fsp24ApiEntryM.nasm</short_desc>
          <delta_ts>2022-09-21 04:59:48 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>ted.kuo</reporter>
          <assigned_to>ted.kuo</assigned_to>
          <cc>chasel.chiu</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19569</commentid>
    <comment_count>0</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2022-09-15 09:06:07 +0000</bug_when>
    <thetext>FSPM_UPD_COMMON_FSP24 defined in in Fsp24ApiEntryM.nasm doesn&apos;t align with FSP 2.4 SPEC.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19570</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-09-15 13:03:49 +0000</bug_when>
    <thetext>Thanks for fixing this issue, patch has been merged:
https://github.com/tianocore/edk2/commit/981bf66d5a7b1a31be5ffccc15fe13b97300e124

Please verify with latest.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19605</commentid>
    <comment_count>2</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2022-09-21 04:59:48 +0000</bug_when>
    <thetext>Confirmed the patch working fine. We can close it.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4682</bug_id>
          
          <creation_ts>2024-02-13 15:24:04 +0000</creation_ts>
          <short_desc>regression from commit 725acd0b9cc0 when &quot;gSmmBaseHobGuid&quot; GUID HOB is absent -- NULL ptr deref in PiSmmCpuDxeSmm</short_desc>
          <delta_ts>2024-02-15 03:03:12 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>regression</keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Laszlo Ersek">laszlo.ersek</assigned_to>
          <cc>dun.tan</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>kraxel</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22572</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2024-02-13 15:24:04 +0000</bug_when>
    <thetext>Commit 725acd0b9cc0 (&quot;UefiCpuPkg: Avoid assuming only one smmbasehob&quot;,
2023-12-12) introduced a NULL pointer dereference to PiSmmCpuDxeSmm on such platforms that do not produce the &quot;gSmmBaseHobGuid&quot; GUID HOB at all.

Please see the multi-step analysis in the following thread:

[edk2-devel] [PATCH 1/1] OvmfPkg/QemuVideoDxe: purge VbeShim
https://edk2.groups.io/g/devel/message/115377
message-id: &lt;20240213085925.687848-1-kraxel@redhat.com&gt;

This issue needs to be fixed for edk2-stable202402.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22573</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2024-02-13 15:25:13 +0000</bug_when>
    <thetext>Working on patches.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22574</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2024-02-13 16:13:17 +0000</bug_when>
    <thetext>[edk2-stable202402 PATCH 0/2]
UefiCpuPkg/PiSmmCpuDxeSmm: fix NULL deref when gSmmBaseHobGuid is missing

https://edk2.groups.io/g/devel/message/115416
msgid &lt;20240213210918.16372-1-lersek@redhat.com&gt;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22600</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2024-02-15 03:03:12 +0000</bug_when>
    <thetext>Fixed in commit range 5fd3078a2e08..edc6681206c1; merged via &lt;https://github.com/tianocore/edk2/pull/5373&gt;.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4543</bug_id>
          
          <creation_ts>2023-08-30 01:27:18 +0000</creation_ts>
          <short_desc>In some cases, LocateHandleBuffer() may allocate a callee freed buffer when an error occurs</short_desc>
          <delta_ts>2023-08-31 16:32:37 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Nathaniel L DeSimone">nathaniel.l.desimone</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21872</commentid>
    <comment_count>0</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2023-08-30 01:27:18 +0000</bug_when>
    <thetext>CoreLocateHandleBuffer() in MdeModulePkg/Core/Dxe/Hand/Locate.c can in certain cases, can return an error and not cleanup a callee freed buffer. Consider the following code snippet:

  *Buffer = AllocatePool (BufferSize);
  if (*Buffer == NULL) {
    CoreReleaseProtocolLock ();
    return EFI_OUT_OF_RESOURCES;
  }

  Status = InternalCoreLocateHandle (
             SearchType,
             Protocol,
             SearchKey,
             &amp;BufferSize,
             *Buffer
             );

  *NumberHandles = BufferSize / sizeof (EFI_HANDLE);
  if (EFI_ERROR (Status)) {
    *NumberHandles = 0;
  }

  CoreReleaseProtocolLock ();
  return Status;

It is possible for InternalCoreLocateHandle() to return a non-successful status code and still have Buffer point to a valid address in the heap. This snippet should instead read:

  *Buffer = AllocatePool (BufferSize);
  if (*Buffer == NULL) {
    CoreReleaseProtocolLock ();
    return EFI_OUT_OF_RESOURCES;
  }

  Status = InternalCoreLocateHandle (
             SearchType,
             Protocol,
             SearchKey,
             &amp;BufferSize,
             *Buffer
             );

  *NumberHandles = BufferSize / sizeof (EFI_HANDLE);
  if (EFI_ERROR (Status)) {
    *NumberHandles = 0;
    if (*Buffer != NULL) {
      FreePool (*Buffer);
      *Buffer = NULL;
    }
  }

  CoreReleaseProtocolLock ();
  return Status;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21883</commentid>
    <comment_count>1</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2023-08-31 16:30:43 +0000</bug_when>
    <thetext>Working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21884</commentid>
    <comment_count>2</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2023-08-31 16:31:41 +0000</bug_when>
    <thetext>Patch sent: https://edk2.groups.io/g/devel/message/108149</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21885</commentid>
    <comment_count>3</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2023-08-31 16:32:37 +0000</bug_when>
    <thetext>Fixed: https://github.com/tianocore/edk2/commit/beafabd</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4093</bug_id>
          
          <creation_ts>2022-10-04 20:55:21 +0000</creation_ts>
          <short_desc>Abstract SmmCpuFeaturesLib for sharing common code</short_desc>
          <delta_ts>2022-11-18 22:17:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19702</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-10-04 20:55:21 +0000</bug_when>
    <thetext>Abstract SmmCpuFeaturesLib for sharing common code with other archs. Strip away Intel implementation and put it in the Intel-specific source file. Other processor archs/vendors can provide the arch/vendor specific implementation and also leverage the common code.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19703</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-10-04 20:55:54 +0000</bug_when>
    <thetext>Assign to Abner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19751</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-11 21:47:35 +0000</bug_when>
    <thetext>Abner is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20061</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-11-18 22:17:19 +0000</bug_when>
    <thetext>Fixed at 957a15ad</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4722</bug_id>
          
          <creation_ts>2024-03-05 22:09:15 +0000</creation_ts>
          <short_desc>Platform/Intel/MinPlatformPkg: Always reboot because of &quot;Memory Type Information settings change&quot;</short_desc>
          <delta_ts>2024-03-05 23:34:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ming Tan">ming.tan</reporter>
          <assigned_to name="Ming Tan">ming.tan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22722</commentid>
    <comment_count>0</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2024-03-05 22:09:15 +0000</bug_when>
    <thetext>There is a compatibility issue about EfiMaxMemoryType after upgrade BIOS.

If there is a change about enum EFI_MEMORY_TYPE
in edk2\MdePkg\Include\Uefi\UefiMultiPhase.h, such as add a new memory type
like EfiUnacceptedMemoryType, then the EfiMaxMemoryType will be change.
then the old BIOS will store EFI variable MemoryTypeInformation with old
value of EfiMaxMemoryType, but after upgrade to new BIOS, new BIOS will use
new value of EfiMaxMemoryType, then it will cause issue, such as the system
will continue reboot because of &quot;Memory Type Information settings change&quot;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22723</commentid>
    <comment_count>1</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2024-03-05 22:09:42 +0000</bug_when>
    <thetext>I will submit a patch for this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22730</commentid>
    <comment_count>2</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2024-03-05 22:13:30 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/3572/commits/385a6468af791e8b80a859d85cdfe4dad054ad39 will change the EfiMaxMemoryType.
Upgrade an old BIOS without above change to a new BIOS with above change, will cause this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22733</commentid>
    <comment_count>3</comment_count>
    <who name="Ming Tan">ming.tan</who>
    <bug_when>2024-03-05 23:34:21 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2-platforms/commit/87c40ac89b97eccac690762536db5376af15bb65 already fixed this issue. Will close this bug now.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4574</bug_id>
          
          <creation_ts>2023-10-26 03:55:00 +0000</creation_ts>
          <short_desc>edk2-libc - realpath function signature doesn&apos;t match the standard</short_desc>
          <delta_ts>2023-10-29 03:18:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>dimitry.kloper</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22041</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-26 03:55:00 +0000</bug_when>
    <thetext>According to
https://pubs.opengroup.org/onlinepubs/009695399/functions/realpath.html the proposed signature of realpath() shall be

char *realpath(const char *restrict file_name,
char *restrict resolved_name);

While &quot;StdLib/Include/stdlib.h&quot; provides the following:

char *realpath (char *file_name, char *resolved_name);

While the &apos;restrict&apos; keyword is optional and may be not supported by older compilers, the &apos;const&apos; part for the first argument is critical, especially when edk2 default policy to turn warnings into errors.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22042</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-26 03:59:20 +0000</bug_when>
    <thetext>stdlib.h of edk2-libc has the following signature 
char * realpath(char *file_name, char *resolved_name);

and is not matching the signature as in IEEE standard https://pubs.opengroup.org/onlinepubs/009695399/functions/realpath.html</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22043</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-26 04:01:07 +0000</bug_when>
    <thetext>This BZ has been raised to process the PR https://github.com/tianocore/edk2-libc/pull/10

Will be sending out the email patch for review on behalf of Dimitry Kloper</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22085</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-27 04:05:13 +0000</bug_when>
    <thetext>Patch reviewed and merged to master branch of edk2-libc</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22094</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-28 07:55:52 +0000</bug_when>
    <thetext>Can you please state the commit hash of the merged patch?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22096</commentid>
    <comment_count>5</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-29 03:18:14 +0000</bug_when>
    <thetext>Below is the commit hash of the merged patch.
commit 5eccddd49914aa48e3447561ce4f2034863e34b6</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4426</bug_id>
          
          <creation_ts>2023-04-26 03:16:22 +0000</creation_ts>
          <short_desc>UefiPayloadPkg: remove llvm-objcopy dependency when replace multiple FV</short_desc>
          <delta_ts>2023-04-28 02:03:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Gua Guo">gua.guo</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>brucex.wang</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21431</commentid>
    <comment_count>0</comment_count>
    <who name="Gua Guo">gua.guo</who>
    <bug_when>2023-04-26 03:16:22 +0000</bug_when>
    <thetext>Currently, UefiPayloadPkg have llvm-objcopy dependency to replace FV, please help to remove llvm-objcopy dependency on python code.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21443</commentid>
    <comment_count>1</comment_count>
    <who name="Bruce Wang">brucex.wang</who>
    <bug_when>2023-04-27 02:20:21 +0000</bug_when>
    <thetext>This task is ongoing in progress.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21444</commentid>
    <comment_count>2</comment_count>
    <who name="Bruce Wang">brucex.wang</who>
    <bug_when>2023-04-27 02:42:01 +0000</bug_when>
    <thetext>Pull request as follow:
https://github.com/tianocore/edk2/pull/4318</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21455</commentid>
    <comment_count>3</comment_count>
    <who name="Bruce Wang">brucex.wang</who>
    <bug_when>2023-04-28 02:03:32 +0000</bug_when>
    <thetext>Code change is merge into tianocore:master.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4251</bug_id>
          
          <creation_ts>2023-01-04 09:54:42 +0000</creation_ts>
          <short_desc>OVMF IA32X64 boot failure on TCG, due to MMIO address space conflict</short_desc>
          <delta_ts>2023-01-18 06:24:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>regression</keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Gerd Hoffmann">kraxel</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20486</commentid>
    <comment_count>0</comment_count>
      <attachid>1126</attachid>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-04 09:54:42 +0000</bug_when>
    <thetext>Created attachment 1126
tarball of domain XMLs, libvirtd logs (QEMU cmdlines), and firmware logs

QEMU: 222059a0fccf, plus the QEMU fix noted in bug 4250 applied

edk2: 9ce09870e721, plus the patch for bug 4250 applied

I&apos;ve noticed that, after switching my IA32X64 and X64 domains from KVM
to TCG accel (in order to test the patch for bug 4250), the firmware
would not boot past the PCI resource assignment.

The reason is that with TCG, two things change, relative to KVM:

- some of the entries exposed to OVMF via the E820 map (fw_cfg) change,
  thereby changing the GCD memory space map

- the CPU address width changes, and with that, the accessible 64-bit
  PCI MMIO aperture.

The result is that, when the PCI host bridge driver tries to add the
large 64-bit PCI MMIO aperture to the GCD memory space map, it conflicts
with the entry added previously due to the E820 map update.

This affects both &quot;pc&quot; and &quot;q35&quot;.

Log excerpt:

&gt;| diff -u -r good/fw/ovmf.rhel79.pc.log bad/fw/ovmf.rhel79.pc.log
&gt;| --- good/fw/ovmf.rhel79.pc.log  2023-01-04 14:56:28.068851596 +0100
&gt;| +++ bad/fw/ovmf.rhel79.pc.log   2023-01-04 14:56:28.065851583 +0100
&gt;|
&gt;| -PlatformScanOrAdd64BitE820Ram: Base=0xFEFFC000 Length=0x4000 Type=2
&gt;| +PlatformScanOrAdd64BitE820Ram: Base=0xFD00000000 Length=0x300000000 Type=2
&gt;|
&gt;| -PlatformAddressWidthFromCpuid: Signature: &apos;GenuineIntel&apos;, PhysBits: 40, QemuQuirk: On, Valid: No
&gt;| -AddressWidthInitialization: Pci64Base=0x800000000 Pci64Size=0x800000000
&gt;| +PlatformAddressWidthFromCpuid: Signature: &apos;AuthenticAMD&apos;, PhysBits: 40, QemuQuirk: On, Valid: Yes
&gt;| +PlatformDynamicMmioWindow: using dynamic mmio window
&gt;| +PlatformDynamicMmioWindow:   Addr Space 0x10000000000 (1024 GB)
&gt;| +PlatformDynamicMmioWindow:   MMIO Space 0x2000000000 (128 GB)
&gt;| +PlatformDynamicMmioWindow:   Pci64 Base 0xE000000000
&gt;| +PlatformDynamicMmioWindow:   Pci64 Size 0x2000000000
&gt;| +AddressWidthInitialization: Pci64Base=0xE000000000 Pci64Size=0x2000000000
&gt;|
&gt;| -PublishPeiMemory: PhysMemAddressWidth=36 PeiMemoryCap=65544 KB
&gt;| -PeiInstallPeiMemory MemoryBegin 0xBBF66000, MemoryLength 0x4002000
&gt;| +PublishPeiMemory: PhysMemAddressWidth=40 PeiMemoryCap=65548 KB
&gt;| +PeiInstallPeiMemory MemoryBegin 0xBBF65000, MemoryLength 0x4003000
&gt;|
&gt;| -PlatformScanOrAdd64BitE820Ram: Base=0xFEFFC000 Length=0x4000 Type=2
&gt;| -PlatformScanOrAdd64BitE820Ram: Reserved: Base=0xFEFFC000 Length=0x4000
&gt;| +PlatformScanOrAdd64BitE820Ram: Base=0xFD00000000 Length=0x300000000 Type=2
&gt;| +PlatformScanOrAdd64BitE820Ram: Reserved: Base=0xFD00000000 Length=0x300000000

Note in particular here that we&apos;re adding a *reserved* memory resource
HOB here, from commit bf65d7ee8842 (&quot;OvmfPkg/PlatformInitLib: pass
through reservations from qemu&quot;, 2022-12-23), at
[0xFD_0000_0000..0x100_0000_0000)

A bit higher above, we also record [0xE0_0000_0000..0x100_0000_0000) for
the 64-bit PCI MMIO aperture.

Later, we get:

&gt;|  RootBridge: PciRoot(0x0)
&gt;|    Support/Attr: 70069 / 70069
&gt;|      DmaAbove4G: No
&gt;|  NoExtConfSpace: Yes
&gt;|       AllocAttr: 3 (CombineMemPMem Mem64Decode)
&gt;|             Bus: 0 - FF Translation=0
&gt;|              Io: C000 - FFFF Translation=0
&gt;|             Mem: C0000000 - FBFFFFFF Translation=0
&gt;| -    MemAbove4G: 800000000 - FFFFFFFFF Translation=0
&gt;| +    MemAbove4G: E000000000 - FFFFFFFFFF Translation=0
&gt;|            PMem: FFFFFFFFFFFFFFFF - 0 Translation=0
&gt;|     PMemAbove4G: FFFFFFFFFFFFFFFF - 0 Translation=0

and

&gt;| -PciHostBridgeDxe: IntersectMemoryDescriptor: add [800000000, 1000000000): Success
&gt;| +PciHostBridgeDxe: IntersectMemoryDescriptor: add [E000000000, FD00000000): Success
&gt;| +PciHostBridgeDxe: IntersectMemoryDescriptor: desc [FD00000000, 10000000000) type 1 cap 8000000000026000 conflicts with aperture [E000000000, 10000000000) cap 1
&gt;| +ASSERT_EFI_ERROR (Status = Invalid Parameter)
&gt;| +ASSERT /home/lacos/src/upstream/edk2/MdeModulePkg/Bus/Pci/PciHostBridgeDxe/PciHostBridge.c(550): !(((INTN)(RETURN_STATUS)(Status)) &lt; 0)

Here&apos;s what PciHostBridgeDxe is doing here: it tries to add the 64-bit
PCI MMIO aperture to the GCD memory space map, but not *naively*.

Originally, every platform had its own PciHostBridgeDxe driver.  In
commit range 9ab925fdf722..4a50cf4ebd7e, in Januar 2016, Ray factored
out the PciHostBridgeLib class, for abstracting away platform specifics,
and introduced the generic PciHostBridgeDxe driver.

At commit 4a50cf4ebd7e, the generic driver would just &quot;naively&quot; call
gDS-&gt;AddIoSpace() and gDS-&gt;AddMemorySpace(), for adding the IO Port and
MMIO apertures to the GCD IO and Memory space maps. This was a problem:
some platforms, such as OvmfPkg, would pre-populate the GCD (Global
Coherency Domain) IO and Memory space maps by producing various Resource
Descriptor HOBs during PEI, which the DXE Core would turn into GCD
entries upon starting the DXE phase. And then, when PciHostBridgeDxe
called said DXE Services sometime later in the DXE phase, the additions
would conflict (overlap) with the previously created GCD entries --
*even if* the actual goal was the same! (That is, even if the DXE
services in question would just re-create the already existing GCD
entries.)

Another issue was that, with PXB (PCI(e) Expander Bridge), OVMF would
expose multiple root bridges or complexes, but all those would share the
same apertures. Another way to trigger the same conflict.

In order to handle this, I wrote what later became commit 6474f1f156ee
(&quot;MdeModulePkg/PciHostBridge: Don&apos;t assume resources are fully
NonExistent&quot;, 2016-02-26). The logic there is the following:

- grab the current GCD entries

- in sequence, intersect each entry with the aperture we want to add

- if the intersection is empty (the existent GCD entry falls outside of
  our desired aperture), skip -- the GCD entry is irrelevant for us, so
  continue with the next GCD entry

- if the intersection is *not* empty, then there are three cases:

  - the GCD entry we&apos;re overlapping is the exact same type we&apos;re trying
    to add (IO for IO, MMIO for MMIO), *and* the GCD provides all the
    capabilities we need in our aperture. In this case again, we&apos;re
    done, continue with the next GCD entry. This branch means that part
    of our grand aperture is already correctly present in the GCD map.

  - if the GCD entry is &quot;NonExistent&quot;, then fill in *just that gap* (=
    fill in the intersection) with our desired aperture type. This
    branch means that we *populate* the GCD map with part of our grand
    (desired) aperture.

  - in any other case, our aperture overlaps an existent GCD entry that
    *differs* from what we want -- either in type or in capabilities.
    This is a conflict that we cannot recover from.

And the last branch is hit here. Due to the E820 map, we created a
reserved memory resource descriptor HOB for
[0xFD_0000_0000..0x100_0000_0000), and then we&apos;re trying to turn the
address space [0xE0_0000_0000..0x100_0000_0000) into the 64-bit PCI MMIO
aperture. These two ranges intersect; the intersection is
[0xFD_0000_0000..0x100_0000_0000) -- that is, the &quot;reserved&quot; area is a
proper sub-interval of our desired aperture --, and they are
incompatible -- we want MMIO, but the existent GCD entry is &quot;reserved
memory&quot;.

I&apos;m asssigning this to Gerd for further triage (I hope that&apos;s OK),
because I believe both the new CPU address width calculation (and the
consequent 64-bit PCI MMIO aperture extension), and the fw_cfg E820 map
parsing updates, are his areas. I&apos;m also adding the &quot;regression&quot; keyword
for now.

I&apos;m also attaching a tarball of my domain XMLs, libvirtd logs (showing
the QEMU command lines), and firmware logs.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20489</commentid>
    <comment_count>1</comment_count>
      <attachid>1128</attachid>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-01-04 15:10:17 +0000</bug_when>
    <thetext>Created attachment 1128
test patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20490</commentid>
    <comment_count>2</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-01-04 15:12:47 +0000</bug_when>
    <thetext>yep, we better avoid that address range, it&apos;s used by the amd iommu.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20503</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-05 09:45:43 +0000</bug_when>
    <thetext>(In reply to Gerd Hoffmann from comment #1)
&gt; Created attachment 1128 [details]
&gt; test patch

- the leading comment on PlatformScanOrAdd64BitE820Ram() is overdue an
update :)

- the MIN and MAX macro calls don&apos;t strictly follow the coding style --
I&apos;m not sure what uncrustify will do -- rearrange them, or flag them and
break the build

- same for DEBUG, plus the comment block should consist of three //
comment lines (one empty before, one empty after)

- more to the point: if you sink the 64-bit aperture underneath the
reserved range, will that not un-align the aperture? See the logic /
comment at the end of PlatformGetFirstNonAddress():

&gt;|   //
&gt;|   // The 64-bit PCI host aperture should also be &quot;naturally&quot; aligned. The
&gt;|   // alignment is determined by rounding the size of the aperture down to the
&gt;|   // next smaller or equal power of two. That is, align the aperture by the
&gt;|   // largest BAR size that can fit into it.
&gt;|   //
&gt;|   PlatformInfoHob-&gt;PcdPciMmio64Base = ALIGN_VALUE (PlatformInfoHob-&gt;PcdPciMmio64Base, GetPowerOfTwo64 (PlatformInfoHob-&gt;PcdPciMmio64Size));

IIUC, with the test patch, we move the aperture down to [0xDD_0000_0000,
0xFD_0000_0000). The largest BAR (= integral power of two) that this
aperture can accommodate (like before) is 0x20_0000_0000. (The size of
the aperture is a power of two itself, so that is at once the largest
BAR it can accommodate too.) But now, after moving it under the reserver
area, the base address of the aperture is no longer a multiple of this
largest BAR (0xDD is not a whole multiple of 0x20) -- IOW, the aperture
is no longer naturally aligned.

Before, the aperture size and the largest encompassible BAR size were
both 0x20_0000_0000, so no change to that -- but previously, the base
address was 0xE0_0000_0000, which *was* a whole multiple of
0x20_0000_0000. So, before, the natural alignment was ensured.

I don&apos;t remember where this natural alignment requirement came from (for
the aperture), at the time of commit 7e5b1b670c382. I think
PciHostBridgeDxe may have enforced it.

I can try retro-actively justifying it though: given the aperture size,
we might be tempted to fit a BAR in it that has 0x20_0000_0000 size.
However, BARs must certainly be naturally aligned (= the base address
must be a multiple of the size). But in this case, because the aperture
itself is not naturally aligned, there&apos;s nowhere to place such a BAR
into it.

Would it make sense to keep the 64-bit aperture at the top of the
address space? IOW, if there&apos;s an overlapping reserved region, move the
64-bit PCI MMIO window *above* it? You can then re-align the *base* of
the moved aperture (moving it yet further upwards), using the same logic
I quoted above. Just a thought.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20507</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-05 12:45:48 +0000</bug_when>
    <thetext>Another reason for aligning the MMIO aperture by the size of the largest BAR it can receive:

IIRC, when PciBusDxe assigns BARs, it starts with the largest BARs, and places those at the lowest addresses in the aperture. The idea is that placing the largest bar at the bottom *preserves* the alignment of the bottom, at the bottom of the remaining free aperture, for the remaining BARs. If you placed a smaller BAR at the bottom, the alignment of the bottom of the remaining area could then get less coarse, and so a larger BAR (which again needs natural alignment) could not be placed there.  So if your entire aperture size is not a whole power of two, but a more generic integer, then the &quot;largest to bottom&quot; placement strategy keeps breaking up the alignment only as you progress to the smallar BARs, and this way you may quite well populate the &quot;irregular&quot; top of the aperture as well, with the smallest BARs that remain.

But for this to work well, the bottom of the whole aperture must be aligned by the largest BAR size it can fit -- otherwise the bottom-most part of the aperture could be wasted.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20518</commentid>
    <comment_count>5</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-01-06 05:14:41 +0000</bug_when>
    <thetext>&gt; - the leading comment on PlatformScanOrAdd64BitE820Ram() is overdue an
&gt; update :)

I&apos;ll have a look.

&gt; - the MIN and MAX macro calls don&apos;t strictly follow the coding style --
&gt; I&apos;m not sure what uncrustify will do -- rearrange them, or flag them and
&gt; break the build
&gt; 
&gt; - same for DEBUG, plus the comment block should consist of three //
&gt; comment lines (one empty before, one empty after)

Usually I just let uncrustify arrange things properly before sending to edk2-devel.
Trying to reproduce uncrustity results manually is not something I enjoy ;)

&gt; IIUC, with the test patch, we move the aperture down to [0xDD_0000_0000,
&gt; 0xFD_0000_0000).

Yes.

&gt; IOW, if there&apos;s an overlapping reserved region, move the
&gt; 64-bit PCI MMIO window *above* it?

Nope, we simply can&apos;t move it up.  The dynamic mmio window code places the window at the end of the address space.  If we have room above the conflicting region (i.e. phys-bits &gt;= 41) the conflict isn&apos;t going to happen in the first place ;)

So the options I see are:
  (1) move it further down for proper alignment (0xc0...).
  (2) leave the window at 0xe0... and make it a bit smaller.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20519</commentid>
    <comment_count>6</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-06 05:49:42 +0000</bug_when>
    <thetext>- How can you run uncrustify locally? I&apos;m sure there&apos;s docs but I&apos;ve not seen them. :) Thanks.

- If we move the aperture further down, can&apos;t we run into another conflict?

(

The data flow is still broken here, unfortunately. We can only arrange things into a total order if we know all the things. But right now we forward one thing from the E820 map to the GCD, and another thing, keying off of the CPU address width, to the GCD. So no wonder that if there&apos;s a conflict, it&apos;s found in the GCD at first -- when it is too late to rearrange.

I don&apos;t think the general idea works that QEMU&apos;s E820 map just exposes nameless reserved regions, and the firmware is supposed to arrange everything in a generic fashion. That&apos;s almost like the Knapsack Problem. We need to know the things we deal with.

)

Anyway, I guess moving the aperture downwards is better. It keeps the size. If we hit something else, we&apos;ll quickly learn about it. :/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20522</commentid>
    <comment_count>7</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-01-06 06:40:11 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #6)
&gt; - How can you run uncrustify locally? I&apos;m sure there&apos;s docs but I&apos;ve not
&gt; seen them. :) Thanks.

https://github.com/tianocore/tianocore.github.io/wiki/EDK-II-Code-Formatting
(scroll down, it explains CI first, local install comes a bit later).

&gt; - If we move the aperture further down, can&apos;t we run into another conflict?

In theory yes.  In practice current qemu current qemu exposes at most a single reserved region above 4G.  We could still run into a conflict with RAM.  But
seeing a VM with &gt; 768G of memory on a machine which has only 1TB physical address space is rather unlikely I guess.

&gt; I don&apos;t think the general idea works that QEMU&apos;s E820 map just exposes
&gt; nameless reserved regions, and the firmware is supposed to arrange
&gt; everything in a generic fashion. That&apos;s almost like the Knapsack Problem. We
&gt; need to know the things we deal with.

Well, there is the option to re-arrange things much later,
in Library/PciHostBridgeLib/PciHostBridgeLib.c

At that point we should have a more complete view of the address space
usage and have probably a better chance to find a non-conflicting place.

But maybe that is overengineering it, in practice there is just that single reservation we must be able to handle.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20615</commentid>
    <comment_count>8</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-01-11 00:35:27 +0000</bug_when>
    <thetext>https://edk2.groups.io/g/devel/message/98238</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20648</commentid>
    <comment_count>9</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-12 13:40:45 +0000</bug_when>
    <thetext>(removing myself from the CC list)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20652</commentid>
    <comment_count>10</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-12 13:44:20 +0000</bug_when>
    <thetext>[edk2-devel] [PATCH v3 0/8] OvmfPkg: check 64bit mmio window for resource conflicts</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20718</commentid>
    <comment_count>11</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-18 06:24:56 +0000</bug_when>
    <thetext>Fixed in commit range a107ad0f6236..015a001b03db.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1126</attachid>
            <date>2023-01-04 09:54:42 +0000</date>
            <delta_ts>2023-01-04 09:54:42 +0000</delta_ts>
            <desc>tarball of domain XMLs, libvirtd logs (QEMU cmdlines), and firmware logs</desc>
            <filename>gcd-conflict.tar.xz</filename>
            <type>application/x-xz</type>
            <size>46048</size>
            <attacher name="Laszlo Ersek">laszlo.ersek</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1128</attachid>
            <date>2023-01-04 15:10:17 +0000</date>
            <delta_ts>2023-01-04 15:10:17 +0000</delta_ts>
            <desc>test patch</desc>
            <filename>0001-OvmfPkg-check-64bit-mmio-window-for-overlaps-with-re.patch</filename>
            <type>text/plain</type>
            <size>3933</size>
            <attacher name="Gerd Hoffmann">kraxel</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4755</bug_id>
          
          <creation_ts>2024-04-16 23:36:12 +0000</creation_ts>
          <short_desc>QemuFwCfgLibMmio needs PEI version.</short_desc>
          <delta_ts>2024-06-06 03:20:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22918</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-04-16 23:36:12 +0000</bug_when>
    <thetext>The QemuFwCfgLibMmio needs PEI version, current version only serves the DXE stage.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22919</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-04-16 23:36:32 +0000</bug_when>
    <thetext>I&apos;m working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22954</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-04-24 20:42:52 +0000</bug_when>
    <thetext>Chao takes it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23094</commentid>
    <comment_count>3</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-06-06 03:20:29 +0000</bug_when>
    <thetext>The patch set was merged, close.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4603</bug_id>
          
          <creation_ts>2023-11-22 04:03:54 +0000</creation_ts>
          <short_desc>Clarify that _IFT and _SRV are used by the DMTF MCTP HI (DSP0256) specification.</short_desc>
          <delta_ts>2024-01-10 11:48:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Jose Marinho">Jose.Marinho</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>samer.el-haj-mahmoud</cc>
          
          <cf_industrystandardspecifications>ACPI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22181</commentid>
    <comment_count>0</comment_count>
      <attachid>1431</attachid>
    <who name="Jose Marinho">Jose.Marinho</who>
    <bug_when>2023-11-22 04:03:54 +0000</bug_when>
    <thetext>Created attachment 1431
ECR_ACPI_MCTP_HI_clarify_FIT_SRV

This is an erratum.

Clarify that _IFT and _SRV are used by the DMTF MCTP HI (DSP0256) specification.

The _IFT and _SRV methods are used in the MCTP HI specification. The ACPI specification only points to IPMI. The return value of both methods differs between the IPMI and MCTP HI context.
This ECR clarifies that both methods, when used in the MCTP HI context, have a return value that is defined in MCTP HI.


&quot;_IFT: Object that specifies the interface type, as defined in the MCHI Table.&quot; 

&quot;_SRV: Object that specifies the specification revision, as defined in the MCHI Table. &quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22347</commentid>
    <comment_count>1</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2024-01-10 11:48:08 +0000</bug_when>
    <thetext>ECR is approved by ASWG at the 1/4/2024 meeting as an errata to next ACPI spec</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1431</attachid>
            <date>2023-11-22 04:03:54 +0000</date>
            <delta_ts>2023-11-22 04:03:54 +0000</delta_ts>
            <desc>ECR_ACPI_MCTP_HI_clarify_FIT_SRV</desc>
            <filename>ECR_ACPI_MCTP_HI_clarify_FIT_SRV.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>55059</size>
            <attacher name="Jose Marinho">Jose.Marinho</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4457</bug_id>
          
          <creation_ts>2023-05-17 13:20:09 +0000</creation_ts>
          <short_desc>Edk2ToolsBuild.py does not mark compiler errors as python&apos;s logging.ERROR</short_desc>
          <delta_ts>2023-08-23 13:09:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Joey Vagedes">joeyvagedes</reporter>
          <assigned_to name="Joey Vagedes">joeyvagedes</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21567</commentid>
    <comment_count>0</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-05-17 13:20:09 +0000</bug_when>
    <thetext>Edk2ToolsBuild.py does not utilize edk2-pytool-extension&apos;s scan_compiler_output() function is used to detect compiler errors/warnings and log them appropriately. Due to this, when the compilation fails, no info is provided to the user and the user must know to check the log file INFO logs.

stuart_build already utilizes the scan_compiler_output() function when building an EDK2 package / platform and appropriately labels compiler errors as an ERROR and logs it to the terminal and log file.

I have attached a diff / patch file that adds the scan_compiler_output() function to Edk2ToolsBuild.py and can appropriately send it out the mailing list when requested.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21609</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 22:00:17 +0000</bug_when>
    <thetext>joeyvagedes@microsoft.com: please send the patch to edk2 mail list.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21677</commentid>
    <comment_count>2</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-06-21 13:11:59 +0000</bug_when>
    <thetext>I have sent the patch. Thanks</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21850</commentid>
    <comment_count>3</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-08-23 13:09:04 +0000</bug_when>
    <thetext>pushed via https://github.com/tianocore/edk2/pull/4621</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4305</bug_id>
          
          <creation_ts>2023-01-16 17:21:20 +0000</creation_ts>
          <short_desc>Authenticated SetVariable with ContentInfo not supported</short_desc>
          <delta_ts>2023-01-23 01:06:15 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jan Bobek">jbobek</reporter>
          <assigned_to name="Jan Bobek">jbobek</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20680</commentid>
    <comment_count>0</comment_count>
      <attachid>1184</attachid>
    <who name="Jan Bobek">jbobek</who>
    <bug_when>2023-01-16 17:21:20 +0000</bug_when>
    <thetext>Created attachment 1184
Fix the bug by adding another offset to check.

Per UEFI specification 2.10 [1], 8.2.6 &quot;Using the EFI_VARIABLE_AUTHENTICATION_2 descriptor&quot;, item 4:

&gt; Construct a DER-encoded SignedData structure per PKCS#7 version 1.5
&gt; (RFC 2315), which shall be supported both with and without a DER-encoded
&gt; ContentInfo structure per PKCS#7 version 1.5, with the signed content
&gt; as follows: [...]
As mentioned above, SignedData structure is defined in RFC 2315 [2], section 9.1 &quot;SignedData type&quot;. However, the same RFC in section 7 &quot;General syntax&quot; says:

&gt; The general syntax for content exchanged between entities according
&gt; to this document associates a content type with content. The syntax
&gt; shall have ASN.1 type ContentInfo:
&gt; 
&gt; ContentInfo ::= SEQUENCE {
&gt;   contentType ContentType,
&gt;   content
&gt;     [0] EXPLICIT ANY DEFINED BY contentType OPTIONAL }
&gt; 
&gt; ContentType ::= OBJECT IDENTIFIER
The following is my interpretation. In the case of UEFI and authenticated SetVariable call, the content we wish to exchange is the SignedData structure. According to the RFC excerpt above, this structure shall be wrapped in a top-level ContentInfo structure, where contentType shall be set to signedData OID (defined in section 14 of said RFC) and content shall be the SignedData structure. However, according to the earlier UEFI spec excerpt, the firmware shall not require this top-level ContentInfo structure to be present; the SignedData structure shall be supported both with and without a ContentInfo structure.

Unfortunately, EDK2 currently requires that the top-level ContentInfo structure *is not* present. What&apos;s even worse, OpenSSL generates SignedData structure according to the RFC, meaning top-level ContentInfo *is* present in its output. This breaks a workflow where one generates custom PK/KEK/db keys using OpenSSL and attempts to enroll them into EDK2 firmware. It also breaks EFI utilities that use OpenSSL internally, like efi-updatevar.

Steps to reproduce:
1. Boot a Linux platform with EDK2 in Setup Mode.
2. Generate a custom PK according to [3].
3. Without entering Custom Mode, attempt to enroll the custom PK via efi-updatevar. Due to bug 2506, the PK must be self-signed even when in Setup Mode. However, enrollment will still fail.

I have tracked this problem to code in SecurityPkg/AuthVariableLib [4] that verifies the digest algorithm is SHA-256 (as required by UEFI spec). Rather than properly parsing DER-encoded SignedData, it checks a fixed offset for SHA-256 algorithm OID. However, when the SignedData structure is wrapped in a top-level ContentInfo (like described by the RFC), the correct offset gets pushed further and this simplistic check fails.

Attaching a patch which checks two offsets: one for when ContentInfo is not present, and one for when ContentInfo is present. Verified functionality by following the steps to reproduce and succeeding.

References:
1. https://uefi.org/specs/UEFI/2.10/
2. https://datatracker.ietf.org/doc/rfc2315/
3. https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot#Manual_process
4. https://github.com/tianocore/edk2/blob/master/SecurityPkg/Library/AuthVariableLib/AuthService.c#L1924-L1946</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20681</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-16 19:19:22 +0000</bug_when>
    <thetext>EDKII discussion - https://edk2.groups.io/g/devel/topic/95419835</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20711</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-18 01:49:09 +0000</bug_when>
    <thetext>I have read all background info.
It seems this is added in UEFI 2.9 with mantis 1982.

First, thanks for contributing this patch to make the tool work.

Second, I feel the comment in the code is not enough, because the ASN.1 encoding is complicated. I am not sure what offset 32 is. (please forgive me that I have not used the tool yet)

Is that possible for you to add more detail on each bytes for those two cases defined in https://www.rfc-editor.org/rfc/rfc2315.

For example:
A) Without ContextInfo: the expected byte stream is:

30 82 0c da // SEQUENCE (5 element) - SignedData
   02 01 01 // INTEGER 1 -- Version
   31 0f // SET (1 element) -- DigestAlgorithmIdentifiers
      30 0d // SEQUENCE (2 element)
         06 09 // OBJECT IDENTIFIER
            60 86 48 01 65 03 04 02 01 // sha-256
         05 00 // NULL

Reference: https://uefi.org/revocationlistfile

B) With ContextInfo, the expected byte stream is:

// please fill it, you can just copy something from the tool you are using

That will help us better understand where 32 comes from.

Reference: https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot#Manual_process</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20730</commentid>
    <comment_count>3</comment_count>
    <who name="Jan Bobek">jbobek</who>
    <bug_when>2023-01-19 18:29:30 +0000</bug_when>
    <thetext>I&apos;ve had this information on hand when I was debugging this problem, but I didn&apos;t keep it, so I&apos;ve had to re-create it.

Following the instructions in [3] of the bug description, I generated PK.auth:

$ uuidgen --random &gt; GUID.txt
$ openssl req -newkey rsa:4096 -nodes -keyout PK.key -new -x509 -sha256 -days 3650 -subj &quot;/CN=my Platform Key/&quot; -out PK.crt
$ openssl x509 -outform DER -in PK.crt -out PK.cer
$ cert-to-efi-sig-list -g &quot;$(&lt; GUID.txt)&quot; PK.crt PK.esl
$ sign-efi-sig-list -g &quot;$(&lt; GUID.txt)&quot; -k PK.key -c PK.crt PK PK.esl PK.auth
$ hd PK.auth | head
00000000  e7 07 09 1f 05 23 2e 00  00 00 00 00 00 00 00 00  |.....#..........|
00000010  ac 05 00 00 00 02 f1 0e  9d d2 af 4a df 68 ee 49  |...........J.h.I|
00000020  8a a9 34 7d 37 56 65 a7  30 82 05 90 06 09 2a 86  |..4}7Ve.0.....*.|
00000030  48 86 f7 0d 01 07 02 a0  82 05 81 30 82 05 7d 02  |H..........0..}.|
00000040  01 01 31 0f 30 0d 06 09  60 86 48 01 65 03 04 02  |..1.0...`.H.e...|                                                                                 
00000050  01 05 00 30 0b 06 09 2a  86 48 86 f7 0d 01 07 01  |...0...*.H......|
00000060  a0 82 03 13 30 82 03 0f  30 82 01 f7 a0 03 02 01  |....0...0.......|
00000070  02 02 14 2f ef 26 9c 60  40 bd e7 2a 45 fb 19 83  |.../.&amp;.`@..*E...|
00000080  75 00 50 d9 b0 04 33 30  0d 06 09 2a 86 48 86 f7  |u.P...30...*.H..|
00000090  0d 01 01 0b 05 00 30 17  31 15 30 13 06 03 55 04  |......0.1.0...U.|

Now one can enroll the custom PK with:
# efi-updatevar -f PK.auth PK

I inserted a debug hex print into VerifyTimeBasedPayload in AuthService.c, right after SigData/SigDataSize are assigned. The following are the first 160 bytes:

VerifyTimeBasedPayload: SigData (1428 bytes):
00000000: 30 82 05 90 06 09 2A 86 - 48 86 F7 0D 01 07 02 A0
00000010: 82 05 81 30 82 05 7D 02 - 01 01 31 0F 30 0D 06 09
00000020: 60 86 48 01 65 03 04 02 - 01 05 00 30 0B 06 09 2A                                                                                                    
00000030: 86 48 86 F7 0D 01 07 01 - A0 82 03 13 30 82 03 0F
00000040: 30 82 01 F7 A0 03 02 01 - 02 02 14 2F EF 26 9C 60
00000050: 40 BD E7 2A 45 FB 19 83 - 75 00 50 D9 B0 04 33 30
00000060: 0D 06 09 2A 86 48 86 F7 - 0D 01 01 0B 05 00 30 17
00000070: 31 15 30 13 06 03 55 04 - 03 0C 0C 50 6C 61 74 66
00000080: 6F 72 6D 20 4B 65 79 30 - 1E 17 0D 32 32 31 30 33
00000090: 31 30 35 33 33 31 37 5A - 17 0D 33 32 31 30 32 38

Note the SigData payload is just a fragment of PK.auth starting at offset 0x28 (40). Decoding the payload yields:

30 82 05 90 // SEQUENCE (1424 BYTES) -- ContentInfo
   06 09 // OBJECT-IDENTIFIER (9 BYTES) -- ContentType                                                                  
       2a 86 48 86 f7 0d 01 07 02 // signedData [1.2.840.113549.1.7.2]
   a0 82 05 81 // CONTEXT-SPECIFIC CONSTRUCTED TAG 0 (1409 BYTES) -- content
      30 82 05 7d // SEQUENCE (1405 BYTES) -- SignedData
         02 01 01 // INTEGER 1 -- Version
         31 0f // SET (15 BYTES) -- DigestAlgorithmIdentifiers
            30 0d // SEQUENCE (13 BYTES) -- AlgorithmIdentifier
               06 09 // OBJECT-IDENTIFIER (9 BYTES) -- algorithm
                  60 86 48 01 65 03 04 02 01 // sha256 [2.16.840.1.101.3.4.2.1]
               05 00 // NULL (0 BYTES) -- parameters

To answer your question, the offset 32 comes from 19 + 13, where 13 is the offset that was originally in the code, and 19 is length of the prefix stemming from the top-level ContentInfo structure.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20731</commentid>
    <comment_count>4</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-20 03:04:54 +0000</bug_when>
    <thetext>Great. Now I understand the problem now.

I vaguely remembered that the ContextInfo header is removed purposely according to MSFT feedback.

The crypto library also handled such difference in WrapPkcs7Data() at https://github.com/tianocore/edk2/blob/master/CryptoPkg/Library/BaseCryptLib/Pk/CryptPkcs7VerifyCommon.c.

With all those context, my only feedback is to add more comment to the code.

Example below. You can copy/paste it, or feel free to edit.
============

  //
  // SignedData.digestAlgorithms shall contain the digest algorithm used when preparing the
  // signature. Only a digest algorithm of SHA-256 is accepted.
  //
  //    According to PKCS#7 Definition: (https://www.rfc-editor.org/rfc/rfc2315)
  //        SignedData ::= SEQUENCE {
  //            version Version,
  //            digestAlgorithms DigestAlgorithmIdentifiers,
  //            contentInfo ContentInfo,
  //            .... }
  //    The DigestAlgorithmIdentifiers can be used to determine the hash algorithm
  //    in VARIABLE_AUTHENTICATION_2 descriptor.
  //    This field has the fixed offset (+13) or (+32) based on whether the DER-encoded
  //    ContentInfo structure is present or not, and can be calculated based on two
  //    bytes of length encoding.
  //
  //    Both condition can be handled in WrapPkcs7Data() in CryptPkcs7VerifyCommon.c.
  //
  //    See below examples:
  //
  // 1. Without ContextInfo
  //    30 82 0c da // SEQUENCE (5 element) (3294 BYTES) -- SignedData
  //       02 01 01 // INTEGER 1 -- Version
  //       31 0f // SET (1 element) (15 BYTES) -- DigestAlgorithmIdentifiers
  //          30 0d // SEQUENCE (2 element) (13 BYTES) -- AlgorithmIdentifier
  //             06 09 // OBJECT-IDENTIFIER (9 BYTES) -- algorithm
  //                60 86 48 01 65 03 04 02 01 // sha256 [2.16.840.1.101.3.4.2.1]
  //             05 00 // NULL (0 BYTES) -- parameters
  //
  // Example from: https://uefi.org/revocationlistfile
  //
  // 2. With ContextInfo
  //    30 82 05 90 // SEQUENCE (1424 BYTES) -- ContentInfo
  //       06 09 // OBJECT-IDENTIFIER (9 BYTES) -- ContentType                                                                  
  //          2a 86 48 86 f7 0d 01 07 02 // signedData [1.2.840.113549.1.7.2]
  //       a0 82 05 81 // CONTEXT-SPECIFIC CONSTRUCTED TAG 0 (1409 BYTES) -- content
  //          30 82 05 7d // SEQUENCE (1405 BYTES) -- SignedData
  //             02 01 01 // INTEGER 1 -- Version
  //             31 0f // SET (1 element) (15 BYTES) -- DigestAlgorithmIdentifiers
  //                30 0d // SEQUENCE (13 BYTES) -- AlgorithmIdentifier
  //                   06 09 // OBJECT-IDENTIFIER (9 BYTES) -- algorithm
  //                      60 86 48 01 65 03 04 02 01 // sha256 [2.16.840.1.101.3.4.2.1]
  //                   05 00 // NULL (0 BYTES) -- parameters
  //
  // Example generated with https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot#Manual_process
  //

============</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20739</commentid>
    <comment_count>5</comment_count>
      <attachid>1209</attachid>
    <who name="Jan Bobek">jbobek</who>
    <bug_when>2023-01-20 15:05:59 +0000</bug_when>
    <thetext>Created attachment 1209
V2 of the patch with more comments added

Attaching a V2 of the patch with more comments.

Should I send the patch out to edk2-devel, too?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20741</commentid>
    <comment_count>6</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-20 19:47:29 +0000</bug_when>
    <thetext>Yes, please send the patch to EDKII dev.

The discussion can be done in mailing list or bugzilla.
The patch review process is done in mailing list only.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20743</commentid>
    <comment_count>7</comment_count>
    <who name="Jan Bobek">jbobek</who>
    <bug_when>2023-01-22 16:57:40 +0000</bug_when>
    <thetext>&gt; Yes, please send the patch to EDKII dev.
&gt; 
&gt; The discussion can be done in mailing list or bugzilla.
&gt; The patch review process is done in mailing list only.
Thank you for the clarification. The updated patch has been sent out to edk2-devel:

https://edk2.groups.io/g/devel/message/98951</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20744</commentid>
    <comment_count>8</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-23 01:06:15 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3940</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1184</attachid>
            <date>2023-01-16 17:21:20 +0000</date>
            <delta_ts>2023-01-20 15:05:59 +0000</delta_ts>
            <desc>Fix the bug by adding another offset to check.</desc>
            <filename>0001-SecurityPkg-AuthVariableLib-Check-SHA-256-OID-with-C.patch</filename>
            <type>text/plain</type>
            <size>2693</size>
            <attacher name="Jan Bobek">jbobek</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1209</attachid>
            <date>2023-01-20 15:05:59 +0000</date>
            <delta_ts>2023-01-20 15:05:59 +0000</delta_ts>
            <desc>V2 of the patch with more comments added</desc>
            <filename>v2-0001-SecurityPkg-AuthVariableLib-Check-SHA-256-OID-wit.patch</filename>
            <type>text/plain</type>
            <size>4834</size>
            <attacher name="Jan Bobek">jbobek</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4141</bug_id>
          
          <creation_ts>2022-11-07 02:51:20 +0000</creation_ts>
          <short_desc>PrmPkg: WHQL Signed Driver test failure for PRM Test Device</short_desc>
          <delta_ts>2022-11-15 21:49:05 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>wei6.xu</reporter>
          <assigned_to>wei6.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>paul.a.lohr</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>PrmPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19949</commentid>
    <comment_count>0</comment_count>
    <who name="">wei6.xu</who>
    <bug_when>2022-11-07 02:51:20 +0000</bug_when>
    <thetext>While running the Signed Driver test, you will see failures for following device with no driver installed:
  ACPI\80860223
With this unknown device, we will not be able to complete the WHQL certification.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19956</commentid>
    <comment_count>1</comment_count>
    <who name="Paul Lohr">paul.a.lohr</who>
    <bug_when>2022-11-07 09:58:11 +0000</bug_when>
    <thetext>Cut and paste from duplicate filed:

PRM Drivers are not native to OS.  for PRMT (_HID = 808602223), it has an incorrect _CID, one that will cause an unknown device to be reported during some certification tests.

Change will implement a correct _CID that defines the device as a generic motherboard when the PRM Drivers are not loaded.  Also, undo the incomplete workaround to hide the device when the PRM Driver is not loaded by setting _STA = 0x0F for said device.  This will allow the device to always be shown in Device Manager, either as the PRM device (when driver is loaded) or as a generic motherboard device (when only native Drivers are loaded).

Source location here:  Edk2\PrmPkg\PrmSsdtInstallDxe\Prm.asl

Code change:

        Device (PRMT)
        {
            Name (_HID, &quot;80860223&quot;)
            Name (_CID, EISAID(&quot;PNP0C02&quot;))
//...

            Method (_STA, 0, NotSerialized)
            {
                Return (0x0F) // Device Present, Enabled, Show, Functional.
            }
//...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19958</commentid>
    <comment_count>2</comment_count>
    <who name="Paul Lohr">paul.a.lohr</who>
    <bug_when>2022-11-07 09:59:16 +0000</bug_when>
    <thetext>*** Bug 4142 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19979</commentid>
    <comment_count>3</comment_count>
    <who name="Paul Lohr">paul.a.lohr</who>
    <bug_when>2022-11-09 12:50:36 +0000</bug_when>
    <thetext>wei - please change the _STA = 0x0F as well.  Current _STA = 0x0B was an insufficient workaround to the unknown device issue the _CID has already fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20030</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-15 21:42:58 +0000</bug_when>
    <thetext>Wei: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20035</commentid>
    <comment_count>5</comment_count>
    <who name="">wei6.xu</who>
    <bug_when>2022-11-15 21:49:05 +0000</bug_when>
    <thetext>The patch has been merged: https://github.com/tianocore/edk2/commit/6032b46dce1dea705f95ecfdb68656281f0822f7</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4787</bug_id>
          
          <creation_ts>2024-06-12 08:15:34 +0000</creation_ts>
          <short_desc>MdeModulePkg/ACPI/AcpiTableDxe: Consume SOC related ACPI table from ACPI Silicon HOB.</short_desc>
          <delta_ts>2024-10-08 21:25:54 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="George Liao">george.liao</reporter>
          <assigned_to name="George Liao">george.liao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23109</commentid>
    <comment_count>0</comment_count>
    <who name="George Liao">george.liao</who>
    <bug_when>2024-06-12 08:15:34 +0000</bug_when>
    <thetext>If ACPI Silicon Hob has been found from entry point of AcpiTableDxe driver, that means SOC related ACPI tables been pass to the DXE phase by HOB.
 Each SOC related ACPI tables will be install.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23129</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-06-18 01:45:26 +0000</bug_when>
    <thetext>george.liao@intel.com takes it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23436</commentid>
    <comment_count>2</comment_count>
    <who name="George Liao">george.liao</who>
    <bug_when>2024-10-08 21:25:54 +0000</bug_when>
    <thetext>Merged code changes.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4014</bug_id>
          
          <creation_ts>2022-08-05 05:03:47 +0000</creation_ts>
          <short_desc>Smbiosview tool is not show &apos;Extended Speed&apos; and &apos;Extended Configured Memory Speed&apos; in type 17.</short_desc>
          <delta_ts>2022-08-15 00:50:55 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="xueshengfeng">shengfengx.xue</reporter>
          <assigned_to name="xueshengfeng">shengfengx.xue</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19362</commentid>
    <comment_count>0</comment_count>
    <who name="xueshengfeng">shengfengx.xue</who>
    <bug_when>2022-08-05 05:03:47 +0000</bug_when>
    <thetext>from smbios spec, if &apos;Configured Memory Speed&apos; is 65,535 MT/s or greater,
and the actual speed is stored in the Extended Configured Memory Speed field. 
but current Smbiosview have no this logic.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19369</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-09 21:36:07 +0000</bug_when>
    <thetext>shengfengx.xue@intel.com: please provide the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19371</commentid>
    <comment_count>2</comment_count>
      <attachid>1015</attachid>
    <who name="xueshengfeng">shengfengx.xue</who>
    <bug_when>2022-08-09 21:40:01 +0000</bug_when>
    <thetext>Created attachment 1015
patch

please help to review attached patch. thank you very much.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19391</commentid>
    <comment_count>3</comment_count>
    <who name="xueshengfeng">shengfengx.xue</who>
    <bug_when>2022-08-15 00:50:55 +0000</bug_when>
    <thetext>Patch merger into EDK II upstream is Done as following. so, we can close this bugzilla now.


SHA-1: 74f44d920a287beef6e5949494dd24d1e2f23145

* ShellPkg/SmbiosView: Display extended memory info in smbiosview -t 17

REF:https://bugzilla.tianocore.org/show_bug.cgi?id=4014

If Configured Memory Speed is 65,535 MT/s or greater,
and the actual speed is stored in the Extended Configured Memory Speed
field. but current Smbiosview have no this logic.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1015</attachid>
            <date>2022-08-09 21:40:01 +0000</date>
            <delta_ts>2022-08-09 21:40:01 +0000</delta_ts>
            <desc>patch</desc>
            <filename>0001-ShellPkg-SmbiosView-Smbiosview-tool-is-not-show.patch</filename>
            <type>application/octet-stream</type>
            <size>1465</size>
            <attacher name="xueshengfeng">shengfengx.xue</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4485</bug_id>
          
          <creation_ts>2023-06-19 03:32:58 +0000</creation_ts>
          <short_desc>Google Mock Library (UefiBootServicesTableLib) support from Edk2</short_desc>
          <delta_ts>2024-02-04 22:38:40 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>mars_cc_lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21671</commentid>
    <comment_count>0</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-06-19 03:32:58 +0000</bug_when>
    <thetext>Based on REF: https://bugzilla.tianocore.org/show_bug.cgi?id=4389, it provides google mock support on Edk2.

We need to based on the solution to provide more google mock library for consumer code to depend on.

 UefiBootServicesTableLib Google Mock Library</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21745</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:39:03 +0000</bug_when>
    <thetext>mars_cc_lin@phoenix.com: will you contribute the patch for it?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22524</commentid>
    <comment_count>2</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2024-02-04 22:38:40 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #1)
&gt; mars_cc_lin@phoenix.com: will you contribute the patch for it?

The PR had been closed. To transfer this request to WONTFIX and close it.

PR link: https://github.com/tianocore/edk2/pull/4559</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4338</bug_id>
          
          <creation_ts>2023-02-07 22:03:33 +0000</creation_ts>
          <short_desc>Fix invalid InitializeMpSyncData call in PiSmmCpuDxeSmm</short_desc>
          <delta_ts>2023-05-06 02:45:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="jiaxinwu">jiaxin.wu</reporter>
          <assigned_to name="jiaxinwu">jiaxin.wu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiaxin.wu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21001</commentid>
    <comment_count>0</comment_count>
    <who name="jiaxinwu">jiaxin.wu</who>
    <bug_when>2023-02-07 22:03:33 +0000</bug_when>
    <thetext>No need call InitializeMpSyncData during normal boot SMI init, because mSmmMpSyncData is NULL at that time. mSmmMpSyncData is allocated in InitializeMpServiceData, which is invoked after normal boot SMI init (SmmRelocateBases).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21058</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-02-14 21:56:08 +0000</bug_when>
    <thetext>Jiaxin is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21499</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-06 02:45:04 +0000</bug_when>
    <thetext>Fix in Edk2 cb4820b6c148e62f9317799610b6e8dcd346c936</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4163</bug_id>
          
          <creation_ts>2022-11-22 16:57:44 +0000</creation_ts>
          <short_desc>MdePkg/BaseRngLib does not properly check for RDRAND support</short_desc>
          <delta_ts>2024-06-14 16:02:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Pedro Falcato">pedro.falcato</reporter>
          <assigned_to name="Pedro Falcato">pedro.falcato</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20077</commentid>
    <comment_count>0</comment_count>
    <who name="Pedro Falcato">pedro.falcato</who>
    <bug_when>2022-11-22 16:57:44 +0000</bug_when>
    <thetext>BaseRngLib (on x86) currently does not properly check the CPUID for instruction support and blindly uses RDRAND. It also never tests for RDRAND sanity which may give very weak RNG on several known x86 CPU implementations.

More details on https://edk2.groups.io/g/devel/topic/94935843.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20090</commentid>
    <comment_count>1</comment_count>
    <who name="Pedro Falcato">pedro.falcato</who>
    <bug_when>2022-11-23 21:38:51 +0000</bug_when>
    <thetext>Latest patch in https://edk2.groups.io/g/devel/message/96581</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20133</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-29 21:49:41 +0000</bug_when>
    <thetext>Pedro is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23120</commentid>
    <comment_count>3</comment_count>
    <who name="Pedro Falcato">pedro.falcato</who>
    <bug_when>2024-06-14 16:02:24 +0000</bug_when>
    <thetext>Fixed and closed by commit c3a8ca7b54a9fd17acdf16c6282a92cc989fa92a in tianocore/edk2.git.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4037</bug_id>
          
          <creation_ts>2022-08-29 23:25:33 +0000</creation_ts>
          <short_desc>Install EFI_DISCOVER_PROTOCOL on each network interface</short_desc>
          <delta_ts>2022-10-04 20:49:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19448</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-08-29 23:25:33 +0000</bug_when>
    <thetext>EFI_DISCOVER_PROTOCOL instance is shared by all network interfaces base on the current implementation. This causes the problem the high-level driver stack on the network interface is stopped when every time the EFI_DISCOVER_PROTOCOL is reinstalled on a new-found network interface. The same issue also happened on the network interface that is currently used to communicate with Redfish service when another network interface is stopped. The EFI_DISCOVER_PROTOCOL should be installed on each network interface.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19449</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-08-30 00:09:19 +0000</bug_when>
    <thetext>I am taking care of this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19700</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-10-04 20:49:15 +0000</bug_when>
    <thetext>Fix ed f7da805b</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19701</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-10-04 20:49:43 +0000</bug_when>
    <thetext>Fix at f7da805b</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4662</bug_id>
          
          <creation_ts>2024-02-01 03:56:59 +0000</creation_ts>
          <short_desc>AlderlakeOpenBoardPkg: Change MinPlatform MinDsdt and Update SpiFlashCommonLib</short_desc>
          <delta_ts>2024-04-22 02:16:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>Placeholder</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dora Hsueh">dorax.hsueh</reporter>
          <assigned_to name="Dora Hsueh">dorax.hsueh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22490</commentid>
    <comment_count>0</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-02-01 03:56:59 +0000</bug_when>
    <thetext>1. Change MinPlatform MinDsdt to fix hang logo issue.
2. Update SecFspWrapperPlatformSecLib for FSP use.
3. Update SpiFlashCommonLib to fix boot assert issue.
4. Fix USB not working issue in OS.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22729</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 22:12:09 +0000</bug_when>
    <thetext>dorax.hsueh@intel.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22935</commentid>
    <comment_count>2</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-04-22 02:16:45 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2-platforms/pull/120
PR merged on WW15.2</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4513</bug_id>
          
          <creation_ts>2023-07-28 01:54:28 +0000</creation_ts>
          <short_desc>Enhance LoadStorage implementation in SetupBrowserDxe for varstore of EFI_HII_VARSTORE_EFI_VARIABLE_BUFFER</short_desc>
          <delta_ts>2023-08-03 21:29:09 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="dandanbi">dandan.bi</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21782</commentid>
    <comment_count>0</comment_count>
    <who name="dandanbi">dandan.bi</who>
    <bug_when>2023-07-28 01:54:28 +0000</bug_when>
    <thetext>Now for varstore of EFI_HII_VARSTORE_EFI_VARIABLE_BUFFER, it will call  ExtractConfig (SetupBrowserDxe) -&gt;GetVariable(HiiDatabase) -&gt;HiiBlockToConfig(HiiDatabase) -&gt;ConfigToBlock (SetupBrowserDxe ).
It seems not necessary and costs lots of time to do the conversion between config and block, so plan to update it to call GetVariable directly in SetupBrowserDxe.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21783</commentid>
    <comment_count>1</comment_count>
    <who name="dandanbi">dandan.bi</who>
    <bug_when>2023-07-28 01:55:20 +0000</bug_when>
    <thetext>WIP</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21784</commentid>
    <comment_count>2</comment_count>
    <who name="dandanbi">dandan.bi</who>
    <bug_when>2023-07-30 21:16:27 +0000</bug_when>
    <thetext>Patch is under review: https://edk2.groups.io/g/devel/message/107385</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21801</commentid>
    <comment_count>3</comment_count>
    <who name="dandanbi">dandan.bi</who>
    <bug_when>2023-08-03 21:29:09 +0000</bug_when>
    <thetext>Change is merged via https://github.com/tianocore/edk2/commit/7672d1cca58228b0cb7f099e8863aa3a44ae45db</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4373</bug_id>
          
          <creation_ts>2023-03-15 04:26:33 +0000</creation_ts>
          <short_desc>Got Page-Fault in CpuIo2Dxe.dll when using edk2-stable202211 ovmf with qemi-kvm</short_desc>
          <delta_ts>2023-03-22 07:54:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Joey Lee">jlee</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>kraxel</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21191</commentid>
    <comment_count>0</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-15 04:26:33 +0000</bug_when>
    <thetext>I got a page-fault in CpuIo2Dxe.dll when using edk2-stable202211 ovmf with qemu-kvm:

linux-691t:/home/joeyli # virsh start opensuseTW; virsh console opensuseTW
Domain &apos;opensuseTW&apos; started

Connected to domain &apos;opensuseTW&apos;
Escape character is ^] (Ctrl + ])
!!!! X64 Exception Type - 0E(#PF - Page-Fault)  CPU Apic ID - 00000000 !!!!
ExceptionData - 000000000000000B  I:0 R:1 U:0 W:1 P:1 PK:0 SS:0 SGX:0
RIP  - 000000007F2CB5E8, CS  - 0000000000000038, RFLAGS - 0000000000010246
RAX  - 0000000000000000, RCX - 0000000000000001, RDX - 000000007F2CC5D0
RBX  - 0000038280000014, RSP - 000000007FF04710, RBP - 000000007FF04790
RSI  - 0000000000000000, RDI - 0000000000000000
R8   - 000000007FF04938, R9  - 0000000000000001, R10 - 0000000000000001
R11  - 0000000000000000, R12 - 000000007FF04938, R13 - 0000000000000001
R14  - 0000000000000001, R15 - 000000007F2CC3EC
DS   - 0000000000000030, ES  - 0000000000000030, FS  - 0000000000000030
GS   - 0000000000000030, SS  - 0000000000000030
CR0  - 0000000080010033, CR2 - 0000038280000014, CR3 - 000000007FC01000
CR4  - 0000000000000668, CR8 - 0000000000000000
DR0  - 0000000000000000, DR1 - 0000000000000000, DR2 - 0000000000000000
DR3  - 0000000000000000, DR6 - 00000000FFFF0FF0, DR7 - 0000000000000400
GDTR - 000000007F9DC000 0000000000000047, LDTR - 0000000000000000
IDTR - 000000007F2CD018 0000000000000FFF,   TR - 0000000000000000
FXSAVE_STATE - 000000007FF04370
!!!! Find image based on IP(0x7F2CB5E8) /home/joeyli/source_code-git/edk2/Build/OvmfX64/DEBUG_GCC5/X64/UefiCpuPkg/CpuIo2Dxe/CpuIo2Dxe/DEBUG/CpuIo2Dxe.dll (ImageBase=000000007F2CA000, EntryPoint=000000007F2CBDE8) !!!!

- ovmf debug log stop here:
...
InstallProtocolInterface: 18A031AB-B443-4D1A-A5C0-0C09261E9F71 7E569E20 
InstallProtocolInterface: 6A7A5CFF-E8D9-4F70-BADA-75AB3025CE14 7E569DF0
Found LPC Bridge device
BdsPlatform.c+712: COM1 DevPath: PciRoot(0x0)/Pci(0x1F,0x0)/Serial(0x0)/Uart(115200,8,N,1)/VenMsg(E0C14753-F9BE-11D2-9A0C-0090273FC14D) 
BdsPlatform.c+750: COM2 DevPath: PciRoot(0x0)/Pci(0x1F,0x0)/Serial(0x1)/Uart(115200,8,N,1)/VenMsg(E0C14753-F9BE-11D2-9A0C-0090273FC14D)
Select Item: 0xE
InstallProtocolInterface: FA920010-6785-4941-B6EC-498C579F160A 7E723020


- My build command for building x64 ovmf:

build -D SECURE_BOOT_ENABLE -D TPM_ENABLE -D TPM_CONFIG_ENABLE -D NETWORK_IP6_ENABLE -D NETWORK_HTTP_BOOT_ENABLE -a X64 -b DEBUG -t GCC5 -p OvmfPkg/OvmfPkgX64.dsc -D FD_SIZE_4MB -D NETWORK_TLS_ENABLE</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21192</commentid>
    <comment_count>1</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-15 04:43:43 +0000</bug_when>
    <thetext>After bisecting, found this patch causes problem:

commit ecb778d0ac62560aa172786ba19521f27bc3f650
Author: Gerd Hoffmann &lt;kraxel@redhat.com&gt;
Date:   Tue Oct 4 15:47:27 2022 +0200

    OvmfPkg/PlatformInitLib: dynamic mmio window size

I reverted this patch and didn&apos;t see CpuIo2Dxe.dll page-fault now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21193</commentid>
    <comment_count>2</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-15 04:47:29 +0000</bug_when>
    <thetext>The same page-fault can reproduced on edk2-stable202302:

linux-691t:/home/joeyli # virsh start opensuseTW; virsh console opensuseTW
Domain &apos;opensuseTW&apos; started

Connected to domain &apos;opensuseTW&apos;
Escape character is ^] (Ctrl + ])
!!!! X64 Exception Type - 0E(#PF - Page-Fault)  CPU Apic ID - 00000000 !!!!
ExceptionData - 000000000000000B  I:0 R:1 U:0 W:1 P:1 PK:0 SS:0 SGX:0
RIP  - 000000007F2C75E8, CS  - 0000000000000038, RFLAGS - 0000000000010246
RAX  - 0000000000000000, RCX - 0000000000000001, RDX - 000000007F2C85D0
RBX  - 0000038280000014, RSP - 000000007FF04710, RBP - 000000007FF04790
RSI  - 0000000000000000, RDI - 0000000000000000
R8   - 000000007FF04938, R9  - 0000000000000001, R10 - 0000000000000001
R11  - 0000000000000000, R12 - 000000007FF04938, R13 - 0000000000000001
R14  - 0000000000000001, R15 - 000000007F2C83EC
DS   - 0000000000000030, ES  - 0000000000000030, FS  - 0000000000000030
GS   - 0000000000000030, SS  - 0000000000000030
CR0  - 0000000080010033, CR2 - 0000038280000014, CR3 - 000000007FC01000
CR4  - 0000000000000668, CR8 - 0000000000000000
DR0  - 0000000000000000, DR1 - 0000000000000000, DR2 - 0000000000000000
DR3  - 0000000000000000, DR6 - 00000000FFFF0FF0, DR7 - 0000000000000400
GDTR - 000000007F9DC000 0000000000000047, LDTR - 0000000000000000
IDTR - 000000007F2C9018 0000000000000FFF,   TR - 0000000000000000
FXSAVE_STATE - 000000007FF04370
!!!! Find image based on IP(0x7F2C75E8) /home/joeyli/source_code-git/edk2/Build/OvmfX64/DEBUG_GCC5/X64/UefiCpuPkg/CpuIo2Dxe/CpuIo2Dxe/DEBUG/CpuIo2Dxe.dll (ImageBase=000000007F2C6000, EntryPoint=000000007F2C7DE8) !!!!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21194</commentid>
    <comment_count>3</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-15 04:49:04 +0000</bug_when>
    <thetext>Part of setting in my libvirt xml for the kvm to reproduce issue:

  &lt;memory unit=&apos;KiB&apos;&gt;2097152&lt;/memory&gt;
  &lt;currentMemory unit=&apos;KiB&apos;&gt;2097152&lt;/currentMemory&gt;
  &lt;vcpu placement=&apos;static&apos;&gt;2&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch=&apos;x86_64&apos; machine=&apos;pc-q35-3.1&apos;&gt;hvm&lt;/type&gt;
    &lt;loader readonly=&apos;yes&apos; secure=&apos;no&apos; type=&apos;pflash&apos;&gt;/usr/share/qemu/ovmf-x86_64-4m-code.bin&lt;/loader&gt;
    &lt;nvram template=&apos;/usr/share/qemu/ovmf-x86_64-4m-vars.bin&apos;&gt;/var/lib/libvirt/qemu/nvram/opensuseTW_VARS.fd&lt;/nvram&gt;
    &lt;boot dev=&apos;hd&apos;/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;ioapic driver=&apos;qemu&apos;/&gt;
  &lt;/features&gt;
  &lt;cpu mode=&apos;host-model&apos; check=&apos;partial&apos;/&gt;
  &lt;clock offset=&apos;utc&apos;&gt;
    &lt;timer name=&apos;rtc&apos; tickpolicy=&apos;catchup&apos;/&gt;
    &lt;timer name=&apos;pit&apos; tickpolicy=&apos;delay&apos;/&gt;
    &lt;timer name=&apos;hpet&apos; present=&apos;no&apos;/&gt;
  &lt;/clock&gt;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21195</commentid>
    <comment_count>4</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-03-15 05:24:21 +0000</bug_when>
    <thetext>&gt; !!!! Find image based on IP(0x7F2CB5E8)
&gt; /home/joeyli/source_code-git/edk2/Build/OvmfX64/DEBUG_GCC5/X64/UefiCpuPkg/
&gt; CpuIo2Dxe/CpuIo2Dxe/DEBUG/CpuIo2Dxe.dll (ImageBase=000000007F2CA000,
&gt; EntryPoint=000000007F2CBDE8) !!!!

Where exactly does it fault?  Just &apos;objdump -S CpuIo2Dxe.dll&apos;, look what is at offset 0x15e8 (IP - ImageBase).

&gt; - ovmf debug log stop here:

Can you &apos;grep ^Platform $logfile&apos; please, or just add the complete logfile as bugzilla attachment?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21198</commentid>
    <comment_count>5</comment_count>
      <attachid>1338</attachid>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-16 02:58:09 +0000</bug_when>
    <thetext>Created attachment 1338
ovmf-edk2-stable202302-page-fault.log

Hi Gerd, 

Thanks for your response!

The attached log file is from qemu-kvm 7.1 with edk2-stable202302 ovmf.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21199</commentid>
    <comment_count>6</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-16 04:08:40 +0000</bug_when>
    <thetext>(In reply to Gerd Hoffmann from comment #4)
&gt; &gt; !!!! Find image based on IP(0x7F2CB5E8)
&gt; &gt; /home/joeyli/source_code-git/edk2/Build/OvmfX64/DEBUG_GCC5/X64/UefiCpuPkg/
&gt; &gt; CpuIo2Dxe/CpuIo2Dxe/DEBUG/CpuIo2Dxe.dll (ImageBase=000000007F2CA000,
&gt; &gt; EntryPoint=000000007F2CBDE8) !!!!
&gt; 
&gt; Where exactly does it fault?  Just &apos;objdump -S CpuIo2Dxe.dll&apos;, look what is
&gt; at offset 0x15e8 (IP - ImageBase).
&gt; 

Looks that RIP is following:

~/source_code-git/edk2&gt; objdump -S ./Build/OvmfX64/DEBUG_GCC5/X64/UefiCpuPkg/CpuIo2Dxe/CpuIo2Dxe/DEBUG/CpuIo2Dxe.dll | less
...
0000000000001526 &lt;CpuMemoryServiceWrite&gt;:
  IN EFI_CPU_IO_PROTOCOL_WIDTH  Width,
  IN UINT64                     Address,
  IN UINTN                      Count,
  IN VOID                       *Buffer
  )
{
    1526:       55                      push   %rbp
    1527:       41 89 d3                mov    %edx,%r11d
  UINT8                      InStride;
  UINT8                      OutStride;
  EFI_CPU_IO_PROTOCOL_WIDTH  OperationWidth;
  UINT8                      *Uint8Buffer;
...
    15ab:       74 3b                   je     15e8 &lt;CpuMemoryServiceWrite+0xc2&gt;
...
      TdMmioWrite8 (Address, Value);
    } else {
      *(volatile UINT8 *)Address = Value;
    15e8:       40 88 3b                mov    %dil,(%rbx)           &lt;-- RIP
    15eb:       e9 bc 01 00 00          jmp    17ac &lt;CpuMemoryServiceWrite+0x286&gt;
    15f0:       e8 74 ec ff ff          call   269 &lt;DebugAssertEnabled&gt;
    } else if (OperationWidth == EfiCpuIoWidthUint16) {
    15f5:       83 fe 01                cmp    $0x1,%esi
    15f8:       40 88 c7                mov    %al,%dil
    15fb:       0f 85 95 00 00 00       jne    1696 &lt;CpuMemoryServiceWrite+0x170&gt;
  IN      UINT16  Value
  )
...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21200</commentid>
    <comment_count>7</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-16 04:10:40 +0000</bug_when>
    <thetext>(In reply to Joey Lee from comment #5)
&gt; Created attachment 1338 [details]
&gt; ovmf-edk2-stable202302-page-fault.log
&gt; 
&gt; Hi Gerd, 
&gt; 
&gt; Thanks for your response!
&gt; 
&gt; The attached log file is from qemu-kvm 7.1 with edk2-stable202302 ovmf.

Here is the register dump matches with the above debug log:

!!!! X64 Exception Type - 0E(#PF - Page-Fault)  CPU Apic ID - 00000000 !!!!
ExceptionData - 000000000000000B  I:0 R:1 U:0 W:1 P:1 PK:0 SS:0 SGX:0
RIP  - 000000007F37A5E8, CS  - 0000000000000038, RFLAGS - 0000000000010246
RAX  - 0000000000000000, RCX - 0000000000000001, RDX - 000000007F37B5D0
RBX  - 0000038280000014, RSP - 000000007FF04710, RBP - 000000007FF04790
RSI  - 0000000000000000, RDI - 0000000000000000
R8   - 000000007FF04938, R9  - 0000000000000001, R10 - 0000000000000001
R11  - 0000000000000000, R12 - 000000007FF04938, R13 - 0000000000000001
R14  - 0000000000000001, R15 - 000000007F37B3EC
DS   - 0000000000000030, ES  - 0000000000000030, FS  - 0000000000000030
GS   - 0000000000000030, SS  - 0000000000000030
CR0  - 0000000080010033, CR2 - 0000038280000014, CR3 - 000000007FC01000
CR4  - 0000000000000668, CR8 - 0000000000000000
DR0  - 0000000000000000, DR1 - 0000000000000000, DR2 - 0000000000000000
DR3  - 0000000000000000, DR6 - 00000000FFFF0FF0, DR7 - 0000000000000400
GDTR - 000000007F9DC000 0000000000000047, LDTR - 0000000000000000
IDTR - 000000007F37E018 0000000000000FFF,   TR - 0000000000000000
FXSAVE_STATE - 000000007FF04370
!!!! Find image based on IP(0x7F37A5E8) /home/joeyli/source_code-git/edk2/Build/OvmfX64/DEBUG_GCC5/X64/UefiCpuPkg/CpuIo2Dxe/CpuIo2Dxe/DEBUG/CpuIo2Dxe.dll (ImageBase=000000007F379000, EntryPoint=000000007F37ADE8)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21201</commentid>
    <comment_count>8</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-03-16 04:37:02 +0000</bug_when>
    <thetext>From the log:

[ ... ]
PciBus: Discovered PCI @ [06|00|00]  [VID = 0x1AF4, DID = 0x1044]
   BAR[4]: Type = PMem64; Alignment = 0x3FFF;	Length = 0x4000;	Offset = 0x20
[ ... ]
PciBus: Resource Map for Bridge [00|01|05]
Type =   Io16; Base = 0x7000;	Length = 0x200;	Alignment = 0xFFF
   Base = Padding;	Length = 0x200;	Alignment = 0x1FF
Type =  Mem32; Base = 0xC0200000;	Length = 0x200000;	Alignment = 0x1FFFFF
   Base = Padding;	Length = 0x200000;	Alignment = 0x1FFFFF
Type =  Mem32; Base = 0xC0E42000;	Length = 0x1000;	Alignment = 0xFFF
Type = PMem64; Base = 0x38280000000;	Length = 0x80000000;	Alignment = 0x7FFFFFFF
   Base = Padding;	Length = 0x80000000;	Alignment = 0x7FFFFFFF
   Base = 0x38280000000;	Length = 0x4000;	Alignment = 0x3FFF;	Owner = PCI [06|00|00:20]
[ ... ]

RBX = 0000038280000014, which addresses the mmio bar of pci device 06:00.0, which is a virtio-rng-pci device.  Possibly just the first access to a 64bit pci bar.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21202</commentid>
    <comment_count>9</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-03-16 04:38:35 +0000</bug_when>
    <thetext>Can&apos;t reproduce it here.  What does &apos;lscpu&apos; print on the host machine?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21203</commentid>
    <comment_count>10</comment_count>
      <attachid>1339</attachid>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-16 07:23:23 +0000</bug_when>
    <thetext>Created attachment 1339
lscpu.log

Hi Gerd,

(In reply to Gerd Hoffmann from comment #9)
&gt; Can&apos;t reproduce it here.  What does &apos;lscpu&apos; print on the host machine?

The attached log is lscpu information on my host machine.

Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21204</commentid>
    <comment_count>11</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-03-16 08:43:53 +0000</bug_when>
    <thetext>Host:

Address sizes:                   39 bits physical, 48 bits virtual

Guest:

PlatformAddressWidthFromCpuid: Signature: &apos;GenuineIntel&apos;, PhysBits: 42, QemuQuirk: On, Valid: Yes

So the guest runs with 42 phys-bits, which is more than the host actually supports (39).  Which is an invalid configuration.  With the patch discussed here OVMF
starts using the physical address space it has, and things will actually explode.  Older OVMF versions used to be very conservative in address space usage, so things usually worked fine even in invalid configurations.

I&apos;m wondering how you end up in that situation.  The libvirt config snippet in
comment 3 does not look like you setting phys-bits to a non-default value.  So
I&apos;d expect qemu using the default of phys-bits=40, which ovmf should discard as invalid because intel cpus with that don&apos;t exist. See PlatformAddressWidthFromCpuid() and the comment above that function for details.

FYI: Libvirt allows to set phys-bits like this (use same as host):

  &lt;cpu [ ... ]&gt;
    &lt;maxphysaddr mode=&apos;passthrough&apos;/&gt;
  &lt;/cpu&gt;

or this (set specific value):

  &lt;cpu [ ... ]&gt;
    &lt;maxphysaddr mode=&apos;emulate&apos; bits=&apos;39&apos;/&gt;
  &lt;/cpu&gt;

See https://libvirt.org/formatdomain.html#cpu-model-and-topology</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21245</commentid>
    <comment_count>12</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-22 04:50:14 +0000</bug_when>
    <thetext>Hi Gerd, 

Thanks for your help!

(In reply to Gerd Hoffmann from comment #11)
&gt; Host:
&gt; 
&gt; Address sizes:                   39 bits physical, 48 bits virtual
&gt; 
&gt; Guest:
&gt; 
&gt; PlatformAddressWidthFromCpuid: Signature: &apos;GenuineIntel&apos;, PhysBits: 42,
&gt; QemuQuirk: On, Valid: Yes
&gt; 
&gt; So the guest runs with 42 phys-bits, which is more than the host actually
&gt; supports (39).  Which is an invalid configuration.  With the patch discussed
&gt; here OVMF
&gt; starts using the physical address space it has, and things will actually
&gt; explode.  Older OVMF versions used to be very conservative in address space
&gt; usage, so things usually worked fine even in invalid configurations.
&gt; 
&gt; I&apos;m wondering how you end up in that situation.  The libvirt config snippet
&gt; in
&gt; comment 3 does not look like you setting phys-bits to a non-default value. 
&gt; So
&gt; I&apos;d expect qemu using the default of phys-bits=40, which ovmf should discard
&gt; as invalid because intel cpus with that don&apos;t exist. See
&gt; PlatformAddressWidthFromCpuid() and the comment above that function for
&gt; details.

As you mentioned, I have added more debug log to PlatformAddressWidthFromCpuid() to print the Max value, it shows:

PlatformAddressWidthFromCpuid
PlatformAddressWidthFromCpuid: Max: 0x80000008
PlatformAddressWidthFromCpuid: PhysBits: 42
PlatformAddressWidthFromCpuid: Signature: &apos;GenuineIntel&apos;, PhysBits: 42, QemuQuirk: On, Valid: Yes

The PhysBit 42 hits the first rule &quot;(1) If it is 41 or higher consider it valid.&quot;.

PlatformAddressWidthFromCpuid() sets the PhysBits to Valid. But it&apos;s more than real value 39 obviously.

Does that mean that my CPU or somewhere in hardware has bug?

&gt; 
&gt; FYI: Libvirt allows to set phys-bits like this (use same as host):
&gt; 
&gt;   &lt;cpu [ ... ]&gt;
&gt;     &lt;maxphysaddr mode=&apos;passthrough&apos;/&gt;
&gt;   &lt;/cpu&gt;
&gt; 
&gt; or this (set specific value):
&gt; 
&gt;   &lt;cpu [ ... ]&gt;
&gt;     &lt;maxphysaddr mode=&apos;emulate&apos; bits=&apos;39&apos;/&gt;
&gt;   &lt;/cpu&gt;
&gt; 
&gt; See https://libvirt.org/formatdomain.html#cpu-model-and-topology

My libvirt is 8.0 which doesn&apos;t support maxphysaddr. But using host-passthrough can also workaround issue on my machinen:

&lt;cpu mode=&apos;host-passthrough&apos; check=&apos;partial&apos; migratable=&apos;on&apos;/&gt;

Thanks a lot!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21246</commentid>
    <comment_count>13</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-03-22 06:13:38 +0000</bug_when>
    <thetext>&gt; Does that mean that my CPU or somewhere in hardware has bug?

No, the configuration (phys-bits=42) is broken.

qemu defaults to phys-bits=40, and I can&apos;t see anything changing that default in
your libvirt xml, so I&apos;m wondering where this comes from ...

&gt; &lt;cpu mode=&apos;host-passthrough&apos; check=&apos;partial&apos; migratable=&apos;on&apos;/&gt;

Yes, that sets the &quot;host-phys-bits=on&quot; cpu option, which will
passthrough the hosts value to the guest.  That&apos;ll work too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21247</commentid>
    <comment_count>14</comment_count>
      <attachid>1345</attachid>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-22 07:45:20 +0000</bug_when>
    <thetext>Created attachment 1345
opensuseTW-libvirt.xml

Not sure it&apos;s helpful, I still attached complete libvirt xml here for reference.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21248</commentid>
    <comment_count>15</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-03-22 07:54:29 +0000</bug_when>
    <thetext>Hi Gerd,

(In reply to Gerd Hoffmann from comment #13)
&gt; &gt; Does that mean that my CPU or somewhere in hardware has bug?
&gt; 
&gt; No, the configuration (phys-bits=42) is broken.
&gt; 
&gt; qemu defaults to phys-bits=40, and I can&apos;t see anything changing that
&gt; default in
&gt; your libvirt xml, so I&apos;m wondering where this comes from ...
&gt; 

I found one thing. I am checking the source code in qemu of openSUSE. I found that a patch be applied to increase x86_64 physical bits to 42. I am checking with our virtualization team against this patch. 

I set this bug to INVALID. Thank you so much!</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1338</attachid>
            <date>2023-03-16 02:58:09 +0000</date>
            <delta_ts>2023-03-16 02:58:09 +0000</delta_ts>
            <desc>ovmf-edk2-stable202302-page-fault.log</desc>
            <filename>ovmf-edk2-stable202302-page-fault.log</filename>
            <type>text/x-log</type>
            <size>102120</size>
            <attacher name="Joey Lee">jlee</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1339</attachid>
            <date>2023-03-16 07:23:23 +0000</date>
            <delta_ts>2023-03-16 07:23:23 +0000</delta_ts>
            <desc>lscpu.log</desc>
            <filename>lscpu.log</filename>
            <type>text/x-log</type>
            <size>2809</size>
            <attacher name="Joey Lee">jlee</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1345</attachid>
            <date>2023-03-22 07:45:20 +0000</date>
            <delta_ts>2023-03-22 07:45:20 +0000</delta_ts>
            <desc>opensuseTW-libvirt.xml</desc>
            <filename>opensuseTW-libvirt.xml</filename>
            <type>text/xml</type>
            <size>5460</size>
            <attacher name="Joey Lee">jlee</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4191</bug_id>
          
          <creation_ts>2022-12-13 22:34:11 +0000</creation_ts>
          <short_desc>Newline error when compiling from linux</short_desc>
          <delta_ts>2022-12-14 03:22:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20210</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-12-13 22:34:11 +0000</bug_when>
    <thetext>There is a newline error when compiling from linux, needs to be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20211</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-12-13 22:34:54 +0000</bug_when>
    <thetext>I&apos;m working on this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20215</commentid>
    <comment_count>2</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-12-14 03:22:00 +0000</bug_when>
    <thetext>This issue is already resolved.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4837</bug_id>
          
          <creation_ts>2024-08-23 18:52:05 +0000</creation_ts>
          <short_desc>Add BrainpoolP512r1 definition</short_desc>
          <delta_ts>2024-08-27 11:34:05 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Holland">michael.holland</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23340</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Holland">michael.holland</who>
    <bug_when>2024-08-23 18:52:05 +0000</bug_when>
    <thetext>Add definition for BrainpoolP512r1</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23341</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Holland">michael.holland</who>
    <bug_when>2024-08-24 12:36:28 +0000</bug_when>
    <thetext>Bug has been assigned</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23343</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Holland">michael.holland</who>
    <bug_when>2024-08-24 12:38:47 +0000</bug_when>
    <thetext>PR has been issued:  https://github.com/tianocore/edk2/pull/6105</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23344</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Holland">michael.holland</who>
    <bug_when>2024-08-27 11:34:05 +0000</bug_when>
    <thetext>Merged into EDK2 master</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4064</bug_id>
          
          <creation_ts>2022-09-15 15:13:32 +0000</creation_ts>
          <short_desc>Update HTTP Boot Device Path in UEFI specification</short_desc>
          <delta_ts>2022-09-15 15:14:18 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4052</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Saloni Kasbekar">saloni.kasbekar</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>UEFI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19573</commentid>
    <comment_count>0</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-15 15:13:32 +0000</bug_when>
    <thetext>Proposal to add below snippet to Section 24.7.3.1 to support addition of proxy server URI in the device path - 


In order to support HTTP Boot via a proxy server, a second Uri() path can be added to the device path that contains the proxy server&apos;s path. In this case, the boot file path would be appended to the proxy server&apos;s URI. For example:
PciRoot(0x0)/Pci(0x19, 0x0)/MAC(001230F4B4FF, 0x0)/IPv4(192.168.1.100, TCP, DHCP, 192.168.1.5,
192.168.1.1, 255.255.255.0)/Uri(http://192.168.1.100)/Uri(http://proxy-server.com/shell.efi)
PciRoot(0x0)/Pci(0x19, 0x0)/MAC(001230F4B4FF, 0x0)/IPv6(2015::100, TCP, StatefulAutoConfigure,
2015::5, 2015::10, 64)/Uri(http://2015::100)/Uri(http://proxy-server.com/shell.efi)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19574</commentid>
    <comment_count>1</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-15 15:14:18 +0000</bug_when>
    <thetext>Will update https://bugzilla.tianocore.org/show_bug.cgi?id=4052 to Edk2 Code First and close this as a duplicate.

*** This bug has been marked as a duplicate of bug 4052 ***</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4683</bug_id>
          
          <creation_ts>2024-02-13 20:35:02 +0000</creation_ts>
          <short_desc>Unit tests that generate an exception may be seen as passing unit test</short_desc>
          <delta_ts>2024-02-13 21:47:02 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>michael.kubacki</cc>
    
    <cc>quic_llindhol</cc>
    
    <cc>sean.brogan</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
    
    <cf_package>UnitTestFrameworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22582</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 20:35:02 +0000</bug_when>
    <thetext>Host-based unit tests that generate an exception may be ignored and 
show as a unit test pass condition. This is observed when unit tests
are run in windows environments.  When an exception occurs, one of
two behaviors are possible:
1) Exit the process with an error condition.  It caught as a unit test failure.
2) Generate a pop-up with option to run a debugger. In CI agent environments,
   depending on the configuration of the CI agent, the popup may be ignored
   and the process exits without an error condition.  This is seen as
   a unit test pass condition.

The proposed fix to this issue is to guarantee that CI builds of unit
tests never generate a popup and always terminate the process with an
error exit code that is seen as a unit test failure. The most compatible
way to build unit tests with this property is to guarantee release
libraries are used.

Attempting to use release libraries uncovered a cascade of issues that
all have to be fixed together.  The complete set of changes required
are: 

* For host-based VX20xx builds, use release builds by default to
  make sure unexpected exceptions are caught as a test failure.
  Using debug libraries may generate a popup window to prompt 
  running a debugger, which is value for debug, but that mode
  does not generate an error in CI.
* Update UNIT_TEST_DEBUG to enable use of VS20xx debug libraries
  to enable popup windows to run debugger. 
* Remove DebugLib.h internal macro name collision with windows.h
  that was introduced when release libraries are used by default.
* Update MSFT and GCC flags to consistently enable structured 
  exception handling so Google Test host-based unit tests that
  check for expected ASSERT() conditions can be properly detected.
  The additional benefit of this bug fix is that catching thrown
  exceptions is much faster than EXPECT_DEATH() tests. The gtest
  sample unit tests are updated to use ASSERT_ANY_THROW() instead
  of EXPECT_DEATH().
* In order to catch C++ exceptions for google test, the 
  UnitTestDebugAssertLib has to be split into a target version
  and a host version and had to be able to detect the difference
  between cmock host-based tests and gtest host-based tests. This
  required minor changes to the UnitTestLib to be able to use the
  UnitTestLib GetFrameworkHandle() API to make that determination.
  It is NULL for gtest and non-NULL for cmocka.
* In order to test the unit test failing conditions, unit tests
  the fail on purpose and unit tests that generate exceptions are
  added.  These are not added to CI because that would cause CI to
  always fail. Instead, they can be run to make sure that reports
  generated provide the right level of detail for a developer to
  quickly identify the source of the unit test failure or the 
  source of the exception.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22583</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 20:36:02 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22584</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 20:46:14 +0000</bug_when>
    <thetext>Additional details on how to select between release libraries and debug libraries
for VS20xx builds of host-based unit tests:

There are 4 choices when building a windows app:
  a. /MT   Release build with statically linked CRT libs
  b. /MTd  Debug build with statically linked CRT libs
  c. /MD   Release build with dynamically linked CRT libs (.dlls)
  d. /MDd  Debug build with dynamically linked CRT libs (.dlls)

https://learn.microsoft.com/en-us/cpp/build/reference/md-mt-ld-use-run-time-library?view=msvc-170

The most important requirement when building the windows application
for google tests is that 100% of the components are all built in one
of those 4 ways.  No mixing or all kinds of strange build issues occur.

Previously, /NODEFAULTLIB was used to build host-based tests.  This 
required the explicit list of libs to link and a carefully crafted
single combination of libs was selected that happened to build.  When
/NODEFAULTLIB was removed, the CRT library selection is performed by
the VS20xx compiler/linker driven by the /MT, /MTd, /MD, /MDd options.
The carefully crafted set avoided the _DEBUG macro collision between
DebugLib and windows.h. Updating DebugLib.h to change _DEBUG to 
_DEBUGLIB_DEBUG avoids that name collision and makes all 4 options
available when building host-based unit tests with VS20xx.

The critical bug that is being fixed is due to the use of debug libs
that generate a popup to run a debugger when an unexpected exception
is detected (e.g. heap corruption, divide by zero, null pointer ref). 
For some CI agents, this popup is suppressed and the test is considered
“PASS”, which means there is a false PASS condition.  There are a
number of ways identified to fix this behavior.

1) Add call in main() to set policy  (requires update to all unit tests)
2) Change policy in CI agent  (requires review/update to all CI agents)
3) Only link VS20xx release libraries /MT (no source code changes to unit
   tests and no CI agents changes required)

Option (3) is selected as the most compatible change.  The default must
be release libs, but when a developer is running locally and wants to
debug, an opt-in option to use debug libs is required so a developer 
can see the popup and invoke a debugger.  The /MTd is enabled when 
UNIT_TESTING_DEBUG=1 is used.

The next decision is between static CRT libs or dynamic CRT libs (.dll).
Static libs are selected so the single .exe contains the unit test cases, 
the code under test, gtest/gmock, and the CRT libs with no DLL 
dependencies. This simplifies the debug experience for FW developers 
that may not have a lot of windows application development experience 
with .dlls.  One side effect may be larger .exes with /MT than /MD, but
that should not matter for most use cases.  The only place it may impact
is if the .exes need to be archives as artifacts and the size of those
artifacts become too large over time.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22585</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 20:54:02 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/5345

Patch email for review
V1: https://edk2.groups.io/g/devel/message/115224
V2: https://edk2.groups.io/g/devel/message/115315
V3: https://edk2.groups.io/g/devel/message/115323
V4: https://edk2.groups.io/g/devel/message/115392</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22586</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 21:04:15 +0000</bug_when>
    <thetext>If exception is seen when a unit test application is run

1) If Google Test, then rerun unit test adding –gtest_catch_exceptions=0
   to the command line.  This will cause popup and allow a developer to
   run a debugger
2) If framework/cmocka, then rebuild unit test with -D UNIT_TESTING_DEBUG=1,
   then rerun unit test.  This will cause popup and allow a developer to
   run a debugger

If the exception is heap corruption, then this can be challenging to find
the source of the heap corruption.  For this exception type add the following
to unit test main .cpp file.  This enabled heap corruption detection on every
allocate and every free operation, so the exeception is generated closer to 
the source of the corruption:

    #include &lt;crtdbg.h&gt;

    main() {
      _CrtSetDbgFlag (_CrtSetDbgFlag ( _CRTDBG_REPORT_FLAG ) | _CRTDBG_CHECK_ALWAYS_DF);

    }

https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/crtsetdbgflag?view=msvc-170</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22587</commentid>
    <comment_count>5</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 21:08:39 +0000</bug_when>
    <thetext>If the current system configuration does not generate a popup to
run a debugger when an exception occurs, the registry may need to
be updated to set the AeDebug key.  There is one entry for 64-bit
apps and one for 32-bit apps

HKLM\Software\Microsoft\Windows NT\CurrentVersion\AeDebug
HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\AeDebug

https://learn.microsoft.com/en-us/windows/win32/debug/configuring-automatic-debugging

https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/enabling-postmortem-debugging</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22588</commentid>
    <comment_count>6</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 21:47:02 +0000</bug_when>
    <thetext>Merged: https://github.com/tianocore/edk2/pull/5345</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4544</bug_id>
          
          <creation_ts>2023-08-30 02:51:34 +0000</creation_ts>
          <short_desc>SMBIOS BCD revision is not match SMBIOS version</short_desc>
          <delta_ts>2023-10-26 17:20:38 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Horace Lien">horacex.lien</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21873</commentid>
    <comment_count>0</comment_count>
      <attachid>1407</attachid>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2023-08-30 02:51:34 +0000</bug_when>
    <thetext>Created attachment 1407
BCD Revision Issue

The SMBIOS BCD Revision(1Eh) field is in SMBIOS 32bit entry point structure table, this is value need to match BCD value of SMBIOS Major/Minor(06-07h) Version.
The value of Major/Minor version are updated from SMBIOS memory data, but BCD
Revision is updated from PCD PcdSmbiosVersion. This PCD default value is 0x0303(means 3.3 version), when PCD PcdSmbiosVersion is no equal than 0x0303 then it will cause BCD Revision is no match Major/Minor version. Because of UefiPayloadPkg.dsc is build by independent, this PCD PcdSmbiosVersion won&apos;t be override. We should also update PCD PcdSmbiosVersion from SMBIOS memory data to make sure that get consistent version value.

Edk2\MdeModulePkg\Universal\SmbiosDxe\SmbiosDxe.c
Function: SmbiosCreateTable()
Line: 1073-1074 is update from SMBIOS memory data
Line: 1075 is update from PCD PcdSmbiosVersion</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21880</commentid>
    <comment_count>1</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2023-08-31 05:29:27 +0000</bug_when>
    <thetext>Corrected typo.

We should also update &quot;BCDRevision&quot; from SMBIOS memory data to make sure that get consistent version value.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21940</commentid>
    <comment_count>2</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2023-09-26 23:31:38 +0000</bug_when>
    <thetext>PR already merged.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22079</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 17:20:38 +0000</bug_when>
    <thetext>commit be971fc302cbef8f47e2612eda114135f21205e6</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1407</attachid>
            <date>2023-08-30 02:51:34 +0000</date>
            <delta_ts>2023-08-30 02:51:34 +0000</delta_ts>
            <desc>BCD Revision Issue</desc>
            <filename>BCD Revision Issue.png</filename>
            <type>image/png</type>
            <size>21279</size>
            <attacher name="Horace Lien">horacex.lien</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4094</bug_id>
          
          <creation_ts>2022-10-04 22:48:06 +0000</creation_ts>
          <short_desc>Platform/Intel: Several invalid DEBUG() macros present</short_desc>
          <delta_ts>2022-10-12 22:17:18 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kubacki">michael.kubacki</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19704</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-04 22:48:06 +0000</bug_when>
    <thetext>Several debug macros in Platform/Intel have a mismatched number of print specifiers to arguments. This can lead to undefined behavior.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19705</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-04 22:48:21 +0000</bug_when>
    <thetext>I will send a patch series soon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19714</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-05 02:01:53 +0000</bug_when>
    <thetext>V1 patch series: https://edk2.groups.io/g/devel/message/94733</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19765</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-12 22:17:18 +0000</bug_when>
    <thetext>Pushed to edk2-platforms/master in df65f5d85c6af0e7076ed052b1e8b831edd14c53 to 66cef08cdef5a1b77f1c15dbc38edb37b0394ea3.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4726</bug_id>
          
          <creation_ts>2024-03-08 02:17:21 +0000</creation_ts>
          <short_desc>There are a lot of file names in the INF that are not in alphabetical order</short_desc>
          <delta_ts>2024-04-24 21:29:28 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22751</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-03-08 02:17:21 +0000</bug_when>
    <thetext>Reorder file or PCD names in an INF file alphabetically.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22752</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-03-08 02:17:53 +0000</bug_when>
    <thetext>I&apos;m working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22966</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-04-24 21:04:33 +0000</bug_when>
    <thetext>Chao Li will take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22971</commentid>
    <comment_count>3</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-04-24 21:29:28 +0000</bug_when>
    <thetext>EDK2 has been merged the changes, and this issue has been resolved and it can be closed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4427</bug_id>
          
          <creation_ts>2023-04-26 08:32:38 +0000</creation_ts>
          <short_desc>UefiPayloadPkg: Fix issues when MULTIPLE_DEBUG_PORT_SUPPORT is true</short_desc>
          <delta_ts>2023-05-09 22:02:58 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Payton Hsieh">paytonx.hsieh</reporter>
          <assigned_to name="Payton Hsieh">paytonx.hsieh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21433</commentid>
    <comment_count>0</comment_count>
    <who name="Payton Hsieh">paytonx.hsieh</who>
    <bug_when>2023-04-26 08:32:38 +0000</bug_when>
    <thetext>When MULTIPLE_DEBUG_PORT_SUPPORT is set to TRUE: 
1. Both legacy and LPSS UART print unrecognized debug messages
2. System hang during ExitBootServices event.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21440</commentid>
    <comment_count>1</comment_count>
    <who name="Payton Hsieh">paytonx.hsieh</who>
    <bug_when>2023-04-27 00:53:56 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/4317</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21545</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 22:02:58 +0000</bug_when>
    <thetext>It has been merged by https://github.com/tianocore/edk2/pull/4317</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4253</bug_id>
          
          <creation_ts>2023-01-04 15:42:13 +0000</creation_ts>
          <short_desc>Expected test results in AuthVariableDERConfTest() do not comply to UEFI specification</short_desc>
          <delta_ts>2024-09-05 16:24:44 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Heinrich Schuchardt">xypron.glpk</reporter>
          <assigned_to name="Stuart Yoder">stuart.yoder</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>eric.jin</cc>
    
    <cc>xypron.glpk</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20491</commentid>
    <comment_count>0</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2023-01-04 15:42:13 +0000</bug_when>
    <thetext>AuthVariableDERConfTest() calls QueryVariableInfo() with Attr == EFI_VARIABLE_NON_VOLATILE (AttrArray[0]). Attr without EFI_VARIABLE_BOOTSERVICE_ACCESS is neither allowable as boot services time nor at runtime. (See comment in VariableServiceSetVariable(), MdeModulePkg/Universal/Variable/RuntimeDxe/Variable.c).

The test expects QueryVariableInfo() to return EFI_UNSUPPORTED because the value of Attr is illegal. But the UEFI specification requires EFI_INVALID_PARAMETER to be returned for an &quot;invalid combination of attribute bits&quot;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21138</commentid>
    <comment_count>1</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-03-02 10:00:19 +0000</bug_when>
    <thetext>For this test there are two main cases:
1. We OR all the attributes test combination with the deprecated attribute: EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS
we expect edk2 to return EFI_UNSUPPORTED

2. We have the invalid combination: EFI_VARIABLE_NON_VOLATILE without EFI_VARIABLE_BOOTSERVICE_ACCESS
we expect edk2 to return EFI_INVALID_PARAMETER
However, since this is ORed with EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS, return of EFI_UNSUPPORTED is valid too.

Which should take precedence?


There is no mention of the precedence in UEFI Spec.

Note: Now setVariable() takes higher precedence for EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS (deprecated) based on a recent code change: https://github.com/tianocore/edk2/commit/68c1bedbf297b57a336a2edc046f1f9874ba69fa</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21139</commentid>
    <comment_count>2</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2023-03-02 10:23:43 +0000</bug_when>
    <thetext>EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS is deprecated but not forbidden to implement. An implementation with EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS support would have to return EFI_INVALID_PARAMETER. So the test must accept this value.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21621</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-06-01 10:27:16 +0000</bug_when>
    <thetext>Stuart to check the UEFI Spec for mention of precedence.
If there is no precedence mentioned then we will raise an ECR ticket for this clarfication in UEFI spec.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21625</commentid>
    <comment_count>4</comment_count>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2023-06-01 16:22:39 +0000</bug_when>
    <thetext>Summarizing the situation...

The SCT test in question ORs the following attributes and passes QueryVariableInfo():
  EFI_VARIABLE_NON_VOLATILE
  EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS

Unfortunately, the UEFI spec is vague and open to interpretation as to how this is to be handled.

The 2.10 spec says the following about EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS:

//NOTE: EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS is deprecated
//and should be considered reserved.

If it is to be treated as reserved, it certainly seems like a firmware implementation should not support it.  For QueryVariableInfo() the return value EFI_UNSUPPORTED means is defined as &quot;The attribute is not supported on this platform&quot;.

So, I think the spec is clear enough that EFI_UNSUPPORTED is correct if EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS is passed in.

But, the second issue is that EFI_VARIABLE_NON_VOLATILE by itself is invalid, which should result in EFI_INVALID_PARAMETER.

So, the question is should firmware return EFI_UNSUPPORTED or EFI_INVALID_PARAMETER?

EDK2 returns EFI_UNSUPPORTED.
edk2-test expects EFI_UNSUPPORTED.

I will open up a bugzilla ticket against the UEFI spec to request clarification.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21627</commentid>
    <comment_count>5</comment_count>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2023-06-01 17:22:14 +0000</bug_when>
    <thetext>https://bugzilla.tianocore.org/show_bug.cgi?id=4475</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23381</commentid>
    <comment_count>6</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-09-05 10:26:02 +0000</bug_when>
    <thetext>Edhay to check if this updated in the latest UEFI draft and close.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23385</commentid>
    <comment_count>7</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-09-05 16:24:44 +0000</bug_when>
    <thetext>The below clarification features in the latest UEFI draft
https://members.uefi.org/wg/uswg/document/1484

&quot;If a caller to QueryVariableInfo() specifies a combination of both unsupported and invalid attributes,
EFI_UNSUPPORTED should be returned.&quot;

the UEFI-SCT test confirms with the above statement.

Closing this issue as RESOLVED.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4119</bug_id>
          
          <creation_ts>2022-10-25 15:32:15 +0000</creation_ts>
          <short_desc>IntelFsp2WrapperPkg: Check header version before accessing MultiPhase fields.</short_desc>
          <delta_ts>2022-10-25 20:46:18 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2WrapperPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19821</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-25 15:32:15 +0000</bug_when>
    <thetext>Current implementation directly accessing MultiPhase fields from FSP header but it may not be present in early version of FSP and can cause system hang.

FSP header specification version should be verified before accessing MultiPhase fields.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19822</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-25 15:32:38 +0000</bug_when>
    <thetext>working on the fix.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19823</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-25 20:46:18 +0000</bug_when>
    <thetext>
Patch merged: https://github.com/tianocore/edk2/commit/26638d2aa399e436f47d629f877e581ed402020a</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4756</bug_id>
          
          <creation_ts>2024-04-17 02:22:52 +0000</creation_ts>
          <short_desc>[TDVF] TDVF README is a bit outdated</short_desc>
          <delta_ts>2024-04-22 02:48:44 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22920</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2024-04-17 02:22:52 +0000</bug_when>
    <thetext>TDVF README at OvmfPkg/IntelTdx/README is a bit outdated.
Its name is README and is better to be changed to README.md so that it can be show as markdown document.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22937</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-04-22 02:48:44 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5578</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4605</bug_id>
          
          <creation_ts>2023-11-27 01:04:45 +0000</creation_ts>
          <short_desc>WifiConnectionManager: Not trigger scan when UEFI Wi-Fi is in BSS connected state</short_desc>
          <delta_ts>2024-01-24 00:58:50 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Heng Luo">heng.luo</reporter>
          <assigned_to name="Heng Luo">heng.luo</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22189</commentid>
    <comment_count>0</comment_count>
    <who name="Heng Luo">heng.luo</who>
    <bug_when>2023-11-27 01:04:45 +0000</bug_when>
    <thetext>When UEFI Wi-Fi is in BSS connected state, the platform is considered as a static and Wi-Fi roaming support is not needed. Wifi connection manager should not  initiate Scan requests  in this state affect BSS client connectivity and must be avoided. User intimated Scan should be adhere to allow the user the option to connect to other network.
When UEFI Wi-Fi is in BSS connected state, the platform is considered as a static and Wi-Fi roaming support is not needed - extra scan can impact the TpT performance.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22190</commentid>
    <comment_count>1</comment_count>
    <who name="Heng Luo">heng.luo</who>
    <bug_when>2023-11-27 01:06:48 +0000</bug_when>
    <thetext>I will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22395</commentid>
    <comment_count>2</comment_count>
    <who name="Heng Luo">heng.luo</who>
    <bug_when>2024-01-24 00:57:10 +0000</bug_when>
    <thetext>he patch had been upstream to Edk2: NetworkPkg: Triger regularly scan only if not connect to AP · tianocore/edk2@c15a899 (github.com)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22396</commentid>
    <comment_count>3</comment_count>
    <who name="Heng Luo">heng.luo</who>
    <bug_when>2024-01-24 00:58:50 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/commit/c15a899d835ce9d06177be6db95ee8e8aeda5891</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4306</bug_id>
          
          <creation_ts>2023-01-17 03:04:21 +0000</creation_ts>
          <short_desc>Add ACPI 6.5 header</short_desc>
          <delta_ts>2023-01-31 05:09:57 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20693</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-01-17 03:04:21 +0000</bug_when>
    <thetext>ACPI specification 6.5 has been released in August 2022, EDK2 needs to add V6.5 header.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20694</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-01-17 03:05:01 +0000</bug_when>
    <thetext>I&apos;m working on this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20961</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-31 00:13:10 +0000</bug_when>
    <thetext>Chao is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20965</commentid>
    <comment_count>3</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-01-31 05:09:57 +0000</bug_when>
    <thetext>Merged, close it.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4142</bug_id>
          
          <creation_ts>2022-11-07 08:38:15 +0000</creation_ts>
          <short_desc>Modify _CID of PRMT Device (_HID=80860223) so it will not generate unknown device when default drivers loaded</short_desc>
          <delta_ts>2022-11-07 09:59:16 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4141</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Paul Lohr">paul.a.lohr</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>paul.a.lohr</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>PrmPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19951</commentid>
    <comment_count>0</comment_count>
    <who name="Paul Lohr">paul.a.lohr</who>
    <bug_when>2022-11-07 08:38:15 +0000</bug_when>
    <thetext>PRM Drivers are not native to OS.  for PRMT (_HID = 808602223), it has an incorrect _CID, one that will cause an unknown device to be reported during some certification tests.

Change will implement a correct _CID that defines the device as a generic motherboard when the PRM Drivers are not loaded.  Also, undo the incomplete workaround to hide the device when the PRM Driver is not loaded by setting _STA = 0x0F for said device.  This will allow the device to always be shown in Device Manager, either as the PRM device (when driver is loaded) or as a generic motherboard device (when only native Drivers are loaded).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19952</commentid>
    <comment_count>1</comment_count>
    <who name="Paul Lohr">paul.a.lohr</who>
    <bug_when>2022-11-07 08:41:08 +0000</bug_when>
    <thetext>Source location here:  Edk2\PrmPkg\PrmSsdtInstallDxe\Prm.asl

Code change:

        Device (PRMT)
        {
            Name (_HID, &quot;80860223&quot;)
            Name (_CID, EISAID(&quot;PNP0C02&quot;))
//...

            Method (_STA, 0, NotSerialized)
            {
                Return (0x0F) // Device Present, Enabled, Show, Functional.
            }
//...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19957</commentid>
    <comment_count>2</comment_count>
    <who name="Paul Lohr">paul.a.lohr</who>
    <bug_when>2022-11-07 09:59:16 +0000</bug_when>
    <thetext>Duplicate.  See 4141.

*** This bug has been marked as a duplicate of bug 4141 ***</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4788</bug_id>
          
          <creation_ts>2024-06-14 11:46:20 +0000</creation_ts>
          <short_desc>edk2-libc - add github actions workflow to build Python UEFI interpreter with VS2019</short_desc>
          <delta_ts>2024-06-20 12:51:57 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23116</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-14 11:46:20 +0000</bug_when>
    <thetext>Add github actions workflow into the edk2-libc repo to build Python UEFI interpreter from AppPkg.dsc whenever there is a push or pull request raised on this repo.

This will help reviewers / maintainers to ensure that the changes to edk2-libc doesn&apos;t break the Python UEFI interpreter build and reduce the amount of work that they need to do before merging the changes to master repo.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23117</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-14 11:47:48 +0000</bug_when>
    <thetext>Jayaprakash Nevara will be working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23118</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-14 11:58:31 +0000</bug_when>
    <thetext>Implemented the github actions workflow required for this feature.
Will be raising an email patch review request for the same.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23119</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-14 13:06:12 +0000</bug_when>
    <thetext>Raised an email patch review request.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23144</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-20 12:51:57 +0000</bug_when>
    <thetext>Sent updated patch for review and got the approvals.
Merged the patch to master using the below commit 
commit 0626ad0f85a9a2e1c2b3782075fdbd78add8d667</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4016</bug_id>
          
          <creation_ts>2022-08-08 22:55:13 +0000</creation_ts>
          <short_desc>SCT StorageSecurityCommandProtocolTest ReceiveData_Conf failed with latest edk2 code base</short_desc>
          <delta_ts>2022-12-11 20:56:48 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Fu Siyuan">fusiyuan.fsy</reporter>
          <assigned_to name="Fu Siyuan">fusiyuan.fsy</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>hao.a.wu</cc>
    
    <cc>mateusz.albecki</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19367</commentid>
    <comment_count>0</comment_count>
    <who name="Fu Siyuan">fusiyuan.fsy</who>
    <bug_when>2022-08-08 22:55:13 +0000</bug_when>
    <thetext>In SctPkg/TestCase/UEFI/EFI/Protocol/StorageSecurityCommand/BlackBoxTest/StorageSecurityCommandBBTestConformance.c

test case SCT_Log/MediaAccessTest/StorageSecurityCommandProtocolTest0/
ReceiveData_Conf 

It tries to pass a 10 bytes length buffer to StorageSecurityCommand protocol and expect it return an error because &quot;for ATA8-ACS SecurityProtocol, 512 byte is a request&quot;.

This works with edk2 AtaAtapiPassThru driver before the SATA recovery flow was introduced. However after the recovery is implemented, the ATA passthru will recover the port error and return an EFI_SUCCESS, then the SCT test will fail.

I&apos;ve no idea if it&apos;s the AtaAtapiPassThru driver&apos;s bug (if it should return success when command execute is actually failed then port recovered), or the SCT test case should update align with edk2 implementation.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19459</commentid>
    <comment_count>1</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-09-01 10:24:25 +0000</bug_when>
    <thetext>Does the new recovery code follow the specification?
Consult the implementer from Intel for the details of the recovery code. 
According to spec, does 10 bytes denote failure?



To Fu Siyuan: 
Please give the complete output of the failing test?
Which line number causes the error ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19463</commentid>
    <comment_count>2</comment_count>
    <who name="Mateusz Albecki">mateusz.albecki</who>
    <bug_when>2022-09-01 10:57:29 +0000</bug_when>
    <thetext>I think it is a bug in SATA driver. The bug is that the Status variable is used to store ErrorRecovery data and overrides packet transfer status on last iteration of the retry loop:

in
https://github.com/tianocore/edk2/commit/64e25d4b062c907dab2dd30b686de9219d8e372c

AhciMode.c:976

The correct flow should be to return packet transfer/operation status. Bug is present in both PIO and DMA transfer.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19468</commentid>
    <comment_count>3</comment_count>
    <who name="Fu Siyuan">fusiyuan.fsy</who>
    <bug_when>2022-09-01 21:58:10 +0000</bug_when>
    <thetext>(In reply to Mateusz Albecki from comment #2)
&gt; I think it is a bug in SATA driver. The bug is that the Status variable is
&gt; used to store ErrorRecovery data and overrides packet transfer status on
&gt; last iteration of the retry loop:
&gt; 
&gt; in
&gt; https://github.com/tianocore/edk2/commit/
&gt; 64e25d4b062c907dab2dd30b686de9219d8e372c
&gt; 
&gt; AhciMode.c:976
&gt; 
&gt; The correct flow should be to return packet transfer/operation status. Bug
&gt; is present in both PIO and DMA transfer.

I hold the same opinion. The recovery result status override the failed transfer status.

It failed in SctPkg/TestCase/UEFI/EFI/Protocol/StorageSecurityCommand/BlackBoxTest/StorageSecurityCommandBBTestConformance.c:235: Status: Success ExpectedStatus:DeviceError</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19726</commentid>
    <comment_count>4</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-10-06 10:18:59 +0000</bug_when>
    <thetext>Hi Fu Siyan,

  Since this an issue in the firmware, can we close the ticket in edk2-test without fix?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19738</commentid>
    <comment_count>5</comment_count>
    <who name="Mateusz Albecki">mateusz.albecki</who>
    <bug_when>2022-10-11 10:52:37 +0000</bug_when>
    <thetext>I am actually planning to fix this in EDK2. I had different priorities until now but I have some spare time so I will fix it by end of week.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19784</commentid>
    <comment_count>6</comment_count>
    <who name="Mateusz Albecki">mateusz.albecki</who>
    <bug_when>2022-10-18 12:03:19 +0000</bug_when>
    <thetext>Patch: https://edk2.groups.io/g/devel/topic/patch_0_1_mdemodulepkg_ata/94411381?p=,,,20,0,0,0::recentpostdate/sticky,,,20,2,0,94411381,previd%3D1666108503382017884,nextid%3D1666099844113401112&amp;previd=1666108503382017884&amp;nextid=1666099844113401112</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19925</commentid>
    <comment_count>7</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-03 10:13:09 +0000</bug_when>
    <thetext>Hi Fu Siyuan,

   Can we close this ticket on edk2-test since the solution raised in edk2 code base?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19937</commentid>
    <comment_count>8</comment_count>
    <who name="Fu Siyuan">fusiyuan.fsy</who>
    <bug_when>2022-11-04 01:59:22 +0000</bug_when>
    <thetext>(In reply to Edhay from comment #7)
&gt; Hi Fu Siyuan,
&gt; 
&gt;    Can we close this ticket on edk2-test since the solution raised in edk2
&gt; code base?

Yes please close This， thanks</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19938</commentid>
    <comment_count>9</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-04 02:11:20 +0000</bug_when>
    <thetext>Solution for this issue is raised in edk2 code base:
https://edk2.groups.io/g/devel/topic/patch_0_1_mdemodulepkg_ata/94411381?p=,,,20,0,0,0::recentpostdate/sticky,,,20,2,0,94411381,previd%3D1666108503382017884,nextid%3D1666099844113401112&amp;previd=1666108503382017884&amp;nextid=1666099844113401112</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20202</commentid>
    <comment_count>10</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-12-11 20:56:48 +0000</bug_when>
    <thetext>Note:
edk2 solution is merged via:
PR - https://github.com/tianocore/edk2/pull/3746
Commit - https://github.com/tianocore/edk2/commit/a6542894391bae58b7704b2624b541a2b8b9ed93</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4486</bug_id>
          
          <creation_ts>2023-06-21 01:51:19 +0000</creation_ts>
          <short_desc>MdePkg: Move gTraceHubDebugInfoHobGuid to MdePkg</short_desc>
          <delta_ts>2023-07-05 01:26:41 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Victor Hsu">victorx.hsu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
    
    <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21673</commentid>
    <comment_count>0</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2023-06-21 01:51:19 +0000</bug_when>
    <thetext>MdePkg: Move gTraceHubDebugInfoHobGuid to MdePkg</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21674</commentid>
    <comment_count>1</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2023-06-21 04:04:37 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/4565</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21707</commentid>
    <comment_count>2</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2023-07-05 01:26:41 +0000</bug_when>
    <thetext>Close as requirement violate edk2 rules</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4339</bug_id>
          
          <creation_ts>2023-02-08 18:02:34 +0000</creation_ts>
          <short_desc>EmulatorPkg PeiTimerLib calls Thunk-&gt;Sleep() with value that is 100x larger than required</short_desc>
          <delta_ts>2023-02-08 21:05:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>afish</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>EmulatorPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21003</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-02-08 18:02:34 +0000</bug_when>
    <thetext>The Sleep() API in the EMU_THUNK_PROTOCOL expects a delay 
in number of Nanoseconds.  The Nanoseconds are converted to milliseconds
before calling the windows API Sleep().

VOID
SecSleep (
  IN  UINT64  Nanoseconds
  )
{
  Sleep ((DWORD)DivU64x32 (Nanoseconds, 1000000));
}

The PeiTimerLib implementation of NanoSecondDelay() calls the
EMU_THINK_PROTOCOL Sleep() API with requested Nanoseconds * 100.

    Thunk = (EMU_THUNK_PROTOCOL *)ThunkPpi-&gt;Thunk ();
    Thunk-&gt;Sleep (NanoSeconds * 100);

This results in 100x the length of the expected delay.  

The DxeTimerLib and DxeCoreTimerLib pass in Nanseconds without any
multiplier.

The PeiTimerLib should be updated to remove the * 100 multiplier.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21004</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-02-08 18:04:16 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21005</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-02-08 19:46:22 +0000</bug_when>
    <thetext>Patch email for review:

https://edk2.groups.io/g/devel/message/99822</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21006</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-02-08 21:05:29 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/4019

Commit: https://github.com/tianocore/edk2/commit/f6ce1a5cd8932844ec24701d158254ccf75b6159</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4164</bug_id>
          
          <creation_ts>2022-11-23 01:14:35 +0000</creation_ts>
          <short_desc>Support multiple firmware volume from elf file</short_desc>
          <delta_ts>2022-12-12 04:43:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>mars_cc_lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20078</commentid>
    <comment_count>0</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2022-11-23 01:14:35 +0000</bug_when>
    <thetext>To add the supportability to sense more than one fv from elf file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20135</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-29 21:53:32 +0000</bug_when>
    <thetext>please provide more details. Which usage model about elf file?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20203</commentid>
    <comment_count>2</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2022-12-11 21:21:34 +0000</bug_when>
    <thetext>The change had implemented, the link is as below
https://github.com/tianocore/edk2/pull/3661</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20207</commentid>
    <comment_count>3</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2022-12-12 04:43:04 +0000</bug_when>
    <thetext>Since the change had committed, change status to Resolved/Fixed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4815</bug_id>
          
          <creation_ts>2024-07-18 03:52:14 +0000</creation_ts>
          <short_desc>edk2-libc: add GitHub build workflow to build Python UEFI with VS2022</short_desc>
          <delta_ts>2024-07-23 21:20:15 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23245</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-18 03:52:14 +0000</bug_when>
    <thetext>VS2022 is the latest visual studio tool chain. We have a github build workflow setup with VS2019. Need to add the build workflow for VS2022 as well.
So that it helps in catching any build issues with the VS2022 compiler before merging the code to main / master branch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23246</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-18 03:52:33 +0000</bug_when>
    <thetext>Jayaprakash Nevara will be working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23250</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-22 02:38:54 +0000</bug_when>
    <thetext>JP Nevara will be working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23251</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-22 04:15:58 +0000</bug_when>
    <thetext>sent patch for review</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23259</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-23 21:20:15 +0000</bug_when>
    <thetext>Merged the changes to master 
commit cead606b14758e33d7dbc3a116f887e47cb8f901</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4041</bug_id>
          
          <creation_ts>2022-09-01 10:30:59 +0000</creation_ts>
          <short_desc>Incorrect BAR read in AhciPei driver</short_desc>
          <delta_ts>2022-09-15 00:20:10 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Maciej Czajkowski">maciej.czajkowski</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>hao.a.wu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19460</commentid>
    <comment_count>0</comment_count>
    <who name="Maciej Czajkowski">maciej.czajkowski</who>
    <bug_when>2022-09-01 10:30:59 +0000</bug_when>
    <thetext>There is a mistake in the AhciPei driver code, in the section where AHCI BAR is read using PCI_DEVICE_PPI&apos;s PciIo instance. A read of width 32 is performed and result is stored in variable of UINTN size; however a Count parameter is set as sizeof (UINTN) instead of 1. This will exceed actual variable size.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19485</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-06 21:42:49 +0000</bug_when>
    <thetext>maciej.czajkowski@intel.com: will you provide the patch to fix it?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19514</commentid>
    <comment_count>2</comment_count>
    <who name="Maciej Czajkowski">maciej.czajkowski</who>
    <bug_when>2022-09-07 09:10:34 +0000</bug_when>
    <thetext>Yes, I will provide a patch that fixes the issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19564</commentid>
    <comment_count>3</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-15 00:19:43 +0000</bug_when>
    <thetext>Patch sent at: https://edk2.groups.io/g/devel/message/93612</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19565</commentid>
    <comment_count>4</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-15 00:20:10 +0000</bug_when>
    <thetext>Resolved via:
PR - https://github.com/tianocore/edk2/pull/3338
Commit - https://github.com/tianocore/edk2/commit/1dccbd1a382aa57719e4e0432b3bd6a03a888507</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4663</bug_id>
          
          <creation_ts>2024-02-01 20:45:12 +0000</creation_ts>
          <short_desc>Add LoongArch help functions and defines in MdePkg and move some ArmVirtPkg libraries and PCDs to OvmfPkg</short_desc>
          <delta_ts>2024-02-27 07:40:39 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ArmPkg</cf_package>
    
    <cf_package>ArmVirtPkg</cf_package>
    
    <cf_package>EmbeddedPkg</cf_package>
    
    <cf_package>MdePkg</cf_package>
    
    <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22497</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-02-01 20:45:12 +0000</bug_when>
    <thetext>In MdePkg, added LoongArch help functions and defines.
In OvmfPkg, moved some libraries and PCDs from ArmVirtPkg.
In EmbeddedPkg, added LoongArch CPU IO width.
In UefiCpuPkg, added a new CPU IO driver used the MMIO.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22498</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-02-01 20:46:16 +0000</bug_when>
    <thetext>I&apos;m dealing on this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22659</commentid>
    <comment_count>2</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-02-27 07:40:39 +0000</bug_when>
    <thetext>The patch series has been merged with EDK2.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4514</bug_id>
          
          <creation_ts>2023-07-31 14:38:35 +0000</creation_ts>
          <short_desc>MdePkg is missing some spec defined status codes</short_desc>
          <delta_ts>2023-08-07 20:42:23 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Nathaniel L DeSimone">nathaniel.l.desimone</reporter>
          <assigned_to name="Nathaniel L DeSimone">nathaniel.l.desimone</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21789</commentid>
    <comment_count>0</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2023-07-31 14:38:35 +0000</bug_when>
    <thetext>REF: https://uefi.org/specs/UEFI/2.10/Apx_D_Status_Codes.html

Upon review it has been found that MdePkg is missing two
status code definitions:

 1. EFI_IP_ADDRESS_CONFLICT - Added in UEFI Spec v2.5
 2. EFI_WARN_RESET_REQUIRED - Added in UEFI Spec v2.6

Moreover, PrintLib does not correctly decode the follow status codes:

 1. EFI_IP_ADDRESS_CONFLICT
 2. EFI_HTTP_ERROR
 3. EFI_WARN_FILE_SYSTEM
 4. EFI_WARN_RESET_REQUIRED</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21809</commentid>
    <comment_count>1</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2023-08-07 20:41:54 +0000</bug_when>
    <thetext>Patch sent: https://edk2.groups.io/g/devel/message/107405</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21810</commentid>
    <comment_count>2</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2023-08-07 20:42:23 +0000</bug_when>
    <thetext>The series has been pushed as ~107ddf1..3c274c0</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4374</bug_id>
          
          <creation_ts>2023-03-15 14:19:17 +0000</creation_ts>
          <short_desc>TCG MOR Test Spec Proposal</short_desc>
          <delta_ts>2024-03-18 14:02:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Abhi Singh">Abhi.Singh</reporter>
          <assigned_to name="Abhi Singh">Abhi.Singh</assigned_to>
          <cc>Abhi.Singh</cc>
    
    <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>stuart.yoder</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21196</commentid>
    <comment_count>0</comment_count>
      <attachid>1337</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-03-15 14:19:17 +0000</bug_when>
    <thetext>Created attachment 1337
Initial Draft for TCG MOR spec

Initial Draft for TCG MOR UEFI-SCT Test Specification. This test checks if the platform has implemented MemoryOverwriteRequestControl and MemoryOverwriteRequestControlLock UEFI variables in accordance with TCG PC Platform Reset Attack Mitigation Specification, v1.10.
Open to review for feedback and further implementations.

- GUIDs and Numbers are unpopulated for the moment

- One uncertainty I have is if the test should actually check the platform memory to see if the memory have been physically reset, for now I have decided to check that MemoryOverwriteAction_BitValue Bit 0 is Cleared upon platform reset after it had intially been set. This is for simplicity&apos;s sake but if there is a possible way to do this in a platform agnostic manner, we should follow through with it.

Thanks,
Abhi</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21290</commentid>
    <comment_count>1</comment_count>
      <attachid>1351</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-03-30 17:38:08 +0000</bug_when>
    <thetext>Created attachment 1351
Updated Draft for TCG MOR SCT spec

After review and feedback from Stuart, Updated Draft for TCG MOR SCT Spec. Some clarifications were made to test descriptions and assertions. Duplicate tests were changed as to not overlap with each other&apos;s functionality. Test for checking if MemoryOverwriteRequestControlLock was added.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21387</commentid>
    <comment_count>2</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-04-21 15:50:58 +0000</bug_when>
    <thetext>Bugzilla Ticket to Implementation: https://bugzilla.tianocore.org/show_bug.cgi?id=4419</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21623</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-06-01 11:00:11 +0000</bug_when>
    <thetext>Calling the Forum to review the Specification.

Volunteers on board
Edhay
Sivasakthivel
Sunny

Already reviewed by Stuart Yoder.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21624</commentid>
    <comment_count>4</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-06-01 11:02:37 +0000</bug_when>
    <thetext>To aid with review of the Spec proposal, here is the link to the TCG PC Platform Reset Attack Mitigation Specification, v1.10: https://trustedcomputinggroup.org/wp-content/uploads/TCG_PlatformResetAttackMitigationSpecification_1.10_published.pdf</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21672</commentid>
    <comment_count>5</comment_count>
      <attachid>1376</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-06-20 18:28:19 +0000</bug_when>
    <thetext>Created attachment 1376
Draft for completed TCG MOR SCT spec

I have updated the SCT Spec to reflect any missing or uneccessary code/assertions. Ones shown in red with strikethrough are uneccessary and the green is added to cover missing requirements listed in TCG Platform Reset Attack Mitigation v1.10.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21834</commentid>
    <comment_count>6</comment_count>
      <attachid>1392</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-08-16 19:24:42 +0000</bug_when>
    <thetext>Created attachment 1392
SCT Spec for TCG MOR and MORLOCK: Review Draft

Updated Draft of SCT Spec for TCG MOR and MORLOCK to be used for external review

NOTE: The code for these test cases will be divided into multiple patches for an easier review process.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22262</commentid>
    <comment_count>7</comment_count>
      <attachid>1449</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-12-12 08:53:36 +0000</bug_when>
    <thetext>Created attachment 1449
Draft for SCT MOR SPEC v4 *review*

document for the review session on 12/12/2023</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22263</commentid>
    <comment_count>8</comment_count>
      <attachid>1450</attachid>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2023-12-12 10:37:58 +0000</bug_when>
    <thetext>Created attachment 1450
review comments from stuart</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22447</commentid>
    <comment_count>9</comment_count>
      <attachid>1468</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2024-01-30 18:39:58 +0000</bug_when>
    <thetext>Created attachment 1468
Draft v5 for TCG MOR SCT spec

Made updates based on feedback, as well as updates that were recently added to the code.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22598</commentid>
    <comment_count>10</comment_count>
      <attachid>1476</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2024-02-14 22:03:29 +0000</bug_when>
    <thetext>Created attachment 1476
Draft v6 of the SCT Spec TCG MOR</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22599</commentid>
    <comment_count>11</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2024-02-14 22:04:16 +0000</bug_when>
    <thetext>Spec v6 has fixes to the guids, all guids now match the test cases.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22805</commentid>
    <comment_count>12</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-03-18 14:02:34 +0000</bug_when>
    <thetext>The changes are upstreamed by the below commit:

https://github.com/tianocore/edk2-test/commit/952292aae171fe4e2aacdd556f236c602523c2d5</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1337</attachid>
            <date>2023-03-15 14:19:17 +0000</date>
            <delta_ts>2023-03-30 17:38:08 +0000</delta_ts>
            <desc>Initial Draft for TCG MOR spec</desc>
            <filename>TCGMORSctSpec.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>52302</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1351</attachid>
            <date>2023-03-30 17:38:08 +0000</date>
            <delta_ts>2023-06-20 18:28:19 +0000</delta_ts>
            <desc>Updated Draft for TCG MOR SCT spec</desc>
            <filename>TCGMORSctSpec_Draft2.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>55721</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1376</attachid>
            <date>2023-06-20 18:28:19 +0000</date>
            <delta_ts>2023-08-16 19:24:42 +0000</delta_ts>
            <desc>Draft for completed TCG MOR SCT spec</desc>
            <filename>SCT_SPEC_TCG_MEMORY_OVERWRITE.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>62126</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1392</attachid>
            <date>2023-08-16 19:24:42 +0000</date>
            <delta_ts>2023-12-12 08:53:36 +0000</delta_ts>
            <desc>SCT Spec for TCG MOR and MORLOCK: Review Draft</desc>
            <filename>SCT_SPEC_TCG_MEMORY_OVERWRITE.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>60986</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1449</attachid>
            <date>2023-12-12 08:53:36 +0000</date>
            <delta_ts>2024-01-30 18:39:58 +0000</delta_ts>
            <desc>Draft for SCT MOR SPEC v4 *review*</desc>
            <filename>SCT_SPEC_TCG_MemoryOverwrite_v4.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>68286</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1450</attachid>
            <date>2023-12-12 10:37:58 +0000</date>
            <delta_ts>2024-01-30 18:39:58 +0000</delta_ts>
            <desc>review comments from stuart</desc>
            <filename>SCT_SPEC_TCG_MemoryOverwrite_v4_Stuart_comments.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>69589</size>
            <attacher name="Stuart Yoder">stuart.yoder</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1468</attachid>
            <date>2024-01-30 18:39:58 +0000</date>
            <delta_ts>2024-02-14 22:03:29 +0000</delta_ts>
            <desc>Draft v5 for TCG MOR SCT spec</desc>
            <filename>SCT_SPEC_TCG_MemoryOverwrite_v5.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>67610</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1476</attachid>
            <date>2024-02-14 22:03:29 +0000</date>
            <delta_ts>2024-02-14 22:03:29 +0000</delta_ts>
            <desc>Draft v6 of the SCT Spec TCG MOR</desc>
            <filename>SCT_SPEC_TCG_MemoryOverwrite_v6.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>68852</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4192</bug_id>
          
          <creation_ts>2022-12-13 22:40:36 +0000</creation_ts>
          <short_desc>Enable LoongArch support</short_desc>
          <delta_ts>2023-03-03 05:20:23 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaojie</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20212</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-12-13 22:40:36 +0000</bug_when>
    <thetext>LoongArch64 support was merged into edk2 and edk2-platforms, enable it in edk2-test now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20213</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-12-13 22:41:16 +0000</bug_when>
    <thetext>I&apos;m working on this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20634</commentid>
    <comment_count>2</comment_count>
    <who name="Barton Gao">gaojie</who>
    <bug_when>2023-01-12 09:17:15 +0000</bug_when>
    <thetext>Wait for another reviewer&apos;s feedback for upstream.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21137</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-03-02 09:08:26 +0000</bug_when>
    <thetext>Link of the patch: https://edk2.groups.io/g/devel/topic/95662761#100545

To be upstreamed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21146</commentid>
    <comment_count>4</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-03-03 05:20:23 +0000</bug_when>
    <thetext>The patch is upstreamed through the commits:
https://github.com/tianocore/edk2-test/commit/09b7d056d43da01b3abe772946879e3ed5b5eebe
https://github.com/tianocore/edk2-test/commit/8713740892bdb857e970a2841de9800b2c6b5552</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4838</bug_id>
          
          <creation_ts>2024-08-28 09:41:14 +0000</creation_ts>
          <short_desc>In BaseCryptLib has PeiCryptLib.inf file in that Valid Architectures is mentioned as IA32 X64. Whether AARCH64 is supported or not.</short_desc>
          <delta_ts>2024-11-04 00:40:35 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>sountharyan</reporter>
          <assigned_to>sountharyan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>gayathrit</cc>
    
    <cc>kanagavels</cc>
    
    <cc>prarthanasv</cc>
    
    <cc>sountharyan</cc>
    
    <cc>srinivasanm</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23348</commentid>
    <comment_count>0</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-08-28 09:41:14 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

We are using BaseCryptLib.PeiCryptLib library instance in AARCH64 based platforms and we are not facing any issues.

In BaseCryptLib.PeiCryptLib.inf file, Valid Architectures is mentioned as IA32 X64 alone.

Could you please let us know whether BaseCryptLib.PeiCryptLib is supported for AARCH64 platforms or not?

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23364</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-09-04 20:37:01 +0000</bug_when>
    <thetext>Add yi1.li@intel.com in cc list.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23386</commentid>
    <comment_count>2</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-09-06 06:01:50 +0000</bug_when>
    <thetext>Hi yi1.li@intel.com,

Kindly provide your comments.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23440</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-10-08 21:36:49 +0000</bug_when>
    <thetext>It supports AARCH64. It has not ARCH limitation.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23441</commentid>
    <comment_count>4</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-10-09 00:47:19 +0000</bug_when>
    <thetext>Hi @gaoliming@byosoft.com.cn,

Thanks for your comments.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23481</commentid>
    <comment_count>5</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-10-23 20:48:17 +0000</bug_when>
    <thetext>sountharyan@ami.com: please update INF to add the missing archs.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23490</commentid>
    <comment_count>6</comment_count>
      <attachid>1553</attachid>
    <who name="">sountharyan</who>
    <bug_when>2024-10-24 01:44:00 +0000</bug_when>
    <thetext>Created attachment 1553
Updated the missing Archs in PeiCryptLib.inf file</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23491</commentid>
    <comment_count>7</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-10-24 01:44:56 +0000</bug_when>
    <thetext>Hi @gaoliming@byosoft.com.cn,

Attached the changes. Kindly provide your comments.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23497</commentid>
    <comment_count>8</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-10-25 02:32:37 +0000</bug_when>
    <thetext>Hi, we use pull request for code review now, please create PR in EDK2 github.

please refer to this if you are not familiar with new process: 
https://github.com/tianocore/tianocore.github.io/wiki/EDK-II-Development-Process#contributor-process</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23507</commentid>
    <comment_count>9</comment_count>
    <who name="Kanagavel Subramani">kanagavels</who>
    <bug_when>2024-10-30 15:27:12 +0000</bug_when>
    <thetext>Hi yi1.li@intel.com

Please find the Pull request https://github.com/tianocore/edk2/pull/6389

Thanks,
Kanagavel</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23509</commentid>
    <comment_count>10</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-11-04 00:40:35 +0000</bug_when>
    <thetext>pushed: https://github.com/tianocore/edk2/commit/47ba459fc1c2cda532b5d7cf16c9fdcbb200784d</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1553</attachid>
            <date>2024-10-24 01:44:00 +0000</date>
            <delta_ts>2024-10-24 01:44:00 +0000</delta_ts>
            <desc>Updated the missing Archs in PeiCryptLib.inf file</desc>
            <filename>CryptoPkg_PeiCryptLib_Changes.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>4960</size>
            <attacher>sountharyan</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4692</bug_id>
          
          <creation_ts>2024-02-18 14:53:43 +0000</creation_ts>
          <short_desc>PatchCheck silently ignores commit message signature check errors</short_desc>
          <delta_ts>2024-03-05 21:57:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22615</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 14:53:43 +0000</bug_when>
    <thetext>The logic in PatchCheck does check signatures in commit messages
and does print error messages in the log, but the error status is
not captured and as a result if the only issue noted is with
signatures in commit messages, an incorrect PASS condition is
generated from both command line use of PatchCheck and CI use of
PatchCheck.

The bug is in the find_signatures() method of the CommitMessageCheck
class where the signature checks are performed, but not used to update
the self.ok value of the CommitMessageCheck class.

The call to EmailAddressCheck() in find_signatures() should be 
updated from:

    EmailAddressCheck(s[3], sig)

to:

    self.ok &amp;= EmailAddressCheck(s[3], sig).ok</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22715</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 21:57:56 +0000</bug_when>
    <thetext>michael.d.kinney@intel.com: please add PR or commit id.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4545</bug_id>
          
          <creation_ts>2023-08-30 07:14:13 +0000</creation_ts>
          <short_desc>ek2-libc: socket module of python UEFI interpreter fails to compile with GCC tool chain</short_desc>
          <delta_ts>2023-09-01 11:48:07 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21874</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-30 07:14:13 +0000</bug_when>
    <thetext>The socket module of Python interpreter for UEFI shell fails to compile due to due to duplicate definitions of some structures such as addrinfo structure, sockaddr_storage structures. 

This requires a simple fix to the pyconfig.h file where to avoid duplicate definitions we need to define the to undefined macros given below:


/* struct sockaddr_storage (sys/socket.h) */
#undef HAVE_SOCKADDR_STORAGE

/* struct addrinfo (netdb.h) */
#undef HAVE_ADDRINFO

Will make this change and submit the patch for review.

This is an issue related to Python UEFI interpreter code and seen only with GCC compiler. The VS2019 compiler ignores redefinition errors and hence doesn&apos;t cause compilation to break.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21875</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-30 07:14:38 +0000</bug_when>
    <thetext>Confirming the issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21881</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-31 10:40:49 +0000</bug_when>
    <thetext>When the Python interpreter is compiled with socket module as built in module with GCC compiler. 
Compilation fails with following errors:

The compilation issues are because of duplicate definitions of addrinfo and sockaddr_storage structures. 


In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:402:
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/addrinfo.h:127:8: error: redefinition of ‘struct addrinfo’
  127 | struct addrinfo {
      |        ^~~~~~~~
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:169:8: note: originally defined here
  169 | struct addrinfo {
      |        ^~~~~~~~
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:402:
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/addrinfo.h:144: warning: &quot;_SS_ALIGNSIZE&quot; redefined
  144 | #define _SS_ALIGNSIZE   (sizeof(long long))
      |
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:284:
/home/jp/src/edk2/StdLib/Include/sys/socket.h:229: note: this is the location of the previous definition
  229 | #define _SS_ALIGNSIZE (sizeof(__int64_t))
      |
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:402:
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/addrinfo.h:145: warning: &quot;_SS_PAD1SIZE&quot; redefined
  145 | #define _SS_PAD1SIZE    (_SS_ALIGNSIZE - sizeof(u_char) * 2)
      |
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:284:
/home/jp/src/edk2/StdLib/Include/sys/socket.h:230: note: this is the location of the previous definition
  230 | #define _SS_PAD1SIZE  (_SS_ALIGNSIZE - 2)
      |
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:402:
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/addrinfo.h:146: warning: &quot;_SS_PAD2SIZE&quot; redefined
  146 | #define _SS_PAD2SIZE    (_SS_MAXSIZE - sizeof(u_char) * 2 - \
      |
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:284:
/home/jp/src/edk2/StdLib/Include/sys/socket.h:231: note: this is the location of the previous definition
  231 | #define _SS_PAD2SIZE  (_SS_MAXSIZE - 2 - \
      |
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:402:
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/addrinfo.h:149:8: error: redefinition of ‘struct sockaddr_storage’
  149 | struct sockaddr_storage {
      |        ^~~~~~~~~~~~~~~~
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:284:
/home/jp/src/edk2/StdLib/Include/sys/socket.h:235:8: note: originally defined here
  235 | struct sockaddr_storage {
      |        ^~~~~~~~~~~~~~~~
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c: In function ‘setipaddr’:
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:1037:40: warning: passing argument 3 of ‘getaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 1037 |         error = getaddrinfo(NULL, &quot;0&quot;, &amp;hints, &amp;res);
      |                                        ^~~~~~
      |                                        |
      |                                        struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:259:37: note: expected ‘const struct addrinfo * restrict’ but argument is of type ‘struct addrinfo *’
  259 |                                     const struct addrinfo * __restrict,
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:1037:48: warning: passing argument 4 of ‘getaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 1037 |         error = getaddrinfo(NULL, &quot;0&quot;, &amp;hints, &amp;res);
      |                                                ^~~~
      |                                                |
      |                                                struct addrinfo **
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:260:37: note: expected ‘struct addrinfo ** restrict’ but argument is of type ‘struct addrinfo **’
  260 |                                     struct addrinfo ** __restrict);
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:1058:26: warning: passing argument 1 of ‘freeaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 1058 |             freeaddrinfo(res);
      |                          ^~~
      |                          |
      |                          struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:264:36: note: expected ‘struct addrinfo *’ but argument is of type ‘struct addrinfo *’
  264 | void              freeaddrinfo    (struct addrinfo *);
      |                                    ^~~~~~~~~~~~~~~~~
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:1064:26: warning: passing argument 1 of ‘freeaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 1064 |             freeaddrinfo(res);
      |                          ^~~
      |                          |
      |                          struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:264:36: note: expected ‘struct addrinfo *’ but argument is of type ‘struct addrinfo *’
  264 | void              freeaddrinfo    (struct addrinfo *);
      |                                    ^~~~~~~~~~~~~~~~~
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:1072:22: warning: passing argument 1 of ‘freeaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 1072 |         freeaddrinfo(res);
      |                      ^~~
      |                      |
      |                      struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:264:36: note: expected ‘struct addrinfo *’ but argument is of type ‘struct addrinfo *’
  264 | void              freeaddrinfo    (struct addrinfo *);
      |                                    ^~~~~~~~~~~~~~~~~
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:1145:37: warning: passing argument 3 of ‘getaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 1145 |     error = getaddrinfo(name, NULL, &amp;hints, &amp;res);
      |                                     ^~~~~~
      |                                     |
      |                                     struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:259:37: note: expected ‘const struct addrinfo * restrict’ but argument is of type ‘struct addrinfo *’
  259 |                                     const struct addrinfo * __restrict,
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:1145:45: warning: passing argument 4 of ‘getaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 1145 |     error = getaddrinfo(name, NULL, &amp;hints, &amp;res);
      |                                             ^~~~
      |                                             |
      |                                             struct addrinfo **
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:260:37: note: expected ‘struct addrinfo ** restrict’ but argument is of type ‘struct addrinfo **’
  260 |                                     struct addrinfo ** __restrict);
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:1163:18: warning: passing argument 1 of ‘freeaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 1163 |     freeaddrinfo(res);
      |                  ^~~
      |                  |
      |                  struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:264:36: note: expected ‘struct addrinfo *’ but argument is of type ‘struct addrinfo *’
  264 | void              freeaddrinfo    (struct addrinfo *);
      |                                    ^~~~~~~~~~~~~~~~~
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c: In function ‘socket_getaddrinfo’:
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:6061:37: warning: passing argument 3 of ‘getaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 6061 |     error = getaddrinfo(hptr, pptr, &amp;hints, &amp;res0);
      |                                     ^~~~~~
      |                                     |
      |                                     struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:259:37: note: expected ‘const struct addrinfo * restrict’ but argument is of type ‘struct addrinfo *’
  259 |                                     const struct addrinfo * __restrict,
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:6061:45: warning: passing argument 4 of ‘getaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 6061 |     error = getaddrinfo(hptr, pptr, &amp;hints, &amp;res0);
      |                                             ^~~~~
      |                                             |
      |                                             struct addrinfo **
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:260:37: note: expected ‘struct addrinfo ** restrict’ but argument is of type ‘struct addrinfo **’
  260 |                                     struct addrinfo ** __restrict);
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:6094:22: warning: passing argument 1 of ‘freeaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 6094 |         freeaddrinfo(res0);
      |                      ^~~~
      |                      |
      |                      struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:264:36: note: expected ‘struct addrinfo *’ but argument is of type ‘struct addrinfo *’
  264 | void              freeaddrinfo    (struct addrinfo *);
      |                                    ^~~~~~~~~~~~~~~~~
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:6100:22: warning: passing argument 1 of ‘freeaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 6100 |         freeaddrinfo(res0);
      |                      ^~~~
      |                      |
      |                      struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:264:36: note: expected ‘struct addrinfo *’ but argument is of type ‘struct addrinfo *’
  264 | void              freeaddrinfo    (struct addrinfo *);
      |                                    ^~~~~~~~~~~~~~~~~
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c: In function ‘socket_getnameinfo’:
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:6150:38: warning: passing argument 3 of ‘getaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 6150 |     error = getaddrinfo(hostp, pbuf, &amp;hints, &amp;res);
      |                                      ^~~~~~
      |                                      |
      |                                      struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:259:37: note: expected ‘const struct addrinfo * restrict’ but argument is of type ‘struct addrinfo *’
  259 |                                     const struct addrinfo * __restrict,
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:6150:46: warning: passing argument 4 of ‘getaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 6150 |     error = getaddrinfo(hostp, pbuf, &amp;hints, &amp;res);
      |                                              ^~~~
      |                                              |
      |                                              struct addrinfo **
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:260:37: note: expected ‘struct addrinfo ** restrict’ but argument is of type ‘struct addrinfo **’
  260 |                                     struct addrinfo ** __restrict);
/home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:6197:22: warning: passing argument 1 of ‘freeaddrinfo’ from incompatible pointer type [-Wincompatible-pointer-types]
 6197 |         freeaddrinfo(res);
      |                      ^~~
      |                      |
      |                      struct addrinfo *
In file included from /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Modules/socketmodule.c:300:
/home/jp/src/edk2/StdLib/Include/netdb.h:264:36: note: expected ‘struct addrinfo *’ but argument is of type ‘struct addrinfo *’
  264 | void              freeaddrinfo    (struct addrinfo *);
      |                                    ^~~~~~~~~~~~~~~~~
make: *** [GNUmakefile:1231: /home/jp/src/edk2/Build/AppPkg/RELEASE_GCC5/X64/AppPkg/Applications/Python/Python-3.6.8/Python368/OUTPUT/Modules/socketmodule.obj] Error 1


build.py...
 : error 7000: Failed to execute command
        make tbuild [/home/jp/src/edk2/Build/AppPkg/RELEASE_GCC5/X64/AppPkg/Applications/Python/Python-3.6.8/Python368]


build.py...
 : error F002: Failed to build module
        /home/jp/src/edk2/AppPkg/Applications/Python/Python-3.6.8/Python368.inf [X64, GCC5, RELEASE]

- Failed -
Build end time: 16:51:09, Aug.31 2023
Build total time: 00:00:10


To fix the above compilation issues, we need to define to macros in pyconfig.h header file as given below:

/* struct addrinfo (netdb.h) */
#define HAVE_ADDRINFO   1


/* struct sockaddr_storage (sys/socket.h) */
#define HAVE_SOCKADDR_STORAGE   1


This fixes the duplicate definition issues</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21882</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-31 12:13:38 +0000</bug_when>
    <thetext>Patch sent for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21889</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-09-01 11:48:07 +0000</bug_when>
    <thetext>Changes are merged after the review.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4404</bug_id>
          
          <creation_ts>2023-04-06 02:05:25 +0000</creation_ts>
          <short_desc>edk2-libc - socket module support in Python UEFI interpreter</short_desc>
          <delta_ts>2023-04-25 21:47:38 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4406</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21333</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-04-06 02:05:25 +0000</bug_when>
    <thetext>This BZ ticket is a request for enabling the socket module support in Python UEFI interpreter.

This will facilitate the remote test / validation / automation use cases over socket interfaces.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21412</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:47:38 +0000</bug_when>
    <thetext>Duplicated one

*** This bug has been marked as a duplicate of bug 4406 ***</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4231</bug_id>
          
          <creation_ts>2022-12-27 21:44:06 +0000</creation_ts>
          <short_desc>Provides NULL instance of IpmiCommandLib</short_desc>
          <delta_ts>2023-03-02 20:35:42 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20308</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-12-27 21:44:06 +0000</bug_when>
    <thetext>Provides a NULL instance of IpmiCommandLib that removes the dependence between edk2 and edk2-platform packages.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20432</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:42:40 +0000</bug_when>
    <thetext>Abner is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20709</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-18 00:09:13 +0000</bug_when>
    <thetext>This is a new feature.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21143</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-03-02 20:35:42 +0000</bug_when>
    <thetext>Fixed at: f60a26dc - a7b0b3f6</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4874</bug_id>
          
          <creation_ts>2024-11-19 03:39:41 +0000</creation_ts>
          <short_desc>[HiiDatabase] Don&apos;t get default value correctly for Questions in BIT VarStore</short_desc>
          <delta_ts>2024-12-02 20:07:06 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="dandanbi">dandan.bi</reporter>
          <assigned_to name="dandanbi">dandan.bi</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23534</commentid>
    <comment_count>0</comment_count>
    <who name="dandanbi">dandan.bi</who>
    <bug_when>2024-11-19 03:39:41 +0000</bug_when>
    <thetext>HiiDatabase:

1.When get the default value in FindQuestionDefaultSetting:
if (BitFieldQuestion) {
 ......
 BitFieldVal = BitFieldRead32 (BufferValue, StartBit, EndBit);
 CopyMem (ValueBuffer, &amp;BitFieldVal, Width); // Copy the default value for bit field VAR based on the actual bytes it occupies.
}

2. When conssume the default value in UpdateDefaultSettingInFormPackage:
Width = (UINTN)((UINT32)1 &lt;&lt; (IfrOneOfOption-&gt;Flags &amp; EFI_IFR_NUMERIC_SIZE));
if (StandardDefaultIsSet) {
  if (CompareMem (&amp;IfrOneOfOption-&gt;Value, &amp;IfrValue, Width) == 0) {
    IfrOneOfOption-&gt;Flags |= EFI_IFR_OPTION_DEFAULT;
  } else {
    IfrOneOfOption-&gt;Flags &amp;= ~EFI_IFR_OPTION_DEFAULT;
  }
}
But Data type is EFI_IFR_TYPE_NUM_SIZE_32 (UNIT32) for BIT Numeric/Oneof

The bytes of default value returned and consumed are not matched, which may cause issue when IfrValue is not initialized and with some garbage data.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23535</commentid>
    <comment_count>1</comment_count>
    <who name="dandanbi">dandan.bi</who>
    <bug_when>2024-11-19 03:40:29 +0000</bug_when>
    <thetext>Will submit a patch to fix this issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23544</commentid>
    <comment_count>2</comment_count>
    <who name="dandanbi">dandan.bi</who>
    <bug_when>2024-12-02 20:07:06 +0000</bug_when>
    <thetext>PR https://github.com/tianocore/edk2/pull/6466 merged. https://github.com/tianocore/edk2/commit/9112fb0ecc6db221268cb54eec76f07149756c91</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4095</bug_id>
          
          <creation_ts>2022-10-04 22:49:29 +0000</creation_ts>
          <short_desc>Silicon/Intel: Several invalid DEBUG() macros present</short_desc>
          <delta_ts>2022-10-24 23:18:15 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>IntelSiliconPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kubacki">michael.kubacki</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19706</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-04 22:49:29 +0000</bug_when>
    <thetext>Several debug macros in Silicon/Intel have a mismatched number of print specifiers to arguments. This can lead to undefined behavior.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19707</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-04 22:49:40 +0000</bug_when>
    <thetext>I will send a patch series soon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19713</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-05 02:01:25 +0000</bug_when>
    <thetext>v1 patch series: https://edk2.groups.io/g/devel/message/94738</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19814</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-24 23:18:15 +0000</bug_when>
    <thetext>Pushed in the following 3 commits:

https://github.com/tianocore/edk2-platforms/commit/ba4318a58bb21beee88109305f4554a98e79d9b5

https://github.com/tianocore/edk2-platforms/commit/de65831e5a68a2edb0a7af24507ebde383bd3040

https://github.com/tianocore/edk2-platforms/commit/8ea6ec38da8812f0703e8845fe639b8845704f96</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4731</bug_id>
          
          <creation_ts>2024-03-17 22:13:40 +0000</creation_ts>
          <short_desc>Tcg2Pei: Assert issue in SyncPcrAllocationsAndPcrMask() with a specific configuration</short_desc>
          <delta_ts>2024-04-15 12:01:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>wei6.xu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22801</commentid>
    <comment_count>0</comment_count>
    <who name="">wei6.xu</who>
    <bug_when>2024-03-17 22:13:40 +0000</bug_when>
    <thetext>The configuration is:
TPM Hardware supports SHA1, SHA256, SHA512, SM3_256.
BIOS Algorithm supports SHA256, SHA512, SM3_256.

Reproduce step:
1. Boot to setup menu and enter TCG2 Configuration Menu.
2. The PCR Bank selection is like:
PCR Bank: SHA1    [ ]
PCR Bank: SHA256  [X]
PCR Bank: SHA384  [X]
PCR Bank: SM3_256 [X]
3. Check SHA1 and un-check the others, then save:
PCR Bank: SHA1    [X]
PCR Bank: SHA256  [ ]
PCR Bank: SHA384  [ ]
PCR Bank: SM3_256 [ ]
4. Reboot and then press F12 to accept the chage.
5. Assert occurs in Tcg2Pei:
SyncPcrAllocationsAndPcrMask - No viable PCRs active! Please set a less restrictive value for PcdTpm2HashMask!
PEI_ASSERT!: K:\Edk2\SecurityPkg\Tcg\Tcg2Pei\Tcg2Pei.c (319): ((BOOLEAN)(0==1))</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22802</commentid>
    <comment_count>1</comment_count>
    <who name="">wei6.xu</who>
    <bug_when>2024-03-17 22:16:03 +0000</bug_when>
    <thetext>Should suppress the algorithm which BIOS doesn&apos;t support in TCG2 Configuration Menu to avoid user to select an unsupported algorithm set that cause an assert in Tcg2Pei.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22910</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-04-15 12:01:34 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/5556</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4576</bug_id>
          
          <creation_ts>2023-10-26 11:08:06 +0000</creation_ts>
          <short_desc>edk2-libc: The definition of the constant nanf is missing in StdiLib</short_desc>
          <delta_ts>2023-10-29 03:19:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>dimitry.kloper</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22050</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-26 11:08:06 +0000</bug_when>
    <thetext>File StdLib/Include/math.h:406 defines NAN constant as __nanf.__val.
The problem is that __nanf is never defined.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22051</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-26 11:09:03 +0000</bug_when>
    <thetext>Confirming the issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22052</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-26 11:10:57 +0000</bug_when>
    <thetext>The fix to this issue has been provided in PR raised on edk2-libc.
https://github.com/tianocore/edk2-libc/pull/9

Will be using this BZ to send an email patch for review by community by pulling it from the PR.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22086</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-27 04:05:51 +0000</bug_when>
    <thetext>Patch reviewed and merged.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22093</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-28 07:55:42 +0000</bug_when>
    <thetext>Can you please state the commit hash of the merged patch?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22097</commentid>
    <comment_count>5</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-29 03:19:32 +0000</bug_when>
    <thetext>below is the commit hash of the merged patch
commit 1ff58f17ffd1210bfdb8a1c01b99941420517fb2</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4428</bug_id>
          
          <creation_ts>2023-04-26 21:09:14 +0000</creation_ts>
          <short_desc>MinPlatformPkg: Update HW signature field in FACS based on ACPI 6.5 Specification</short_desc>
          <delta_ts>2023-05-31 02:07:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>vincentx.ke</reporter>
          <assigned_to>vincentx.ke</assigned_to>
          <cc>ankit.sinha</cc>
    
    <cc>aryeh.chen</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>vincentx.ke</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21435</commentid>
    <comment_count>0</comment_count>
      <attachid>1357</attachid>
    <who name="">vincentx.ke</who>
    <bug_when>2023-04-26 21:09:14 +0000</bug_when>
    <thetext>Created attachment 1357
MinPlatformPkg: Update HWSignature filed in FADT

Calculating CRC based on checksum from all ACPI tables.
Update HWSignature filed in FADT based on CRC while ACPI table changed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21436</commentid>
    <comment_count>1</comment_count>
    <who name="">vincentx.ke</who>
    <bug_when>2023-04-26 21:12:05 +0000</bug_when>
    <thetext>Calculating CRC based on checksum from all ACPI tables.
Update HWSignature filed in FADT based on CRC while ACPI table changed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21437</commentid>
    <comment_count>2</comment_count>
    <who name="">vincentx.ke</who>
    <bug_when>2023-04-26 21:42:31 +0000</bug_when>
    <thetext>Patch sent out as https://edk2.groups.io/g/devel/topic/98528732</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21438</commentid>
    <comment_count>3</comment_count>
    <who name="">vincentx.ke</who>
    <bug_when>2023-04-26 21:45:20 +0000</bug_when>
    <thetext>(In reply to Vincent from comment #2)
&gt; Patch sent out as https://edk2.groups.io/g/devel/topic/98528732

https://edk2.groups.io/g/devel/message/103681</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21442</commentid>
    <comment_count>4</comment_count>
    <who name="">vincentx.ke</who>
    <bug_when>2023-04-27 02:11:16 +0000</bug_when>
    <thetext>[PATCH v2] https://edk2.groups.io/g/devel/message/103696</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21452</commentid>
    <comment_count>5</comment_count>
    <who name="">vincentx.ke</who>
    <bug_when>2023-04-27 23:03:02 +0000</bug_when>
    <thetext>[PATCH v3] https://edk2.groups.io/g/devel/message/103734</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21453</commentid>
    <comment_count>6</comment_count>
    <who name="">vincentx.ke</who>
    <bug_when>2023-04-27 23:47:46 +0000</bug_when>
    <thetext>[PATCH v4] https://edk2.groups.io/g/devel/message/103738</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21468</commentid>
    <comment_count>7</comment_count>
      <attachid>1362</attachid>
    <who name="">vincentx.ke</who>
    <bug_when>2023-05-03 02:11:37 +0000</bug_when>
    <thetext>Created attachment 1362
[Patch V5] 0001-MinPlatformPkg-Update-HWSignature-filed-in-FACS

[Patch V5] 0001-MinPlatformPkg-Update-HWSignature-filed-in-FACS</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21552</commentid>
    <comment_count>8</comment_count>
    <who name="">vincentx.ke</who>
    <bug_when>2023-05-10 06:02:16 +0000</bug_when>
    <thetext>[Patch V6] https://edk2.groups.io/g/devel/message/104537</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21558</commentid>
    <comment_count>9</comment_count>
      <attachid>1366</attachid>
    <who name="">vincentx.ke</who>
    <bug_when>2023-05-11 06:27:09 +0000</bug_when>
    <thetext>Created attachment 1366
[Patch V7] 0001-MinPlatformPkg-Update-HWSignature-filed-in-FACS

https://edk2.groups.io/g/devel/message/104685</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21612</commentid>
    <comment_count>10</comment_count>
      <attachid>1373</attachid>
    <who name="">vincentx.ke</who>
    <bug_when>2023-05-31 01:59:24 +0000</bug_when>
    <thetext>Created attachment 1373
[PATCH v10] MinPlatformPkg: Update HWSignature field in FACS

[PATCH v10] MinPlatformPkg: Update HWSignature field in FACS</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21613</commentid>
    <comment_count>11</comment_count>
    <who name="">vincentx.ke</who>
    <bug_when>2023-05-31 02:07:43 +0000</bug_when>
    <thetext>Patch merged with https://github.com/tianocore/edk2-platforms/commit/1a7bd150d39007bfb72c4727feda3184c23efe96</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1357</attachid>
            <date>2023-04-26 21:09:14 +0000</date>
            <delta_ts>2023-05-03 02:11:37 +0000</delta_ts>
            <desc>MinPlatformPkg: Update HWSignature filed in FADT</desc>
            <filename>0001-MinPlatformPkg-Update-HWSignature-filed-in-FADT.patch</filename>
            <type>application/octet-stream</type>
            <size>6070</size>
            <attacher>vincentx.ke</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1362</attachid>
            <date>2023-05-03 02:11:37 +0000</date>
            <delta_ts>2023-05-11 06:27:09 +0000</delta_ts>
            <desc>[Patch V5] 0001-MinPlatformPkg-Update-HWSignature-filed-in-FACS</desc>
            <filename>0001-MinPlatformPkg-Update-HWSignature-filed-in-FACS.patch</filename>
            <type>application/octet-stream</type>
            <size>10187</size>
            <attacher>vincentx.ke</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1366</attachid>
            <date>2023-05-11 06:27:09 +0000</date>
            <delta_ts>2023-05-31 01:59:24 +0000</delta_ts>
            <desc>[Patch V7] 0001-MinPlatformPkg-Update-HWSignature-filed-in-FACS</desc>
            <filename>0001-MinPlatformPkg-Update-HWSignature-filed-in-FACS_v7.patch</filename>
            <type>application/octet-stream</type>
            <size>13533</size>
            <attacher>vincentx.ke</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1373</attachid>
            <date>2023-05-31 01:59:24 +0000</date>
            <delta_ts>2023-05-31 01:59:24 +0000</delta_ts>
            <desc>[PATCH v10] MinPlatformPkg: Update HWSignature field in FACS</desc>
            <filename>0001-MinPlatformPkg-Update-HWSignature-field-in-FACS_v10.patch</filename>
            <type>text/plain</type>
            <size>12921</size>
            <attacher>vincentx.ke</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4120</bug_id>
          
          <creation_ts>2022-10-25 21:32:26 +0000</creation_ts>
          <short_desc>File/Directory naming guidance for processor archs/vendors</short_desc>
          <delta_ts>2022-11-18 22:27:15 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Documentation</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>AbdulLateef.Attar</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          <cf_documents>EDK II C Coding Standards</cf_documents>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19825</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-10-25 21:32:26 +0000</bug_when>
    <thetext>Add the guidance in File and Directory chapter in edk2 c coding standard spec for the processor archs/vendors.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19826</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-25 21:36:52 +0000</bug_when>
    <thetext>Abner is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20063</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-11-18 22:27:15 +0000</bug_when>
    <thetext>The CCS v2.3 at https://github.com/tianocore-docs/edk2-CCodingStandardsSpecification/tree/release/2.30.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4757</bug_id>
          
          <creation_ts>2024-04-17 10:34:25 +0000</creation_ts>
          <short_desc>[edk2-test-rc1_202404] Compilation errors during VS2015 x86 build</short_desc>
          <delta_ts>2024-07-17 15:28:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Stuart Yoder">stuart.yoder</reporter>
          <assigned_to name="Stuart Yoder">stuart.yoder</assigned_to>
          <cc>alex_fox</cc>
    
    <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>stuart.yoder</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22922</commentid>
    <comment_count>0</comment_count>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2024-04-17 10:34:25 +0000</bug_when>
    <thetext>Issue found by Alex Fox &lt;Alex_Fox@phoenix.com&gt;

c:\sct_workspace\edk2\SctPkg\UEFI/Protocol/TCG2.h(127): error C2233: &apos;Digests&apos;: arrays of objects containing zero-size arrays are illegal

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(27): warning C4103: alignment changed after including header, may be due to missing #pragma pack(pop)

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(478): warning C4013: &apos;__builtin_offsetof&apos; undefined; assuming extern returning int

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(478): error C2275: &apos;EFI_TCG2_BOOT_SERVICE_CAPABILITY&apos;: illegal use of this type as an expression

c:\sct_workspace\edk2\SctPkg\UEFI/Protocol/TCG2.h(85): note: see declaration of &apos;EFI_TCG2_BOOT_SERVICE_CAPABILITY&apos;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22923</commentid>
    <comment_count>1</comment_count>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2024-04-17 10:34:53 +0000</bug_when>
    <thetext>Additional errors found by Alex:

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(657): error C2220: warning treated as error - no &apos;object&apos; file generated

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(657): warning C4244: &apos;=&apos;: conversion from &apos;UINTN&apos; to &apos;UINT32&apos;, possible loss of data

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(742): warning C4244: &apos;=&apos;: conversion from &apos;UINTN&apos; to &apos;UINT32&apos;, possible loss of data

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(642): warning C4267: &apos;initializing&apos;: conversion from &apos;size_t&apos; to &apos;UINT32&apos;, possible loss of data

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(800): warning C4244: &apos;=&apos;: conversion from &apos;UINTN&apos; to &apos;UINT32&apos;, possible loss of data

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(785): warning C4267: &apos;initializing&apos;: conversion from &apos;size_t&apos; to &apos;UINT32&apos;, possible loss of data

c:\sct_workspace\edk2\SctPkg\TestCase\UEFI\EFI\Protocol\TCG2\BlackBoxTest\TCG2ProtocolBBTestConformance.c(1079): warning C4244: &apos;function&apos;: conversion from &apos;UINTN&apos; to &apos;UINT

 

build.py...

: error F002: Failed to build module</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22924</commentid>
    <comment_count>2</comment_count>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2024-04-17 10:37:40 +0000</bug_when>
    <thetext>Issue was due to differences in how type conversion warnings were handled in GCC vs VS2015.

Fixed in patch series sent upstream.

Patches are here:
https://github.com/stuyod01/edk2-test/tree/tcg2-cleanup</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23238</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-07-17 15:28:32 +0000</bug_when>
    <thetext>The solution patch is upstreamed by the commit:
https://github.com/tianocore/edk2-test/commit/abb54c667fe6ae2a41144c010871569ef519c459

Author: Stuart Yoder

Closing the ticket.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4607</bug_id>
          
          <creation_ts>2023-11-27 22:08:58 +0000</creation_ts>
          <short_desc>Add PCD to assign Redfish service port</short_desc>
          <delta_ts>2024-01-30 20:47:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>igork</cc>
    
    <cc>nicklew</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22197</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-11-27 22:08:58 +0000</bug_when>
    <thetext>Add PCD to assign Redfish service port, such as port 443 and port 80.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22201</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-11-28 21:11:49 +0000</bug_when>
    <thetext>Abner will take this</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22203</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-11-28 21:12:16 +0000</bug_when>
    <thetext>Abner will take this</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22449</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-01-30 20:47:08 +0000</bug_when>
    <thetext>Fixed at 70b174e2</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4143</bug_id>
          
          <creation_ts>2022-11-07 08:56:32 +0000</creation_ts>
          <short_desc>InternalSyncCompareExchange64 is not implemented in RISC-V platform.</short_desc>
          <delta_ts>2022-12-02 03:31:13 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="zhihao">zhihao.li</reporter>
          <assigned_to name="Sunil V L">sunilvl</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19954</commentid>
    <comment_count>0</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-11-07 08:56:32 +0000</bug_when>
    <thetext>In BaseSynchronizationLib, InternalSyncCompareExchange64 is not implemented in RISC-V platform.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19961</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-07 20:22:11 +0000</bug_when>
    <thetext>Sunil: please check it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19966</commentid>
    <comment_count>2</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-11-08 02:51:39 +0000</bug_when>
    <thetext>Could you please provide more details? What error do you see and when? 

I see this function at 
https://github.com/tianocore/edk2/blob/50bee4cc121aacc67f40b6c5ee0c71d3879dcc41/MdePkg/Library/BaseSynchronizationLib/RiscV64/Synchronization.S#L39</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19973</commentid>
    <comment_count>3</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-11-08 21:39:29 +0000</bug_when>
    <thetext>(In reply to Sunil V L from comment #2)
&gt; Could you please provide more details? What error do you see and when? 
&gt; 
&gt; I see this function at 
&gt; https://github.com/tianocore/edk2/blob/
&gt; 50bee4cc121aacc67f40b6c5ee0c71d3879dcc41/MdePkg/Library/
&gt; BaseSynchronizationLib/RiscV64/Synchronization.S#L39

hi.
This PR encounter a problem that &apos;undefined reference to &quot;InternalSyncCompareExchange64 &quot;&apos; in RISCV64 building.

PR:https://github.com/tianocore/edk2/pull/3581

LOG:
INFO - /home/vsts/work/1/s/Build/CryptoPkg/All/DEBUG_GCC5/RISCV64/MdePkg/Library/BaseSynchronizationLib/BaseSynchronizationLib/OUTPUT/BaseSynchronizationLib.lib(Synchronization.obj): in function `InterlockedCompareExchange64&apos;:
INFO - /home/vsts/work/1/s/MdePkg/Library/BaseSynchronizationLib/Synchronization.c:364: undefined reference to `InternalSyncCompareExchange64&apos;
INFO - make: *** [GNUmakefile:355: /home/vsts/work/1/s/Build/CryptoPkg/All/DEBUG_GCC5/RISCV64/CryptoPkg/Driver/31C17C54-325D-47D5-8622-888098F10E44/DEBUG/CryptoDxe.dll] Error 1</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20176</commentid>
    <comment_count>4</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-12-02 03:31:13 +0000</bug_when>
    <thetext>Fixed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4789</bug_id>
          
          <creation_ts>2024-06-17 06:09:54 +0000</creation_ts>
          <short_desc>edk2-libc : make python368.inf compile conditionally in AppPkg.dsc file</short_desc>
          <delta_ts>2024-06-19 00:55:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23123</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-17 06:09:54 +0000</bug_when>
    <thetext>Currently python368.inf file is commented in AppPkg.dsc and it needs to be uncommented to include it for compilation as part of AppPkg.dsc. This is not CI/CD friendly for setting up the auto build through github actions. 

Making python368.inf conditionally compliable by surrounding it with !if and !endif through a macro which can be passed through the build command would help solve this problem.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23124</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-17 06:10:17 +0000</bug_when>
    <thetext>Jayaprakash Nevara will be working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23132</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-18 02:49:58 +0000</bug_when>
    <thetext>Made changes and verified them locally.
Also sent a patch request for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23138</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-19 00:55:32 +0000</bug_when>
    <thetext>Changes merged to master branch through the below commit id.

commit 7e8fe1c9b65c6463a66373b1d9781dc366b2e48e</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4017</bug_id>
          
          <creation_ts>2022-08-10 20:44:38 +0000</creation_ts>
          <short_desc>Add PCI_DEVICE_PPI support for NvmExpressPei</short_desc>
          <delta_ts>2022-09-01 01:33:59 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>xiao.x.chen</reporter>
          <assigned_to>xiao.x.chen</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>hao.a.wu</cc>
    
    <cc>ray.ni</cc>
    
    <cc>xiao.x.chen</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19388</commentid>
    <comment_count>0</comment_count>
    <who name="">xiao.x.chen</who>
    <bug_when>2022-08-10 20:44:38 +0000</bug_when>
    <thetext>This bugzilla is a follow up the https://bugzilla.tianocore.org/show_bug.cgi?id=3907
which has added the PCI_DEVICE_PPI definition and will install PCI_DEVICE_PPI allow device driver PEIM to communicate with the HW.
Implementation of installation AHCI driver PEIM use PCI_DEVICE_PPI is completed, this is for Nvme PEIM driver</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19410</commentid>
    <comment_count>1</comment_count>
    <who name="">xiao.x.chen</who>
    <bug_when>2022-08-19 00:59:38 +0000</bug_when>
    <thetext>follow up the https://bugzilla.tianocore.org/show_bug.cgi?id=3907 to do change for the Nvme device</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19450</commentid>
    <comment_count>2</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-08-30 02:31:59 +0000</bug_when>
    <thetext>V1 patch sent at: https://edk2.groups.io/g/devel/message/92945
V2 patch sent at: https://edk2.groups.io/g/devel/message/92957</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19456</commentid>
    <comment_count>3</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-01 01:33:59 +0000</bug_when>
    <thetext>Resolved via:
PR - https://github.com/tianocore/edk2/pull/3267
Commit - https://github.com/tianocore/edk2/commit/9ca7ece8b3b1743b6ee76f5f20f2c5eeed001d72</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4633</bug_id>
          
          <creation_ts>2024-01-02 01:02:25 +0000</creation_ts>
          <short_desc>Capsule.py does not handle OEM_CAPSULE_FLAGS parsed by FdfParser.py</short_desc>
          <delta_ts>2024-03-13 22:13:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Igniculus Fu">Igniculus.Fu</reporter>
          <assigned_to name="Igniculus Fu">Igniculus.Fu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22300</commentid>
    <comment_count>0</comment_count>
    <who name="Igniculus Fu">Igniculus.Fu</who>
    <bug_when>2024-01-02 01:02:25 +0000</bug_when>
    <thetext>Overview:
FdfParser.py has defined a key named OEM_CAPSULE_FLAGS to set the lower 16 bits of EFI_CAPSULE_HEADER.Flags. However, this key is totally &quot;forgotten&quot; in Capsule.py, making it impossible to set lower 16 bits of this field, and leading to an always FALSE when comparing to gEfiMdeModulePkgTokenSpaceGuid.PcdSystemRebootAfterCapsuleProcessFlag in MdeModulePkg/Library/DxeCapsuleLibFmp/DxeCapsuleProcessLib.c: ProcessTheseCapsules().

Steps to Reproduce:
1. Add the following sample definition into [Capsule] section of FDF:
CAPSULE_FLAGS               = PersistAcrossReset,InitiateReset
OEM_CAPSULE_FLAGS           = 0xBEEF
2. Call build process to generate capsule file.

Actual Results:
Build process ends with no error, but the value of EFI_CAPSULE_HEADER.Flags is 0x00050000 (PersistAcrossReset,InitiateReset)

Expected Results:
Build process ends with no error, and the value of EFI_CAPSULE_HEADER.Flags is 0x0005BEEF (PersistAcrossReset,InitiateReset + 0xBEEF)

Build Date &amp; Hardware: 
Build 2023-12-23 on Microsoft Windows [Version 10.0.19045.3693]</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22302</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-02 21:37:35 +0000</bug_when>
    <thetext>Liming will add notes for this flag OEM_CAPSULE_FLAGS</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22332</commentid>
    <comment_count>2</comment_count>
    <who name="Igniculus Fu">Igniculus.Fu</who>
    <bug_when>2024-01-08 00:19:16 +0000</bug_when>
    <thetext>Patch sent: [PATCH] BaseTools/GenFds: Apply OEM_CAPSULE_FLAGS during Capsule  generation.

Got approval from liming: Reviewed-by: Liming Gao &lt;gaoliming@byosoft.com.cn&gt;

Github PR (CI Test) created: https://github.com/tianocore/edk2/pull/5231</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22334</commentid>
    <comment_count>3</comment_count>
    <who name="Igniculus Fu">Igniculus.Fu</who>
    <bug_when>2024-01-08 02:07:44 +0000</bug_when>
    <thetext>Github PR (CI Test) passed, removed (CI Test) word in pull request.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22789</commentid>
    <comment_count>4</comment_count>
    <who name="Igniculus Fu">Igniculus.Fu</who>
    <bug_when>2024-03-13 22:13:26 +0000</bug_when>
    <thetext>Code merged successfully.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4487</bug_id>
          
          <creation_ts>2023-06-21 12:50:01 +0000</creation_ts>
          <short_desc>[BaseTools] GenFw: Set NXCOMPAT in DllCharacteristics if requirements met</short_desc>
          <delta_ts>2024-03-13 11:10:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Joey Vagedes">joeyvagedes</reporter>
          <assigned_to name="Joey Vagedes">joeyvagedes</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21675</commentid>
    <comment_count>0</comment_count>
      <attachid>1377</attachid>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-06-21 12:50:01 +0000</bug_when>
    <thetext>Created attachment 1377
Sample Diff of the change

Enable GenFw to set NXCOMPAT flag in a PE64&apos;s Optional Header&apos;s DLLCharacteristics if the NXCOMPAT requirements are met.

This can be done by verifying:

1. The PE is 64 bit
2. The PE&apos;s Section alignment is evenly divisibly by EFI_PAGE_SIZE (4K) 
3. No section in the PE is both EFI_IMAGE_SCN_MEM_EXECUTE and EFI_IMAGE_SCN_MEM_WRITE.

I have a patch I can send to the mailing list. I&apos;ve uploaded the diff that is actively being used in Project Mu.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21676</commentid>
    <comment_count>1</comment_count>
      <attachid>1378</attachid>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-06-21 12:51:31 +0000</bug_when>
    <thetext>Created attachment 1378
Diff Example</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21699</commentid>
    <comment_count>2</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-06-28 12:37:20 +0000</bug_when>
    <thetext>Through a conversation on the mailing list, there was a concern over components that meet these requirements but should still not be nx compat (such as the EBC DXE driver). In these situations, my suggestion was to follow the current standards that the MSVC compiler follows, which is that the component should opt out via a compiler flag.

I will be be adding a new GenFw flag, --nonxcompat in V2.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21740</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:33:54 +0000</bug_when>
    <thetext>joeyvagedes@microsoft.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22785</commentid>
    <comment_count>4</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2024-03-13 11:10:04 +0000</bug_when>
    <thetext>Resolved via commit da219919538b679d5cf7387f4eba6c20384bf868</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1377</attachid>
            <date>2023-06-21 12:50:01 +0000</date>
            <delta_ts>2023-06-21 12:51:31 +0000</delta_ts>
            <desc>Sample Diff of the change</desc>
            <filename>genfw.diff</filename>
            <type>application/octet-stream</type>
            <size>2659</size>
            <attacher name="Joey Vagedes">joeyvagedes</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1378</attachid>
            <date>2023-06-21 12:51:31 +0000</date>
            <delta_ts>2023-06-21 12:51:31 +0000</delta_ts>
            <desc>Diff Example</desc>
            <filename>genfw.diff</filename>
            <type>text/plain</type>
            <size>2659</size>
            <attacher name="Joey Vagedes">joeyvagedes</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4165</bug_id>
          
          <creation_ts>2022-11-23 01:18:30 +0000</creation_ts>
          <short_desc>PcdAcpiDebugFeatureActive should be referenced in InitializeAcpiDebugSmm</short_desc>
          <delta_ts>2022-11-23 01:42:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>AcpiDebugFeaturePkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>jackx.lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jackx.lin</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202105</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20079</commentid>
    <comment_count>0</comment_count>
    <who name="">jackx.lin</who>
    <bug_when>2022-11-23 01:18:30 +0000</bug_when>
    <thetext>InitializeAcpiDebugSmm will be executed when PcdAcpiDebugFeatureActive is set as FALSE. It should add PcdAcpiDebugFeatureActive check in InitializeAcpiDebugSmm.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20080</commentid>
    <comment_count>1</comment_count>
    <who name="">jackx.lin</who>
    <bug_when>2022-11-23 01:42:11 +0000</bug_when>
    <thetext>It is fixed in SHA-1:d85e4251ce49d0d9eec4b1176a10e1042dcb9736</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4816</bug_id>
          
          <creation_ts>2024-07-23 15:58:17 +0000</creation_ts>
          <short_desc>Support HTTP CONNECT message in Tx path.</short_desc>
          <delta_ts>2024-08-07 19:10:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Saloni Kasbekar">saloni.kasbekar</reporter>
          <assigned_to name="Saloni Kasbekar">saloni.kasbekar</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23256</commentid>
    <comment_count>0</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-07-23 15:58:17 +0000</bug_when>
    <thetext>HttpGenRequestMessage() doesn&apos;t support HTTP CONNECT messages</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23257</commentid>
    <comment_count>1</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-07-23 15:58:36 +0000</bug_when>
    <thetext>Assign to me.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23258</commentid>
    <comment_count>2</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-07-23 16:09:00 +0000</bug_when>
    <thetext>PR created - https://github.com/tianocore/edk2/pull/5954</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23301</commentid>
    <comment_count>3</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-08-07 19:10:14 +0000</bug_when>
    <thetext>PR submitted.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4043</bug_id>
          
          <creation_ts>2022-09-02 12:50:59 +0000</creation_ts>
          <short_desc>Use switch case when checking supported HTTP methods</short_desc>
          <delta_ts>2023-06-15 16:55:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>3951</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Saloni Kasbekar">saloni.kasbekar</reporter>
          <assigned_to name="Saloni Kasbekar">saloni.kasbekar</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>maciej.rabeda</cc>
    
    <cc>saloni.kasbekar</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19471</commentid>
    <comment_count>0</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-02 12:50:59 +0000</bug_when>
    <thetext>Current code uses if() to scan through the supported HTTP methods - 
  if ((Request != NULL) &amp;&amp; (Request-&gt;Method != HttpMethodGet) &amp;&amp;
      (Request-&gt;Method != HttpMethodHead) &amp;&amp; (Request-&gt;Method != HttpMethodDelete) &amp;&amp;
      (Request-&gt;Method != HttpMethodPut) &amp;&amp; (Request-&gt;Method != HttpMethodPost) &amp;&amp;
      (Request-&gt;Method != HttpMethodPatch) &amp;&amp; (Request-&gt;Method != HttpMethodConnect))

This can be modified to use switch() to make it more readable.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19472</commentid>
    <comment_count>1</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-02 12:52:06 +0000</bug_when>
    <thetext>Updating status and assigning to myself.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21664</commentid>
    <comment_count>2</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2023-06-15 16:54:35 +0000</bug_when>
    <thetext>Merged with implementation for https://bugzilla.tianocore.org/show_bug.cgi?id=3951</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21665</commentid>
    <comment_count>3</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2023-06-15 16:55:31 +0000</bug_when>
    <thetext>Marking as duplicate

*** This bug has been marked as a duplicate of bug 3951 ***</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4664</bug_id>
          
          <creation_ts>2024-02-01 22:27:07 +0000</creation_ts>
          <short_desc>AlderlakeSiliconPkg: Update for SPI2 Protocol and Identify flash regions by GUID</short_desc>
          <delta_ts>2024-04-09 04:38:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>Placeholder</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dora Hsueh">dorax.hsueh</reporter>
          <assigned_to name="Dora Hsueh">dorax.hsueh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22501</commentid>
    <comment_count>0</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-02-01 22:27:07 +0000</bug_when>
    <thetext>1. Updates references to the &quot;PCH_SPI_PROTOCOL&quot; to instead refer to &quot;PCH_SPI2_PROTOCOL&quot;.
2. Updates the library to identify flash regions by GUID and internally
map the GUID entries to values specific to AlderlakeSiliconPkg.
3. Libs/modules that need to reference IntelSiliconPkg are updated.
4. Add gUsbConfigGuid to fix USB not working issue in OS.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22728</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 22:11:53 +0000</bug_when>
    <thetext>dorax.hsueh@intel.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22889</commentid>
    <comment_count>2</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-04-09 04:38:24 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2-platforms/pull/121
PR merged on WW15.2</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4517</bug_id>
          
          <creation_ts>2023-08-03 11:05:03 +0000</creation_ts>
          <short_desc>edk2-libc: edk2module.c documentation issues in rdmsr and wrmsr</short_desc>
          <delta_ts>2023-11-24 04:52:28 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>Other</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Vishal">vishal.r</reporter>
          <assigned_to name="Vishal">vishal.r</assigned_to>
          <cc>aaron.frinzell</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>n.jayaprakash</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21798</commentid>
    <comment_count>0</comment_count>
      <attachid>1388</attachid>
    <who name="Vishal">vishal.r</who>
    <bug_when>2023-08-03 11:05:03 +0000</bug_when>
    <thetext>Created attachment 1388
Screenshot of the rdmsr help document

The document for the rdmsr and wrmsr in the edkmodule.c is as below:
File location: https://github.com/tianocore/edk2-libc/blob/master/AppPkg/Applications/Python/Python-3.6.8/PyMod-3.6.8/Modules/edk2module.c

&quot;rdmsr(ecx) -&gt; (eax,edx)\n\
Read the given MSR.&quot;

&quot;wrmsr(ecx, eax, edx) -&gt; None\n\
Write edx:eax to the given MSR.&quot;

The usage of names such as eax, ecx and edx is not correct in the context of MSR operations and needs updating to right names.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21799</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-03 11:08:44 +0000</bug_when>
    <thetext>Confirming that it is a documentation issue in Python module edk2module.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21800</commentid>
    <comment_count>2</comment_count>
    <who name="Vishal">vishal.r</who>
    <bug_when>2023-08-03 12:44:58 +0000</bug_when>
    <thetext>Submitted patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22186</commentid>
    <comment_count>3</comment_count>
    <who name="Vishal">vishal.r</who>
    <bug_when>2023-11-24 04:52:28 +0000</bug_when>
    <thetext>Patch has been merged with master:

commit 4f15bc2164008adff892dd5dd2df53a3446ee8f7</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1388</attachid>
            <date>2023-08-03 11:05:03 +0000</date>
            <delta_ts>2023-08-03 11:05:03 +0000</delta_ts>
            <desc>Screenshot of the rdmsr help document</desc>
            <filename>rdmsr-wrmsr.png</filename>
            <type>image/png</type>
            <size>253081</size>
            <attacher name="Vishal">vishal.r</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4377</bug_id>
          
          <creation_ts>2023-03-17 02:40:24 +0000</creation_ts>
          <short_desc>IntelFsp2Pkg: Fix NASM X64 build warning.</short_desc>
          <delta_ts>2023-03-24 19:52:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21206</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-17 02:40:24 +0000</bug_when>
    <thetext>NASM X64 generated below warnings:
/X64/FspHelper.iii:26: warning: signed dword value exceeds bounds 
/X64/FspHelper.iii:35: warning: signed dword value exceeds bounds 
/X64/FspApiEntryT.iii:320: warning: dword data exceeds bounds</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21207</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-17 02:40:45 +0000</bug_when>
    <thetext>Looking into this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21208</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-17 02:54:20 +0000</bug_when>
    <thetext>code review sent:
 https://edk2.groups.io/g/devel/message/101307</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21261</commentid>
    <comment_count>3</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-24 19:52:36 +0000</bug_when>
    <thetext>patch merged:
https://github.com/tianocore/edk2/commit/f6bd3286edfbe5eb6b50946cc8bb89e5c60b9388</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4193</bug_id>
          
          <creation_ts>2022-12-14 02:54:55 +0000</creation_ts>
          <short_desc>Remove RTC_INDEX/RTC_TARGET from UplBuild macro list</short_desc>
          <delta_ts>2023-02-07 01:14:42 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Kasim Liu">kasimx.liu</reporter>
          <assigned_to name="Kasim Liu">kasimx.liu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20214</commentid>
    <comment_count>0</comment_count>
    <who name="Kasim Liu">kasimx.liu</who>
    <bug_when>2022-12-14 02:54:55 +0000</bug_when>
    <thetext>In order to remove RTC_INDEX/RTC_TARGET from the UplBuild macro list,change the RTC_INDEX/RTC_TARGET type from PcdsFixedAtBuild to PcdsDynamicEx</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20233</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-12-20 21:40:19 +0000</bug_when>
    <thetext>Kasim has worked on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20622</commentid>
    <comment_count>2</comment_count>
    <who name="Kasim Liu">kasimx.liu</who>
    <bug_when>2023-01-11 22:37:53 +0000</bug_when>
    <thetext>It&apos;s resolved by  https://github.com/tianocore/edk2/pull/3804
                  https://github.com/tianocore/edk2/pull/3856</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20995</commentid>
    <comment_count>3</comment_count>
    <who name="Kasim Liu">kasimx.liu</who>
    <bug_when>2023-02-07 01:14:42 +0000</bug_when>
    <thetext>Update the new commit - https://github.com/tianocore/edk2/pull/3856</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4840</bug_id>
          
          <creation_ts>2024-09-03 10:28:19 +0000</creation_ts>
          <short_desc>edk2-libc: adopt the github PR review process for this repo</short_desc>
          <delta_ts>2024-09-05 03:20:01 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>rebecca</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23358</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-09-03 10:28:19 +0000</bug_when>
    <thetext>Recently many of the tinaocore projects are migrating to use the github PR review process instead of the legacy email patch review process. 
This BZ is to migrate the edk2-libc project to adopt the github PR review process.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23359</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-09-03 10:29:12 +0000</bug_when>
    <thetext>Jayaprakash will be working on this with the help of Rebecca.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23378</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-09-05 03:19:31 +0000</bug_when>
    <thetext>Patch sent for review and got the approvals for the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23379</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-09-05 03:20:01 +0000</bug_when>
    <thetext>patch merged through 
commit 51b9dca2ad0ce88b6f5162871370f5d64fa428e7</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4068</bug_id>
          
          <creation_ts>2022-09-19 01:30:25 +0000</creation_ts>
          <short_desc>PCI Express Base PCD is UINT64, code should not thunk to UINT32</short_desc>
          <delta_ts>2023-01-22 07:23:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ashraf Ali S">ashraf.ali.s</reporter>
          <assigned_to name="Ashraf Ali S">ashraf.ali.s</assigned_to>
          <cc>ashraf.ali.s</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19588</commentid>
    <comment_count>0</comment_count>
    <who name="Ashraf Ali S">ashraf.ali.s</who>
    <bug_when>2022-09-19 01:30:25 +0000</bug_when>
    <thetext>There is a thunking operation from UINT64 to UINT32 for the PCI Express Base address. if the PCIE base address is 32bit then there won&apos;t be a issue. but if the PCIE base address then thunking the address will points to different junk address which will fail the execution flow.
API PciHostBridgeGetRootBridges</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19589</commentid>
    <comment_count>1</comment_count>
    <who name="Ashraf Ali S">ashraf.ali.s</who>
    <bug_when>2022-09-19 01:59:57 +0000</bug_when>
    <thetext>Patch already sent to devel:
[edk2-devel] [PATCH] FIX MinPlatformPkg PCIE Base Addess avoid thunking operation.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19649</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:17:13 +0000</bug_when>
    <thetext>Ashraf has worked on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20742</commentid>
    <comment_count>3</comment_count>
    <who name="Ashraf Ali S">ashraf.ali.s</who>
    <bug_when>2023-01-22 07:23:21 +0000</bug_when>
    <thetext>Submitted : https://github.com/tianocore/edk2-platforms/commit/6198c1c497dcd3b0b46abac882247728fe5e0cf1</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4693</bug_id>
          
          <creation_ts>2024-02-18 14:55:02 +0000</creation_ts>
          <short_desc>PatchCheck silently ignores commit message signature check errors</short_desc>
          <delta_ts>2024-03-08 15:21:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>bob.c.feng</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>rebecca</cc>
    
    <cc>yuwei.chen</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22616</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 14:55:02 +0000</bug_when>
    <thetext>The logic in PatchCheck does check signatures in commit messages
and does print error messages in the log, but the error status is
not captured and as a result if the only issue noted is with
signatures in commit messages, an incorrect PASS condition is
generated from both command line use of PatchCheck and CI use of
PatchCheck.

The bug is in the find_signatures() method of the CommitMessageCheck
class where the signature checks are performed, but not used to update
the self.ok value of the CommitMessageCheck class.

The call to EmailAddressCheck() in find_signatures() should be 
updated from:

    EmailAddressCheck(s[3], sig)

to:

    self.ok &amp;= EmailAddressCheck(s[3], sig).ok</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22617</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 14:56:18 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22618</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 15:32:50 +0000</bug_when>
    <thetext>Test case:
    Cc: &lt;abc@xyz.org&gt;
    Cc: ABC
    Cc: ABC &lt;abc@xyz.org&gt;

Run PatchCheck.py:
    Checking git commit: HEAD
    Readme.rst: Add Line
    The &apos;Cc&apos; email address is not valid:
     * Name is not provided with email address: &lt;abc@xyz.org&gt;
     * There should be a space between the name and email address: &lt;abc@xyz.org&gt;
    The &apos;Cc&apos; email address is not valid:
     * Email format is invalid: ABC
    The commit message format passed all checks.
    The code passed all checks.

PatchCheck prints error messages for the first 2 Cc: statements.

But the status after running PatchCheck for these conditions is 0 which
is a success code</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22623</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 16:03:52 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/5383

Patch Review: https://edk2.groups.io/g/devel/message/115568</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22765</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-03-08 15:21:00 +0000</bug_when>
    <thetext>Merged: https://github.com/tianocore/edk2/pull/5419</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4547</bug_id>
          
          <creation_ts>2023-09-01 05:08:22 +0000</creation_ts>
          <short_desc>Add New Intel Processor family for SMBIOS Type 4 from SMBIOS 3.7.0</short_desc>
          <delta_ts>2023-10-26 16:36:13 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="avi">avinash.bhargava</reporter>
          <assigned_to name="avi">avinash.bhargava</assigned_to>
          <cc>avinash.bhargava</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21887</commentid>
    <comment_count>0</comment_count>
    <who name="avi">avinash.bhargava</who>
    <bug_when>2023-09-01 05:08:22 +0000</bug_when>
    <thetext>Add New Intel Processor family for SMBIOS Type 4 from SMBIOS 3.7.0

Hex value - 16h
Name - Intel® Processor</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21888</commentid>
    <comment_count>1</comment_count>
    <who name="avi">avinash.bhargava</who>
    <bug_when>2023-09-01 05:10:00 +0000</bug_when>
    <thetext>I started working and making changes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22070</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:36:13 +0000</bug_when>
    <thetext>Apparently fixed in commit d4ae5df71190148c902942c3462245e97ed2fcc8.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4548</bug_id>
          
          <creation_ts>2023-09-01 11:54:28 +0000</creation_ts>
          <short_desc>edk2-libc : update instructions to build socket module</short_desc>
          <delta_ts>2023-09-01 12:37:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Documentation</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          <cf_documents>Other Document</cf_documents>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21890</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-09-01 11:54:28 +0000</bug_when>
    <thetext>The current build instructions available in readme https://github.com/tianocore/edk2-libc/blob/master/AppPkg/Applications/Python/Python-3.6.8/Py368ReadMe.txt 
to enable socket module support in Python interpreter are not complete.

Below is the extract from the Py368ReadMe.txt file:

6. Example: Enabling socket support
===================================
  1.  enable {&quot;_socket&quot;, init_socket}, in PyMod-3.6.8\Modules\config.c
  2.  enable LibraryClasses BsdSocketLib and EfiSocketLib in Python368.inf
  3.  Build Python interpreter application using below command
          build -a X64 -p AppPkg\AppPkg.dsc
  6.  copy Build\AppPkg\RELEASE_VS2017\X64\Python.efi to \Efi\Tools on your
      target system. Replace &quot;RELEASE_VS2017&quot;, in the source path, with
      values appropriate for your tool chain.

It doesn&apos;t mention uncommenting of the line in Python368.inf file which adds the socketmodule.c source file for compilation. 

This documentation issue needs to be fixed to provide clear instructions for enabling socket module as built in module in Python interpreter of UEFI shell.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21891</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-09-01 11:56:09 +0000</bug_when>
    <thetext>Confirming the documentation issue.
I will be updating the documentation to fix this issue and send the patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21892</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-09-01 12:27:29 +0000</bug_when>
    <thetext>submitted the patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21893</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-09-01 12:37:56 +0000</bug_when>
    <thetext>patch merged</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4405</bug_id>
          
          <creation_ts>2023-04-07 08:38:18 +0000</creation_ts>
          <short_desc>expose IBT/BTI compatible runtime DXE drivers via memory attributes table</short_desc>
          <delta_ts>2023-05-06 02:25:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ard Biesheuvel">ardb</reporter>
          <assigned_to name="Ard Biesheuvel">ardb</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
    
    <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21339</commentid>
    <comment_count>0</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-04-07 08:38:18 +0000</bug_when>
    <thetext>Version 2 of the EFI memory attributes table now contains a
flag informing the OS whether or not code regions may be mapped with CFI
mitigations such as IBT or BTI enabled.

The PE/COFF spec has introduced a new DllCharacteristicsEx metadata flag that describes whether the executable code regions of a PE/COFF executable can tolerate being mapped with strict enforcement for IBT/BTI.

Let&apos;s wire this up, by

- setting the PE/COFF flag on binaries generated from ELF, if the ELF binary has the equivalent metadata flag set
- setting the associated EFI memory attributes flag if all runtime DXE drivers have the PE/COFF flag set.

TODO:
- changes to build options to generate IBT/BTI ELF binaries (but this can be done on an individual basis by platforms)
- document/clarify how native PE toolchains can be used to set this PE/COFF metadata flag</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21410</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:45:21 +0000</bug_when>
    <thetext>Ard is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21497</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-06 02:25:43 +0000</bug_when>
    <thetext>Fix in Edk2 cdf6ff1719a9453351baec4bd32fcfc30e9ceeac..6405cd03048c1850d5047bf66fefa04189a05c94</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4875</bug_id>
          
          <creation_ts>2024-12-02 23:20:36 +0000</creation_ts>
          <short_desc>ArmPkg/Library/CompilerIntrinsicsLib/CompilerIntrinsicsLib.inf is not found in packages path</short_desc>
          <delta_ts>2024-12-17 14:21:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>richard.lyu</reporter>
          <assigned_to name="Edhay">edhaya.chandran</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23546</commentid>
    <comment_count>0</comment_count>
    <who name="">richard.lyu</who>
    <bug_when>2024-12-02 23:20:36 +0000</bug_when>
    <thetext>I tried to build the SCT and followed the instructions provided [here](https://github.com/tianocore/edk2-test/blob/master/uefi-sct/HowToBuild/HowToBuildSct.txt) on Linux, but encountered the following error:

build.py...
/home/Workspace/sct_workspace/SctPkg/UEFI/UEFI_SCT.dsc(179): error 000E: File/directory not found in workspace
    ArmPkg/Library/CompilerIntrinsicsLib/CompilerIntrinsicsLib.inf is not found in packages path:
    /home/Workspace/sct_workspace/edk2
    /home/Workspace/sct_workspace/SctPkg

It seems CompilerIntrinsicsLib.inf is missing from the edk2. Does anyone have any ideas on how to resolve this?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23550</commentid>
    <comment_count>1</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-12-05 10:18:16 +0000</bug_when>
    <thetext>Thank you for raising the issue.
The solution is given by the PR: https://github.com/tianocore/edk2-test/pull/105

The same is reviewed OK. This shall be upstreamed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23573</commentid>
    <comment_count>2</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-12-17 14:21:03 +0000</bug_when>
    <thetext>The solution is upstreamed through:
https://github.com/tianocore/edk2-test/commit/032f97a668e85651e101df868a0b0e9aba2dc50c

Closing the issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4096</bug_id>
          
          <creation_ts>2022-10-04 23:05:03 +0000</creation_ts>
          <short_desc>Deprecated crypto services should be disabled in UefiPayloadPkg.dsc</short_desc>
          <delta_ts>2022-10-12 22:56:07 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Gua Guo">gua.guo</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>gua.guo</cc>
    
    <cc>guo.dong</cc>
    
    <cc>james.lu</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19708</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-04 23:05:03 +0000</bug_when>
    <thetext>The UefiPayloadPkg.dsc file has TDES and ARC4 crypto service families enabled.

  gEfiCryptoPkgTokenSpaceGuid.PcdCryptoServiceFamilyEnable.Tdes.Family                              | PCD_CRYPTO_SERVICE_ENABLE_FAMILY
  gEfiCryptoPkgTokenSpaceGuid.PcdCryptoServiceFamilyEnable.Arc4.Family                              | PCD_CRYPTO_SERVICE_ENABLE_FAMILY


These services are deprecated and should be disabled in this DSC file.

https://github.com/tianocore/edk2/blob/f931506815548cee5a3929856bfc98266c39999c/CryptoPkg/Driver/Crypto.c#L2067

https://github.com/tianocore/edk2/blob/f931506815548cee5a3929856bfc98266c39999c/CryptoPkg/Driver/Crypto.c#L2388</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19709</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-04 23:08:14 +0000</bug_when>
    <thetext>CC maintainers</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19750</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-11 21:47:04 +0000</bug_when>
    <thetext>Gua is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19768</commentid>
    <comment_count>3</comment_count>
    <who name="Gua Guo">gua.guo</who>
    <bug_when>2022-10-12 22:56:07 +0000</bug_when>
    <thetext>The PR can resolve the BZ
https://github.com/tianocore/edk2/pull/3468</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4732</bug_id>
          
          <creation_ts>2024-03-19 10:07:21 +0000</creation_ts>
          <short_desc>CryptoPkg/BaseCryptLib: add additional RSAEP-OAEP crypto functions</short_desc>
          <delta_ts>2024-04-07 22:26:44 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chris Ruffin">cruffin</reporter>
          <assigned_to name="Chris Ruffin">cruffin</assigned_to>
          <cc>cruffin</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>wenxing.hou</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22809</commentid>
    <comment_count>0</comment_count>
    <who name="Chris Ruffin">cruffin</who>
    <bug_when>2024-03-19 10:07:21 +0000</bug_when>
    <thetext>BasecryptLib currently only provides RSAES-OAEP encryption capability with Pkcs1v2Encrypt() which takes as input a DER encoded x.509 certificate.  A DXE application which needs access to RSAES-OAEP encryption and decryption capabilities currently only has the option of statically linking OpensslLib and using functions such as RSA_public_encrypt() and RSA_private_decrypt().  These applications would benefit from an expanded access to RSAES-OAEP encryption / decryption capability in BaseCryptLib so that the shared crypto driver can be used and the applciation can be migrated away from RSA_public_decrypt() and RSA_private_decrypt() which are deprecated in Openssl 3.

There is the following challenges with migrating to BaseCryptLib interfaces:

	1) BaseCryptLib Pkcs1v2Encrypt() requires the use of an X.509 DER-encoded certificate to pass the public key.  This interface is dissimilar from the rest of the RSA APIs in BasecryptLib.  Applications that have used other RSA APIs from BaseCryptLib for key generation and management such as RsaGenerateKey() and RsaSetKey() will not have such a structure available.
	2) BaseCryptLib currently exposes no decryption capability.

This feature provides an easy migration path for drivers/applications which need access to RSAES-OAEP encryption / decryption and that are currently using an RsaContext structure to pass key components to OpensslLib. These applications can be easily migrated to one of the new APIs to remove the direct dependency on OpensslLib, migrate away from deprecated interfaces, take advantage of CryptoPkg/Driver, and get BasecryptLib access to RSAES-OAEP decryption.

Key changes proposed:
InternalPkcs1v2Encrypt(): New internal-only function created from refactoring of Pkcs1v2Encrypt().  Takes key input from an ENV_PKEY and is used by both public functions Pkcs1v2Encrypt() and RsaOaepEncrypt().

Pkcs1v2Encrypt(): has been refactored to create InternalPkcs1v2Encrypt() but the public interface is maintained.

RsaOaepEncrypt(): New function takes key input from an RsaContext, creates an ENV_PKEY, and calls InternalPkcs1v2Encrypt()

InternalPkcs1v2Decrypt(): New internal-only function InternalPkcs1v2Decrypt() takes key input from an ENV_PKEY and provides the RSAES-OAEP decryption capability to Pkcs1v2Decrypt() and RsaOaepDecrypt().

Pkcs1v2Decrypt(): New public function Pkcs1v2Decrypt() takes a DER-encoded private key, creates an ENV_PKEY, and calls InternalPkcs1v2Decrypt()

RsaOaepDecrypt(): New public function RsaOaepDecrypt() takes a pointer to RsaContext, creates an ENV_PKEY, and calls InternalPkcs1v2Decrypt()</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22817</commentid>
    <comment_count>1</comment_count>
    <who name="Chris Ruffin">cruffin</who>
    <bug_when>2024-03-25 21:17:02 +0000</bug_when>
    <thetext>v1 patches:
https://edk2.groups.io/g/devel/message/116870
https://edk2.groups.io/g/devel/message/116871
https://edk2.groups.io/g/devel/message/116872

Github PR: https://github.com/tianocore/edk2/pull/5473</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22818</commentid>
    <comment_count>2</comment_count>
    <who name="Chris Ruffin">cruffin</who>
    <bug_when>2024-03-25 21:21:31 +0000</bug_when>
    <thetext>Set to confirmed with patches available.  Would like to target 202405 with this feature.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22874</commentid>
    <comment_count>3</comment_count>
    <who name="Chris Ruffin">cruffin</who>
    <bug_when>2024-04-04 19:24:57 +0000</bug_when>
    <thetext>V2 patch set:
https://edk2.groups.io/g/devel/message/117249
https://edk2.groups.io/g/devel/message/117250
https://edk2.groups.io/g/devel/message/117251
https://edk2.groups.io/g/devel/message/117252</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22880</commentid>
    <comment_count>4</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-07 22:26:44 +0000</bug_when>
    <thetext>Pushed: https://github.com/tianocore/edk2/pull/5532</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4577</bug_id>
          
          <creation_ts>2023-10-26 14:08:50 +0000</creation_ts>
          <short_desc>ArmVirtPkg: support two PL011 UARTs</short_desc>
          <delta_ts>2024-06-10 14:16:50 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Laszlo Ersek">laszlo.ersek</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ArmVirtPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22057</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 14:08:50 +0000</bug_when>
    <thetext>* Original report (and test results):

  EDK2 ArmVirtQemu behaviour with multiple UARTs
  http://mid.mail-archive.com/CAFEAcA_P5aOTQnM2ARYgR5WvKouvndMbX95XNmDsS0KTxMkMMw@mail.gmail.com
  https://listman.redhat.com/archives/edk2-devel-archive/2023-September/068241.html
  https://edk2.groups.io/g/devel/message/108941

* Edk2 series:

  [edk2-devel] [PATCH 0/9] ArmVirtPkg: support two PL011 UARTs
  https://edk2.groups.io/g/devel/message/109394
  http://mid.mail-archive.com/20231008153912.175941-1-lersek@redhat.com
  https://listman.redhat.com/archives/edk2-devel-archive/2023-October/068694.html

* Cover letter (extract):

The series does the following:

- It centralizes (and cleans up) two FDT parsing actions, namely looking
  up all serial ports, and looking up the /chosen &quot;stdout-path&quot; serial
  port, in a new library class and instance.

- It rebases Fdt16550SerialPortHookLib, EarlyFdtPL011SerialPortLib and
  PlatformPeiLib to the new library.

- If QEMU specifies just one PL011 UART, then this patch set is
  unobservable from the outside.

- If QEMU specifies (at least) two PL011 UARTs, then we distinguish a
  &quot;chosen&quot; one, and a (first) &quot;non-chosen&quot; one:

  - Both EarlyFdtPL011SerialPortLib, and (PlatformPeiLib +
    FdtPL011SerialPortLib), target the &quot;chosen&quot; PL011. The consequence
    of this is that (a) direct SerialPortLib traffic, (b) the dependent
    SerialIo (SerialDxe) protocol traffic, and (c) the dependent UEFI
    console traffic, all occcur on the same PL011, and do so regardless
    of the firmware phase. Furthermore, (d) the Linux serial console
    traffic is directed to the same PL011 as well. In total, the
    &quot;chosen&quot; PL011 UART becomes &quot;the console&quot;, covering both firmware
    and Linux.

  - Three new DebugLib instances -- namely Flash, RAM, and DXE Runtime
    instances of &quot;DebugLibFdtPL011Uart&quot; -- target the (first)
    &quot;non-chosen&quot; PL011. The consequence is that DebugLib output is
    hermetically separated from the above-mentioned console, mirroring
    the isa-debugcon situation with x86 OVMF.

* Interfacing QEMU series:

  [qemu-devel] [PATCH 0/3] hw/arm: Create second NonSecure UART for virt board
  http://mid.mail-archive.com/20231023161532.2729084-1-peter.maydell@linaro.org
  https://patchew.org/QEMU/20231023161532.2729084-1-peter.maydell@linaro.org/
  https://lists.gnu.org/archive/html/qemu-devel/2023-10/msg08000.html</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22058</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 14:09:13 +0000</bug_when>
    <thetext>series is on the list and has been tested &amp; acked</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22059</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 14:10:02 +0000</bug_when>
    <thetext>... this is a feature request, updating the Product field</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22060</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 15:00:25 +0000</bug_when>
    <thetext>Merged as commit range 74c687cc2f2f..f945b72331d7 via &lt;https://github.com/tianocore/edk2/pull/4967&gt;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23104</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2024-06-10 14:16:50 +0000</bug_when>
    <thetext>V2 of the interfacing QEMU series:

[PATCH v2 0/3] hw/arm: Create second NonSecure UART for virt board
https://patchew.org/QEMU/20240610162343.2131524-1-peter.maydell@linaro.org/</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4432</bug_id>
          
          <creation_ts>2023-04-27 09:29:04 +0000</creation_ts>
          <short_desc>There is a return value bug in LoongArch synchronization operation</short_desc>
          <delta_ts>2023-05-09 23:25:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21448</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-04-27 09:29:04 +0000</bug_when>
    <thetext>LoongArch AsmInternalSyncCompareExchange32 and AsmInternalSyncCompareExchange64 have wrong return values, needs to be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21541</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 21:59:47 +0000</bug_when>
    <thetext>lichao@loongson.cn: please fix it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21551</commentid>
    <comment_count>2</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-05-09 23:25:31 +0000</bug_when>
    <thetext>This has been fixed and the patch has been merged by edk2.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4256</bug_id>
          
          <creation_ts>2023-01-05 05:44:22 +0000</creation_ts>
          <short_desc>SCT improvement - increase the waiting time in the SCT GetStatus_Func test</short_desc>
          <delta_ts>2024-11-07 15:09:41 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sunny Wang">Sunny.Wang</reporter>
          <assigned_to name="Edhay">edhaya.chandran</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaojie</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20499</commentid>
    <comment_count>0</comment_count>
    <who name="Sunny Wang">Sunny.Wang</who>
    <bug_when>2023-01-05 05:44:22 +0000</bug_when>
    <thetext>The current time delay in the SCT GetStatus_Func test is 5 milliseconds, which caused false positives with some platforms&apos; NIC. 

For example, in one of our tests, a platform that has 6 ethernet ports, GetStatus_Func test each port 32 times so, it has 18 instances. 
    - With current time delay (5 milliseconds), we got 5 or 6 failed instances.
    - Changing the delay time to 10 milliseconds and we got 4 failed instances.
    - Changing the delay time to 1000 milliseconds and we got no failed instances.


We will need to check why we set 5 milliseconds in the very beginning and if there is any concern to increase the time delay.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20500</commentid>
    <comment_count>1</comment_count>
    <who name="Sunny Wang">Sunny.Wang</who>
    <bug_when>2023-01-05 05:48:54 +0000</bug_when>
    <thetext>The current time delay in the SCT GetStatus_Func test is 5 milliseconds, which caused false positives on some platforms. 

For example, in one of our tests, a platform that has 6 ethernet ports, GetStatus_Func test each port 3 times, so it has 18 instances. 
    - With the current time delay (5 milliseconds), we got 5 or 6 failed instances.
    - After changing the delay time to 10 milliseconds, we got 4 failed instances.
    - After changing the delay time to 1000 milliseconds, we got no failed instances.


We will need to check why we set 5 milliseconds in the beginning and if there is any concern to increase the time delay.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20501</commentid>
    <comment_count>2</comment_count>
    <who name="Sunny Wang">Sunny.Wang</who>
    <bug_when>2023-01-05 06:08:29 +0000</bug_when>
    <thetext>The following links are where we should update.

https://github.com/tianocore/edk2-test/blob/06f84debb796b2f6ac893b130e90ab5599195b29/uefi-sct/SctPkg/TestCase/UEFI/EFI/Protocol/SimpleNetwork/BlackBoxTest/SimpleNetworkBBTestFunction.c#L1774

https://github.com/tianocore/edk2-test/blob/06f84debb796b2f6ac893b130e90ab5599195b29/uefi-sct/SctPkg/TestCase/UEFI/EFI/Protocol/SimpleNetwork/BlackBoxTest/SimpleNetworkBBTestFunction.c#L2091


It looks fine to increase the delay time to 500 milliseconds as similar code because it is the waiting time used in edk2 NetworkPkg NetLib.

https://github.com/tianocore/edk2/blob/9ce09870e721efacc41fa7ee684e9e299f120350/NetworkPkg/Include/Library/NetLib.h#L264</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23383</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-09-05 10:48:45 +0000</bug_when>
    <thetext>As discussed in the community, the timeout value may be increased to 500 milliseconds without impacting the test logic.

The old value of 5 milliseconds may have been based on experience.

Sunny, please go ahead with the changes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23423</commentid>
    <comment_count>4</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-10-03 10:27:04 +0000</bug_when>
    <thetext>Edhay to take up the patch solution.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23469</commentid>
    <comment_count>5</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-10-22 18:01:12 +0000</bug_when>
    <thetext>Patch is upstreamed to mailing list
https://edk2.groups.io/g/devel/message/120655

Open for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23470</commentid>
    <comment_count>6</comment_count>
      <attachid>1550</attachid>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-10-22 18:04:17 +0000</bug_when>
    <thetext>Created attachment 1550
edk2-test-uefi-sct-Increase-the-waiting-time</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23514</commentid>
    <comment_count>7</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-11-07 10:15:27 +0000</bug_when>
    <thetext>Reviewed in the bug triage meeting 7th Nov.
Patch shall be upstreamed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23522</commentid>
    <comment_count>8</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-11-07 15:09:41 +0000</bug_when>
    <thetext>Patch upstreamed through the commit ID: 
https://github.com/tianocore/edk2-test/commit/8d01932fb1f253b5a28b21e278945557d1ebc409

Issue is resolved.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1550</attachid>
            <date>2024-10-22 18:04:17 +0000</date>
            <delta_ts>2024-10-22 18:04:17 +0000</delta_ts>
            <desc>edk2-test-uefi-sct-Increase-the-waiting-time</desc>
            <filename>0001-edk2-test-uefi-sct-Increase-the-waiting-time-in-the-.patch</filename>
            <type>text/plain</type>
            <size>2195</size>
            <attacher name="Edhay">edhaya.chandran</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4123</bug_id>
          
          <creation_ts>2022-10-26 21:30:39 +0000</creation_ts>
          <short_desc>Rename VmgExitLib to CcExitLib</short_desc>
          <delta_ts>2023-01-17 01:03:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>kraxel</cc>
    
    <cc>min.m.xu</cc>
    
    <cc>thomas.lendacky</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19850</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-10-26 21:30:39 +0000</bug_when>
    <thetext>OvmfPkg/Library/VmgExitLib once was designed to provide interfaces to support VMGEXIT handler. After TDVF (enable TDX feature in OVMF) is introduced, this library is updated to support #VE as well. Now the name of VmgExitLib cannot reflect what the lib does. So VmgExitLib is going to be renamed as CcExitLib. Cc means Confidentail Computing.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19851</commentid>
    <comment_count>1</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-10-26 21:37:02 +0000</bug_when>
    <thetext>Min is working on this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19904</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-01 21:51:00 +0000</bug_when>
    <thetext>Min will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20692</commentid>
    <comment_count>3</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-01-17 01:03:26 +0000</bug_when>
    <thetext>Completed with below commit:
a89f558d3c 2022-11-07 OvmfPkg/UefiCpuPkg/UefiPayloadPkg: Rename VmgExitLib to CcExitLib</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4608</bug_id>
          
          <creation_ts>2023-11-28 02:07:28 +0000</creation_ts>
          <short_desc>edk2-redfish-client: Enhance the implementation of getting etag and @Redfish.Settings anootation URI</short_desc>
          <delta_ts>2024-01-30 20:57:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>igork</cc>
    
    <cc>nicklew</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22198</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-11-28 02:07:28 +0000</bug_when>
    <thetext>Don&apos;t get the whole Redfish HTTP response body for etag and @Redfish.Settings. For etag, we can use HTTP HEAD. For @Redfish.Settings, we can leverage $select HTTP query to get @Redfish.Settings resource specifically.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22202</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-11-28 21:11:54 +0000</bug_when>
    <thetext>Abner will take this</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22450</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-01-30 20:57:11 +0000</bug_when>
    <thetext>at ced596e6 on edk2-redfish-client repo</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4144</bug_id>
          
          <creation_ts>2022-11-08 01:42:22 +0000</creation_ts>
          <short_desc>Path finding to support TraceHub on UPL.elf</short_desc>
          <delta_ts>2023-05-11 21:42:02 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Victor Hsu">victorx.hsu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>gua.guo</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19963</commentid>
    <comment_count>0</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-08 01:42:22 +0000</bug_when>
    <thetext>Path finding to support TraceHub on UPL.elf</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19964</commentid>
    <comment_count>1</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-08 01:42:47 +0000</bug_when>
    <thetext>WIP</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19997</commentid>
    <comment_count>2</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-11 01:41:57 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/3613</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21557</commentid>
    <comment_count>3</comment_count>
    <who name="Gua Guo">gua.guo</who>
    <bug_when>2023-05-11 03:39:00 +0000</bug_when>
    <thetext>Merge it, https://github.com/tianocore/edk2/pull/3901. Set it to resolved.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21561</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-11 21:42:02 +0000</bug_when>
    <thetext>This is a new feature to  add Trace Hub debug library support</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4790</bug_id>
          
          <creation_ts>2024-06-17 08:04:24 +0000</creation_ts>
          <short_desc>HII display engine supports &quot;^&quot; and &quot;V&quot; for the up/down selection in pop up form</short_desc>
          <delta_ts>2024-07-11 03:35:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>dandan.bi</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202305</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23125</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-06-17 08:04:24 +0000</bug_when>
    <thetext>The current HII display engine only supports the arrow keys for the up/down selection on the pop-up form. This is not the same behavior with the up/down keys supported on the regular HII form, as &quot;^&quot; and &quot;v&quot; keys are also supported on the regular form. This issue is created to support &quot;^&quot; and &quot;v&quot; keys on the pop-up form.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23198</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-07-10 20:48:23 +0000</bug_when>
    <thetext>Abner has worked on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23205</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-07-10 21:44:01 +0000</bug_when>
    <thetext>Fixed at commit ae09721a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23210</commentid>
    <comment_count>3</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-07-11 03:35:08 +0000</bug_when>
    <thetext>Fixed at commit ae09721a</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4018</bug_id>
          
          <creation_ts>2022-08-11 01:52:34 +0000</creation_ts>
          <short_desc>UefipayloadPkg: Coverity scan flags multiple issues.</short_desc>
          <delta_ts>2022-08-29 05:07:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Greg">gregx.yeh</reporter>
          <assigned_to name="Greg">gregx.yeh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>gregx.yeh</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19389</commentid>
    <comment_count>0</comment_count>
      <attachid>1017</attachid>
    <who name="Greg">gregx.yeh</who>
    <bug_when>2022-08-11 01:52:34 +0000</bug_when>
    <thetext>Created attachment 1017
UefiPayload Coverity defect report

Coverity report UefiPayloadpkg has defect in VirtualMemory.c and PciHostBridgeLib.c 

Coverity version: 2022.3.1 
Attached report file</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19418</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-22 22:50:35 +0000</bug_when>
    <thetext>Greg is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19446</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-29 05:07:14 +0000</bug_when>
    <thetext>Merge at dfdba857a6b6a708e754ddb1a04086a3402acdef</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1017</attachid>
            <date>2022-08-11 01:52:34 +0000</date>
            <delta_ts>2022-08-11 01:52:34 +0000</delta_ts>
            <desc>UefiPayload Coverity defect report</desc>
            <filename>UefiPayloadPkg Coverity report .zip</filename>
            <type>application/x-zip-compressed</type>
            <size>31910</size>
            <attacher name="Greg">gregx.yeh</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4634</bug_id>
          
          <creation_ts>2024-01-03 23:14:31 +0000</creation_ts>
          <short_desc>CryptoPkg: SmmCryptLib consumed RngLib but not add it to [LibraryClasses]</short_desc>
          <delta_ts>2024-01-07 21:16:20 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to>wenxing.hou</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22322</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-03 23:14:31 +0000</bug_when>
    <thetext>It will cause build error.
Please also check all INF files.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22331</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-07 21:16:20 +0000</bug_when>
    <thetext>CryptRand of mbedtls not upstreamed to EDK2 yet, this issue is a staging bug actually. Closed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4489</bug_id>
          
          <creation_ts>2023-06-26 17:34:31 +0000</creation_ts>
          <short_desc>Update edk2-pytools</short_desc>
          <delta_ts>2024-03-13 11:08:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Joey Vagedes">joeyvagedes</reporter>
          <assigned_to name="Joey Vagedes">joeyvagedes</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ArmPkg</cf_package>
    
    <cf_package>ArmVirtPkg</cf_package>
    
    <cf_package>BaseTools</cf_package>
    
    <cf_package>MdePkg</cf_package>
    
    <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21691</commentid>
    <comment_count>0</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-06-26 17:34:31 +0000</bug_when>
    <thetext>Update edk2-pytool-extensions to 0.23.6 and edk2-pytool-library to 0.15.3 which introduces a new policy to PrEval.

This new policy is used when a library instance INF is changed. In this instance, each package&apos;s dsc file (as specified in the packages ci.yaml file) is parsed to see if the library instance is used by the package. If it is, the package will be compiled and tested.

due to this, the &quot;PrEval: DscPath&quot; entry must be added to each package&apos;s CI.yaml file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21742</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:36:25 +0000</bug_when>
    <thetext>joeyvagedes@microsoft.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22784</commentid>
    <comment_count>2</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2024-03-13 11:08:08 +0000</bug_when>
    <thetext>Resolved in commit 9f5e409623e043d6298181aa94ab5cd3c5e315a1</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4347</bug_id>
          
          <creation_ts>2023-02-22 02:04:52 +0000</creation_ts>
          <short_desc>Integrate UiApp and BootManagerMenuApp into MultiFv BdsFv</short_desc>
          <delta_ts>2023-07-11 03:48:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>mars_cc_lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21098</commentid>
    <comment_count>0</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-02-22 02:04:52 +0000</bug_when>
    <thetext>To put UiApp.inf and BootManagerMenuApp.inf to proper FV(BDSFV)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21099</commentid>
    <comment_count>1</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-02-22 02:05:10 +0000</bug_when>
    <thetext>I&apos;m working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21644</commentid>
    <comment_count>2</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-06-08 04:24:45 +0000</bug_when>
    <thetext>wait for fmmt fix patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21710</commentid>
    <comment_count>3</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-07-11 03:48:03 +0000</bug_when>
    <thetext>
It had implemented.
PR link: https://github.com/tianocore/edk2/pull/4619</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4169</bug_id>
          
          <creation_ts>2022-11-28 16:24:06 +0000</creation_ts>
          <short_desc>Fix Instruction Pointer Incrementation by TD #VE MMIO Handler</short_desc>
          <delta_ts>2023-01-17 22:47:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ryan Afranji">afranji</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>min.m.xu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20114</commentid>
    <comment_count>0</comment_count>
      <attachid>1055</attachid>
    <who name="Ryan Afranji">afranji</who>
    <bug_when>2022-11-28 16:24:06 +0000</bug_when>
    <thetext>Created attachment 1055
Patch for the case described in detail; no fix for the additional cases

In edk2/OvmfPkg/Library/CcExitLib/CcExitVeHandler.c, there is an errant instruction pointer increment in MmioExit(). This leads to incorrect functionality and opens the door for the instruction pointer to be exploited.

For context, TD disallowed instructions executed by a TD are handled in various ways by the #VE handler such as making a corresponding TDCALL or inserting a NOP. After handling this instruction, the guest’s instruction pointer needs to be incremented to the start of the next instruction so that it can resume execution. The #VE handler is responsible for incrementing the guest’s instruction pointer.

This #VE MMIO handler parses through each byte of the instruction to handle the MMIO call and determine the amount the guest’s instruction pointer should be incremented. According to the Intel SDM Vol. 2A Figure 2-1, instruction encodings follow the order of Instruction Prefixes (optional), REX prefixes (optional), Opcode, and then other fields. This handler begins with a loop to parse the first portion of the instruction (Instruction and REX prefixes). This loop breaks once the current byte being parsed is no longer a prefix; therefore, this byte should be the beginning of the opcode according to the Intel SDM. The problem occurs here because the instruction pointer is incremented immediately after parsing the prefixes. This skips parsing the first byte of the opcode. This causes incorrect parsing functionality because the code is expecting to the first byte of the opcode but uses the value in the byte following it. This results in the MMIO instruction being handled incorrectly and the guest instruction pointer pointing to the wrong byte once the guest resumes execution. The guest’s instruction pointer pointing to the wrong byte is exploitable so removing this extra instruction pointer increment can solve this vulnerability.

The comment above the extra instruction pointer increment is misleading. The instruction pointer at this part of the code is pointing to the first byte of the opcode. The instruction may have just one additional byte to increment to. It does have at least two more bytes it needs to parse (the first byte of the opcode and the aforementioned byte) but “We need to have at least 2 more bytes for this instruction” seems to imply the instruction pointer should be incremented at least two more times.

This is just describes one instruction case and there are other cases that need to be handled.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20120</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-11-28 23:16:05 +0000</bug_when>
    <thetext>*** Bug 4170 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20121</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-11-29 01:57:54 +0000</bug_when>
    <thetext>Agree with the assessment.

I think we need carefully review all possible MOV instruction, instead of only handle existing one.

The pattern is:
       REX            PREFIX    | ESCAPE
    [0x40~0x4F][0x66,0xF2,0xF3] | [0x0F]  OpCode(1~2)

Linux reference: https://elixir.bootlin.com/linux/latest/source/arch/x86/lib/insn-eval.c#L1600

Also unsupported instruction should be treated as decode failure error.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20708</commentid>
    <comment_count>3</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-17 22:47:56 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3918</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1055</attachid>
            <date>2022-11-28 16:24:06 +0000</date>
            <delta_ts>2022-11-28 16:24:06 +0000</delta_ts>
            <desc>Patch for the case described in detail; no fix for the additional cases</desc>
            <filename>0001-OvmfPkg-Fix-Instruction-Pointer-Incrementation-by-VE.patch</filename>
            <type>application/octet-stream</type>
            <size>3292</size>
            <attacher name="Ryan Afranji">afranji</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4820</bug_id>
          
          <creation_ts>2024-07-27 04:38:04 +0000</creation_ts>
          <short_desc>[UfsBlockIoPei][UfsPassThruDxe] Move the UFS Device Initialize Timeout into PCD Value</short_desc>
          <delta_ts>2024-08-16 06:52:02 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jason Lin">jason1.lin</reporter>
          <assigned_to name="Jason Lin">jason1.lin</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23268</commentid>
    <comment_count>0</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-07-27 04:38:04 +0000</bug_when>
    <thetext>UFS device initialize timeout is dependent on the UFS device itself.
It shall be configurable by platform itself.
The definition &quot;UFS_INIT_COMPLETION_TIMEOUT&quot; shall be moved into PCD value.
Then platform could control the expected value.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23269</commentid>
    <comment_count>1</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-07-27 04:38:36 +0000</bug_when>
    <thetext>Take the owner of this Bugzilla ticket.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23327</commentid>
    <comment_count>2</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-08-16 06:52:02 +0000</bug_when>
    <thetext>PR https://github.com/tianocore/edk2/pull/5989 had been raised and merged.

It had been as a part of the EDK-II codebase.

SHA1-ID series:
- https://github.com/tianocore/edk2/commit/bc1c890e8ea08c133806ed2f5f681e7af64bddb2
- https://github.com/tianocore/edk2/commit/5289ad177d4f2d587a47185e0567b9d7e579e4e8
- https://github.com/tianocore/edk2/commit/f8f34edd9db82882fd70f14cb97ab28e9bb0b9a3

Mark this ticket as &quot;Resolved&quot; and &quot;Fixed&quot;.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4044</bug_id>
          
          <creation_ts>2022-09-05 02:36:28 +0000</creation_ts>
          <short_desc>UefiCpuPkg/SmmCpuRendezvousLib: Separate the processing logic of MM_STANDALONE and DXE_SMM_DRIVER customers</short_desc>
          <delta_ts>2022-12-02 03:26:25 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="zhihao">zhihao.li</reporter>
          <assigned_to name="zhihao">zhihao.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19473</commentid>
    <comment_count>0</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-09-05 02:36:28 +0000</bug_when>
    <thetext>MM_STANDALONE and DXE_SMM_DRIVER has different work flow after using SmmCpuRendezvousLib. The smm rendezvous protocol instance also has different lifecycle. So separate SmmCpuRendezvousLib for MM_STANDALONE out will be more reasonable.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19483</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-06 21:39:57 +0000</bug_when>
    <thetext>Zhihao: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20173</commentid>
    <comment_count>2</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-12-02 03:26:25 +0000</bug_when>
    <thetext>Invalid.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4665</bug_id>
          
          <creation_ts>2024-02-02 02:18:46 +0000</creation_ts>
          <short_desc>AlderlakeOpenBoardPkg: Fix BootStage 5 can&apos;t install Windows11.</short_desc>
          <delta_ts>2024-05-06 13:27:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>Placeholder</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dora Hsueh">dorax.hsueh</reporter>
          <assigned_to name="Dora Hsueh">dorax.hsueh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22502</commentid>
    <comment_count>0</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-02-02 02:18:46 +0000</bug_when>
    <thetext>Since installing windows does not meet the minimum system requirements, Added TPM related code to meet the requirements.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22727</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 22:11:35 +0000</bug_when>
    <thetext>dorax.hsueh@intel.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23011</commentid>
    <comment_count>2</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-05-06 13:26:47 +0000</bug_when>
    <thetext>Patch Sent: https://edk2.groups.io/g/devel/message/118592</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23012</commentid>
    <comment_count>3</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-05-06 13:27:36 +0000</bug_when>
    <thetext>Pushed: https://github.com/tianocore/edk2-platforms/commit/0ab97ab</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4194</bug_id>
          
          <creation_ts>2022-12-14 03:22:46 +0000</creation_ts>
          <short_desc>TdTcg2Dxe lives in the Ovmfpkg instead of the SecurityPkg.</short_desc>
          <delta_ts>2023-01-15 19:53:58 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>ARGU</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20216</commentid>
    <comment_count>0</comment_count>
    <who name="">ARGU</who>
    <bug_when>2022-12-14 03:22:46 +0000</bug_when>
    <thetext>The TdTcg2Dxe lives in the OvmfPkg instead of the SecurityPkg. Having the TdTcg2Dxe at the same place as Tcg2Dxe will be easier for platforms to consume. For my platform, if I have to include TdTcg2Dxe, I need to override both the Tcg2Dxe implementation and the Ovmf implementation - this makes it hard to maintain the code. Since both of these are variations of the Tcg implementation, they could also share a lot of the code if they live in the SecurityPkg.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20232</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-12-20 21:39:26 +0000</bug_when>
    <thetext>Min: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20243</commentid>
    <comment_count>2</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-12-20 21:53:01 +0000</bug_when>
    <thetext>Yes, Min is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20673</commentid>
    <comment_count>3</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-15 19:53:58 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3862</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4071</bug_id>
          
          <creation_ts>2022-09-20 05:07:15 +0000</creation_ts>
          <short_desc>UefiPayloadPkg: Provide a wrapper for UniversalPayloadBuild.py</short_desc>
          <delta_ts>2022-09-28 06:55:05 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Victor Hsu">victorx.hsu</reporter>
          <assigned_to name="Victor Hsu">victorx.hsu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>victorx.hsu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19592</commentid>
    <comment_count>0</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-09-20 05:07:15 +0000</bug_when>
    <thetext>Provide a python script wrapper for UniversalPauloadBuild.py</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19648</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:16:17 +0000</bug_when>
    <thetext>Victor: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19659</commentid>
    <comment_count>2</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-09-28 06:53:34 +0000</bug_when>
    <thetext>PR https://github.com/tianocore/edk2/pull/3407 has been merged, so close it</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19660</commentid>
    <comment_count>3</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-09-28 06:55:05 +0000</bug_when>
    <thetext>merged</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4694</bug_id>
          
          <creation_ts>2024-02-18 15:41:33 +0000</creation_ts>
          <short_desc>PatchCheck does not generate an error if there are no Cc lines present in commit message</short_desc>
          <delta_ts>2024-03-08 15:21:22 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>bob.c.feng</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>rebecca</cc>
    
    <cc>yuwei.chen</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22619</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 15:41:33 +0000</bug_when>
    <thetext>If no Cc tags are detected at all in a commit message, then an error
should be generated.

All patches sent for review are required to provide the set of 
maintainers and reviewers responsible for the directories/files
modified. The set of maintainers and reviewers are documented in
Maintainers.txt and can be retrieved using the script
BaseTools/Scripts/GetMaintainer.py.

The following signatures are not required when a patch is originally
submitted, so it is not an error is there are none of these.
* Reviewed-by
* Reported-by
* Tested-by
* Suggested-by
* Acked-by

The CommitMessageCheck class has the check_misc_signatures() method
that is responsible for finding all signatures in a commit message.
This is the best place to add a check to see if the number of &apos;Cc:&apos;
signatures is &gt; 0 or not.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22620</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 15:42:21 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22624</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 16:04:17 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/5383

Patch Review: https://edk2.groups.io/g/devel/message/115568</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22766</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-03-08 15:21:22 +0000</bug_when>
    <thetext>Merged: https://github.com/tianocore/edk2/pull/5419</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4408</bug_id>
          
          <creation_ts>2023-04-10 23:15:21 +0000</creation_ts>
          <short_desc>[MTL] HDDPassword driver must transition from Variable Lock to Variable Policy</short_desc>
          <delta_ts>2023-05-08 20:44:50 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc>https://github.com/tianocore/edk2/pull/4358</bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Linus Liu">linus.liu</reporter>
          <assigned_to name="Linus Liu">linus.liu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21348</commentid>
    <comment_count>0</comment_count>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2023-04-10 23:15:21 +0000</bug_when>
    <thetext>The HDDPassword driver must transition from Variable Lock to Variable Policy</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21349</commentid>
    <comment_count>1</comment_count>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2023-04-10 23:17:24 +0000</bug_when>
    <thetext>In future, Variable Lock will be deprecated from Tianocore.  Instead of Variable Lock, platforms should use newer Variable Policy to lock EFI variables.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21368</commentid>
    <comment_count>2</comment_count>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2023-04-17 01:20:16 +0000</bug_when>
    <thetext>Before

InstallProtocolInterface: 09576E91-6D3F-11D2-8E39-00A0C969723B 67E4C490
InstallProtocolInterface: 330D4706-F2A0-4E4F-A369-B66FA8D54385 68180030
!!! DEPRECATED INTERFACE !!! VariableLockRequestToLock() will go away soon!
!!! DEPRECATED INTERFACE !!! Please move to use Variable Policy!
!!! DEPRECATED INTERFACE !!! Variable: 737CDED7-448B-4801-B57D-B19483EC606F HddPassword
HddPasswordDxeInit(): Lock HddPassword variable (Success)


After 

InstallProtocolInterface: 09576E91-6D3F-11D2-8E39-00A0C969723B 67EA1370
InstallProtocolInterface: 330D4706-F2A0-4E4F-A369-B66FA8D54385 68153DB0
HddPasswordDxeInit(): Lock HddPassword variable (Success)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21514</commentid>
    <comment_count>3</comment_count>
    <who name="Linus Liu">linus.liu</who>
    <bug_when>2023-05-08 20:44:50 +0000</bug_when>
    <thetext>1) The HDD password feature still works

2) The variable is really locked.
&gt; &gt; [2023-05-04 11:42:11.046] FS1:\&gt; dmpstore -guid 737cded7-448b-4801- 
&gt; &gt; b57d-b19483ec606F -s HDDPwd.txt
&gt; &gt; [2023-05-04 11:42:18.835] Save variable to file: HDDPwd.txt.
&gt; &gt; [2023-05-04 11:42:18.909] Variable NV+BS &apos;737CDED7-448B-4801-B57D- 
&gt; &gt; B19483EC606F:HddPassword&apos; DataSize = 0x48
&gt; &gt; [2023-05-04 11:42:42.859] Load and set variables from file: HDDPwd.txt.
&gt; &gt; [2023-05-04 11:42:42.934] Variable NV+BS &apos;737CDED7-448B-4801-B57D- 
&gt; &gt; B19483EC606F:HddPassword&apos; DataSize = 0x48
&gt; &gt; [2023-05-04 11:42:43.082] dmpstore: Failed to set variable HddPassword:
&gt; &gt; Write Protected.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4233</bug_id>
          
          <creation_ts>2022-12-30 03:13:29 +0000</creation_ts>
          <short_desc>Reduce the size of LoongArch64 cross compiler</short_desc>
          <delta_ts>2023-01-31 05:09:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20324</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-12-30 03:13:29 +0000</bug_when>
    <thetext>The LoongArch64 cross compiler size is too large after decompression, and needs to be reduced.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20325</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-12-30 03:14:06 +0000</bug_when>
    <thetext>I&apos;m working on this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20429</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:39:08 +0000</bug_when>
    <thetext>Chao has worked on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20964</commentid>
    <comment_count>3</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-01-31 05:09:19 +0000</bug_when>
    <thetext>Merged, Close it.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4097</bug_id>
          
          <creation_ts>2022-10-04 23:13:56 +0000</creation_ts>
          <short_desc>Enable CryptoPkg BaseCryptLib ParallelHash for PEI and DXE</short_desc>
          <delta_ts>2023-03-20 22:25:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="zhihao">zhihao.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>guomin.jiang</cc>
    
    <cc>jian.j.wang</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>xiaoyux.lu</cc>
    
    <cc>zhihao.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19710</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-04 23:13:56 +0000</bug_when>
    <thetext>The BaseCryptLib in the CryptoPkg currently supports ParallelHash algorithm for SMM.  

https://bugzilla.tianocore.org/show_bug.cgi?id=3908

The MP Services PPI and MP Services Protocol could be used to enable ParallelHash in PEI and DXE versions of the BaseCryptLib.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19711</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-04 23:18:09 +0000</bug_when>
    <thetext>SMM ParallelHash:

https://bugzilla.tianocore.org/show_bug.cgi?id=3596</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19749</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-11 21:45:23 +0000</bug_when>
    <thetext>zhihao.li@intel.com: will you work on this request?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19762</commentid>
    <comment_count>3</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-10-12 11:39:52 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #2)
&gt; zhihao.li@intel.com: will you work on this request?

Yes we will.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19777</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-17 21:20:04 +0000</bug_when>
    <thetext>zhihao.li@intel.com will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21212</commentid>
    <comment_count>5</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2023-03-20 22:25:36 +0000</bug_when>
    <thetext>Completed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4734</bug_id>
          
          <creation_ts>2024-03-20 03:27:08 +0000</creation_ts>
          <short_desc>Add LoongArch libraries and drivers into UefiCpuPkg</short_desc>
          <delta_ts>2024-06-06 03:20:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22811</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-03-20 03:27:08 +0000</bug_when>
    <thetext>Add some Libraries and drivers for LoongArch into UefiCpuPkg, such as timer, exception, MMU, MpInit, CpuDxe, etc.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22812</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-03-20 03:28:18 +0000</bug_when>
    <thetext>I&apos;m doing this part of the job.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23095</commentid>
    <comment_count>2</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-06-06 03:20:56 +0000</bug_when>
    <thetext>The patch set was merged, close.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4579</bug_id>
          
          <creation_ts>2023-10-27 04:15:49 +0000</creation_ts>
          <short_desc>edk2-libc: Fix typo issues in StdLib comments</short_desc>
          <delta_ts>2023-12-01 00:31:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Vishal">vishal.r</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22087</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-27 04:15:49 +0000</bug_when>
    <thetext>Observed typo issues (spelling issues) in several comments in multiple files in AppPkg.
These are not affecting any functionality but it would be good to fix them for sanity of the comments and for better readability.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22088</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-27 04:16:58 +0000</bug_when>
    <thetext>Assigning it to Vishal R.
He will help fix the typo issues seen with the comments inside AppPkg under edk2-libc.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22187</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-11-24 05:14:34 +0000</bug_when>
    <thetext>This BZ will be used to fix type issues in documentation strings of StdLib under edk2-libc.
These issues have been identified by running the cspell checker.

.\StdLib\BsdSocketLib\ns_addr.c:75:51 - Unknown word (prefered) fix: (preferred)
.\StdLib\BsdSocketLib\ns_addr.c:77:48 - Unknown word (compatability) fix: (compatibility)
.\StdLib\BsdSocketLib\res_comp.c:111:30 - Unknown word (begining) fix: (beginning)
.\StdLib\BsdSocketLib\res_config.h:3:54 - Unknown word (reccomended) fix: (recommended)
.\StdLib\BsdSocketLib\res_init.c:137:7 - Unknown word (interrim) fix: (interim)
.\StdLib\Include\arpa\telnet.h:216:18 - Unknown word (compatability) fix: (compatibility)
.\StdLib\Include\errno.h:21:72 - Unknown word (preceeding) fix: (preceding)
.\StdLib\Include\locale.h:96:82 - Unknown word (preceeding) fix: (preceding)
.\StdLib\Include\net\if.h:42:19 - Unknown word (compatability) fix: (compatibility)
.\StdLib\Include\net\if.h:112:39 - Unknown word (compatability) fix: (compatibility)
.\StdLib\Include\net\if.h:126:40 - Unknown word (compatability) fix: (compatibility)
.\StdLib\Include\net\if.h:140:41 - Unknown word (compatability) fix: (compatibility)
.\StdLib\Include\netns\ns.h:66:45 - Unknown word (priveleged) fix: (privileged)
.\StdLib\Include\stdio.h:356:36 - Unknown word (successfull) fix: (successful)
.\StdLib\Include\stdlib.h:76:23 - Unknown word (Miscelaneous) fix: (Miscellaneous)
.\StdLib\Include\stdlib.h:861:20 - Unknown word (Miscelaneous) fix: (Miscellaneous)
.\StdLib\Include\stdlib.h:875:46 - Unknown word (occured) fix: (occurred)
.\StdLib\Include\sys\termios.h:256:28 - Unknown word (occured) fix: (occurred)
.\StdLib\Include\sys\termios.h:272:28 - Unknown word (occured) fix: (occurred)
.\StdLib\Include\sys\termios.h:288:28 - Unknown word (occured) fix: (occurred)
.\StdLib\Include\sys\termios.h:314:28 - Unknown word (occured) fix: (occurred)
.\StdLib\Include\sys\termios.h:326:28 - Unknown word (occured) fix: (occurred)
.\StdLib\Include\sys\wait.h:40:32 - Unknown word (relevent) fix: (relevant)
.\StdLib\LibC\gdtoa\gdtoaimp.h:2:47 - Unknown word (arbitary) fix: (arbitrary)
.\StdLib\LibC\Main\Arm\flt_rounds.c:55:18 - Unknown word (postive) fix: (positive)
.\StdLib\LibC\Math\k_rem_pio2.c:154:1 - Unknown word (twon) fix: (town)
.\StdLib\LibC\Math\k_rem_pio2.c:185:35 - Unknown word (twon) fix: (town)
.\StdLib\LibC\Math\k_rem_pio2.c:252:29 - Unknown word (twon) fix: (town)
.\StdLib\LibC\Math\k_rem_pio2.c:262:36 - Unknown word (twon) fix: (town)

.\StdLib\LibC\Stdio\vfscanf.c:930:44 - Unknown word (considerd) fix: (considered)

.\StdLib\LibC\StdLib\realpath.c:32:44 - Unknown word (occured) fix: (occurred)
.\StdLib\LibC\Uefi\InteractiveIO\TerminalFunctions.c:71:28 - Unknown word (occured) fix: (occurred)
.\StdLib\LibC\Uefi\InteractiveIO\TerminalFunctions.c:104:28 - Unknown word (occured) fix: (occurred)
.\StdLib\LibC\Uefi\InteractiveIO\TerminalFunctions.c:137:28 - Unknown word (occured) fix: (occurred)
.\StdLib\LibC\Uefi\InteractiveIO\TerminalFunctions.c:194:28 - Unknown word (occured) fix: (occurred)
.\StdLib\LibC\Uefi\SysCalls.c:913:34 - Unknown word (occured) fix: (occurred)
.\StdLib\LibC\Uefi\SysCalls.c:954:63 - Unknown word (occured) fix: (occurred)
.\StdLib\LibC\Uefi\SysCalls.c:1075:30 - Unknown word (occured) fix: (occurred)
.\StdLib\LibC\Uefi\SysCalls.c:1444:30 - Unknown word (occured) fix: (occurred)
.\StdLib\LibC\Wchar\String.c:2:5 - Unknown word (Miscelaneous) fix: (Miscellaneous)
.\StdLib\PosixLib\Gen\dirname.c:73:33 - Unknown word (occurence) fix: (occurrence)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22188</commentid>
    <comment_count>3</comment_count>
    <who name="Vishal">vishal.r</who>
    <bug_when>2023-11-24 06:22:43 +0000</bug_when>
    <thetext>Submitted patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22209</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-12-01 00:31:19 +0000</bug_when>
    <thetext>Merged the PR to master.

commit 2b8b3908c9e6f16f51e9a70de728165004c1eaec</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4124</bug_id>
          
          <creation_ts>2022-10-27 03:30:17 +0000</creation_ts>
          <short_desc>edk2-libc : Remove substring 368 from the name of python interpreter application built from edk2-libc</short_desc>
          <delta_ts>2022-11-21 05:15:05 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19852</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2022-10-27 03:30:17 +0000</bug_when>
    <thetext>The python interpreter application built from edk2-libc has a substring 368 i.e python368.efi.

Chipsec team wants the substring 368 to be removed from the application name built from this code base.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19853</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2022-10-27 03:31:31 +0000</bug_when>
    <thetext>This is a costmetic change request coming from chipsec team.
Will be making necessary changes to inf and other dependent files and raise a PR for merging to main branch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19855</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2022-10-27 10:39:11 +0000</bug_when>
    <thetext>Fixed the issue and raised a Patch Request for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20066</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2022-11-21 05:15:05 +0000</bug_when>
    <thetext>The PR has been reviewed and merged into the main repo. Hence closing this BZ ticket.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4761</bug_id>
          
          <creation_ts>2024-04-22 02:27:37 +0000</creation_ts>
          <short_desc>AlderlakeOpenBoardPkg: Halt the TCO timer.</short_desc>
          <delta_ts>2024-05-03 03:44:51 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>Placeholder</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dora Hsueh">dorax.hsueh</reporter>
          <assigned_to name="Dora Hsueh">dorax.hsueh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22936</commentid>
    <comment_count>0</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-04-22 02:27:37 +0000</bug_when>
    <thetext>Halt the TCO timer to fix release mode hang</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22951</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-04-24 20:39:29 +0000</bug_when>
    <thetext>dorax.hsueh@intel.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22999</commentid>
    <comment_count>2</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-05-03 03:44:51 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2-platforms/pull/137
PR merged on WW18.5</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4609</bug_id>
          
          <creation_ts>2023-11-29 19:08:11 +0000</creation_ts>
          <short_desc>CalculateCrc16Ansi miscalculates the checksum</short_desc>
          <delta_ts>2023-12-03 07:36:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Pedro Falcato">pedro.falcato</reporter>
          <assigned_to name="Pedro Falcato">pedro.falcato</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22204</commentid>
    <comment_count>0</comment_count>
    <who name="Pedro Falcato">pedro.falcato</who>
    <bug_when>2023-11-29 19:08:11 +0000</bug_when>
    <thetext>The current CalculateCrc16Ansi implementation does the following:

1) Invert the passed checksum
2) Calculate the new checksum by going through data and using the lookup table
3) Invert it back again

This emulated my design for CalculateCrc32c, where 0 is passed as the initial checksum, and it inverts in the end. However, CRC16 does not invert the checksum on input and output. So this is incorrect.

This problem was found out-of-list when older ext4 filesystems (that use crc16 checksums) failed to mount with &quot;corruption&quot;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22205</commentid>
    <comment_count>1</comment_count>
    <who name="Pedro Falcato">pedro.falcato</who>
    <bug_when>2023-11-29 19:08:52 +0000</bug_when>
    <thetext>Working on it...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22213</commentid>
    <comment_count>2</comment_count>
    <who name="Pedro Falcato">pedro.falcato</who>
    <bug_when>2023-12-03 07:36:08 +0000</bug_when>
    <thetext>Fixed and pushed (https://github.com/tianocore/edk2/pull/5098)</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4464</bug_id>
          
          <creation_ts>2023-05-24 14:57:29 +0000</creation_ts>
          <short_desc>Support Standalone MM based variable services in PEI on ARM systems</short_desc>
          <delta_ts>2023-08-16 01:09:23 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>kun.qin</reporter>
          <assigned_to>kun.qin</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ArmPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21577</commentid>
    <comment_count>0</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-05-24 14:57:29 +0000</bug_when>
    <thetext>As of today, there has been a void in the variable service in PEI phase on ARM systems that support PEI phase and standalone MM hosted variable service. This ticket is created to request such support.

In order to support the functionality, we will need to add MM communication services in PEI phase. This module will be based on SMC calls to standalone MM environments, similar to &quot;ArmPkg/Drivers/MmCommunicationDxe/MmCommunication.inf&quot;.

Then build a service module to install `gEfiPeiReadOnlyVariable2PpiGuid` based on MM communication PPI provided above.

Examples of such modules are already available in Project MU:
https://github.com/microsoft/mu_silicon_arm_tiano/commit/a04c443f448817823c561706f9e4aecfb7b3b1c8#diff-8e6148308f57a898b64aa04e1a1cda0a3045e39172d28bc7dc9fbc12bc93e3f0
https://github.com/microsoft/mu_silicon_arm_tiano/commit/562fe0db6cd47c542360bdf9b2864f48fafa8584</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21602</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 21:52:31 +0000</bug_when>
    <thetext>kun.qin@microsoft.com: will you contribute the patch to edk2?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21610</commentid>
    <comment_count>2</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-05-31 01:15:13 +0000</bug_when>
    <thetext>Hi Liming, yes, I will contribute the patches. Thanks for confirming the ticket.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21647</commentid>
    <comment_count>3</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-06-08 16:45:48 +0000</bug_when>
    <thetext>Patch sent for review here: https://edk2.groups.io/g/devel/message/105954</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21700</commentid>
    <comment_count>4</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-06-28 16:02:48 +0000</bug_when>
    <thetext>Merged as by 01ac3d8b...6607062e https://github.com/tianocore/edk2/pull/4589.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21821</commentid>
    <comment_count>5</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:09:23 +0000</bug_when>
    <thetext>this is a new feature</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4324</bug_id>
          
          <creation_ts>2023-01-20 09:19:14 +0000</creation_ts>
          <short_desc>Update edk2 CI to QEMU v8</short_desc>
          <delta_ts>2023-08-06 12:12:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Test</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          <see_also>https://bugzilla.tianocore.org/show_bug.cgi?id=4250</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Ard Biesheuvel">ardb</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>michael.kubacki</cc>
    
    <cc>osteffen</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20738</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-20 09:19:14 +0000</bug_when>
    <thetext>(At the time of this writing, QEMU v8 has not been released yet. Based
on the 7.* release cadence,

  https://wiki.qemu.org/Planning/7.0
  https://wiki.qemu.org/Planning/7.1
  https://wiki.qemu.org/Planning/7.2

I think we can reckon with ~4 months of development time, so v8 could be
released in March 2023, or thereabouts.)

*When* edk2&apos;s CI adopts QEMU 8.0:

- Please revert edk2 commit 3beb8c965455 (&quot;OvmfPkg/PlatformCI VS2019:
  Enable temporary workaround for cpuhp bugfix&quot;, 2023-01-20; bug 4250).

- In the containers repository
  &lt;https://github.com/tianocore/containers.git&gt;, please drop the extra
  QEMU patch, currently fetched by Message-Id
  &lt;20230105161804.82486-1-lersek@redhat.com&gt;. Introduced in commit
  &lt;https://github.com/tianocore/containers/commit/47addc9a4f20&gt;.

  That QEMU patch is now upstream (dab30fbef389, &quot;acpi: cpuhp: fix
  guest-visible maximum access size to the legacy reg block&quot;,
  2023-01-08), and should be a part of qemu-8.0.

- Please update the Linux container reference (&quot;fedora-35-test:47addc9&quot;)
  that presently comes from commit ef0916009843 (&quot;CI: Use Fedora 35
  container (Linux only)&quot;, 2023-01-17) accordingly.

The above steps will clean up both the Linux and Windows CI env. Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21366</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-04-15 08:17:11 +0000</bug_when>
    <thetext>Also reapply commit f92a9dce1028.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21510</commentid>
    <comment_count>2</comment_count>
    <who name="Oliver Steffen">osteffen</who>
    <bug_when>2023-05-08 08:06:39 +0000</bug_when>
    <thetext>Container images for Linux with Qemu 8 are being prepared in this PR:
https://github.com/tianocore/containers/pull/72</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21528</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 21:47:18 +0000</bug_when>
    <thetext>Please continue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21805</commentid>
    <comment_count>4</comment_count>
    <who name="Oliver Steffen">osteffen</who>
    <bug_when>2023-08-06 12:12:31 +0000</bug_when>
    <thetext>With these two series below merged, we can close this bug:

- Qemu 8 in Windows CI jobs,
  revert of workaround,
  and re-enabling SMP:
  https://edk2.groups.io/g/devel/topic/100524063#107546

- Qemu 8 in Linux CI jobs:
  https://edk2.groups.io/g/devel/topic/99695648#106345</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4146</bug_id>
          
          <creation_ts>2022-11-09 23:41:04 +0000</creation_ts>
          <short_desc>Pytools generates exception if nested packages are detected</short_desc>
          <delta_ts>2022-11-10 23:17:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>michael.kubacki</cc>
    
    <cc>sean.brogan</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19984</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-09 23:41:04 +0000</bug_when>
    <thetext>edk2-pytool-library raises an exception if nested packages are
detected.  Nested packages are now allowed by the edk2 specifications,
so this check is valid.

However, there are downstream consumers that have nested packages
and it will take time to resolve those and follow the edk2 specifications.

The edk2-pytools-library version 0.12.0 adds support for an environment
variable PYTOOL_TEMPORARILY_IGNORE_NESTED_EDK_PACKAGES that when set to
true will not raise an exception and instead generates WARNING messages
identifying the nested package that was detected.

pip-requirements.txt should be updated to use edk2-pytools-library
version 0.12.0 to allow downstream consumers to use pytools without
raising an exception.

This issue must be resolved for edk2-stable202211 tag.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19985</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-09 23:41:49 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19986</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-10 01:32:19 +0000</bug_when>
    <thetext>This issue was introduced by the following commit on 11/1/2022

https://github.com/tianocore/edk2/commit/b5dbf8267b2596f4a28cdb30d1f533b958ddd4ed

This commit updated edk2-pytools-library and was the first version 
in pip-requirements.txt that added the raise exception behavior for
nested packages.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19987</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-10 01:33:12 +0000</bug_when>
    <thetext>Patch email for review:

https://edk2.groups.io/g/devel/message/96181</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19991</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-10 23:17:04 +0000</bug_when>
    <thetext>PR:

https://github.com/tianocore/edk2/pull/3619

Commit: 

https://github.com/tianocore/edk2/commit/342813a3f7794bf67405a236053f27c916804d36</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4791</bug_id>
          
          <creation_ts>2024-06-18 04:21:13 +0000</creation_ts>
          <short_desc>edk2-libc : update python UEFI build and package creation scripts to take edk2-libc path as environment variable</short_desc>
          <delta_ts>2024-06-20 05:51:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23134</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-18 04:21:13 +0000</bug_when>
    <thetext>Currently the Python UEFI package creation .bat and .sh scripts are assuming that the edk2-libc repo contents are copied to edk2 folder for build purpose.
These scripts always look for the specific files and folders to be copied for packaging from the edk2 folder path. They will fail in case the edk2-libc contents are not copied to edk2 folder.

Hence suggest that this path be taken through an environment variable such as EDK2_LIBC_PATH.

Also for backward compatibility of some of the existing build flows setup by users, it is suggested that in case EDK2_LIBC_PATH is not set by the user assume that edk2-libc contents are copied to edk2 as part of the build process and set the EDK2_LIBC_PATH to edk2 folder itself. Also display a warning message before making this decision in the .bat and .sh scripts.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23135</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-18 04:21:44 +0000</bug_when>
    <thetext>Jayaprakash Nevara will be working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23139</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-19 01:23:27 +0000</bug_when>
    <thetext>This requires making changes to the .bat and .sh scripts for creating the python uefi package besides the GCCCompilationBKMs.rst GCC compilation BKM document and Py368ReadMe.txt needs to be updated to provide an additional instructions for the users to set the EDK2_LIBC_PATH environment variable before executing the Python UEFI package creation script.

Will be implementing these changes and verify them locally and raise an email patch request for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23140</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-19 02:13:38 +0000</bug_when>
    <thetext>It also requires making changes to the Python368.inf to take EDK2_LIBC_PATH as environment variable instead of the WORKSPACE environment variable which is currently used.

The WORKSPACE points to edk2 folder path, so if the contents of edk2-libc are copied to edk2 folder then this environment variable would work good as part of the inf file for compilation. 

Since we are trying to remove the dependency on copying of edk2-libc content to edk2 folder. We need to update this inf file as well. So that edk2-libc can be read from the environment variable EDK2_LIBC_PATH.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23141</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-19 03:55:22 +0000</bug_when>
    <thetext>Email patch sent for review</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23143</commentid>
    <comment_count>5</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-20 05:51:11 +0000</bug_when>
    <thetext>Patch reviewed and the changes are merged to master.
commit 7ceeb2195dba0fbced5fbb7f8d45a16fbb4e560b</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4019</bug_id>
          
          <creation_ts>2022-08-15 02:12:29 +0000</creation_ts>
          <short_desc>IntelFsp2Pkg: FSPM_ARCH2_UPD mismatching bug.</short_desc>
          <delta_ts>2022-08-15 04:04:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19392</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-08-15 02:12:29 +0000</bug_when>
    <thetext>FSPM_ARCH2_UPD in FspApiEntryM.nasm was not up-to-date and should be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19393</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-08-15 02:12:44 +0000</bug_when>
    <thetext>working on the fix.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19395</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-08-15 04:04:14 +0000</bug_when>
    <thetext>Fix merged: https://github.com/tianocore/edk2/commit/a2b61de2f6f6bbfb71c9430634f2ec365d82667b</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4635</bug_id>
          
          <creation_ts>2024-01-07 03:11:59 +0000</creation_ts>
          <short_desc>Add a PCD to be able to skip microcode patch load</short_desc>
          <delta_ts>2024-01-27 07:47:07 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc>https://github.com/tianocore/edk2/pull/5228</bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Ilan Bar">ilan.bar</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22328</commentid>
    <comment_count>0</comment_count>
    <who name="Ilan Bar">ilan.bar</who>
    <bug_when>2024-01-07 03:11:59 +0000</bug_when>
    <thetext>Rational:
=========
When the user want to load the microcode patch later in the boot process


What:
=====
Add new Pcd to Edk2\IntelFsp2Pkg\IntelFsp2Pkg.dec
gIntelFsp2PkgTokenSpaceGuid.PcdLoadMicroCodePatch|TRUE

#if ASM_PFX(PcdGet32 (PcdLoadMicroCodePatch)) ; &lt;-- Added PCD
  ; Load microcode
  LOAD_ESP
  LOAD_ECX
  CALL_MMX  ASM_PFX(LoadMicrocodeDefault)
  SAVE_UCODE_STATUS                 ; Save microcode return status in slot 1 in xmm5.
#endif


Note:
=====
PCD MUST be enabled by default (POR)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22329</commentid>
    <comment_count>1</comment_count>
    <who name="Ilan Bar">ilan.bar</who>
    <bug_when>2024-01-07 03:53:27 +0000</bug_when>
    <thetext>Rational2:
==========
Reduce the boot time on emulated/simulated systems that doesn&apos;t support microcode load</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22330</commentid>
    <comment_count>2</comment_count>
    <who name="Ilan Bar">ilan.bar</who>
    <bug_when>2024-01-07 12:43:14 +0000</bug_when>
    <thetext>code changes are under this PR
https://github.com/tianocore/edk2/pull/5228</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22341</commentid>
    <comment_count>3</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-01-09 13:34:45 +0000</bug_when>
    <thetext>Hi Ilan,

I believe setting FSPT_CORE_UPD.MicrocodeCodeAddr/Size to 0 would have the effect you are looking for. Can you take a look and see if that would work for you?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22433</commentid>
    <comment_count>4</comment_count>
    <who name="Ilan Bar">ilan.bar</who>
    <bug_when>2024-01-27 07:45:24 +0000</bug_when>
    <thetext>thanks for the feedback. let&apos;s use the the &quot;FSPT_CORE_UPD.MicrocodeCodeAddr/Size = 0&quot; solution. closing this request</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22434</commentid>
    <comment_count>5</comment_count>
    <who name="Ilan Bar">ilan.bar</who>
    <bug_when>2024-01-27 07:47:07 +0000</bug_when>
    <thetext>as noted solution will be to set &quot;FSPT_CORE_UPD.MicrocodeCodeAddr/Size = 0&quot; solution</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4490</bug_id>
          
          <creation_ts>2023-06-27 09:06:06 +0000</creation_ts>
          <short_desc>In UFS PEI driver, we are not seeing any PPI to link the platform specific code as same like in DXE UFS driver</short_desc>
          <delta_ts>2024-10-28 02:31:41 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Arun K">arunk</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>hao.a.wu</cc>
    
    <cc>ray.ni</cc>
    
    <cc>srinivasanm</cc>
    
    <cc>sundaresans</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202305</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21693</commentid>
    <comment_count>0</comment_count>
    <who name="Arun K">arunk</who>
    <bug_when>2023-06-27 09:06:06 +0000</bug_when>
    <thetext>In the UFS DXE driver, We are seeing platform protocol(gEdkiiUfsHcPlatformProtocolGuid) to link the platform-specific code for PreHce and PostHce link via protocol callback API.

While for the UFS PEI driver, we do not see such PPI, to link the platform-specific code and its failure to enable the UFS host controller in the PEI phase.

Please let me know, Is there any specific reason for not providing the support in the PEI phase or,  will it be added in the future?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21741</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:35:55 +0000</bug_when>
    <thetext>Include Ufs maintainer Hao and Ray for comments.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21766</commentid>
    <comment_count>2</comment_count>
    <who name="Arun K">arunk</who>
    <bug_when>2023-07-24 05:39:52 +0000</bug_when>
    <thetext>Hi Hao/Ray,

Please let me know your comments on this.

Thanks,
Arun</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21785</commentid>
    <comment_count>3</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2023-07-30 23:07:18 +0000</bug_when>
    <thetext>Hello,

&gt; Please let me know, Is there any specific reason for not providing the
&gt; support in the PEI phase or,  will it be added in the future?

I think we do not meet/receive such request for PEI phase.
I do not have plan to add this support.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21975</commentid>
    <comment_count>4</comment_count>
    <who name="Arun K">arunk</who>
    <bug_when>2023-10-12 05:16:40 +0000</bug_when>
    <thetext>Hi Hao, 

   We have received the request for recovery support from the UFS device in PEI. Since the platform-specific code is not linked in the PEI phase UFS device fails to work. So, could you please provide the PPI support to link the platform-specific code like DXE? 


Thanks,
Arun</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21978</commentid>
    <comment_count>5</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2023-10-12 07:10:14 +0000</bug_when>
    <thetext>(In reply to Arun K from comment #4)
&gt; Hi Hao, 
&gt; 
&gt;    We have received the request for recovery support from the UFS device in
&gt; PEI. Since the platform-specific code is not linked in the PEI phase UFS
&gt; device fails to work. So, could you please provide the PPI support to link
&gt; the platform-specific code like DXE? 
&gt; 
&gt; 
&gt; Thanks,
&gt; Arun

Sorry, I do not have plan to add this support.
I think it is encouraged for developers that are interested in such support to contribute the implementation into the edk2.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23504</commentid>
    <comment_count>6</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-10-28 02:31:41 +0000</bug_when>
    <thetext>Fix it in https://github.com/tianocore/edk2/pull/6340</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4348</bug_id>
          
          <creation_ts>2023-02-24 10:47:30 +0000</creation_ts>
          <short_desc>Calculate DisplayFamily correctly</short_desc>
          <delta_ts>2023-03-14 22:33:35 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="StarZeng">star.zeng</reporter>
          <assigned_to>zhiguang.liu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>star.zeng</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21114</commentid>
    <comment_count>0</comment_count>
    <who name="StarZeng">star.zeng</who>
    <bug_when>2023-02-24 10:47:30 +0000</bug_when>
    <thetext>Per SDM, DisplayFamily = Extended_Family_ID + Family_ID. The code below needs to be corrected accordingly.

Edk2\UefiCpuPkg\Library\RegisterCpuFeaturesLib\CpuFeaturesInitialize.c:
  DisplayedFamily = Eax.Bits.FamilyId;
  if (Eax.Bits.FamilyId == 0x0F) {
    DisplayedFamily |= (Eax.Bits.ExtendedFamilyId &lt;&lt; 4); -&gt; DisplayedFamily += Eax.Bits.ExtendedFamilyId;
  }</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21121</commentid>
    <comment_count>1</comment_count>
    <who name="StarZeng">star.zeng</who>
    <bug_when>2023-02-27 05:38:08 +0000</bug_when>
    <thetext>Assign it to Ray.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21189</commentid>
    <comment_count>2</comment_count>
    <who name="">zhiguang.liu</who>
    <bug_when>2023-03-14 22:33:35 +0000</bug_when>
    <thetext>done, merged at aa1cd447b346e8cc8141df2fe2d321b032c08acb</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4170</bug_id>
          
          <creation_ts>2022-11-28 16:24:34 +0000</creation_ts>
          <short_desc>Fix Instruction Pointer Incrementation by TD #VE MMIO Handler</short_desc>
          <delta_ts>2022-11-28 23:16:05 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4169</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Ryan Afranji">afranji</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20115</commentid>
    <comment_count>0</comment_count>
    <who name="Ryan Afranji">afranji</who>
    <bug_when>2022-11-28 16:24:34 +0000</bug_when>
    <thetext>In edk2/OvmfPkg/Library/CcExitLib/CcExitVeHandler.c, there is an errant instruction pointer increment in MmioExit(). This leads to incorrect functionality and opens the door for the instruction pointer to be exploited.

For context, TD disallowed instructions executed by a TD are handled in various ways by the #VE handler such as making a corresponding TDCALL or inserting a NOP. After handling this instruction, the guest’s instruction pointer needs to be incremented to the start of the next instruction so that it can resume execution. The #VE handler is responsible for incrementing the guest’s instruction pointer.

This #VE MMIO handler parses through each byte of the instruction to handle the MMIO call and determine the amount the guest’s instruction pointer should be incremented. According to the Intel SDM Vol. 2A Figure 2-1, instruction encodings follow the order of Instruction Prefixes (optional), REX prefixes (optional), Opcode, and then other fields. This handler begins with a loop to parse the first portion of the instruction (Instruction and REX prefixes). This loop breaks once the current byte being parsed is no longer a prefix; therefore, this byte should be the beginning of the opcode according to the Intel SDM. The problem occurs here because the instruction pointer is incremented immediately after parsing the prefixes. This skips parsing the first byte of the opcode. This causes incorrect parsing functionality because the code is expecting to the first byte of the opcode but uses the value in the byte following it. This results in the MMIO instruction being handled incorrectly and the guest instruction pointer pointing to the wrong byte once the guest resumes execution. The guest’s instruction pointer pointing to the wrong byte is exploitable so removing this extra instruction pointer increment can solve this vulnerability.

The comment above the extra instruction pointer increment is misleading. The instruction pointer at this part of the code is pointing to the first byte of the opcode. The instruction may have just one additional byte to increment to. It does have at least two more bytes it needs to parse (the first byte of the opcode and the aforementioned byte) but “We need to have at least 2 more bytes for this instruction” seems to imply the instruction pointer should be incremented at least two more times.

This is just describes one instruction case and there are other cases that need to be handled.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20119</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-11-28 23:16:05 +0000</bug_when>
    <thetext>Duplicated with 4169. Close this one as duplicated and only track status in 4169.

*** This bug has been marked as a duplicate of bug 4169 ***</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4821</bug_id>
          
          <creation_ts>2024-07-27 08:34:34 +0000</creation_ts>
          <short_desc>BaseTools/GenerateCapsule: Support to Use Different Hash Algorithm for Payload Content</short_desc>
          <delta_ts>2024-08-16 06:53:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jason Lin">jason1.lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23270</commentid>
    <comment_count>0</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-07-27 08:34:34 +0000</bug_when>
    <thetext>In GenerateCapsule.py script, it is hardcoded the hash algorithm with SHA256 only.

For Windows SignTools,
&gt; Command = Command + &apos;sign /fd sha256 /p7ce DetachedSignedData /p7co 1.2.840.113549.1.7.2 &apos;

For OpenSSL,
&gt; Command = Command + &apos;smime -sign -binary -outform DER -md sha256 &apos;

This Bugzilla is purposed to add an optional input argument &quot;-ha&quot; to make caller to input the expected algorithm.
Keep the default value as SHA256 to keep the backward compatibility.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23271</commentid>
    <comment_count>1</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-07-27 08:35:13 +0000</bug_when>
    <thetext>Take the owner of this Bugzilla ticket, would send out the tentative PR later.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23328</commentid>
    <comment_count>2</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-08-16 06:53:56 +0000</bug_when>
    <thetext>PR https://github.com/tianocore/edk2/pull/5995 had been raised and merged.

It had been as a part of the EDK-II codebase.

SHA1-ID
- https://github.com/tianocore/edk2/commit/68b4c4b481f3129132cd90c45d241990445f4a3a

Mark this ticket as &quot;Resolved&quot; and &quot;Fixed&quot;.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4046</bug_id>
          
          <creation_ts>2022-09-06 17:55:34 +0000</creation_ts>
          <short_desc>EmbeddedPkg: Add CI YAML file</short_desc>
          <delta_ts>2022-10-04 11:12:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kubacki">michael.kubacki</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>EmbeddedPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19478</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-06 17:55:34 +0000</bug_when>
    <thetext>This package still does not have a CI YAML file. This change is tracking
a minimal CI YAML file being added so the package can take part in edk2
CI.

Since it currently has not been run against CI, some CI failures may need to
be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19479</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-06 17:55:52 +0000</bug_when>
    <thetext>I will send a patch for this soon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19500</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-06 22:38:16 +0000</bug_when>
    <thetext>V1 series: https://edk2.groups.io/g/devel/message/93308</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19693</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-04 11:12:08 +0000</bug_when>
    <thetext>Merged from the following PR: https://github.com/tianocore/edk2/pull/3299

In the following commits:
51e059953696f1b41e7f65426e342badc2e6acaf to
12973359d02d59c0f856b1c1dd6d0ad2f85cdab9</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4523</bug_id>
          
          <creation_ts>2023-08-16 01:17:15 +0000</creation_ts>
          <short_desc>Add RISC-V MMU support</short_desc>
          <delta_ts>2023-08-16 01:17:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>gaoliming</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21822</commentid>
    <comment_count>0</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:17:15 +0000</bug_when>
    <thetext>Add RISC-V MMU support. 

This one has been supported at e67409..f220dc</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21823</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:17:29 +0000</bug_when>
    <thetext>Supported in Edk2.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4384</bug_id>
          
          <creation_ts>2023-03-22 21:10:24 +0000</creation_ts>
          <short_desc>Update toolchain support</short_desc>
          <delta_ts>2023-05-05 23:25:09 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Rebecca Cran">rebecca</reporter>
          <assigned_to name="Rebecca Cran">rebecca</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>nobody</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21253</commentid>
    <comment_count>0</comment_count>
    <who name="Rebecca Cran">rebecca</who>
    <bug_when>2023-03-22 21:10:24 +0000</bug_when>
    <thetext>The set of toolchains defined in EDK2 is outdated and confusing.
To simplify things, the following changes should be made:

o Update CLANGDWARF to support IA32, X64, ARM and AARCH64.
o Delete CLANG35 and CLANG38.
o Delete VS2008, VS2010, VS2012 and VS2013.
o Delete EBC toolchain definitions in preparation for completely removing EBC support from the EDK2.
o Delete GCC48 and GCC49.
o Rename GCC5 to GCC.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21283</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-03-28 22:35:54 +0000</bug_when>
    <thetext>rebecca@bsdio.com works on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21491</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-05 23:14:31 +0000</bug_when>
    <thetext>The code has been merged at edk2 94c802e108a082d6f74c854bea8bd98fe7808453..757f502a3b350436877102c3043744e021537c19</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21492</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-05 23:14:43 +0000</bug_when>
    <thetext>The code has been merged at edk2 94c802e108a082d6f74c854bea8bd98fe7808453..757f502a3b350436877102c3043744e021537c19</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21494</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-05 23:17:01 +0000</bug_when>
    <thetext>*** Bug 1750 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4195</bug_id>
          
          <creation_ts>2022-12-15 08:30:25 +0000</creation_ts>
          <short_desc>UefiCpuPkg: Supporting S3 in 64bit PEI</short_desc>
          <delta_ts>2023-05-23 06:06:02 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>ted.kuo</reporter>
          <assigned_to>ted.kuo</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>kraxel</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20217</commentid>
    <comment_count>0</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2022-12-15 08:30:25 +0000</bug_when>
    <thetext>Resuming from S3 failed with 64bit PEI.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20231</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-12-20 21:38:14 +0000</bug_when>
    <thetext>Ted is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20334</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-01 07:19:32 +0000</bug_when>
    <thetext>This seems to have been committed in 6acf72901a2e (&quot;UefiCpuPkg: Supporting S3 in 64bit PEI&quot;, 2022-12-19).

Has it been tested with OVMF?

OVMF X64 currently refuses to start if it detects that QEMU enables S3, precisely due to this problem. (So then the user either needs to disable S3, or use the IA32X64 build of OVMF, or build OVMF X64 without the SMM driver stack.)

Refer to the S3Verification() function. It may no longer be necessary.

(CC Gerd)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20339</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-01 08:37:40 +0000</bug_when>
    <thetext>Changing Status to RESOLVED|FIXED per comment 2 -- commit 6acf72901a2e. Please undo if more work is necessary for solving the BZ.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20364</commentid>
    <comment_count>4</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-01-02 08:49:23 +0000</bug_when>
    <thetext>&gt; Has it been tested with OVMF?
&gt; 
&gt; OVMF X64 currently refuses to start if it detects that QEMU enables S3,
&gt; precisely due to this problem. (So then the user either needs to disable S3,
&gt; or use the IA32X64 build of OVMF, or build OVMF X64 without the SMM driver
&gt; stack.)

Tested now, works with OVMF, S3Verification() can be dropped.
(/me noticed the change, but didn&apos;t test before xmas break due to lack of time).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21574</commentid>
    <comment_count>5</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-05-23 06:06:02 +0000</bug_when>
    <thetext>Also related:

8bd2028f9ac3 (&quot;MdeModulePkg: Supporting S3 in 64bit PEI&quot;)</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4843</bug_id>
          
          <creation_ts>2024-09-06 16:31:25 +0000</creation_ts>
          <short_desc>Indicate the UEFI specification version conformance of edk2-test in GitHub readme</short_desc>
          <delta_ts>2024-11-07 16:02:30 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Edhay">edhaya.chandran</reporter>
          <assigned_to name="Edhay">edhaya.chandran</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>xypron.glpk</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23387</commentid>
    <comment_count>0</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-09-06 16:31:25 +0000</bug_when>
    <thetext>Indicate the UEFI specification version conformance of edk2-test in GitHub readme. 
Also indicate the tests covered in other specifications like TCG2, SecureBoot etc.

Suggested by Lenovo in the 5th September edk2-test bug triage meeting.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23425</commentid>
    <comment_count>1</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-10-03 10:45:59 +0000</bug_when>
    <thetext>To update the UEFI-SCT README about the details of UEFI specification coverage.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23476</commentid>
    <comment_count>2</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-10-23 14:45:56 +0000</bug_when>
    <thetext>For review:
https://edk2.groups.io/g/devel/message/120673</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23477</commentid>
    <comment_count>3</comment_count>
      <attachid>1552</attachid>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-10-23 14:47:16 +0000</bug_when>
    <thetext>Created attachment 1552
Readme patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23511</commentid>
    <comment_count>4</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2024-11-05 15:27:51 +0000</bug_when>
    <thetext>The appended patch looks good to me.

Best regards

Heinrich</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23515</commentid>
    <comment_count>5</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-11-07 10:19:26 +0000</bug_when>
    <thetext>Reviewed in edk2-test bug triage meeting 7th Nov.
Patch shall be upstreamed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23525</commentid>
    <comment_count>6</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-11-07 16:02:30 +0000</bug_when>
    <thetext>The patch is upstreamed through commit id: https://github.com/tianocore/edk2-test/commit/89f4e59d5189933000709c6e286d12e734a8a33b

Issue resolved.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1552</attachid>
            <date>2024-10-23 14:47:16 +0000</date>
            <delta_ts>2024-10-23 14:47:16 +0000</delta_ts>
            <desc>Readme patch</desc>
            <filename>0001-edk2-test-uefi-sct-Readme-updates-with-UEFI-specific.patch</filename>
            <type>application/octet-stream</type>
            <size>1531</size>
            <attacher name="Edhay">edhaya.chandran</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4072</bug_id>
          
          <creation_ts>2022-09-20 12:30:59 +0000</creation_ts>
          <short_desc>Code First / External ECR – RISC-V: Add Apic structure in MADT</short_desc>
          <delta_ts>2022-09-30 07:20:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>Other</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Sunil V L">sunilvl</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>ACPI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19593</commentid>
    <comment_count>0</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-20 12:30:59 +0000</bug_when>
    <thetext>This is the BZ created for the RINTC V1 ECR submitted via https://mantis.uefi.org/mantis/view.php?id=2348</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19614</commentid>
    <comment_count>1</comment_count>
      <attachid>1028</attachid>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-23 01:26:14 +0000</bug_when>
    <thetext>Created attachment 1028
ACPI_MADT_RINTC_ECR</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19615</commentid>
    <comment_count>2</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-23 01:26:42 +0000</bug_when>
    <thetext>This ECR is approved as is by ASWG (no changes suggested)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19680</commentid>
    <comment_count>3</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-30 07:20:14 +0000</bug_when>
    <thetext>EDK2 codefirst BZ is specifically for EDK2 community. RISC-V codefirst generic ECRs have generic scope and will be part of RISC-V community. So, closing this BZ as invalid.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1028</attachid>
            <date>2022-09-23 01:26:14 +0000</date>
            <delta_ts>2022-09-23 01:26:14 +0000</delta_ts>
            <desc>ACPI_MADT_RINTC_ECR</desc>
            <filename>ACPI_MADT_RISC-V_INTC_ECR.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>9612</size>
            <attacher name="Sunil V L">sunilvl</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4555</bug_id>
          
          <creation_ts>2023-09-20 12:04:04 +0000</creation_ts>
          <short_desc>UefiDevicePathLib DevPathToTextAcpiEx overflows the device path node when searching for optional strings</short_desc>
          <delta_ts>2023-10-26 17:31:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Mateusz Albecki">mateusz.albecki</reporter>
          <assigned_to name="Mateusz Albecki">mateusz.albecki</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21922</commentid>
    <comment_count>0</comment_count>
    <who name="Mateusz Albecki">mateusz.albecki</who>
    <bug_when>2023-09-20 12:04:04 +0000</bug_when>
    <thetext>ACPI_EXTENDED_HID_DEVICE_PATH definition in DevicePath.h lists _HIDSTR, _UIDSTR and _CIDSTR as optional but the DevPathToTextAcpiEx treats them as mandatory which causes overflows when the producer of the device path doesn&apos;t specify one of the strings.

The UEFI spec states the following about the rules for this device path type(table 10.67 from UEFI 2.10):

AcpiEx( HID,CID,UID,HIDSTR,CIDSTR,UIDSTR)
AcpiEx(HID ,(CID Only)
The HID parameter is an EISAID. The default value is 0. Either HID or HIDSTR
must be present.
The CID parameter is an EISAID. The default value is 0. Either CID must be 0 or
CIDSTR must be empty.
The UID parameter is an integer. The default value is 0. Either UID must be 0 or
UIDSTR must be empty.
The HIDSTR is a string. The default value is the empty string. Either HID or
HIDSTR must be present.
The CIDSTR is a string. The default value is an empty string. Either CID must be 0
or CIDSTR must be empty.
The UIDSTR is a string. The default value is an empty string. Either UID must be 0
or UIDSTR must be empty.

This suggests that spec really does intend to make _HIDSTR, _UIDSTR and _CIDSTR optional. My proposition is to add a code in DevPathToTextAcpiEx that will take into account the size of the device path when searching for those strings to avoid overflow and initializes missing strings with &quot;\0&quot;. If we want to force the producer of the device path node to make sure that the 3 strings are present we should remove the comment that states those strings are optional and instead add a node that they are mandatory and if producer doesn&apos;t have any specific string they should provide empty string.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22003</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 22:54:41 +0000</bug_when>
    <thetext>mateusz.albecki@intel.com: please provide the patch to fix this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22082</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 17:31:34 +0000</bug_when>
    <thetext>Fixed in commit 96ed60dfd7d4818a532216d64ee87b13fae5c726.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4410</bug_id>
          
          <creation_ts>2023-04-12 13:12:18 +0000</creation_ts>
          <short_desc>TcgMorLockSmm: Key Mismatch doesn&apos;t update the MorLock Variable Value.</short_desc>
          <delta_ts>2023-07-11 12:35:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Abhi Singh">Abhi.Singh</reporter>
          <assigned_to name="Abhi Singh">Abhi.Singh</assigned_to>
          <cc>Abhi.Singh</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jian.j.wang</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21354</commentid>
    <comment_count>0</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-04-12 13:12:18 +0000</bug_when>
    <thetext>Inside TcgMorLockSmm.c, the SetVariableCheckHandlerMorLock() function has a scenario to prevent a possible dictionary attack on the MorLock Key in accordance with the TCG Platform Reset Mitigation Specification v1.10. 

Specification Requirement:
&quot;If current lock state is locked with key and the input 
8-byte shared secret key does not match the 8-
byte shared secret key in previous SetVariable() 
lock with key action then the lock state is updated 
to Locked without key to prevent dictionary attack
and SetVariable returns EFI_ACCESS_DENIED.&quot;

The mechanism to prevent this attack must also change the MorLock Variable Value to 0x01 to indicate Locked Without Key, but this is not implemented.

We need to implement this change to reflect the requirements of the TCG specification.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21360</commentid>
    <comment_count>1</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-04-13 12:37:21 +0000</bug_when>
    <thetext>Initial Patch: https://github.com/aabhi64/edk2/commit/3aaecf1b7c37f6deaefdd517d006697b6cd2183b</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21648</commentid>
    <comment_count>2</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-06-08 16:46:51 +0000</bug_when>
    <thetext>Link to patch in edk2devel: https://edk2.groups.io/g/devel/message/102917</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21656</commentid>
    <comment_count>3</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-06-12 18:03:04 +0000</bug_when>
    <thetext>Link to patch v2 in edk2devel: https://edk2.groups.io/g/devel/message/106027</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21669</commentid>
    <comment_count>4</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-06-16 12:20:53 +0000</bug_when>
    <thetext>Github PR: https://github.com/tianocore/edk2/pull/4546</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21711</commentid>
    <comment_count>5</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-07-11 12:35:32 +0000</bug_when>
    <thetext>Fix is merged: https://github.com/tianocore/edk2/commit/63923a5642e86f386a5c719a90cfc6a929ea9cb0</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4234</bug_id>
          
          <creation_ts>2023-01-01 06:24:21 +0000</creation_ts>
          <short_desc>UefiCpuPkg reaches a new low by BLATANTLY ignoring 32-bit Intel processors in commit 73ccde8f6d04</short_desc>
          <delta_ts>2023-04-19 01:05:07 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          <see_also>https://bugzilla.tianocore.org/show_bug.cgi?id=4250</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>regression</keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Yuanhao Xie">yuanhao.xie</assigned_to>
          <cc>ardb</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>kraxel</cc>
    
    <cc>mcb30</cc>
    
    <cc>mhaeuser</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20332</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-01 06:24:21 +0000</bug_when>
    <thetext>UefiCpuPkg maintenance has reached a new low point by merging the
following trainwreck of a commit:

73ccde8f6d04 (&quot;UefiCpuPkg: Has APs in 64 bit long-mode before booting to
OS.&quot;, 2022-12-20)

With this commit in, launching a 32-bit UEFI OS (such as a special
edition of Fedora) on the &quot;OvmfPkgIa32.dsc&quot; platform, using
&quot;qemu-system-i386&quot;, results in a hang or crash.

Here is the bisection log:

&gt;| git bisect start
&gt;| # good: [f47c4676dd1a532b22a059cd036918abd6b0dd11] Pytool: SpellCheck: Defer path expansion in cspell parameters
&gt;| git bisect good f47c4676dd1a532b22a059cd036918abd6b0dd11
&gt;| # bad: [bbd30066e137c036db140b6e58e6e172e2827eb3] BaseTools: Generate deps for Arm targets
&gt;| git bisect bad bbd30066e137c036db140b6e58e6e172e2827eb3
&gt;| # good: [63e155f24d2b6f44d42c451c8a32eecb13937d1c] UefiPayloadPkg: Add dependency of VariableSmm driver.
&gt;| git bisect good 63e155f24d2b6f44d42c451c8a32eecb13937d1c
&gt;| # good: [981bf66d5a7b1a31be5ffccc15fe13b97300e124] IntelFsp2Pkg: NvsBufferPtr is missing in Fsp24ApiEntryM.nasm
&gt;| git bisect good 981bf66d5a7b1a31be5ffccc15fe13b97300e124
&gt;| # good: [52199bf5326a8355d28b2d395db483f7c77d5a4d] MdeModulePkg/ScsiDiskDxe: Update proper device name for ScsiDisk drive
&gt;| git bisect good 52199bf5326a8355d28b2d395db483f7c77d5a4d
&gt;| # good: [d2842bb6ec3e7fa691318c31e71e88b9a9eca545] EmulatorPkg/WinHost: pre-allocate &quot;physical&quot; RAM
&gt;| git bisect good d2842bb6ec3e7fa691318c31e71e88b9a9eca545
&gt;| # good: [0e3e62fc2b9af7a264e4d178930a0ebd5c2a402a] .pytool/Readme.md: Add reference to new build instructions
&gt;| git bisect good 0e3e62fc2b9af7a264e4d178930a0ebd5c2a402a
&gt;| # bad: [a7e722941cf62f08294cdcfba36fa7e40f9797de] MdePkg: Fix typos and spacing in Library/PerformanceLib.h
&gt;| git bisect bad a7e722941cf62f08294cdcfba36fa7e40f9797de
&gt;| # good: [39ba0f8dfc12bc9ce47ef288df18eed70d4862da] CryptoPkg: Need to enable crypto functions
&gt;| git bisect good 39ba0f8dfc12bc9ce47ef288df18eed70d4862da
&gt;| # good: [7bda8c648192d76f7b3f7cee54bd7b1c86a6a84f] UefiCpuPkg: Duplicated AsmRelocateApLoop as AsmRelocateApLoopAmd
&gt;| git bisect good 7bda8c648192d76f7b3f7cee54bd7b1c86a6a84f
&gt;| # bad: [3f378450dfafc11754bfdb64af28060ec8466acb] UefiPayloadPkg: Add CpuPageTableLib required by MpInitLib.
&gt;| git bisect bad 3f378450dfafc11754bfdb64af28060ec8466acb
&gt;| # bad: [4a8642422460635462d315defe4ca84bf6d33351] OvmfPkg: Add CpuPageTableLib required by MpInitLib.
&gt;| git bisect bad 4a8642422460635462d315defe4ca84bf6d33351
&gt;| # bad: [73ccde8f6d04a246377cabaed2875e69d4b6b719] UefiCpuPkg: Has APs in 64 bit long-mode before booting to OS.
&gt;| git bisect bad 73ccde8f6d04a246377cabaed2875e69d4b6b719
&gt;| # first bad commit: [73ccde8f6d04a246377cabaed2875e69d4b6b719] UefiCpuPkg: Has APs in 64 bit long-mode before booting to OS.

I&apos;m literally gasping after having looked through the commit. Consider
the commit message:

&gt;| commit 73ccde8f6d04a246377cabaed2875e69d4b6b719 (HEAD, refs/bisect/bad)
&gt;| Author: Xie, Yuanhao &lt;yuanhao.xie@intel.com&gt;
&gt;| Date:   Tue Dec 20 05:40:15 2022 +0800
&gt;|
&gt;|     UefiCpuPkg: Has APs in 64 bit long-mode before booting to OS.
&gt;|
&gt;|     During the finalization of Mp initialization before booting into the OS,
&gt;|      depending on whether Mwait is supported or not, AsmRelocateApLoop
&gt;|      places Aps in MWAIT-loop or HLT-loop.
&gt;|
&gt;|     Since paging is necessary for long mode, the original implementation of
&gt;|     moving APs to 32-bit was to disable paging to ensure that the booting
&gt;|     does not crash.
&gt;|
&gt;|     The current modification creates a page table in reserved memory,
&gt;|     avoiding switching modes and reclaiming memory by OS. This modification
&gt;|     is only for 64 bit mode.
&gt;|
&gt;|     More specifically, we keep the AMD logic as the original code flow,
&gt;|     extract and update the Intel-related code, where the APs would stay
&gt;|     in 64-bit, and run in a Mwait or Hlt loop until the OS wake them up.
&gt;|
&gt;|     Signed-off-by: Ray Ni &lt;ray.ni@intel.com&gt;
&gt;|     Signed-off-by: Yuanhao Xie &lt;yuanhao.xie@intel.com&gt;
&gt;|     Reviewed-by: Ray Ni &lt;ray.ni@intel.com&gt;

The commit message *literally says* &quot;This modification is only for 64
bit mode&quot;, and then goes ahead and does the following:

- in &quot;UefiCpuPkg/Library/MpInitLib/MpLib.h&quot;, changes the
  (*ASM_RELOCATE_AP_LOOP) function prototype by removing the
  PmCodeSegment, Pm16CodeSegment, SevEsAPJumpTable, WakeupBuffer
  parameters, and adding the Cr3 parameter,

- in &quot;UefiCpuPkg/Library/MpInitLib/X64/MpFuncs.nasm&quot;, adapts the
  function implementation for X64 *only*,

- in &quot;UefiCpuPkg/Library/MpInitLib/DxeMpLib.c&quot;, function
  RelocateApLoop(), adapts the AsmRelocateApLoopFunc() function call for
  IA32 and X64 *both*,

- in &quot;UefiCpuPkg/Library/MpInitLib/DxeMpLib.c&quot;, function
  InitMpGlobalData(), it leaves the *comment* about &lt;4GB buffer
  allocation in place, but removes the actual allocation limit for IA32
  and X64 *both*, single-handedly breaking *both* code/comment
  consistency *and* IA32 functionality,

- *completely* misses that in
  &quot;UefiCpuPkg/Library/MpInitLib/Ia32/MpFuncs.nasm&quot;, the the 32-bit
  AsmRelocateApLoopStart function implementation still has the original
  function prototype, so the call in RelocateApLoop()
  [UefiCpuPkg/Library/MpInitLib/DxeMpLib.c] no longer matches. In
  particular, the removal of the &quot;PmCodeSegment&quot; parameter changes the
  stack offsets for the &quot;TopOfApStack&quot; and &quot;CountTofinish&quot; parameters,
  which parameters the function *does* depend upon.

Compare:

[UefiCpuPkg/Library/MpInitLib/X64/MpFuncs.nasm]
&gt;| ;-------------------------------------------------------------------------------------
&gt;| ;  AsmRelocateApLoop (MwaitSupport, ApTargetCState, TopOfApStack, CountTofinish, Cr3);
&gt;| ;  This function is called during the finalizaiton of Mp initialization before booting
&gt;| ;  to OS, and aim to put Aps either in Mwait or HLT.
&gt;| ;-------------------------------------------------------------------------------------
&gt;| ; +----------------+
&gt;| ; | Cr3            |  rsp+40
&gt;| ; +----------------+
&gt;| ; | CountTofinish  |  r9
&gt;| ; +----------------+
&gt;| ; | TopOfApStack   |  r8
&gt;| ; +----------------+
&gt;| ; | ApTargetCState |  rdx
&gt;| ; +----------------+
&gt;| ; | MwaitSupport   |  rcx
&gt;| ; +----------------+
&gt;| ; | the return     |
&gt;| ; +----------------+ low address
&gt;|
&gt;| AsmRelocateApLoopStart:

vs.

[UefiCpuPkg/Library/MpInitLib/Ia32/MpFuncs.nasm]
&gt;| ;-------------------------------------------------------------------------------------
&gt;| ;  AsmRelocateApLoop (MwaitSupport, ApTargetCState, PmCodeSegment, TopOfApStack, CountTofinish, Pm16CodeSegment, SevEsAPJumpTable, WakeupBuffer);
&gt;| ;
&gt;| ;  The last three parameters (Pm16CodeSegment, SevEsAPJumpTable and WakeupBuffer) are
&gt;| ;  specific to SEV-ES support and are not applicable on IA32.
&gt;| ;-------------------------------------------------------------------------------------
&gt;| AsmRelocateApLoopStart:
&gt;|     mov        eax, esp
&gt;|     mov        esp, [eax + 16]     ; TopOfApStack
&gt;|     push       dword [eax]         ; push return address for stack trace
&gt;|     push       ebp
&gt;|     mov        ebp, esp
&gt;|     mov        ebx, [eax + 8]      ; ApTargetCState
&gt;|     mov        ecx, [eax + 4]      ; MwaitSupport
&gt;|     mov        eax, [eax + 20]     ; CountTofinish

How the *hell* was this tested for IA32?

How the hell was this *reviewed* for IA32?

I&apos;m livid.

Please revert this pile of crap immediately, go back to the drawing
board, and grow a modicum of respect for keeping the tree
regression-free.

If you don&apos;t care about IA32 DXE anymore, citing the lack of physical
32-bit-only processors, then be honest about that, and remove all the
related code from UefiCpuPkg, and remove the &quot;OvmfPkgIa32.dsc&quot; platform
too.

Gerd: please keep a close eye on UefiCpuPkg. Maintenance has always been
reckless and ignorant of OvmfPkg (especially on KVM). I suggest that you
mark yourself as a designated reviewer on UefiCpuPkg, and triple-check
whathever is about to be merged there. (Well, in the current case it
might not have helped, as the code was posted and merged
&lt;https://github.com/tianocore/edk2/pull/3802&gt; in or around the Christmas
vacation time.)

(Not to mention the general sorry state of edk2: the patch series in
question does not reference any bugzilla, the Summary of PR#3802 is
*empty*, and as of this writing, there are *419* OPEN pull requests in
the tracker. Yeah, moving the patch merge process to github.com has
totally saved this project from the negligence of its maintainers. /s
Intel&apos;s firmware team in China still treats edk2 as their own sandbox.
Good riddance for me.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20362</commentid>
    <comment_count>1</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-01-02 08:06:05 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #0)
&gt; With this commit in, launching a 32-bit UEFI OS (such as a special
&gt; edition of Fedora) on the &quot;OvmfPkgIa32.dsc&quot; platform, using
&gt; &quot;qemu-system-i386&quot;, results in a hang or crash.

/me updates test cases to run qemu with &apos;-smp 2&apos;.
/me watches all ia32 test cases fail.

Composing a special ia32 distro image is not needed, trying to boot an
i386 linux kernel via direct kernel boot is enough to reproduce this.

&gt; Gerd: please keep a close eye on UefiCpuPkg. Maintenance has always been
&gt; reckless and ignorant of OvmfPkg (especially on KVM). I suggest that you
&gt; mark yourself as a designated reviewer on UefiCpuPkg, and triple-check
&gt; whathever is about to be merged there.

Noted.

&gt; (Well, in the current case it
&gt; might not have helped, as the code was posted and merged
&gt; &lt;https://github.com/tianocore/edk2/pull/3802&gt; in or around the Christmas
&gt; vacation time.)

I think I even looked briefly at the patchset, figured the x64 changes look
sane, but didn&apos;t notice how it also affects (and breaks) ia32.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20365</commentid>
    <comment_count>2</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-01-02 09:17:03 +0000</bug_when>
    <thetext>Laszlo,

I share your frustration about how careless contributors often are when it comes to taking less common platforms into consideration, and testing for regressions.

However, this issue is not as easy to reproduce as you make it out to be. OvmfPkgIa32.dsc boots happily for me in qemu-system-i386 with -M q35 -cpu pentium3 -smp 2, and while the MaxCpuCount appears to be capped in PEI

  PlatformMaxCpuCountInitialization: QEMU v2.7 reset bug: BootCpuCount=2 Present=0
  PlatformMaxCpuCountInitialization: BootCpuCount=0 MaxCpuCount=1

I can boot a i386 Linux kernel just fine in SMP mode, with 2 cores coming up.

So please provide a specific (and minimal, if possible) QEMU command line that demonstrates the failure, so we can add it to the CI pre-merge checks.

Also, there is a related patch 2f7d5a03dbe733f3de5 that seems to differentiate between AMD and Intel targets, and it looks like the IA32 implementation of AsmRelocateApLoop() now implements the AsmRelocateApLoopAmd() prototype, and should be renamed accordingly. AIUI, that means the only thing that would need to be fixed on top of that is the &lt;4 GB allocation of the buffer.

I don&apos;t have any problems with reverting the whole lot, though, so unless anyone objects and volunteers a fix for this mess, I will go ahead and do that later this week.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20367</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-02 14:00:38 +0000</bug_when>
    <thetext>Hi Ard,

(In reply to ardb from comment #2)
&gt;| Laszlo,
&gt;|
&gt;| I share your frustration about how careless contributors often are
&gt;| when it comes to taking less common platforms into consideration, and
&gt;| testing for regressions.
&gt;|
&gt;| However, this issue is not as easy to reproduce as you make it out to
&gt;| be. OvmfPkgIa32.dsc boots happily for me in qemu-system-i386 with -M
&gt;| q35 -cpu pentium3 -smp 2, and while the MaxCpuCount appears to be
&gt;| capped in PEI

&gt;|   PlatformMaxCpuCountInitialization: QEMU v2.7 reset bug: BootCpuCount=2 Present=0
&gt;|   PlatformMaxCpuCountInitialization: BootCpuCount=0 MaxCpuCount=1

&gt;| I can boot a i386 Linux kernel just fine in SMP mode, with 2 cores
&gt;| coming up.

the log lines you quoted above bear witness to some *serious* QEMU (or
edk2) breakage.

There are two &quot;CPU count&quot; concepts we need to consider here, with QEMU:
&quot;present&quot; and &quot;possible&quot;. &quot;Possible&quot; is the possible maximum (achievable
when hot-plugging all CPUs available in the topology), and &quot;present&quot; is,
well, what&apos;s currently plugged. When we boot, the &quot;present&quot; (=
cold-plugged) value is also called &quot;boot CPU count&quot;.

In QEMU, the boot CPU count and the CPU hotplug interfaces had undergone
significant changes. Therefore when OVMF starts up, it tries to cope
with most known situations, for determining the CPU counts. This code
originally lived in PlatformPei, but now it is in
PlatformMaxCpuCountInitialization(), in PlatformInitLib.

The log lines you quote above imply the following code path:

- QEMU advertizes the boot CPU count via fw_cfg (--&gt; we set
  BootCpuCount),

- the modern CPU hotplug interface (register block) is available,

- we collect both the &quot;possible&quot; and the &quot;present&quot; CPU counts via the
  modern CPU hotplug interface (which is a channel entirely distinct
  from fw_cfg) --&gt; we set Present and Possible.

- At this point, we perform a sanity check. Because we&apos;re just booting
  and no CPU hotplug may have taken place, Present (from the modern
  hotplug register block) *must* equal  BootCpuCount (from fw_cfg).

  If that&apos;s not the case, then *thus far* we&apos;ve known only one reason
  for it: a bug in QEMU-2.7 and earlier, which got fixed in QEMU-2.8.
  The symptom was that, when you hot-plugged some CPUs after first boot,
  and then rebooted, the fw_cfg value BootCpuCount would not reflect,
  during the second boot, the hotplugged CPUs. For this reason, in case
  we caught this inconsistency, we&apos;d let &quot;Present&quot; (= from the modern
  hotplug register block) take effect, overriding the value from fw_cfg.

- Either way, because the modern CPU hotplug interface is available,
  we set MaxCpuCount from Possible.

*However*. The second log line you quote highlights an entirely new type
of misbehavior -- it&apos;s either a new (thus far unseen) QEMU bug, or else
a recent *separate* issue in OVMF. Namely, &quot;BootCpuCount=0&quot; on the
*second* line is totally bogus and impossible.

What apparently happens is that the &quot;inconsistency check&quot; between the
&quot;BootCpuCount&quot; value from fw_cfg, and the &quot;Present&quot; value from the
modern register block, fires for a *different reason* than expected (as
described above). &quot;BootCpuCount&quot; (from fw_cfg) is actually the correct
value (2), and the &quot;Present&quot; value (from the modern register block) is
zero! This has never been seen, and looks like a recent QEMU regression.

The logic laid out above then gives priority to &quot;Present&quot; (setting
BootCpuCount to zero! -- hence BootCpuCount=0 on the second line), which
is precisely the opposite of what we&apos;d need.

MaxCpuCount=1 is set from the max Possible value determined while
scanning the modern CPU hotplug register block.

All in all it looks like we have a virtual machine with 1 *possible* CPU
in total, but the modern register block reports that particular CPU as
*unplugged*.

Once this happens, all bets are off. Here&apos;s why: at the end of the
function, we set PcdCpuBootLogicalProcessorNumber from BootCpuCount,
that is, to zero.

But zero for PcdCpuBootLogicalProcessorNumber is a special value in
UefiCpuPkg. It means that the platform does not specify the precise,
a-priori known number of boot CPUs, and therefore relies on UefiCpuPkg&apos;s
MpInitLib to discover the CPUs available in the system in the &quot;slow&quot; way
that is done on physical machines.

*Furthermore*, because MaxCpuCount is 1, MpInitLib will think there are
*zero* APs in the system -- and that entirely masks the problem I
reported in this ticket. Namely, the MpInitLib regression is in the
routine where edk2 &quot;parks&quot; (or &quot;pens&quot;) the APs at ExitBootServices(). If
there is no AP (as far as MpInitLib is concerned), then MpInitLib does
not start up any APs, and then does not attempt parking them.

The fact that Linux still brings up both CPUs may be due to both CPUs
presented in the MADT (aka &quot;APIC&quot;) ACPI table
&lt;https://wiki.osdev.org/MADT&gt;, which OVMF exposes from QEMU. Linux then
sends the INIT-SIPI-SIPI sequences to the APs and fires them up for the
very first time.

Again, this is outright scary. The logs you quoted should never be
possible.

&gt;| So please provide a specific (and minimal, if possible) QEMU command
&gt;| line that demonstrates the failure, so we can add it to the CI
&gt;| pre-merge checks.

(1) Download the 32-bit UEFI OS image from Gerd&apos;s repo:
&lt;https://www.kraxel.org/repos/images/fedora-30-efi-systemd-i686.qcow2.xz&gt;

(2) Extract the kernel from it:
&quot;/a29755367bf242efb072cfdd1a70134f/5.3.12-200.fc30.i686/linux&quot; on the
second partition (VFAT).

(3) Build OVMF at edk2 commit bbd30066e137 with the following options:

  build \
    -a IA32 \
    -b NOOPT \
    -p OvmfPkg/OvmfPkgIa32.dsc \
    -t GCC5 \
    -D SECURE_BOOT_ENABLE \
    -D SMM_REQUIRE \
    -D NETWORK_TLS_ENABLE \
    -D NETWORK_IP6_ENABLE \
    -D NETWORK_HTTP_BOOT_ENABLE \
    -D TPM2_ENABLE \
    --pcd=gEfiMdePkgTokenSpaceGuid.PcdDebugPrintErrorLevel=0x8040004F

(4) Using QEMU-7.2:

  qemu-system-i386 \
    -cpu coreduo,-nx \
    -machine q35,smm=on,accel=kvm \
    -m 5120 \
    -smp 2 \
    -global driver=cfi.pflash01,property=secure,value=on \
    -drive if=pflash,format=raw,unit=0,file=OVMF_CODE.fd,readonly=on \
    -drive if=pflash,format=raw,unit=1,file=OVMF_VARS.fd,snapshot=on \
    -debugcon file:debug.log \
    -global isa-debugcon.iobase=0x402 \
    -chardev stdio,signal=off,mux=on,id=char0 \
    -mon chardev=char0,mode=readline \
    -serial chardev:char0 \
    -kernel linux \
    -append &quot;ignore_loglevel console=ttyS0&quot;

(5) Near the top of the log file, you&apos;ll find:

&gt;| PlatformMaxCpuCountInitialization: CmdData2=0x0
&gt;| PlatformMaxCpuCountInitialization: BootCpuCount=2 MaxCpuCount=2

(as expected).

(6) The last few lines of &quot;debug.log&quot; will be:

&gt;| SmmInstallProtocolInterface: [EdkiiSmmExitBootServicesProtocol] 0
&gt;| CpuDxe: 5-Level Paging = 0

and the guest will hang.

(7) If you remove the &quot;-smp 2&quot; option, then:

- there is no

&gt;| CpuDxe: 5-Level Paging = 0

  line in &quot;debug.log&quot;, and

- the guest kernel starts up, and writes messages to the serial console.

(8) If you revert the series containing the offending commit
73ccde8f6d04:

  git revert 3f378450dfaf
  git revert 4a8642422460
  git revert 73ccde8f6d04
  git revert 7bda8c648192

and rebuild, and retest *with -smp 2*, then the guest kernel will nicely
proceed until it panics, and &quot;debug.log&quot; continues as follows:

&gt;| SmmInstallProtocolInterface: [EdkiiSmmExitBootServicesProtocol] 0
&gt;| CpuDxe: 5-Level Paging = 0
&gt;| MpInitChangeApLoopCallback() done!

Note in particular the last message. MpInitChangeApLoopCallback()
[UefiCpuPkg/Library/MpInitLib/DxeMpLib.c] is the EBS handler for CpuDxe.
It first calls

&gt;|   WakeUpAP (CpuMpData, TRUE, 0, RelocateApLoop, NULL, TRUE);

(executing the &quot;parking&quot; that has been regressed), then waits until all
APs are parked, and finally prints the &quot;done!&quot; message.

&gt;| Also, there is a related patch 2f7d5a03dbe733f3de5 that seems to
&gt;| differentiate between AMD and Intel targets, and it looks like the
&gt;| IA32 implementation of AsmRelocateApLoop() now implements the
&gt;| AsmRelocateApLoopAmd() prototype, and should be renamed accordingly.
&gt;| AIUI, that means the only thing that would need to be fixed on top of
&gt;| that is the &lt;4 GB allocation of the buffer.

I can&apos;t find commit 2f7d5a03dbe733f3de5 in my clone, at bbd30066e137.

You probably mean AsmRelocateApLoopAmd() from commit 7bda8c648192
(&quot;UefiCpuPkg: Duplicated AsmRelocateApLoop as AsmRelocateApLoopAmd&quot;,
2022-12-20), which is the direct ancestor of offending commit
73ccde8f6d04 (&quot;UefiCpuPkg: Has APs in 64 bit long-mode before booting to
OS.&quot;, 2022-12-20).

Unfortunately, *both* commits are wrong, in that each commit keys off,
*separately*, of the wrong thing -- namely
StandardSignatureIsAuthenticAMD(). The first commit does it to
RelocateApLoop(), the second one does it to InitMpGlobalData().

What is necessary is to use the &quot;AMD&quot; variant for 32-bit processors
(regardless of vendor), and for 64-bit AMD processors; and to use the
&quot;new&quot; variant for 64-bit Intel processors only. Furthermore, the
allocations in InitMpGlobalData() need to be split across the same
boundary too.

In other words, there are at least two issues: wrong factor used for
variant selection, *and* ignoring the distinction *entirely* in the
allocations.

I&apos;d strongly prefer if the whole thing were just reverted for now.

(BTW: even the *ordering* of the patches in the original series is
wrong: it first adds the new CpuPageTableLib class dependency in
patch#2, then fills in the library resolutions in patches #3 and #4. So
now you are left with an extra problem, for ordering the *revert*
commits: if you revert the patches in inverse order of the originals
(which is normally the right way), you just create *more* un-bisectable
commits in the history, where the dependencies will be broken. If you
want to keep the tree buildable across the whole revert series, you need
to revert out-of-order.)

&gt;| I don&apos;t have any problems with reverting the whole lot, though, so
&gt;| unless anyone objects and volunteers a fix for this mess, I will go
&gt;| ahead and do that later this week.

Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20373</commentid>
    <comment_count>4</comment_count>
    <who name="Yuanhao Xie">yuanhao.xie</who>
    <bug_when>2023-01-03 02:27:52 +0000</bug_when>
    <thetext>
Thanks for the key part points: 

&gt; - in &quot;UefiCpuPkg/Library/MpInitLib/DxeMpLib.c&quot;, function
&gt;   InitMpGlobalData(), it leaves the *comment* about &lt;4GB buffer
&gt;   allocation in place, but removes the actual allocation limit for IA32
&gt;   and X64 *both*, single-handedly breaking *both* code/comment
&gt;   consistency *and* IA32 functionality,
&gt; 
&gt; - *completely* misses that in
&gt;   &quot;UefiCpuPkg/Library/MpInitLib/Ia32/MpFuncs.nasm&quot;, the the 32-bit
&gt;   AsmRelocateApLoopStart function implementation still has the original
&gt;   function prototype, so the call in RelocateApLoop()
&gt;   [UefiCpuPkg/Library/MpInitLib/DxeMpLib.c] no longer matches. In
&gt;   particular, the removal of the &quot;PmCodeSegment&quot; parameter changes the
&gt;   stack offsets for the &quot;TopOfApStack&quot; and &quot;CountTofinish&quot; parameters,
&gt;   which parameters the function *does* depend upon.

and 32-bit UEFI OS image.

I will send a patch to fix them.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20405</commentid>
    <comment_count>5</comment_count>
    <who name="Ray Ni">ray.ni</who>
    <bug_when>2023-01-03 06:16:24 +0000</bug_when>
    <thetext>
&gt; (Not to mention the general sorry state of edk2: the patch series in
&gt; question does not reference any bugzilla, the Summary of PR#3802 is
&gt; *empty*, and as of this writing, there are *419* OPEN pull requests in
&gt; the tracker. Yeah, moving the patch merge process to github.com has
&gt; totally saved this project from the negligence of its maintainers. /s
&gt; Intel&apos;s firmware team in China still treats edk2 as their own sandbox.
&gt; Good riddance for me.)

Sorry for hearing that on my first working day of 2023.
Anyway, thanks for reporting the bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20410</commentid>
    <comment_count>6</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-03 07:21:37 +0000</bug_when>
    <thetext>Ray, I apologize for my harsh words; I do not apologize for the *message*. I failed at expressing the problem civilly; I did not fail at stating the problem itself.

Before I left edk2 in Summer 2021, I&apos;d been trying to get the same *message* through, for about a decade. None of the core problems had been remedied, and they&apos;ve apparently only become worse since I left.

Every time I blow up at a new instance of the *systemic* dysfunctions of the edk2 community, a *one-time* mitigation is implemented. The attitude, the resources, the commitment, the decication -- those things never improve.

And so I mince words less and less whenever I report a new issue rooted in those dysfunctions. Part of it is conscious on my part, hoping to elicit *some* positive long-term response from Intel maintainers. A betterment of the process if you will. Because polite words have not produced any permanent results in the past. One hopes that yelling might hold the attention of Intel maintainers for longer than a few days.

With UefiCpuPkg, Intel wields *huge power*. That&apos;s what you all should realize. And, &quot;with great power comes great responsibility&quot;.

It cannot be news to you that OvmfPkg critically depends on UefiCpuPkg, and that QEMU/KVM subjects UefiCpuPkg code to such an environment and to such code paths that are frequently not seen on physical hardware. Why then is test coverage still so lackluster? I&apos;m not asking about CI, and I&apos;m also not asking that the submitter test the patch in every possible configuration. But why not *honestly state*, in the commit message, that the code was never tested on IA32? Why not *ask* about testing, during review? If you find out during review that IA32 was not tested at all, you can always reach out to the OvmfPkg maintainers / reviewers, and they will help. You just need to *care*.

You cannot have forgotten that I&apos;d been a UefiCpuPkg co-reviewer for many years, specifically so that I could catch regressions early. Do you think UefiCpuPkg matters *less* on QEMU/KVM than before?

And if you do care, but simply don&apos;t have the time / capacity to deal with QEMU/KVM aspects, then I think the community would be happy to discuss all this with *Intel management*. In the last 10+ years, I&apos;ve *repeatedly* tried to address community issues by escalating on the Red Hat side, to the Intel on-site engineers and partner managers. Only to see all those efforts die a silent and hidden death &quot;somewhere&quot; at the Intel side, after the escalations were transfered. I&apos;ve talked to Intel community managers, I&apos;ve talked to the other stewards. I&apos;ve tried everything. Only yelling remains.

Edk2 is the worst project I&apos;ve ever worked with, yet I&apos;ve given it my all. Almost nothing has improved. Since you brought up New Year&apos;s Eve: near the end of my Christmas vacation, I thought I&apos;d *tinker* with UEFI-related stuff a bit. I&apos;m not returning to edk2 by any means, it&apos;s just that UEFI and edk2 hold such a place in my heart that, once I found a bit of free time after several months, I couldn&apos;t resist playing with UEFI. Starting with a lingering issue in the &quot;shim&quot; bootloader, then with the UEFI spec, then... the regressions in edk2, as a dependency chain, just wouldn&apos;t stop popping up. Issue tracker in total neglect, bugzilla tracker in total neglect. Complete smack in the face.

Can you honestly answer WHY edk2 practices have not improved? Are your internal incentives and goals at Intel so much misaligned with Open Development? Has this all been a sham?

Edk2 has broken my heart. It rewards caring and attention with neglect, disregard and abuse. The primary factors to success in edk2 are not expertise but endurance and thick skin. I kinda wish I had spent the last decade in a different community.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20419</commentid>
    <comment_count>7</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-03 13:14:12 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #3)
&gt;| (In reply to ardb from comment #2)
&gt;&gt;| However, this issue is not as easy to reproduce as you make it out
&gt;&gt;| to be. OvmfPkgIa32.dsc boots happily for me in qemu-system-i386 with
&gt;&gt;| -M q35 -cpu pentium3 -smp 2, and while the MaxCpuCount appears to be
&gt;&gt;| capped in PEI
&gt;&gt;|
&gt;&gt;|   PlatformMaxCpuCountInitialization: QEMU v2.7 reset bug: BootCpuCount=2 Present=0
&gt;&gt;|   PlatformMaxCpuCountInitialization: BootCpuCount=0 MaxCpuCount=1
&gt;|
&gt;| the log lines you quoted above bear witness to some *serious* QEMU (or
&gt;| edk2) breakage.

Ard and I narrowed it down to TCG acceleration (as opposed to KVM).
Further analysis &amp; questions in:

  IO port write width clamping differs between TCG and KVM

  http://mid.mail-archive.com/aaedee84-d3ed-a4f9-21e7-d221a28d1683@redhat.com
  https://lists.gnu.org/archive/html/qemu-devel/2023-01/msg00199.html

Looks like a TCG bug in QEMU.

As I wrote earlier in comment#3, this QEMU bug can unfortunately mask
the issue that&apos;s the subject of this BZ. If you are on Windows and only
use QEMU with TCG, the issue will be hidden, as QEMU&apos;s misbehavior will
make OVMF think that there is only 1 processor in the system, and so
MpInitLib will not try to start up (and then pen) APs.

I don&apos;t think that&apos;s an excuse though -- I wrote a wiki article 5 years
ago, specifically for Windows-based developers, for testing OVMF on KVM,
using a single lab server.

  https://github.com/tianocore/tianocore.github.io/wiki/Testing-SMM-with-QEMU,-KVM-and-libvirt

Testing UefiCpuPkg changes on KVM has *always* been necessary. KVM tends
to inject such jitter and other scheduling artifacts to VCPUs that are
rarely seen on physical CPUs. This has exposed race conditions (improper
locking etc) in UefiCpuPkg in the past.

The current case only drives the same point home. The penning issue is
real for 32-bit Intel PCPUs; testing on KVM would have caught it
earlier.

(And again, if we don&apos;t care about 32-bit physical CPUs any longer, then
we should remove all 32-bit-only code from UefiCpuPkg, and OvmfPkg too!)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20444</commentid>
    <comment_count>8</comment_count>
    <who name="Ray Ni">ray.ni</who>
    <bug_when>2023-01-04 00:51:17 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #6)
&gt; Ray, I apologize for my harsh words; I do not apologize for the *message*.
&gt; I failed at expressing the problem civilly; I did not fail at stating the
&gt; problem itself.

Thanks. That helps.

&gt; Are your internal incentives and goals at Intel so much misaligned
&gt; with Open Development?

You are asking the key question:)

But I won&apos;t use this as an excuse for the IA32 bugs you reported here.
We are improving the Intel X64 code quality by simplifying the logic (removing the unnecessary 64 to 32 transition). I just thought such change didn&apos;t impact IA32.
If you check the code change, we tried to isolate the AMD flow to make sure no impact to AMD CPU (but the &lt;4G allocation bug did impact AMD CPU). We indeed missed the careful review on IA32 logic change.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20482</commentid>
    <comment_count>9</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2023-01-04 08:03:18 +0000</bug_when>
    <thetext>(In reply to Ray Ni from comment #8)
&gt; &gt; Are your internal incentives and goals at Intel so much misaligned
&gt; &gt; with Open Development?
&gt; 
&gt; You are asking the key question:)

Does this question have an answer?

What are the incentives and goals within this part of Intel?  It does feel as though something is set up incorrectly, and is incentivizing the wrong outcomes.

My guess would be the typical &quot;ship it ASAP, don&apos;t care about incurring technical debt, rely on someone else to fix our problems later&quot; approach that often infects large companies.  But this is just a guess from the outside.  It would be interesting to get an inside perspective.

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20645</commentid>
    <comment_count>10</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-12 13:39:54 +0000</bug_when>
    <thetext>(removing myself from the CC list)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21365</commentid>
    <comment_count>11</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-04-15 07:37:11 +0000</bug_when>
    <thetext>Has this been fixed?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21367</commentid>
    <comment_count>12</comment_count>
    <who name="Yuanhao Xie">yuanhao.xie</who>
    <bug_when>2023-04-16 22:07:16 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #11)
&gt; Has this been fixed?

Yes</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21369</commentid>
    <comment_count>13</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-04-17 11:16:40 +0000</bug_when>
    <thetext>Please record the hashes of the commits that fixed the issue in a new comment, and then move the BZ ticket to RESOLVED|FIXED status. Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21378</commentid>
    <comment_count>14</comment_count>
    <who name="Yuanhao Xie">yuanhao.xie</who>
    <bug_when>2023-04-19 01:05:07 +0000</bug_when>
    <thetext>
Please check the following commits:

UefiCpuPkg: Move AsmRelocateApLoopStart from Mpfuncs.nasm to AmdSev.nasm 
c7c25997595aa34ce0a7a21ca2e1fc5b0f9b38a6

UefiCpuPkg: Rename AsmRelocateApLoopStart. 
0d1ad06c27e36bef6d89a7cbdfda39b5c36fdfbe

UefiCpuPkg: Put APs in 64 bit mode before handoff to OS. 
facf52aeb8accb312acfd34b60266d4ea866afbb

UefiCpuPkg: Allocate contiguous memory for stacks and APs loop. 
e9782e69070c3a876f6bc1af966603cc1fc90320

UefiCpuPkg: Split the path in RelocateApLoop into two. 
a6f799e7fdb6389178485ddd36f472df100cebba

UefiCpuPkg: Check AP_SAFE_STACK_SIZE during build time. 
0c3f8766b00bfc8e97728f3d96b8d8c084575fa6</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4099</bug_id>
          
          <creation_ts>2022-10-09 21:46:52 +0000</creation_ts>
          <short_desc>DayRemainder may overflow</short_desc>
          <delta_ts>2023-01-10 16:44:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Wenyi, Xie">xiewenyi0201</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>amachiry</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19730</commentid>
    <comment_count>0</comment_count>
    <who name="Wenyi, Xie">xiewenyi0201</who>
    <bug_when>2022-10-09 21:46:52 +0000</bug_when>
    <thetext>The function gmtime in file TimerWrapper.c has a variant DayRemainder which is UINT16, this variant may overflow when it is assigned.
DayRemainder = (UINT32)(*timer % SECSPERDAY);
For example, when the time is 2022-09-28 04:29:58, (*timer % SECSPERDAY) = 73798,
it is larger than the maximun of UNIT16.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19731</commentid>
    <comment_count>1</comment_count>
    <who name="Wenyi, Xie">xiewenyi0201</who>
    <bug_when>2022-10-09 21:59:46 +0000</bug_when>
    <thetext>Sorry, I check the new code and find out that this issue has been fixed in master, so close this issue. 
https://github.com/tianocore/edk2/commit/3c9e2f239a38590b4e3a8c1ec2304227f2af0103</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4735</bug_id>
          
          <creation_ts>2024-03-20 04:29:04 +0000</creation_ts>
          <short_desc>SecurityPkg\OpalPasswordDxe: BrowserCallback() cannot be used within FORM_OPEN browser action</short_desc>
          <delta_ts>2024-04-16 05:21:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Tina Chen">tina.chen</reporter>
          <assigned_to name="Tina Chen">tina.chen</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>ming.tan</cc>
    
    <cc>tina.chen</cc>
    
    <cc>xiao.x.chen</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22813</commentid>
    <comment_count>0</comment_count>
    <who name="Tina Chen">tina.chen</who>
    <bug_when>2024-03-20 04:29:04 +0000</bug_when>
    <thetext>Refer to UEFI_Spec_2_10_Aug29.pdf page 1694

In section 35.5.4 for EFI_BROWSER_ACTION_FORM_OPEN:
NOTE: EFI_FORM_BROWSER2_PROTOCOL.BrowserCallback() cannot be used with
this browser action because question values have not been retrieved yet.

So should not call HiiGetBrowserData() and HiiSetBrowserData() in FORM_OPEN
call back function.

Those APIs are called within OpalHiiSetBrowserData/OpalHiiGetBrowserData which have been used by OpalHii.c.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22814</commentid>
    <comment_count>1</comment_count>
    <who name="Tina Chen">tina.chen</who>
    <bug_when>2024-03-20 06:50:34 +0000</bug_when>
    <thetext>Patch v2 submitted: https://edk2.groups.io/g/devel/message/116934
PR is created: https://github.com/tianocore/edk2/pull/5485</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22914</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-04-16 05:21:43 +0000</bug_when>
    <thetext>merged https://github.com/tianocore/edk2/pull/5563</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4580</bug_id>
          
          <creation_ts>2023-10-27 08:58:03 +0000</creation_ts>
          <short_desc>edk2-libc Python: Provide sample python scripts to demonstrate socket client capabilities on UEFI shell</short_desc>
          <delta_ts>2023-11-22 02:55:05 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22089</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-27 08:58:03 +0000</bug_when>
    <thetext>This BZ has been created to provide the sample python scripts to demonstrate the socket client capabilities using http library on UEFI shell with the help of Python UEFI interpreter.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22090</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-27 09:00:07 +0000</bug_when>
    <thetext>Will be providing a simple echo client python script that can be run on UEFI shell and a server script which needs to be run on a system booted to OS. 

These are sample demonstration applications to demonstrate the working of http based communications from UEFI shell using Python programming.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22091</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-10-27 12:28:07 +0000</bug_when>
    <thetext>Submitted patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22092</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-28 06:27:11 +0000</bug_when>
    <thetext>Please provide the archive URL(s) of the patch in a new bugzilla comment, whenever submitting a patch.

[edk2-devel] [edk2-libc Patch 0/1] AppPkg/Python - Sample scripts to exercise socket functionality

Primary URL:
https://edk2.groups.io/g/devel/message/110221

Secondary URLs:
https://listman.redhat.com/archives/edk2-devel-archive/2023-October/069522.html
http://mid.mail-archive.com/20231027162718.830-1-n.jayaprakash@intel.com</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22180</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-11-22 02:55:05 +0000</bug_when>
    <thetext>merged the changes to master branch
commit f24e13afe55d37d33fe0fe0ec4789a16b8a0a5ff</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4438</bug_id>
          
          <creation_ts>2023-05-02 23:15:34 +0000</creation_ts>
          <short_desc>Depex unsatisfied PEIM dispatched, but it isn&apos;t in Apriori file</short_desc>
          <delta_ts>2023-06-02 05:16:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Wendy Liao">wendy.liao</reporter>
          <assigned_to name="Wendy Liao">wendy.liao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21467</commentid>
    <comment_count>0</comment_count>
      <attachid>1361</attachid>
    <who name="Wendy Liao">wendy.liao</who>
    <bug_when>2023-05-02 23:15:34 +0000</bug_when>
    <thetext>Created attachment 1361
suggested solution

The main dispatch loop in PeiDispatcher() goes through each FV and calls
DiscoverPeimsAndOrderWithApriori() to search Apriori file to reorder all PEIMs then do the PEIM dispatched.

DiscoverPeimsAndOrderWithApriori() calculates Apriori file count for every FV once and set Private-&gt;AprioriCount, but Private-&gt;AprioriCount doesn&apos;t be set to 0 before dispatch loop walking through the next FV.

It causes the peim which sort on less than Private-&gt;AprioriCount and depex is not satisfied would be dispatched when dispatch loop go through to a scaned FV, even the peim is not set in APRIORI file.

Suggested solution attached.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21535</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 21:55:50 +0000</bug_when>
    <thetext>Wendy Liao: please send the patch to edk2 mail list for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21631</commentid>
    <comment_count>2</comment_count>
    <who name="Wendy Liao">wendy.liao</who>
    <bug_when>2023-06-02 05:16:26 +0000</bug_when>
    <thetext>pushed at ba91d0292e593df8528b66f99c1b0b14fadc8e16</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1361</attachid>
            <date>2023-05-02 23:15:34 +0000</date>
            <delta_ts>2023-05-02 23:15:34 +0000</delta_ts>
            <desc>suggested solution</desc>
            <filename>Set-Private-AprioriCount-to-0-before-walking-through.patch</filename>
            <type>application/octet-stream</type>
            <size>831</size>
            <attacher name="Wendy Liao">wendy.liao</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4264</bug_id>
          
          <creation_ts>2023-01-06 03:56:03 +0000</creation_ts>
          <short_desc>[UEFIPayLoad] DebugPrintErrorLevelLibHob with deadcode caused unexpected log print level.</short_desc>
          <delta_ts>2023-01-10 21:44:16 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ning Feng">ning.feng</reporter>
          <assigned_to name="Ning Feng">ning.feng</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20514</commentid>
    <comment_count>0</comment_count>
    <who name="Ning Feng">ning.feng</who>
    <bug_when>2023-01-06 03:56:03 +0000</bug_when>
    <thetext>in function &quot;DebugPrintErrorLevelLibHob -&gt;GetDebugPrintErrorLevel&quot; deadcode caused unexpected log print level.

if (DebugPrintErrorLevel-&gt;Header.Length &gt; UNIVERSAL_PAYLOAD_SIZEOF_THROUGH_FIELD (UEFI_PAYLOAD_DEBUG_PRINT_ERROR_LEVEL, ErrorLevel)) {
            gDebugPrintErrorLevel = DebugPrintErrorLevel-&gt;ErrorLevel;
          }
looks like &quot;DebugPrintErrorLevel-&gt;Header.Length&quot;will always equal to “UNIVERSAL_PAYLOAD_SIZEOF_THROUGH_FIELD (UEFI_PAYLOAD_DEBUG_PRINT_ERROR_LEVEL, ErrorLevel)”, it will cause bios will always consume debugprintlevel value from fixedpcd, but not the hob.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20583</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-10 21:40:19 +0000</bug_when>
    <thetext>ning.feng@intel.com: please take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20586</commentid>
    <comment_count>2</comment_count>
    <who name="Ning Feng">ning.feng</who>
    <bug_when>2023-01-10 21:44:16 +0000</bug_when>
    <thetext>fix patch merged, we can close the bug.
UefiPayloadPkg: Fix debug print error level hob not save correct 

REF: https://bugzilla.tianocore.org/show_bug.cgi?id=4264
Fix debug print error level hob not save correct DebugPrintErrorlevel
Should cover the case:
Header.Length == UNIVERSAL_PAYLOAD_SIZEOF_THROUGH_FIELD ()
Cc: Ray Ni &lt;ray.ni@intel.com&gt;
Cc: Sean Rhodes &lt;sean@starlabs.systems&gt;
Cc: James Lu &lt;james.lu@intel.com&gt;
Cc: Gua Guo &lt;gua.guo@intel.com&gt;
Signed-off-by: Ning Feng &lt;ning.feng@intel.com&gt;
Reviewed-by: Gua Guo &lt;gua.guo@intel.com&gt;</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4125</bug_id>
          
          <creation_ts>2022-10-27 21:22:18 +0000</creation_ts>
          <short_desc>TDVF: Need add GPA check for #VE handle</short_desc>
          <delta_ts>2022-11-04 05:50:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>jiewen.yao</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19856</commentid>
    <comment_count>0</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-10-27 21:22:18 +0000</bug_when>
    <thetext>Currently, this is no check in https://github.com/tianocore/edk2/blob/master/OvmfPkg/Library/VmgExitLib/VmTdExitVeHandler.c.

We need add GPA check for #VE check. Please refer to:
https://github.com/intel/tdx/commit/f045b0d52a5f7d8bf66cd4410307d05a90523f10#diff-20b69003deb151d572d7460425aeaf1df5b42b8a4f4adf9ca58de50334bae5a9</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19864</commentid>
    <comment_count>1</comment_count>
      <attachid>1043</attachid>
    <who name="">jiewen.yao</who>
    <bug_when>2022-10-28 04:31:38 +0000</bug_when>
    <thetext>Created attachment 1043
patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19874</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-10-28 22:21:57 +0000</bug_when>
    <thetext>assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19877</commentid>
    <comment_count>3</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-10-28 22:27:28 +0000</bug_when>
    <thetext>This is defense in depth for https://bugzilla.tianocore.org/show_bug.cgi?id=4131.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19940</commentid>
    <comment_count>4</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-11-04 03:12:11 +0000</bug_when>
    <thetext>This issue is reported by ruogui.ygr@alibaba-inc.com.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19941</commentid>
    <comment_count>5</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-11-04 05:50:45 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3589

https://github.com/tianocore/edk2/commit/eff44c008d99eca6e3700e864b014821ba88683c</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1043</attachid>
            <date>2022-10-28 04:31:38 +0000</date>
            <delta_ts>2022-10-28 04:31:38 +0000</delta_ts>
            <desc>patch</desc>
            <filename>0001-OvmfPkg-VmgExitLig-HALT-on-#VE-when-access-to-private-memory.patch</filename>
            <type>application/octet-stream</type>
            <size>2640</size>
            <attacher>jiewen.yao</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4762</bug_id>
          
          <creation_ts>2024-04-22 23:28:47 +0000</creation_ts>
          <short_desc>PatchFv.py unable to find Symbols from Map file for 32 BIT GCC Builds</short_desc>
          <delta_ts>2024-05-03 16:15:47 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="cbduggap">chinni.b.duggapu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22939</commentid>
    <comment_count>0</comment_count>
    <who name="cbduggap">chinni.b.duggapu</who>
    <bug_when>2024-04-22 23:28:47 +0000</bug_when>
    <thetext>PatchFv.py unable to find Symbols from Map file for 32 BIT GCC Builds</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22940</commentid>
    <comment_count>1</comment_count>
    <who name="cbduggap">chinni.b.duggapu</who>
    <bug_when>2024-04-22 23:29:18 +0000</bug_when>
    <thetext>Able to reproduce using GCC Build Files</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23003</commentid>
    <comment_count>2</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-05-03 16:15:28 +0000</bug_when>
    <thetext>Patch provided by Chinni: https://edk2.groups.io/g/devel/message/118120</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23004</commentid>
    <comment_count>3</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-05-03 16:15:47 +0000</bug_when>
    <thetext>Pushed as 248aa15</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4467</bug_id>
          
          <creation_ts>2023-05-24 16:30:33 +0000</creation_ts>
          <short_desc>Add support for running shell test application in an immutable volume</short_desc>
          <delta_ts>2023-07-20 16:37:37 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>kun.qin</reporter>
          <assigned_to>kun.qin</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UnitTestFrameworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21581</commentid>
    <comment_count>0</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-05-24 16:30:33 +0000</bug_when>
    <thetext>Current implementation of UnitTestFrameworkPkg for shell-based unit test will save the unit test cache to the same volume as the test application itself. This works as long as the test application is on a writable volume, such as USB or EFI partition.

However, sometimes the test application would live inside the firmware volume because it was integrated into the UEFI image and published through drivers such as &quot;FvSimpleFileSystem&quot;. In this case, attempting to write cache file to the volume will fail and thus unable to run the tests.

The proposed change is to write the test cache to the path where this unit test is invoked. i.e. test is on FS0, which is a FV file system, but FS1 is a usb file system. The traditional flow of running this test in shell will be &quot;fs0:&quot;, &quot;test.efi&quot;, which will fail to write to &quot;fs0:&quot;. The proposed flow is to navigate shell to &quot;fs1:&quot;, then execute the test with &quot;fs0:test.efi&quot;. This way the cache file will be saved to fs1 successfully.

An example of such change is checked in to Project MU: https://github.com/microsoft/mu_basecore/commit/d66ba3be2668f4a37970c07b4e9ad458484eaac3</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21600</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 21:48:12 +0000</bug_when>
    <thetext>kun.qin@microsoft.com: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21755</commentid>
    <comment_count>2</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-07-20 16:37:37 +0000</bug_when>
    <thetext>Merged as c6b512962e92ae54a895bdfd2147abaf2c9e3e22: https://github.com/tianocore/edk2/pull/4670.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4325</bug_id>
          
          <creation_ts>2023-01-25 14:48:27 +0000</creation_ts>
          <short_desc>buildzip.sh contains out of date path</short_desc>
          <delta_ts>2023-03-02 09:05:16 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Stuart Yoder">stuart.yoder</reporter>
          <assigned_to name="Abhi Singh">Abhi.Singh</assigned_to>
          <cc>Abhi.Singh</cc>
    
    <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>vincent.stehle</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20920</commentid>
    <comment_count>0</comment_count>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2023-01-25 14:48:27 +0000</bug_when>
    <thetext>The script ./uefi-sct/SctPkg/buildzip.sh contains an out of date path.

It does the following:
# Copy the SCT Parser tool into the repo
cp sct_parser/* ${TARGET_ARCH}_SCT/SCT/Sequence/

The &quot;sct_parser&quot; has been replaced with edk2-test-parser (see https://gitlab.arm.com/systemready/edk2-test-parser).

The path name needs to be updated.  Also, a check should be put in place so that if someone forgets to clone edk2-test-parser they get a meaningful message, not just an error where the cp command fails.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20922</commentid>
    <comment_count>1</comment_count>
      <attachid>1303</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-01-26 14:41:16 +0000</bug_when>
    <thetext>Created attachment 1303
Proposed Patch for buildzip.sh old reference and repo check</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21031</commentid>
    <comment_count>2</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-02-13 01:56:11 +0000</bug_when>
    <thetext>https://edk2.groups.io/g/devel/message/99096?p=,,,20,0,0,0::recentpostdate/sticky,,Abhi,20,2,0,96551593</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21135</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-03-02 09:05:16 +0000</bug_when>
    <thetext>Solution is upstream by the commit:
Upstreamed by the commit id: https://github.com/tianocore/edk2-test/commit/8713740892bdb857e970a2841de9800b2c6b5552</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1303</attachid>
            <date>2023-01-26 14:41:16 +0000</date>
            <delta_ts>2023-01-26 14:41:16 +0000</delta_ts>
            <desc>Proposed Patch for buildzip.sh old reference and repo check</desc>
            <filename>0001-uefi-sct-SctPkg-update-path-to-edk2-test-parser-chec.patch</filename>
            <type>text/plain</type>
            <size>1789</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4147</bug_id>
          
          <creation_ts>2022-11-11 06:22:02 +0000</creation_ts>
          <short_desc>Multiple Coverity issues were found from EDK2 ShellPkg.</short_desc>
          <delta_ts>2022-11-11 07:03:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4148</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Kalaivani Palanikumar">kalaivanip</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19999</commentid>
    <comment_count>0</comment_count>
      <attachid>1053</attachid>
    <who name="Kalaivani Palanikumar">kalaivanip</who>
    <bug_when>2022-11-11 06:22:02 +0000</bug_when>
    <thetext>Created attachment 1053
ShellPkg Coverity Report

Attached is the report for Coverity issues identified in ShellPkg based on edk2-stable202205.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20001</commentid>
    <comment_count>1</comment_count>
    <who name="Kalaivani Palanikumar">kalaivanip</who>
    <bug_when>2022-11-11 07:03:29 +0000</bug_when>
    <thetext>https://bugzilla.tianocore.org/show_bug.cgi?id=4148. This issue is the Duplicate issue of 4148

*** This bug has been marked as a duplicate of bug 4148 ***</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1053</attachid>
            <date>2022-11-11 06:22:02 +0000</date>
            <delta_ts>2022-11-11 06:22:02 +0000</delta_ts>
            <desc>ShellPkg Coverity Report</desc>
            <filename>changes_V1.rar</filename>
            <type>application/octet-stream</type>
            <size>192953</size>
            <attacher name="Kalaivani Palanikumar">kalaivanip</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4021</bug_id>
          
          <creation_ts>2022-08-15 21:24:17 +0000</creation_ts>
          <short_desc>Fix GenSec use EFI_SECTION_FREEFORM_SUBTYPE_GUID in extended size header</short_desc>
          <delta_ts>2022-08-22 13:43:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19400</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-08-15 21:24:17 +0000</bug_when>
    <thetext>GenSec does not generate correct common section type for 
-s EFI_SECTION_FREEFORM_SUBTYPE_GUID if the size of the section
requires extended size in a EFI_FREEFORM_SUBTYPE_GUID_SECTION2 header.

SubtypeGuidSect2-&gt;CommonHeader.Type should be assigned to 
EFI_SECTION_FREEFORM_SUBTYPE_GUID instead of EFI_SECTION_GUID_DEFINED 
in the function GenSectionSubtypeGuidSection()</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19401</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-08-15 21:26:25 +0000</bug_when>
    <thetext>This issue was introduced in the following commit that fixed
a PI Spec conformance issue for EFI_SECTION_FREEFORM_SUBTYPE_GUID.

https://github.com/tianocore/edk2/commit/cf02322c984a16fc2af252124df96564e574f3a7

The logic is correct for standard size sections, but not extended size.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19403</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-08-15 22:39:15 +0000</bug_when>
    <thetext>Assign</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19404</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-08-15 22:44:47 +0000</bug_when>
    <thetext>Code review

https://edk2.groups.io/g/devel/message/92465</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19417</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-08-22 13:43:03 +0000</bug_when>
    <thetext>Commit:
https://github.com/tianocore/edk2/commit/e2ac68a23b4954d5c0399913a1df3dd9fd90315d

PR: 
https://github.com/tianocore/edk2/pull/3215</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4636</bug_id>
          
          <creation_ts>2024-01-08 01:49:37 +0000</creation_ts>
          <short_desc>No need to check SCI status in UPL</short_desc>
          <delta_ts>2024-01-09 20:59:05 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc>https://github.com/tianocore/edk2/pull/5230</bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Gang Chen">gang.c.chen</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22333</commentid>
    <comment_count>0</comment_count>
    <who name="Gang Chen">gang.c.chen</who>
    <bug_when>2024-01-08 01:49:37 +0000</bug_when>
    <thetext>There is an Error log from UPL will be printed out always:
ERROR: The ACPI enabling status is inconsistent: SCI is not enabled but the ACPI table does not provide a means to enable it through FADT-&gt;SmiCmd. This may cause issues in OS.

The check SMI_CMD/SCI_EN code is in UPL, which is executed before jumping into DXE phase. But the point we enable the SCI is before in BDS, which is very late.

So the SMI_CMD/SCI_EN check in the UPL should be too early, which should be removed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22342</commentid>
    <comment_count>1</comment_count>
      <attachid>1458</attachid>
    <who name="Gang Chen">gang.c.chen</who>
    <bug_when>2024-01-09 20:56:47 +0000</bug_when>
    <thetext>Created attachment 1458
check point</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22343</commentid>
    <comment_count>2</comment_count>
    <who name="Gang Chen">gang.c.chen</who>
    <bug_when>2024-01-09 20:59:05 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5230 got merged.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1458</attachid>
            <date>2024-01-09 20:56:47 +0000</date>
            <delta_ts>2024-01-09 20:56:47 +0000</delta_ts>
            <desc>check point</desc>
            <filename>UEFI_Boot_Flow.jpg</filename>
            <type>image/jpeg</type>
            <size>226769</size>
            <attacher name="Gang Chen">gang.c.chen</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4491</bug_id>
          
          <creation_ts>2023-06-27 21:29:51 +0000</creation_ts>
          <short_desc>RngDxe assert at &quot;ASSERT (Index != mAvailableAlgoArrayCount);&quot;</short_desc>
          <delta_ts>2023-10-04 10:41:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>kun.qin</reporter>
          <assigned_to>kun.qin</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21696</commentid>
    <comment_count>0</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-06-27 21:29:51 +0000</bug_when>
    <thetext>On an ARM system that does not support firmware TRNG (or not yet), the updated logic from RngDxe will cause the system to assert at &quot;ASSERT (Index != mAvailableAlgoArrayCount);&quot;

The reason seems to be:
1. when initializing the number of `mAvailableAlgoArrayCount`, the logic will only treat the zero guid of &quot;&quot; as a warning and still increment the counter because &quot;RngGetBytes&quot; might still succeed: https://github.com/tianocore/edk2/blob/1a39bdf2c53858ebb39e6de1362203c65c163c63/SecurityPkg/RandomNumberGenerator/RngDxe/AArch64/AArch64Algo.c#L51C3-L51C3.
2. This will cause the main entry to publish the RNG protocol and trigger further usage.
3. However, during usage, the zero guid is always filtered out: https://github.com/tianocore/edk2/blob/1a39bdf2c53858ebb39e6de1362203c65c163c63/SecurityPkg/RandomNumberGenerator/RngDxe/ArmRngDxe.c#L91. Thus, this will cause the system to always not able to find the algorithm and fail the boot with an assert.

The suggestion is to at least make the 2 logic consistent.

During this process, I also noticed that the zero guid comparison of `mAvailableAlgoArray` will always trigger a data abortion error, which is caused by buffer allocated is `RNG_AVAILABLE_ALGO_MAX` bytes, which should be RNG_AVAILABLE_ALGO_MAX * sizeof (EFI_RNG_ALGORITHM).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21697</commentid>
    <comment_count>1</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-06-27 21:31:46 +0000</bug_when>
    <thetext>(In reply to kun.qin from comment #0)
&gt; On an ARM system that does not support firmware TRNG (or not yet), the
&gt; updated logic from RngDxe will cause the system to assert at &quot;ASSERT (Index
&gt; != mAvailableAlgoArrayCount);&quot;
&gt; 
&gt; The reason seems to be:
&gt; 1. when initializing the number of `mAvailableAlgoArrayCount`, the logic
&gt; will only treat the zero guid of &quot;&quot; as a warning and still increment the
&gt; counter because &quot;RngGetBytes&quot; might still succeed:
&gt; https://github.com/tianocore/edk2/blob/
&gt; 1a39bdf2c53858ebb39e6de1362203c65c163c63/SecurityPkg/RandomNumberGenerator/
&gt; RngDxe/AArch64/AArch64Algo.c#L51C3-L51C3.
&gt; 2. This will cause the main entry to publish the RNG protocol and trigger
&gt; further usage.
&gt; 3. However, during usage, the zero guid is always filtered out:
&gt; https://github.com/tianocore/edk2/blob/
&gt; 1a39bdf2c53858ebb39e6de1362203c65c163c63/SecurityPkg/RandomNumberGenerator/
&gt; RngDxe/ArmRngDxe.c#L91. Thus, this will cause the system to always not able
&gt; to find the algorithm and fail the boot with an assert.
&gt; 
&gt; The suggestion is to at least make the 2 logic consistent.
&gt; 
&gt; During this process, I also noticed that the zero guid comparison of
&gt; `mAvailableAlgoArray` will always trigger a data abortion error, which is
&gt; caused by buffer allocated is `RNG_AVAILABLE_ALGO_MAX` bytes, which should
&gt; be RNG_AVAILABLE_ALGO_MAX * sizeof (EFI_RNG_ALGORITHM).

I meant treat the zero guid of &quot;PcdCpuRngSupportedAlgorithm&quot;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21701</commentid>
    <comment_count>2</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-06-28 16:43:13 +0000</bug_when>
    <thetext>Patch sent for review at https://edk2.groups.io/g/devel/message/106483.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21739</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:32:45 +0000</bug_when>
    <thetext>kun.qin@microsoft.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21952</commentid>
    <comment_count>4</comment_count>
    <who name="">kun.qin</who>
    <bug_when>2023-10-04 10:41:03 +0000</bug_when>
    <thetext>Fixed as b74f1f7ab5e956f58ae1771dc4e2a4b92bc51430</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4349</bug_id>
          
          <creation_ts>2023-02-24 13:35:30 +0000</creation_ts>
          <short_desc>MdeModulePkg/FtwMisc: Ftw may fail to recover variable in corner case.</short_desc>
          <delta_ts>2023-03-28 14:05:13 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21115</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-02-24 13:35:30 +0000</bug_when>
    <thetext>Current FtwGetLastWriteHeader() assumed ftw_work space will be all 0xFF
when incompleted FTW triggered by surprise reset or power off, however,
in mass testing scenario we observed some system ftw_work space
are all 0x00 and that caused FTW going into wrong flow and corrupted
ftw_spare region before restoring to main working region.

This may cause next boot hang in VariableSmm driver because -
gEdkiiFaultTolerantWriteGuid will not be created and working variable
region header may still be invalid (not recovered yet)

To fix this issue the FtwGetLastWriteHeader() has added header verification to prevent from consuming invalid ftw_work region data.

Example reproduce flow:
Surprise reset in Variable Reclaim (ftw_work region may be all 0x00) -&gt;
  Boot with backup NVS -&gt; FtwGetLastWriteHeader() goes to wrong flow -&gt;
    FtwReclaimWorkSpace() erases spare region -&gt; surprise reset -&gt;
      Next boot hang in VariableSmm driver.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21274</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-28 14:03:43 +0000</bug_when>
    <thetext>Currently we treated this as flash content corruption and might be chip or board specific behavior and no plan to submit this workaround.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21275</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-28 14:05:13 +0000</bug_when>
    <thetext>no plan to fix such issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4171</bug_id>
          
          <creation_ts>2022-11-28 21:52:54 +0000</creation_ts>
          <short_desc>Pre-alloc shared memory in IOMMU for Td guest&apos;s DMA operation</short_desc>
          <delta_ts>2022-12-17 21:15:09 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20116</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-11-28 21:52:54 +0000</bug_when>
    <thetext>A typical QEMU fw_cfg read bytes with IOMMU for td guest is that: (QemuFwCfgReadBytes@QemuFwCfgLib.c is the example)
1) Allocate DMA Access buffer
2) Map actual data buffer
3) start the transfer and wait for the transfer to complete
4) Free DMA Access buffer
5) Un-map actual data buffer

In step 1/2, Private memories are allocated, converted to shared memories. In Step 4/5 the shared memories are converted to private memories and accepted again. The final step is to free the pages.

This is time-consuming and impact td guest&apos;s boot perf (both direct boot and grub boot) badly.

We&apos;re going to reserve a pre-allocated shared-memory for Td guest&apos;s DMA operation. So that the time of alloc/set-shared/set-private/accept/free is saved. This will improve the td guest&apos;s boot perf significantly.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20130</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-29 21:47:38 +0000</bug_when>
    <thetext>Min is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20221</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-12-17 21:15:09 +0000</bug_when>
    <thetext>Fixed https://github.com/tianocore/edk2/pull/3784</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4822</bug_id>
          
          <creation_ts>2024-07-30 12:05:29 +0000</creation_ts>
          <short_desc>edk2-libc: remove an accidental commit made to edk2-libc which has added .gitmodules file</short_desc>
          <delta_ts>2024-07-30 13:04:35 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23275</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-30 12:05:29 +0000</bug_when>
    <thetext>There was an accidental commit went into edk2-libc while experimenting with some inner-source repos. Which lead to the addition of .gitmodules file.
This needs to be undone.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23276</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-30 12:06:13 +0000</bug_when>
    <thetext>Jayaprakash Nevara will work on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23277</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-30 12:22:08 +0000</bug_when>
    <thetext>Submitted email patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23278</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-30 13:04:35 +0000</bug_when>
    <thetext>email patch reviewed by Rebecca.
Patch has been merged to the master repo through commit
87108465dcfbf888b8044ae86b4dc84b04b19082</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4048</bug_id>
          
          <creation_ts>2022-09-06 22:56:44 +0000</creation_ts>
          <short_desc>Add Intel FSP packages to edk2 CI</short_desc>
          <delta_ts>2022-10-04 13:00:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kubacki">michael.kubacki</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
    
    <cf_package>IntelFsp2WrapperPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19501</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-06 22:56:44 +0000</bug_when>
    <thetext>These packages still do not have a CI YAML file. This change is tracking
a minimal CI YAML file being added so the package can take part in edk2
CI.

Since it currently has not been run against CI, some CI failures may need to
be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19502</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-06 23:02:54 +0000</bug_when>
    <thetext>I will be sending a patch soon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19695</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-04 13:00:21 +0000</bug_when>
    <thetext>Changes merged to edk2 master in the following PR:
https://github.com/tianocore/edk2/pull/3347

And the following commits:
629709a51d76fe6ad22a5441fb979a1b8c9d2e16 to
769879e2a6761277b8099014ad8bc426d23dc50b</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4667</bug_id>
          
          <creation_ts>2024-02-02 03:35:42 +0000</creation_ts>
          <short_desc>Readme.md: Update AlderlakeOpenBoardPkg known limitations.</short_desc>
          <delta_ts>2024-05-13 23:03:01 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>Placeholder</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dora Hsueh">dorax.hsueh</reporter>
          <assigned_to name="Dora Hsueh">dorax.hsueh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22504</commentid>
    <comment_count>0</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-02-02 03:35:42 +0000</bug_when>
    <thetext>Add Readme.md to explain how to build AlderlakeOpenBoardPkg.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22725</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 22:10:49 +0000</bug_when>
    <thetext>dorax.hsueh@intel.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23024</commentid>
    <comment_count>2</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-05-13 23:03:01 +0000</bug_when>
    <thetext>https://edk2.groups.io/g/devel/message/118708
https://edk2.groups.io/g/devel/message/118707

These PATCH to resolve the issue, Already Pushed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4524</bug_id>
          
          <creation_ts>2023-08-16 01:25:12 +0000</creation_ts>
          <short_desc>Add USB Network RNDIS Drivers</short_desc>
          <delta_ts>2023-08-16 01:25:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>gaoliming</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21824</commentid>
    <comment_count>0</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:25:12 +0000</bug_when>
    <thetext>Add USB RNDIS devices support
Add USB Cdc ECM devices support
Add USB Cdc NCM devices support</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21825</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:25:45 +0000</bug_when>
    <thetext>This feature has been merged at 8dab4e..ff3382</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4386</bug_id>
          
          <creation_ts>2023-03-23 22:59:49 +0000</creation_ts>
          <short_desc>UefiPayloadPkg: Support input data in UniversalPayloadBuild.py</short_desc>
          <delta_ts>2023-04-10 04:48:53 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Gua Guo">gua.guo</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>linusx.wu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21257</commentid>
    <comment_count>0</comment_count>
    <who name="Gua Guo">gua.guo</who>
    <bug_when>2023-03-23 22:59:49 +0000</bug_when>
    <thetext>Currently, UniversalPayloadBuild.py can&apos;t specific point to spec version, producer id and revision by input data, have it with input data can have benefit isolate SpecRevision delta.


Expected behavior
py -3 UefiPayloadPkg\UniversalPayloadBuild.py -t VS2019
        SpecRevision   = 0x0007
        Revision       = 0x0000010105
        ProducerId     = b&apos;INTEL&apos;


py -3 UefiPayloadPkg\UniversalPayloadBuild.py -t VS2019 --SpecRevision 0x0009 --ProducerId Insyde
        SpecRevision   = 0x0009
        Revision       = 0x0000010105
        ProducerId     = b&apos;Insyde&apos;

py -3 UefiPayloadPkg\UniversalPayloadBuild.py -t VS2019 --SpecRevision 0x0006 --ProducerId AMI --Revision 0x0000878787
        SpecRevision   = 0x0006
        Revision       = 0x0000878787
        ProducerId     = b&apos;AMI&apos;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21271</commentid>
    <comment_count>1</comment_count>
    <who name="Linus Wu">linusx.wu</who>
    <bug_when>2023-03-28 04:15:36 +0000</bug_when>
    <thetext>(In reply to Gua Guo from comment #0)
&gt; Currently, UniversalPayloadBuild.py can&apos;t specific point to spec version,
&gt; producer id and revision by input data, have it with input data can have
&gt; benefit isolate SpecRevision delta.
&gt; 
&gt; 
&gt; Expected behavior
&gt; py -3 UefiPayloadPkg\UniversalPayloadBuild.py -t VS2019
&gt;         SpecRevision   = 0x0070
&gt;         Revision       = 0x00010105
&gt;         ProducerId     = b&apos;INTEL&apos;
&gt; 
&gt; 
&gt; py -3 UefiPayloadPkg\UniversalPayloadBuild.py -t VS2019 --SpecRevision
&gt; 0.9 --ProducerId Insyde
&gt;         SpecRevision   = 0x0090
&gt;         Revision       = 0x00010105
&gt;         ProducerId     = b&apos;Insyde&apos;
&gt; 
&gt; py -3 UefiPayloadPkg\UniversalPayloadBuild.py -t VS2019 --SpecRevision
&gt; 0.6 --ProducerId AMI --Revision 0x0000878787
&gt;         SpecRevision   = 0x0060
&gt;         Revision       = 0x00878787
&gt;         ProducerId     = b&apos;AMI&apos;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21344</commentid>
    <comment_count>2</comment_count>
    <who name="Gua Guo">gua.guo</who>
    <bug_when>2023-04-10 04:48:53 +0000</bug_when>
    <thetext>Fixed by https://github.com/tianocore/edk2/pull/4201, thanks Linus contribute.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4196</bug_id>
          
          <creation_ts>2022-12-18 21:32:23 +0000</creation_ts>
          <short_desc>Move bdsdxe.inf from DXEFV to BDSFV in UefiPayloadPkg</short_desc>
          <delta_ts>2022-12-20 03:52:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>mars_cc_lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20222</commentid>
    <comment_count>0</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2022-12-18 21:32:23 +0000</bug_when>
    <thetext>Since UefiPayload had supported multiple fv, move bdsdxe.inf to new firmware volume and modify the script of UniversalPayloadPkgBuild.py to support bdsdxe fv in elf file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20224</commentid>
    <comment_count>1</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2022-12-19 00:45:07 +0000</bug_when>
    <thetext>I&apos;m working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20229</commentid>
    <comment_count>2</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2022-12-20 03:52:00 +0000</bug_when>
    <thetext>The change had committed as the link below:
https://github.com/tianocore/edk2/pull/3786</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4847</bug_id>
          
          <creation_ts>2024-09-10 23:32:01 +0000</creation_ts>
          <short_desc>SCT test fails when ExtractConfig returns EFI_ACCESS_DENIED</short_desc>
          <delta_ts>2024-12-17 14:17:27 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>Ann.Cheng</reporter>
          <assigned_to>Ann.Cheng</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23392</commentid>
    <comment_count>0</comment_count>
    <who name="">Ann.Cheng</who>
    <bug_when>2024-09-10 23:32:01 +0000</bug_when>
    <thetext>EFI_ACCESS_DENIED (The action violated a system policy.) is an acceptable status for ExtractConfig in UEFI specification. SCT should issue a warning, rather than marking the test case as a failure, when EFI_ACCESS_DENIED is returned.



Similar issue was found and fixed in: https://bugzilla.tianocore.org/show_bug.cgi?id=3759

https://github.com/aabhi64/edk2-test/blob/315e3a56a6d9261d4fad4c1950f2d01a052eeba4/uefi-sct/SctPkg/TestCase/UEFI/EFI/Protocol/HIIConfigAccess/BlackBoxTest/HIIConfigAccessBBTestFunction.c#L367


logs from failure system:

HII_CONFIG_ACCESS_PROTOCOL.ExtractConfig- ExtractConfig() returns EFI_SUCCESS and vaild Results with valid parameters . -- FAILURE
961A5268-1998-4A7E-9D9D-CEDC67FBCC77
/home/runner/work/arm-systemready/arm-systemready/SR/scripts/edk2-test/uefi-sct/SctPkg/TestCase/UEFI/EFI/Protocol/HIIConfigAccess/BlackBoxTest/HIIConfigAccessBBTestFunction.c:379: Status - Access Denied</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23517</commentid>
    <comment_count>1</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-11-07 10:29:11 +0000</bug_when>
    <thetext>The issue is valid.
Assigning to Ann for solution implementation.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23536</commentid>
    <comment_count>2</comment_count>
    <who name="">Ann.Cheng</who>
    <bug_when>2024-11-20 03:54:47 +0000</bug_when>
    <thetext>Changes were raised by:

Git PR: https://github.com/tianocore/edk2-test/pull/110
Mailing list: https://edk2.groups.io/g/devel/topic/patch_v1_1_1/109648112</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23551</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-12-05 10:19:04 +0000</bug_when>
    <thetext>The solution is reviewed and shall be upstreamed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23572</commentid>
    <comment_count>4</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-12-17 14:17:27 +0000</bug_when>
    <thetext>The solution is upstreamed through

https://github.com/tianocore/edk2-test/commit/a41f58c09bccdd3e6626d87d3f4ec8b3855c9365


Closing this ticket.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4073</bug_id>
          
          <creation_ts>2022-09-20 12:51:20 +0000</creation_ts>
          <short_desc>Code First / External ECR – RISC-V: Add RHCT Table</short_desc>
          <delta_ts>2022-09-30 07:21:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>Other</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Sunil V L">sunilvl</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>ACPI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19594</commentid>
    <comment_count>0</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-20 12:51:20 +0000</bug_when>
    <thetext>This is the BZ created for the RHCT ECR submitted via https://mantis.uefi.org/mantis/view.php?id=2349</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19595</commentid>
    <comment_count>1</comment_count>
      <attachid>1025</attachid>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-20 12:59:48 +0000</bug_when>
    <thetext>Created attachment 1025
RHCT_ECR</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19611</commentid>
    <comment_count>2</comment_count>
      <attachid>1027</attachid>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-22 10:19:45 +0000</bug_when>
    <thetext>Created attachment 1027
RHCT_ECR</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19613</commentid>
    <comment_count>3</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-23 01:21:32 +0000</bug_when>
    <thetext>This ECR is approved by ASWG as is (without any changes suggested)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19681</commentid>
    <comment_count>4</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-30 07:21:24 +0000</bug_when>
    <thetext>EDK2 codefirst BZ is specifically for EDK2 community. RISC-V codefirst generic ECRs have generic scope and will be part of RISC-V community. So, closing this BZ as invalid.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1025</attachid>
            <date>2022-09-20 12:59:48 +0000</date>
            <delta_ts>2022-09-22 10:19:45 +0000</delta_ts>
            <desc>RHCT_ECR</desc>
            <filename>ACPI_RHCT_RISC-V_ECR-3.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>11263</size>
            <attacher name="Sunil V L">sunilvl</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1027</attachid>
            <date>2022-09-22 10:19:45 +0000</date>
            <delta_ts>2022-09-22 10:19:45 +0000</delta_ts>
            <desc>RHCT_ECR</desc>
            <filename>ACPI_RHCT_RISC-V_ECR.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>11306</size>
            <attacher name="Sunil V L">sunilvl</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4696</bug_id>
          
          <creation_ts>2024-02-21 20:31:25 +0000</creation_ts>
          <short_desc>[TDVF] RBP register shall be cleared in TDVMCALL</short_desc>
          <delta_ts>2024-03-19 06:27:30 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22630</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2024-02-21 20:31:25 +0000</bug_when>
    <thetext>According to GHCI (Guest-Host-Communication Interface) spec:
RBP register is usually used as a frame pointer according to the C language calling convention. The software should not use RBP as an input/output parameter and should clear BIT5 (RBP) in the GPR mask in RCX.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22713</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 21:56:41 +0000</bug_when>
    <thetext>min.m.xu@intel.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22745</commentid>
    <comment_count>2</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2024-03-06 20:12:59 +0000</bug_when>
    <thetext>We have submitted the patch-set for review. https://edk2.groups.io/g/devel/message/115941</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22808</commentid>
    <comment_count>3</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-03-19 06:27:30 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5479</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4413</bug_id>
          
          <creation_ts>2023-04-14 02:44:31 +0000</creation_ts>
          <short_desc>CryptoPkg: Enable DXE_CORE support in BaseCryptLibOnProtocolPpi\DxeCryptLib.inf</short_desc>
          <delta_ts>2023-07-27 03:54:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to name="yi1.li@intel.com">yi1.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21363</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-04-14 02:44:31 +0000</bug_when>
    <thetext>Make the DXE_CORE module also able to call the crypto protocol, which can reduce FV size on platforms using the Crypto Binaries.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21408</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:43:26 +0000</bug_when>
    <thetext>yi1.li@intel.com works on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21779</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-07-27 03:54:00 +0000</bug_when>
    <thetext>Done.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4235</bug_id>
          
          <creation_ts>2023-01-01 07:14:13 +0000</creation_ts>
          <short_desc>UefiCpuPkg, OvmfPkg: incomplete API removal: SmmCpuFeaturesAllocatePageTableMemory</short_desc>
          <delta_ts>2023-01-04 08:00:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Laszlo Ersek">laszlo.ersek</assigned_to>
          <cc>ardb</cc>
    
    <cc>dun.tan</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>kraxel</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>mcb30</cc>
    
    <cc>mhaeuser</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
    
    <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20333</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-01 07:14:13 +0000</bug_when>
    <thetext>Commit 0426115b6738 (&quot;UefiCpuPkg: Remove unused API in SmmCpuFeaturesLib.h&quot;, 2022-12-21) removed the declaration of the function SmmCpuFeaturesAllocatePageTableMemory() from the &quot;SmmCpuFeaturesLib.h&quot; library class header.

The commit message *incorrectly* claims that: &quot;[...] no other files use this API&quot;.

Is it REALLY THAT FRICKIN HARD to run a &quot;git grep&quot;?

As of commit bbd30066e137, two *definitions* of the function remain in edk2:

- OvmfPkg/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLib.c
- UefiCpuPkg/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLibCommon.c

Furthermore, in edk2-platforms, as of 1b3845432449, one definition remains:

- Silicon/Intel/QuarkSocPkg/QuarkNorthCluster/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLib.c

It generates a lot of trust that a developer unable (or not caring enough) to tie up trivial loose ends like this is allowed to modify core SMM functionality. Details are hard, let&apos;s go shopping!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20416</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-03 10:04:12 +0000</bug_when>
    <thetext>[PATCH 0/4] fixes for BZs 3876, 4235, 4236
Message-Id: &lt;20230103150244.66835-1-lersek@redhat.com&gt;
https://listman.redhat.com/archives/edk2-devel-archive/2023-January/057171.html
https://edk2.groups.io/g/devel/message/97873</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20420</commentid>
    <comment_count>2</comment_count>
    <who name="Dun Tan">dun.tan</who>
    <bug_when>2023-01-03 19:37:00 +0000</bug_when>
    <thetext>Before I delete the API in the headfile, I have checked all the related code about this API in both edk2 and edk2-platforms repo. In current edk2 and edk2-platforms repo, all the implementention of this API returns NULL. So I removed it in the headfile and planed to delete the dummy implementention code in SmmCpuFeaturesLib instance c file. Thanks for your reminding!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20421</commentid>
    <comment_count>3</comment_count>
    <who name="Dun Tan">dun.tan</who>
    <bug_when>2023-01-03 19:39:44 +0000</bug_when>
    <thetext>Just saw your patches. Thank you for fixing this issue!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20440</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-04 00:25:20 +0000</bug_when>
    <thetext>Hello Dun Tan,

please do open a new BZ for the &quot;edk2-platforms&quot; product as well, and post a patch for that. &quot;Silicon/Intel/QuarkSocPkg/QuarkNorthCluster/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLib.c&quot; still has an implementation of the function. Thanks</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20443</commentid>
    <comment_count>5</comment_count>
    <who name="Dun Tan">dun.tan</who>
    <bug_when>2023-01-04 00:43:19 +0000</bug_when>
    <thetext>Hi Laszlo Ersek,
I&apos;ll open a bugzila for edk2-platforms and send patch to remove the API in edk2-platforms. Thank you for removing it in UefiCpuPkg and OvmfPkg.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20465</commentid>
    <comment_count>6</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-01-04 04:45:41 +0000</bug_when>
    <thetext>Taking Dun Tan&apos;s comment as an ack, fix merged as part of #3852</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20481</commentid>
    <comment_count>7</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-04 08:00:11 +0000</bug_when>
    <thetext>(commits ff379e1b489f1cde5edff1ef564ea97616e71972 and 9ce09870e721efacc41fa7ee684e9e299f120350)</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4100</bug_id>
          
          <creation_ts>2022-10-10 08:46:08 +0000</creation_ts>
          <short_desc>ScsiDiskDxe driver updates &quot;ControllerNameTable&quot; with common string &quot;SCSI Disk Device&quot; for all SCSI disk devices</short_desc>
          <delta_ts>2022-10-30 22:52:51 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Cheripally Gopi">gopic</reporter>
          <assigned_to name="Cheripally Gopi">gopic</assigned_to>
          <cc>arunk</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>gopic</cc>
    
    <cc>hao.a.wu</cc>
    
    <cc>kalaivanip</cc>
    
    <cc>sainadhn</cc>
    
    <cc>sundaresans</cc>
    
    <cc>vasudevans</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19733</commentid>
    <comment_count>0</comment_count>
    <who name="Cheripally Gopi">gopic</who>
    <bug_when>2022-10-10 08:46:08 +0000</bug_when>
    <thetext>Due to this common string, when multiple SCSI disk devices connected, facing difficulty in identifying correct SCSI disk device. As per SCSI spec, standard Inquiry Data is having the fields to know Vendor and Product information. Update &quot;ControllerNameTable&quot; with Vendor and Product information. So that, device specific name can be retrieved using ComponentName protocol.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19734</commentid>
    <comment_count>1</comment_count>
    <who name="Cheripally Gopi">gopic</who>
    <bug_when>2022-10-10 08:56:33 +0000</bug_when>
    <thetext>I have made changes. can i send changes to devel@edk2.groups.io</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19747</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-11 21:41:37 +0000</bug_when>
    <thetext>gopic@ami.com: please send the patch to edk2 mail list.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19879</commentid>
    <comment_count>3</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-10-30 22:27:47 +0000</bug_when>
    <thetext>V1 patch sent at: https://edk2.groups.io/g/devel/message/95297
V2 patch sent at: https://edk2.groups.io/g/devel/message/95636</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19880</commentid>
    <comment_count>4</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-10-30 22:52:51 +0000</bug_when>
    <thetext>Resolved via:
PR - https://github.com/tianocore/edk2/pull/3559
Commit - https://github.com/tianocore/edk2/commit/52199bf5326a8355d28b2d395db483f7c77d5a4d</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4440</bug_id>
          
          <creation_ts>2023-05-03 11:14:40 +0000</creation_ts>
          <short_desc>cve.org CVE-2019-0160 links to edk2-docs.gitbooks.io</short_desc>
          <delta_ts>2023-05-12 13:50:15 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Documentation</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Rebecca Cran">rebecca</reporter>
          <assigned_to name="Miki Demeter">miki.demeter</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          <cf_documents>Other Document</cf_documents>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21470</commentid>
    <comment_count>0</comment_count>
    <who name="Rebecca Cran">rebecca</who>
    <bug_when>2023-05-03 11:14:40 +0000</bug_when>
    <thetext>The page at https://www.cve.org/CVERecord?id=CVE-2019-0160 links to edk2-docs.gitbooks.io .</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21533</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 21:53:15 +0000</bug_when>
    <thetext>Rebecca: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21548</commentid>
    <comment_count>2</comment_count>
    <who name="Rebecca Cran">rebecca</who>
    <bug_when>2023-05-09 22:36:35 +0000</bug_when>
    <thetext>Miki has said she will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21564</commentid>
    <comment_count>3</comment_count>
    <who name="Miki Demeter">miki.demeter</who>
    <bug_when>2023-05-12 13:50:15 +0000</bug_when>
    <thetext>The https://www.cve.org/CVERecord?id=CVE-2019-0160 has been updated with the corrected link.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4126</bug_id>
          
          <creation_ts>2022-10-27 22:44:35 +0000</creation_ts>
          <short_desc>IntelFsp2Pkg: Update function header to support IA32/X64.</short_desc>
          <delta_ts>2022-11-02 15:41:41 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19857</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-27 22:44:35 +0000</bug_when>
    <thetext>Common functions will have either 32bit or 64bits instances which
having different return code size. Function header should support both
scenarios.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19858</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-27 22:44:57 +0000</bug_when>
    <thetext>Working on the fix.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19915</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-11-02 15:41:41 +0000</bug_when>
    <thetext>patch merged: https://github.com/tianocore/edk2/commit/c46204e25f5b929fae2b336c03c73fada632d4f4</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4767</bug_id>
          
          <creation_ts>2024-04-25 22:20:01 +0000</creation_ts>
          <short_desc>Re-define GCC*_IA32_X64_DLINK_COMMON common-page-size=0x1000</short_desc>
          <delta_ts>2024-07-30 10:42:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Reference Implementation</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>hehe.li</reporter>
          <assigned_to>hehe.li</assigned_to>
          <cc>abner.chang</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>rebecca</cc>
          
          <cf_industrystandardspecifications>UEFI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22986</commentid>
    <comment_count>0</comment_count>
    <who name="">hehe.li</who>
    <bug_when>2024-04-25 22:20:01 +0000</bug_when>
    <thetext>GCC*_IA32_X64_DLINK_COMMON is defined in Edk2\BaseTools\Conf\tools_def.template with following statement:
DEFINE GCC49_IA32_X64_DLINK_COMMON   = -nostdlib -Wl,-n,-q,--gc-sections -z common-page-size=0x40
DEFINE GCC48_IA32_X64_DLINK_COMMON   = -nostdlib -Wl,-n,-q,--gc-sections -z common-page-size=0x20
But the Intel repo will override it as 1000 since more common page size means more efficient to get large variable.

I recommend to re-define GCC*_IA32_X64_DLINK_COMMON as 1000 in the top level.
so, Intel don&apos;t need to override again in other source code.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23076</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-29 21:08:25 +0000</bug_when>
    <thetext>hehe.li@intel.com : what&apos;s problem? Which module type needs 4k alignement? Is it XIP PEIM or DXE_RUNTIME?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23121</commentid>
    <comment_count>2</comment_count>
    <who name="">hehe.li</who>
    <bug_when>2024-06-15 11:43:27 +0000</bug_when>
    <thetext>I take this as an enhancement.

Compared with ARM 64:
DEFINE GCC49_AARCH64_DLINK_FLAGS     = DEF(GCC48_AARCH64_DLINK_FLAGS) -z common-page-size=0x1000 
DEFINE CLANGDWARF_AARCH64_DLINK_FLAGS  = DEF(CLANGDWARF_AARCH64_TARGET) DEF(GCC_AARCH64_DLINK_FLAGS) -z common-page-size=0x1000

They all override linker flag with common-page-size as 4K.
Besides, in the practical implementation of Intel Repo, we all override common-page-size as 0x1000(4K) alignment in source code.

More large common-page-size will bring in more efficiency code execution.

Except that, PEI now running in 64 bit. It becomes easier to change this Macro definition.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23199</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-07-10 20:56:23 +0000</bug_when>
    <thetext>you can continue to work on it, create Pull Reqest, and document the impact. It may increase the image size on PEI FV image.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23206</commentid>
    <comment_count>4</comment_count>
    <who name="">hehe.li</who>
    <bug_when>2024-07-10 22:23:30 +0000</bug_when>
    <thetext>OK, Will do it</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23207</commentid>
    <comment_count>5</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2024-07-10 22:40:13 +0000</bug_when>
    <thetext>Same as Intel&apos;s platform. AMD overrides this build option to 0x1000. This means we are ok with this change.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23267</commentid>
    <comment_count>6</comment_count>
    <who name="">hehe.li</who>
    <bug_when>2024-07-26 03:34:29 +0000</bug_when>
    <thetext>Hi, 
pls review PR in https://github.com/tianocore/edk2/pull/5981</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23272</commentid>
    <comment_count>7</comment_count>
    <who name="">hehe.li</who>
    <bug_when>2024-07-30 02:02:02 +0000</bug_when>
    <thetext>This change, as a code improvement, may not bring us too many benefits.
close my PR and close this topic.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23274</commentid>
    <comment_count>8</comment_count>
    <who name="Rebecca Cran">rebecca</who>
    <bug_when>2024-07-30 10:42:36 +0000</bug_when>
    <thetext>Close this ticket as requested.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4468</bug_id>
          
          <creation_ts>2023-05-25 09:43:42 +0000</creation_ts>
          <short_desc>Use restricted memory mappings in PEI</short_desc>
          <delta_ts>2023-08-16 01:37:47 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ard Biesheuvel">ardb</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21583</commentid>
    <comment_count>0</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-05-25 09:43:42 +0000</bug_when>
    <thetext>PEI currently relies heavily on the deeply rooted assumption that page allocations from DRAM are both writable and executable by default. This is problematic because it conflicts with one of the most fundamental principles in computer security, i.e., that memory should be executable or writable but never both.

Given that PEI is typically initiated while executing from NOR flash, which is implicitly read-only regardless of the memory attributes in the page tables, we can address this by introducing a memory permission management API by means of a PPI, and invoking this API to cover the following cases:
- When a PEIM is shadowed to memory, the page allocation in question is explicitly mapped read-only and executable.
- When the DxeIpl loads the DXE core, its code and data sections are mapped with the appropriate permissions, as described by its PE/COFF section metadata.

This removes the need from the PEI phase perspective to map DRAM with both writable and executable permissions, although this is not yet sufficient to map DRAM non-executable by default: some changes will need to be made to the DXE core as well so that it is able to dispatch DXE drivers before the CPU architectural protocol becomes available. This will be tracked by a separate issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21599</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 21:46:50 +0000</bug_when>
    <thetext>Ard is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21827</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:37:47 +0000</bug_when>
    <thetext>This patch set has been merged at ac33eee..5542e52</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4326</bug_id>
          
          <creation_ts>2023-01-26 12:56:18 +0000</creation_ts>
          <short_desc>EccCheck tries to copy packages only from WORKSPACE</short_desc>
          <delta_ts>2023-02-14 22:08:15 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Marvin Häuser">mhaeuser</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>mhaeuser</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>pedro.falcato</cc>
    
    <cc>sean.brogan</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20921</commentid>
    <comment_count>0</comment_count>
    <who name="Marvin Häuser">mhaeuser</who>
    <bug_when>2023-01-26 12:56:18 +0000</bug_when>
    <thetext>EccCheck assumes that packages reside in WORKSPACE when copying them for re-formatting [1]. This behaviour has been introduced by [2]. Instead, it must do a full walk on WORKSPACE and PACKAGES_PATH to locate the package. This issue was discovered when enabling CI for Ext4Pkg, which does not reside in the repository root. A workaround that was confirmed working is to symlink Ext4Pkg into WORKSPACE.

[1] https://github.com/tianocore/edk2/blob/d0ff1cae3a1ab20ffd5a1d80658c38c113585651/.pytool/Plugin/EccCheck/EccCheck.py#L80

[2]
https://bugzilla.tianocore.org/show_bug.cgi?id=2986
https://github.com/tianocore/edk2/pull/2216/commits/db62ddb8c34e176d51909a1214f7669705a79a0a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20927</commentid>
    <comment_count>1</comment_count>
    <who name="Sean Brogan">sean.brogan</who>
    <bug_when>2023-01-27 12:54:21 +0000</bug_when>
    <thetext>Other plugins resolve files using the ed2_path python module or mws so that Edk2 relative paths can be resolved using both the workspace and package paths</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20975</commentid>
    <comment_count>2</comment_count>
    <who name="Marvin Häuser">mhaeuser</who>
    <bug_when>2023-02-01 09:51:41 +0000</bug_when>
    <thetext>Patch posted at https://edk2.groups.io/g/devel/message/99407</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21063</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-02-14 22:08:15 +0000</bug_when>
    <thetext>It has been fixed at b59e6fdae2545b45c36c8c5373f4b858fb83c8cd</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4149</bug_id>
          
          <creation_ts>2022-11-13 23:34:46 +0000</creation_ts>
          <short_desc>CryptoPkg remove EC PCD and merge optimized openssl libs</short_desc>
          <delta_ts>2022-11-13 23:36:05 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>gaoliming</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20008</commentid>
    <comment_count>0</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-13 23:34:46 +0000</bug_when>
    <thetext>The recent addition of the Ecliptic Curve (EC) feature and the performance
optimization feature increased the complexity for platforms to integrate
and enable these features. This request simplifies the platform configuration
as much as possible and improves the ability to manage the the size impact
of cryptographic services in each FW phase. A Readme.md is also added that
provides an overview of the CryptoPkg design and features along with platform
integration recommendations.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20009</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-13 23:35:30 +0000</bug_when>
    <thetext>This feature has been merged by https://github.com/tianocore/edk2/pull/3505</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20010</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-13 23:36:05 +0000</bug_when>
    <thetext>Add owner Mike.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4794</bug_id>
          
          <creation_ts>2024-06-21 13:33:32 +0000</creation_ts>
          <short_desc>edk2-libc : add github actions workflow to build Python UEFI interpreter with GCC</short_desc>
          <delta_ts>2024-07-01 23:25:37 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23146</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-21 13:33:32 +0000</bug_when>
    <thetext>Currently edk2-libc has the github build actions setup for building python uefi interpreter using VS2019 tool chain. Need to add a new workflow for setting up the github build actions using GCC tool chain.

This will help developers and maintainers of edk2-libc and more specifically the python uefi project of the edk2-libc repo.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23147</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-21 13:34:01 +0000</bug_when>
    <thetext>JP N will be working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23168</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-01 23:24:21 +0000</bug_when>
    <thetext>Patch submitted for review and the review got completed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23169</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-01 23:25:37 +0000</bug_when>
    <thetext>Changed merged to repo through the below commit:
commit 0626ad0f85a9a2e1c2b3782075fdbd78add8d667</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4022</bug_id>
          
          <creation_ts>2022-08-15 21:37:16 +0000</creation_ts>
          <short_desc>Update GenSec to support prior behavior if EFI_SECTION_FREEFORM_SUBTYPE_GUID is used with no GUID</short_desc>
          <delta_ts>2022-08-17 13:01:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19402</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-08-15 21:37:16 +0000</bug_when>
    <thetext>GenSec used to process -s EFI_SECTION_FREEFORM_SUBTYPE_GUID with no guid
and did not produce the section header required by the PI Specification.

Instead, it produced a simple header with only the section type and length
and no GUID before the data.

The following commit added support for the proper header for this section type.

https://github.com/tianocore/edk2/commit/cf02322c984a16fc2af252124df96564e574f3a7

It also required a GUID value to be passed in with the -g option.

Some platform scripts depend on the prior behavior and need some time to
update to use the correct behavior of GenSec.

The suggestion is if -g is missing, then make that a warning instead of
an error and produce the simple header without the GUID.

Once all platforms have been updated to use the PI Specification required
section headers, this non-conformant behavior can be removed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19405</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-08-15 22:45:35 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19406</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-08-15 22:46:17 +0000</bug_when>
    <thetext>Code review email:

https://edk2.groups.io/g/devel/message/92464</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19409</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-08-17 13:01:43 +0000</bug_when>
    <thetext>After further review, preserving the prior behavior is not required.

Closing issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4638</bug_id>
          
          <creation_ts>2024-01-09 11:36:46 +0000</creation_ts>
          <short_desc>Enable config editor tool to have a new feature that can load and view the configuration data of compiled VFR or HFR in form of YAML.</short_desc>
          <delta_ts>2024-01-11 22:28:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="cbduggap">chinni.b.duggapu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22339</commentid>
    <comment_count>0</comment_count>
    <who name="cbduggap">chinni.b.duggapu</who>
    <bug_when>2024-01-09 11:36:46 +0000</bug_when>
    <thetext>Support to enable config editor tool to have a new feature that can load
and view the configuration data of compiled VFR or HFR in form of YAML.
This can help users to understand and track the configuration data when
modifications are made.

Requires compiled vfr file as input in YAML format.

Running Configuration Editor:
python ConfigEditor.py</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22340</commentid>
    <comment_count>1</comment_count>
    <who name="cbduggap">chinni.b.duggapu</who>
    <bug_when>2024-01-09 11:37:54 +0000</bug_when>
    <thetext>Need enhancement to the tool to support this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22355</commentid>
    <comment_count>2</comment_count>
    <who name="cbduggap">chinni.b.duggapu</who>
    <bug_when>2024-01-11 22:28:29 +0000</bug_when>
    <thetext>using PR: https://github.com/tianocore/edk2/pull/5249
Changes checked-in:
https://github.com/tianocore/edk2/commit/7d055812cc7a7d2b062cf56291211e8cecca36ed</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4172</bug_id>
          
          <creation_ts>2022-11-28 22:10:35 +0000</creation_ts>
          <short_desc>Enable Multi-core based lazy-accept for TDVF</short_desc>
          <delta_ts>2023-01-15 19:49:58 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20118</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-11-28 22:10:35 +0000</bug_when>
    <thetext>In current TDVF&apos;s lazy-accept implementation, only the BSP accepts memories under 4G. It impacts the boot perf of Tdx guest.

We&apos;re going to enhance the implementation of Tdx guest&apos;s lazy-accept by making BSP and APs work together to accept memories. It will improve the boot perf of Tdx guest.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20131</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-29 21:48:38 +0000</bug_when>
    <thetext>Min is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20672</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-15 19:49:58 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3813</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4824</bug_id>
          
          <creation_ts>2024-07-31 12:49:47 +0000</creation_ts>
          <short_desc>EAP Authentication Method will change to default value after fill in Identity ID</short_desc>
          <delta_ts>2024-09-04 20:42:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>hong-chih.hsueh</reporter>
          <assigned_to>hong-chih.hsueh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>zachary.clark-williams</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23282</commentid>
    <comment_count>0</comment_count>
    <who name="">hong-chih.hsueh</who>
    <bug_when>2024-07-31 12:49:47 +0000</bug_when>
    <thetext>How to reproduce this issue:

1. Goto BIOS Setup-&gt;Device Manager-&gt;Wi-Fi Configuration-&gt;Mac:xx:xx:xx:xx-&gt;Wi-Fi Network List-&gt;choose a WPA2-Enterprise network

2. Change EAP Authentication Method from TTLS to PEAP

3. Fill in Identity and press enter. The EAP Authentication Method will be changed to default value TTLS unexpectedly.

4. Change EAP Authentication Method from TTLS to PEAP again. The Identity content will be cleared out unexpectedly.


Note:
This issue start to appear after this this commit:
https://github.com/tianocore/edk2/commit/601ab74c5daa1e219eed3d8cc238d5179144a0dd</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23283</commentid>
    <comment_count>1</comment_count>
    <who name="Zachary W Clark-Williams">zachary.clark-williams</who>
    <bug_when>2024-07-31 17:53:32 +0000</bug_when>
    <thetext>Is the bug due to accessing user selected profile that does not exist? 
Removing the update of connection manager wifi nvdata on close form could lead to misaligned data as we are not updating the profile data for connection use.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23284</commentid>
    <comment_count>2</comment_count>
    <who name="">hong-chih.hsueh</who>
    <bug_when>2024-07-31 18:14:09 +0000</bug_when>
    <thetext>This issue is not results from accessing non-exist user selected profile.

This issue is introduced by this commit (https://github.com/tianocore/edk2/commit/601ab74c5daa1e219eed3d8cc238d5179144a0dd), which use the Profile data to update the IfrNvData in the EFI_BROWSER_ACTION_CHANGING action.

The purpose to use Profile data to update IfrNvdata is to display the previously stored user input, and it should only happens while opening the form. Perform this action in EFI_BROWSER_ACTION_CHANGING is the root cause of this issue.

By the way, update the Profile data from IfrNvData while closing form is not touched and remain the same.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23285</commentid>
    <comment_count>3</comment_count>
    <who name="">hong-chih.hsueh</who>
    <bug_when>2024-07-31 18:15:13 +0000</bug_when>
    <thetext>This issue is not results from accessing non-exist user selected profile.

This issue is introduced by this commit (https://github.com/tianocore/edk2/commit/601ab74c5daa1e219eed3d8cc238d5179144a0dd), which use the Profile data to update the IfrNvData in the EFI_BROWSER_ACTION_CHANGING action.

The purpose to use Profile data to update IfrNvdata is to display the previously stored user input, and it should only happens while opening the form. Perform this action in EFI_BROWSER_ACTION_CHANGING is the root cause of this issue.

By the way, update the Profile data from IfrNvData while closing form is not touched and remain the same.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23286</commentid>
    <comment_count>4</comment_count>
    <who name="Zachary W Clark-Williams">zachary.clark-williams</who>
    <bug_when>2024-07-31 19:44:38 +0000</bug_when>
    <thetext>You&apos;re saying that this occurring during EFI_BROWSER_ACTION_CHANGING is the root, I assume be cause the updated data is not available while occurring but we are removing the updating during EFI_BROWSER_ACTION_FROM_CLOSING?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23288</commentid>
    <comment_count>5</comment_count>
    <who name="">hong-chih.hsueh</who>
    <bug_when>2024-08-01 10:45:44 +0000</bug_when>
    <thetext>This commit(https://github.com/tianocore/edk2/commit/601ab74c5daa1e219eed3d8cc238d5179144a0dd) is removing the updating during the EFI_BROWSER_ACTION_FORM_OPEN, so at the same time it tried to move this updating (from Profile data to IfrNvdata) into EFI_BROWSER_ACTION_CHANGING, which caused problem. Because the EFI_BROWSER_ACTION_CHANGING covers a lot of different kind of operations, such as user changing the EAP Authentication Method, or key in the Identity ID.

So, instead of perform updating in EFI_BROWSER_ACTION_CHANGING, my change is to put the updating inside EFI_BROWSER_ACTION_FORM_CLOSE with the question id KEY_REFRESH_NETWORK_LIST. By doing this, the updating can occur at the time user entering a WPA2-Enterprise network page (the EFI_BROWSER_ACTION_FORM_CLOSE with question id KEY_REFRESH_NETWORK_LIST will be executed prior entering a sub page).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23289</commentid>
    <comment_count>6</comment_count>
    <who name="Zachary W Clark-Williams">zachary.clark-williams</who>
    <bug_when>2024-08-01 13:36:08 +0000</bug_when>
    <thetext>Alright I see the change and it all looks good to me.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23290</commentid>
    <comment_count>7</comment_count>
    <who name="">hong-chih.hsueh</who>
    <bug_when>2024-08-01 15:15:43 +0000</bug_when>
    <thetext>Hi Zach,

Thank you for your review and feedback.

my previous pull request does not pass the patch check due to the commit message format so I revised and created a new PR. Could you help to approve this one?
https://github.com/tianocore/edk2/pull/6022</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23291</commentid>
    <comment_count>8</comment_count>
    <who name="Zachary W Clark-Williams">zachary.clark-williams</who>
    <bug_when>2024-08-01 16:57:19 +0000</bug_when>
    <thetext>approved, thanks for getting this fix covered</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23369</commentid>
    <comment_count>9</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-09-04 20:42:34 +0000</bug_when>
    <thetext>this has been fixed https://github.com/tianocore/edk2/pull/6022</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4049</bug_id>
          
          <creation_ts>2022-09-06 23:16:09 +0000</creation_ts>
          <short_desc>IntelFsp2Pkg: Fix build failure (FSP 2.4 Multi-Phase Interface)</short_desc>
          <delta_ts>2022-09-15 14:27:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>chasel.chiu</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19503</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-06 23:16:09 +0000</bug_when>
    <thetext>The following commit in IntelFsp2Pkg introduced the FSP 2.4 Multi-Phase interface:

https://github.com/tianocore/edk2/commit/df25a5457f04ec465dce97428cfee96f462676e7

Files such as IntelFsp2Pkg/FspSecCore/Fsp24SecCoreM.inf and IntelFsp2Pkg/FspSecCore/Fsp24SecCoreS.inf were added to IntelFsp2Pkg.dsc but the files were not added to the package.

BZ4048 enables CI in these packages. It is recommended to merge those changes and then enable the compiler check plugin in IntelFsp2Pkg.ci.yaml which will include compilation in CI and then verify all CI checks pass with the future change for this BZ.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19504</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-06 23:49:42 +0000</bug_when>
    <thetext>Chasel, are you willing to take this BZ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19507</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-09-07 00:22:31 +0000</bug_when>
    <thetext>I thought the Fsp24SecCore modules should be merged separately later after platforms resolved the library dependency, but actually we should be able to merge Fsp24SecCore modules now and platforms should adopt new modules only when all dependency resolved.

patch merged: https://github.com/tianocore/edk2/commit/3d35a6c243ffe749a2ae71d5d72ce0361f168f49

Please help to check if this CI build issue resolved with latest code base.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19509</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-07 01:08:12 +0000</bug_when>
    <thetext>(In reply to Chasel from comment #2)
&gt; I thought the Fsp24SecCore modules should be merged separately later after
&gt; platforms resolved the library dependency, but actually we should be able to
&gt; merge Fsp24SecCore modules now and platforms should adopt new modules only
&gt; when all dependency resolved.
&gt; 
&gt; patch merged:
&gt; https://github.com/tianocore/edk2/commit/
&gt; 3d35a6c243ffe749a2ae71d5d72ce0361f168f49
&gt; 
&gt; Please help to check if this CI build issue resolved with latest code base.

I know I mentioned this to you outside this BZ, but to keep things in sync here, I&apos;m still seeing this linker failure with 3d35a6c:

ERROR - Linker #2001 from BaseFspSecPlatformLibNull.lib(Flat32.obj) :   unresolved external symbol _TempRamInitApi
ERROR - Linker #1120 from \edk2\Build\IntelFsp2Pkg\DEBUG_VS2019\IA32\IntelFsp2Pkg\FspSecCore\FspSecCoreI\DEBUG\FspSecCoreI.dll : fatal   1 unresolved externals</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19515</commentid>
    <comment_count>4</comment_count>
      <attachid>1020</attachid>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-09-07 12:03:44 +0000</bug_when>
    <thetext>Created attachment 1020
test patch for fixing FspSecCoreI linker failure.

Somehow VS2015 did not see such build failure, would you also share what&apos;s the build environment which reproduce this issue? I also attached the test patch for fixing this build failure, please help to check if issue resolved.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19520</commentid>
    <comment_count>5</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-07 15:28:34 +0000</bug_when>
    <thetext>(In reply to Chasel from comment #4)
&gt; Created attachment 1020 [details]
&gt; test patch for fixing FspSecCoreI linker failure.
&gt; 
&gt; Somehow VS2015 did not see such build failure, would you also share what&apos;s
&gt; the build environment which reproduce this issue? I also attached the test
&gt; patch for fixing this build failure, please help to check if issue resolved.

Yes, with that patch, CI with VS2019 now passes

This is why we need CI :)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19571</commentid>
    <comment_count>6</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-09-15 13:31:30 +0000</bug_when>
    <thetext>Patch merged:
https://github.com/tianocore/edk2/commit/f46c7d1e36c901e72cc0daee8429275bcb319eb9

Please help to double check if still any build failure.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19572</commentid>
    <comment_count>7</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-15 14:27:24 +0000</bug_when>
    <thetext>Issue is fixed. I&apos;ll mark this as resolved.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1020</attachid>
            <date>2022-09-07 12:03:44 +0000</date>
            <delta_ts>2022-09-07 12:03:44 +0000</delta_ts>
            <desc>test patch for fixing FspSecCoreI linker failure.</desc>
            <filename>0001-IntelFsp2Pkg-Fix-FspSecCoreI-build-failure.patch</filename>
            <type>text/plain</type>
            <size>2270</size>
            <attacher name="Chasel">chasel.chiu</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4668</bug_id>
          
          <creation_ts>2024-02-02 11:08:08 +0000</creation_ts>
          <short_desc>edk2 - Compilation error due to arithmetic operation on void pointer in EmbeddedPkg</short_desc>
          <delta_ts>2024-02-13 10:36:47 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>EmbeddedPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22506</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-02-02 11:08:08 +0000</bug_when>
    <thetext>Getting the following compilation error while trying to compile the EmbeddedPkg due to arithmatic operation done on a void pointer

edk2\EmbeddedPkg\Library\PrePiMemoryAllocationLib\MemoryAllocationLib.c(311): error C2036: &apos;void *&apos;: unknown size</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22508</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-02-02 11:13:55 +0000</bug_when>
    <thetext>The issue has been confirmed by Laszlo Ersek &lt;lersek@redhat.com&gt; through email in reply to query sent to the developer community.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22530</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-02-06 02:09:15 +0000</bug_when>
    <thetext>Submitted email patch for review and merger</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22561</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-02-13 10:36:47 +0000</bug_when>
    <thetext>Patch reviewed and merged to edk2 main repo through the following commit
commit dcf2e39dce00a5978f1c1a53a0fce04d0fdc9a3c</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4525</bug_id>
          
          <creation_ts>2023-08-16 01:47:52 +0000</creation_ts>
          <short_desc>Remove the duplicated definitions from BaseTools</short_desc>
          <delta_ts>2023-08-16 01:48:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>gaoliming</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21830</commentid>
    <comment_count>0</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:47:52 +0000</bug_when>
    <thetext>Some definitions are duplicated in BaseTools and MdePkg.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21831</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:48:26 +0000</bug_when>
    <thetext>Fix at c1e85376..1df665</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4388</bug_id>
          
          <creation_ts>2023-03-24 13:00:27 +0000</creation_ts>
          <short_desc>edk2-libc: Update the Maintainer info of edk2-libc repo</short_desc>
          <delta_ts>2023-04-06 01:34:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Documentation</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          <cf_documents>Other Document</cf_documents>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21259</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-03-24 13:00:27 +0000</bug_when>
    <thetext>This BZ is for updating the Maintainer.txt file with Jayaprakash N &lt;n.jayaprakash@intel.com&gt; as one of the maintainers of edk2-libc repo.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21260</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-03-24 13:04:30 +0000</bug_when>
    <thetext>Working on sending a patch request</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21330</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-04-06 01:34:43 +0000</bug_when>
    <thetext>Patch submitted, reviewed and merged to the repo.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4848</bug_id>
          
          <creation_ts>2024-09-11 17:16:45 +0000</creation_ts>
          <short_desc>Add VTUTF8 to Putty function key map</short_desc>
          <delta_ts>2024-10-03 12:15:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Phil Noh">phil.noh</reporter>
          <assigned_to name="Phil Noh">phil.noh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>phil.noh</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23393</commentid>
    <comment_count>0</comment_count>
      <attachid>1538</attachid>
    <who name="Phil Noh">phil.noh</who>
    <bug_when>2024-09-11 17:16:45 +0000</bug_when>
    <thetext>Created attachment 1538
TerminalConIn.c : Update for adding VTUTF8 to Putty function key map

According to the existing update below, EDKII TerminalDxe.inf driver (TerminalConIn.c) supports “Putty function key map”. But VTUTF8 type is missing. In Putty, it is required for translating a stream of Unicode characters for function keys on UTF8 correctly.

BugZilla : https://bugzilla.tianocore.org/show_bug.cgi?id=2186
Commit : https://github.com/tianocore/edk2/commit/8a53ea9d9f40aad5504dc6080978a30b1b89ff3e


The attachment is the expected update. We have fixed a related issue with it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23395</commentid>
    <comment_count>1</comment_count>
    <who name="Phil Noh">phil.noh</who>
    <bug_when>2024-09-12 12:32:27 +0000</bug_when>
    <thetext>Created the following PR for this report. Please help to review it.

https://github.com/tianocore/edk2/pull/6197</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23426</commentid>
    <comment_count>2</comment_count>
    <who name="Phil Noh">phil.noh</who>
    <bug_when>2024-10-03 12:15:32 +0000</bug_when>
    <thetext>The PR has been merged to EDK2 master after code review.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1538</attachid>
            <date>2024-09-11 17:16:45 +0000</date>
            <delta_ts>2024-09-11 17:16:45 +0000</delta_ts>
            <desc>TerminalConIn.c : Update for adding VTUTF8 to Putty function key map</desc>
            <filename>TerminalConIn.7z</filename>
            <type>application/x-compressed</type>
            <size>9010</size>
            <attacher name="Phil Noh">phil.noh</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4074</bug_id>
          
          <creation_ts>2022-09-20 21:28:20 +0000</creation_ts>
          <short_desc>[MdeModulePkg][XhciDxe] Current endpoint input context is not fully initialized for evaluate context command</short_desc>
          <delta_ts>2022-09-26 22:48:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Hao Wu">hao.a.wu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19598</commentid>
    <comment_count>0</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-20 21:28:20 +0000</bug_when>
    <thetext>From community report:
https://edk2.groups.io/g/devel/message/93737
https://edk2.groups.io/g/devel/message/93741
https://edk2.groups.io/g/devel/message/93976

The endpoint input context of Default Control Endpoint (EP[0]) for Evaluate Context
command is not fully initialized according to the requirements in the xHCI specification:

6.2.3 Endpoint Context:
* Note: Unless otherwise stated: As Input, all fields of the Endpoint Context shall be initialized to the appropriate value by software before issuing a command.
* Endpoint Type (EP Type). This field identifies whether an Endpoint Context is Valid

According to the above community report (https://edk2.groups.io/g/devel/message/93741), this will prevent USB devices from being initialized on Phytium Platform (ARM).

Need to update XhcEvaluateContext/XhcEvaluateContext64 to properly initialize the input context for Evaluate Context command.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19599</commentid>
    <comment_count>1</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-21 02:14:36 +0000</bug_when>
    <thetext>V1 patch sent at: https://edk2.groups.io/g/devel/message/93737
V2 patch sent at: https://edk2.groups.io/g/devel/message/94030</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19636</commentid>
    <comment_count>2</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-26 22:48:08 +0000</bug_when>
    <thetext>Resolved by jdzhang@kunluntech.com.cn via:
PR - https://github.com/tianocore/edk2/pull/3413
Commit - https://github.com/tianocore/edk2/commit/b3dd9cb836e2aed68198aa79a1ca6afdb25adf80</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4559</bug_id>
          
          <creation_ts>2023-09-22 02:54:46 +0000</creation_ts>
          <short_desc>BaseTools: Add support for LOONGARCH64  R_LARCH_RELAX relocation</short_desc>
          <delta_ts>2023-10-26 17:17:54 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>qiandongyan</reporter>
          <assigned_to>qiandongyan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21929</commentid>
    <comment_count>0</comment_count>
    <who name="">qiandongyan</who>
    <bug_when>2023-09-22 02:54:46 +0000</bug_when>
    <thetext>gcc14 adds new relocation:0x63, 0x67, and the generated relocation causes the build and compilation to fail.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22001</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 22:51:56 +0000</bug_when>
    <thetext>qiandongyan@loongson.cn: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22007</commentid>
    <comment_count>2</comment_count>
    <who name="">qiandongyan</who>
    <bug_when>2023-10-18 23:01:43 +0000</bug_when>
    <thetext>Problem fixed, patch has been submitted: https://github.com/tianocore/edk2/pull/4858</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22078</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 17:17:54 +0000</bug_when>
    <thetext>commit c70d91442889078eb94e0abf777f74e403b72d37</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4236</bug_id>
          
          <creation_ts>2023-01-01 07:49:45 +0000</creation_ts>
          <short_desc>please raise DXEFV to 13MB for NOOPT IA32X64 OVMF&apos;s sake</short_desc>
          <delta_ts>2023-01-05 02:22:47 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Laszlo Ersek">laszlo.ersek</assigned_to>
          <cc>anthony</cc>
    
    <cc>ardb</cc>
    
    <cc>brijesh.singh</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>erdemaktas</cc>
    
    <cc>James.Bottomley</cc>
    
    <cc>kraxel</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>min.m.xu</cc>
    
    <cc>rebecca</cc>
    
    <cc>sebastien.boeuf</cc>
    
    <cc>thomas.lendacky</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20336</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-01 07:49:45 +0000</bug_when>
    <thetext>The NOOPT build of OVMF is relevant for source level debugging (including disassembled source code listing with &quot;objdump -S *.debug&quot;).

As of commit bbd30066e137, minimally the IA32X64 variant of OVMF no longer builds for the NOOPT target, when several -D features are enabled. DXE phase components no longer fit. Raising the DXEFV size to 13MB solves the problem.

Refer to commits d272449d9e1e (&quot;OvmfPkg: raise DXEFV size to 11 MB&quot;, 2018-05-29), and 5e75c4d1fe4f (&quot;OvmfPkg: raise DXEFV size to 12 MB&quot;, 2020-03-11).

Keeping with the same cadence, it&apos;s been again ~1.75 years, so it&apos;s time to bump the DXEFV size.

Note that the DXEFV sizes in the various OvmfPkg platform FDF files are not uniform. &quot;BhyveX64.fdf&quot; is at 11MB, &quot;OvmfXen.fdf&quot; is at 10MB.

The &quot;AmdSevX64.fdf&quot;, &quot;CloudHvX64.fdf&quot;, &quot;IntelTdxX64.fdf&quot; and &quot;MicrovmX64.fdf&quot; files specify 12 MB for DXEFV, so in theory they could be affected, but I don&apos;t build or use those platforms, so I cannot comment on them.

The direct request is therefore to increase the DXEFV size to 13MB in the traditional OVMF platforms (IA32, IA32X64, X64).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20417</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-03 10:04:24 +0000</bug_when>
    <thetext>[PATCH 0/4] fixes for BZs 3876, 4235, 4236
Message-Id: &lt;20230103150244.66835-1-lersek@redhat.com&gt;
https://listman.redhat.com/archives/edk2-devel-archive/2023-January/057171.html
https://edk2.groups.io/g/devel/message/97873</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20464</commentid>
    <comment_count>2</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-01-04 04:45:36 +0000</bug_when>
    <thetext>Fix merged as part of #3852</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20480</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-04 07:59:46 +0000</bug_when>
    <thetext>(commit d452feedf21416320c44a6a3758b6c2d9b6ce2f6)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20496</commentid>
    <comment_count>4</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-01-05 02:22:47 +0000</bug_when>
    <thetext>[PATCH V1 1/1] OvmfPkg/IntelTdxX64: Raise DXEFV size to 13MB
https://edk2.groups.io/g/devel/message/97975</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4102</bug_id>
          
          <creation_ts>2022-10-11 01:44:22 +0000</creation_ts>
          <short_desc>CryptoPkg: Add EC key retrieving and signature interface</short_desc>
          <delta_ts>2022-10-12 02:56:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="qi1.zhang@intel.com">qi1.zhang</reporter>
          <assigned_to name="qi1.zhang@intel.com">qi1.zhang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19736</commentid>
    <comment_count>0</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-10-11 01:44:22 +0000</bug_when>
    <thetext>Add EC key retrieving (from PEM &amp; X509) and signature interface</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19737</commentid>
    <comment_count>1</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-10-11 01:44:46 +0000</bug_when>
    <thetext>Work in progress</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19761</commentid>
    <comment_count>2</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-10-12 02:56:45 +0000</bug_when>
    <thetext>merged in https://github.com/tianocore/edk2/pull/3469</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4739</bug_id>
          
          <creation_ts>2024-03-27 06:12:03 +0000</creation_ts>
          <short_desc>TLS HandShake Error in KMIP server.</short_desc>
          <delta_ts>2024-06-03 00:03:22 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>sountharyan</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22821</commentid>
    <comment_count>0</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-03-27 06:12:03 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com, 
@emcmillan@microsoft.com, 
@mikuback@linux.microsoft.com,
@guomin.jiang@intel.com,
@jian.j.wang@intel.com,
@jiewen.yao@intel.com,
@xiaoyu1.lu@intel.com

We are facing handshake error in CryptoPkg from edk2-stable-202308 release tag, while communicating with KMIP server. We are currently using Openssl 3.x series. Below is the error, which we are currently facing,


TlsDoHandshake SSL_HANDSHAKE_ERROR State=0x10 SSL_ERROR_SSL
TlsDoHandshake ERROR 0x308010C=L6:R8010C
TlsDoHandshake ERROR 0xA0C0103=L14:RC0103


Kindly provide your comments ASAP to resolve this error.

cc: @karthikar@ami.com, @gayathrit@ami.com, @srinivasanm@ami.com

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22823</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-27 21:54:59 +0000</bug_when>
    <thetext>Is it a regression? have you tested it with edk2-stable-202305？
And please share you test code or detailed Tls handshake messages.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22825</commentid>
    <comment_count>2</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-03-27 22:57:57 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

Yes, we tested with edk2-stable-202305. We are not facing this issue.

TlsDoHandshake SSL_HANDSHAKE_ERROR State=0x10 SSL_ERROR_SSL
TlsDoHandshake ERROR 0x308010C=L6:R8010C
TlsDoHandshake ERROR 0xA0C0103=L14:RC0103

L6 - EVP library
R8010C - ERR_R_UNSUPPORTED

L14 - ERR_LIB_SSL from ssl Lib
RC0103 - SSL_R_UNSUPPORTED_SSL_VERSION

After checking code found that error might have occurred from below code (evp_fetch.c). edk2-stable-202305, CryptoPkg is not consuming this file, so we couldn&apos;t face this error. 

if ((name_id != 0 || name != NULL) &amp;&amp; method == NULL) {
int code = unsupported ? ERR_R_UNSUPPORTED : ERR_R_FETCH_FAILED;

if (name == NULL)
name = ossl_namemap_num2name(namemap, name_id, 0);
ERR_raise_data(ERR_LIB_EVP, code,
&quot;%s, Algorithm (%s : %d), Properties (%s)&quot;,
ossl_lib_ctx_get_descriptor(methdata-&gt;libctx),
name == NULL ? &quot;&lt;null&gt;&quot; : name, name_id,
properties == NULL ? &quot;&lt;null&gt;&quot; : properties);
}

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22826</commentid>
    <comment_count>3</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-27 23:11:29 +0000</bug_when>
    <thetext>Currently I don&apos;t get enough information from your comments.
Please share more detailed info of your tls config, such as:
Tls version, cipher suite, complete Tls handshake message...

I have some suspicion that this problem is related to the usage of an unsupported crypto algorithm. You can try to apply this patch:

and check if there are some log related to &apos;&apos;skipping CipherId=&apos;&apos;.
Please note it is DEBUG_VERBOSE log, you can change it to DEBUG_INFO if you cannot see VERBOSE log.

TlsSetCipherList {
...
    if (StackIdx == sk_SSL_CIPHER_num (OpensslCipherStack)) {
      DEBUG ((
        DEBUG_VERBOSE,
        &quot;%a:%a: skipping CipherId=0x%04x\n&quot;,</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22827</commentid>
    <comment_count>4</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-27 23:35:18 +0000</bug_when>
    <thetext>(In reply to yi1.li@intel.com from comment #3)
&gt; Currently I don&apos;t get enough information from your comments.
&gt; Please share more detailed info of your tls config, such as:
&gt; Tls version, cipher suite, complete Tls handshake message...
&gt; 
&gt; I have some suspicion that this problem is related to the usage of an
&gt; unsupported crypto algorithm. You can try to apply this patch:

Missed patch link here:
https://github.com/tianocore/edk2/commit/4ddd8ac3a29d9c5974a19f36c1dc5896d813dc6e

&gt; and check if there are some log related to &apos;&apos;skipping CipherId=&apos;&apos;.
&gt; Please note it is DEBUG_VERBOSE log, you can change it to DEBUG_INFO if you
&gt; cannot see VERBOSE log.
&gt; 
&gt; TlsSetCipherList {
&gt; ...
&gt;     if (StackIdx == sk_SSL_CIPHER_num (OpensslCipherStack)) {
&gt;       DEBUG ((
&gt;         DEBUG_VERBOSE,
&gt;         &quot;%a:%a: skipping CipherId=0x%04x\n&quot;,</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22828</commentid>
    <comment_count>5</comment_count>
      <attachid>1486</attachid>
    <who name="">sountharyan</who>
    <bug_when>2024-03-28 00:37:59 +0000</bug_when>
    <thetext>Created attachment 1486
Tls debug messages Log

Hi @yi1.li@intel.com,

I added few debug messages and here I have updated. 

I used DEBUG_ERROR, still I couldn&apos;t see any messages.

if (StackIdx == sk_SSL_CIPHER_num (OpensslCipherStack)) {
      DEBUG ((
        DEBUG_ERROR,
        &quot;%a:%a: skipping CipherId=0x%04x\n&quot;,


Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22829</commentid>
    <comment_count>6</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-03-28 00:42:45 +0000</bug_when>
    <thetext>(In reply to sountharyan from comment #5)
&gt; Created attachment 1486 [details]
&gt; Tls debug messages Log
&gt; 
&gt; Hi @yi1.li@intel.com,
&gt; 
&gt; I added few debug messages and here I have updated. 
&gt; Both server and client are using TLS 1.2 version. 
  Cipher suite: TLS_RSA_WITH_AES_256_CBC_SHA256

&gt; I used DEBUG_ERROR, still I couldn&apos;t see any messages.
&gt; 
&gt; if (StackIdx == sk_SSL_CIPHER_num (OpensslCipherStack)) {
&gt;       DEBUG ((
&gt;         DEBUG_ERROR,
&gt;         &quot;%a:%a: skipping CipherId=0x%04x\n&quot;,
&gt; 
&gt; 
&gt; Thanks,
&gt; Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22830</commentid>
    <comment_count>7</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-28 00:58:37 +0000</bug_when>
    <thetext>Thanks for your log, it is clear and useful.
Please try to add aes256-sha256 cipher to uefiprov.c L127, I think this will solve your problem.

static const OSSL_ALGORITHM_CAPABLE deflt_ciphers[] = {
...

    ALG(PROV_NAMES_AES_256_GCM, ossl_aes256gcm_functions),
    ALG(PROV_NAMES_AES_192_GCM, ossl_aes192gcm_functions),
    ALG(PROV_NAMES_AES_128_GCM, ossl_aes128gcm_functions),

    +ALGC(PROV_NAMES_AES_128_CBC_HMAC_SHA256, ossl_aes128cbc_hmac_sha256_functions,
        ossl_cipher_capable_aes_cbc_hmac_sha256),
    +ALGC(PROV_NAMES_AES_256_CBC_HMAC_SHA256, ossl_aes256cbc_hmac_sha256_functions,
         ossl_cipher_capable_aes_cbc_hmac_sha256),
    { { NULL, NULL, NULL }, NULL }
};</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22831</commentid>
    <comment_count>8</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-03-28 03:25:34 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

    //ALGC(PROV_NAMES_AES_256_CBC_HMAC_SHA256, ossl_aes256cbc_hmac_sha256_functions,
      //    ossl_cipher_capable_aes_cbc_hmac_sha256),
    ALG(PROV_NAMES_AES_256_CBC_HMAC_SHA256, ossl_aes256cbc_hmac_sha256_functions),

Tried both ways, but still, it returns same error.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22832</commentid>
    <comment_count>9</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-28 03:37:45 +0000</bug_when>
    <thetext>Sounds strange, have you tried OpensslLibAccel.inf?

Anyway, I think this is indeed a problem because AES256-SHA256 is a Tls1.2 suite so we should continue to support it, change status to CONFIRMED.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22833</commentid>
    <comment_count>10</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-28 04:05:17 +0000</bug_when>
    <thetext>I don&apos;t have a good way to reproduce this problem locally, so please help capture the details of SSL_SESSION-&gt;cipher when the error occurs:
ssl_cipher_get_evp()
s-&gt;cipher-&gt;
     const char *name; /* text name */
     uint32_t id; /* id, 4 bytes, first is version */
     uint32_t algorithm_mkey; /* key exchange algorithm */
     uint32_t algorithm_auth; /* server authentication */
     uint32_t algorithm_enc; /* symmetric encryption */
     uint32_t algorithm_mac; /* symmetric authentication */</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22834</commentid>
    <comment_count>11</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-28 04:32:25 +0000</bug_when>
    <thetext>(In reply to yi1.li@intel.com from comment #7)
&gt; Thanks for your log, it is clear and useful.
&gt; Please try to add aes256-sha256 cipher to uefiprov.c L127, I think this will
&gt; solve your problem.
&gt; 
&gt; static const OSSL_ALGORITHM_CAPABLE deflt_ciphers[] = {
&gt; ...
&gt; 
&gt;     ALG(PROV_NAMES_AES_256_GCM, ossl_aes256gcm_functions),
&gt;     ALG(PROV_NAMES_AES_192_GCM, ossl_aes192gcm_functions),
&gt;     ALG(PROV_NAMES_AES_128_GCM, ossl_aes128gcm_functions),
&gt; 
&gt;     +ALGC(PROV_NAMES_AES_128_CBC_HMAC_SHA256,
&gt; ossl_aes128cbc_hmac_sha256_functions,
&gt;         ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt;     +ALGC(PROV_NAMES_AES_256_CBC_HMAC_SHA256,
&gt; ossl_aes256cbc_hmac_sha256_functions,
&gt;          ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt;     { { NULL, NULL, NULL }, NULL }
&gt; };

also add -DAESNI_ASM to OpensslLibAccel/AccelFull.inf:
  DEFINE OPENSSL_FLAGS_IA32      = +-DAESNI_ASM -DAES_ASM
  DEFINE OPENSSL_FLAGS_X64       = +-DAESNI_ASM -DAES_ASM</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22847</commentid>
    <comment_count>12</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-02 02:34:00 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

 ssl_cipher_get_evp Cipher id:50331709 [TlsDxe]: 
 ssl_cipher_get_evp Cipher name:AES256-SHA256 [TlsDxe]: 
 ssl_cipher_get_evp Cipher mkey:1 [TlsDxe]: 
 ssl_cipher_get_evp Cipher auth:1[TlsDxe]: 
 ssl_cipher_get_evp Cipher enc:128 [TlsDxe]: 
 ssl_cipher_get_evp Cipher mac:16 [TlsDxe]:


Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22848</commentid>
    <comment_count>13</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-02 02:43:46 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

  DEFINE OPENSSL_FLAGS_IA32      = +-DAESNI_ASM -DAES_ASM
  DEFINE OPENSSL_FLAGS_X64       = +-DAESNI_ASM -DAES_ASM


Added above flags and also, we added asm related files in Openssllibfull and still we are getting same error.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22849</commentid>
    <comment_count>14</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-02 02:50:14 +0000</bug_when>
    <thetext>(In reply to sountharyan from comment #13)
&gt; Hi @yi1.li@intel.com,
&gt; 
&gt;   DEFINE OPENSSL_FLAGS_IA32      = +-DAESNI_ASM -DAES_ASM
&gt;   DEFINE OPENSSL_FLAGS_X64       = +-DAESNI_ASM -DAES_ASM
&gt; 
&gt; 
&gt; Added above flags and also, we added asm related files in Openssllibfull and
&gt; still we are getting same error.
&gt; 
&gt; Thanks,
&gt; Sountharya

Openssllibfull? AES256-SHA256 is a hw feature so it only supported by OpensslLibAccel and OpensslLibFullAccel lib. Could you check if using the correct Accel lib.
I don&apos;t recommend modifying OpensslLibFull to support AES ASM (from your description I assume you do this), since all openssl INFs are automatically generated by scripts and you might miss something.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22852</commentid>
    <comment_count>15</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-03 03:44:11 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com, 

Consuming OpensslLibFullAccel resolved the handshake error. Thanks for your support.

But below warning messages are printed.

OpensslLibFullAccel.lib(x86cpuid.obj) : warning LNK4210: .CRT section exists; there may be unhandled static initializers or terminators

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22853</commentid>
    <comment_count>16</comment_count>
      <attachid>1487</attachid>
    <who name="">sountharyan</who>
    <bug_when>2024-04-03 03:46:18 +0000</bug_when>
    <thetext>Created attachment 1487
warning_messages_Build_log</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22854</commentid>
    <comment_count>17</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-03 04:11:55 +0000</bug_when>
    <thetext>(In reply to yi1.li@intel.com from comment #7)

&gt; static const OSSL_ALGORITHM_CAPABLE deflt_ciphers[] = {
&gt; ...
&gt; 
&gt;     ALG(PROV_NAMES_AES_256_GCM, ossl_aes256gcm_functions),
&gt;     ALG(PROV_NAMES_AES_192_GCM, ossl_aes192gcm_functions),
&gt;     ALG(PROV_NAMES_AES_128_GCM, ossl_aes128gcm_functions),
&gt; 
&gt;     +ALGC(PROV_NAMES_AES_128_CBC_HMAC_SHA256,
&gt; ossl_aes128cbc_hmac_sha256_functions,
&gt;         ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt;     +ALGC(PROV_NAMES_AES_256_CBC_HMAC_SHA256,
&gt; ossl_aes256cbc_hmac_sha256_functions,
&gt;          ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt;     { { NULL, NULL, NULL }, NULL }
&gt; };

I think Accel lib still need this change to solve handshake issue, right?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22855</commentid>
    <comment_count>18</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-03 04:14:09 +0000</bug_when>
    <thetext>(In reply to sountharyan from comment #15)
&gt; Hi @yi1.li@intel.com, 
&gt; 
&gt; Consuming OpensslLibFullAccel resolved the handshake error. Thanks for your
&gt; support.
&gt; 
&gt; But below warning messages are printed.
&gt; 
&gt; OpensslLibFullAccel.lib(x86cpuid.obj) : warning LNK4210: .CRT section
&gt; exists; there may be unhandled static initializers or terminators
&gt; 
&gt; Thanks,
&gt; Sountharya

This is a harmless warning, and if I remember correctly it has existed since openssl1.1. Just ignore it</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22856</commentid>
    <comment_count>19</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-03 04:24:22 +0000</bug_when>
    <thetext>(In reply to yi1.li@intel.com from comment #17)
&gt; (In reply to yi1.li@intel.com from comment #7)
&gt; 
&gt; &gt; static const OSSL_ALGORITHM_CAPABLE deflt_ciphers[] = {
&gt; &gt; ...
&gt; &gt; 
&gt; &gt;     ALG(PROV_NAMES_AES_256_GCM, ossl_aes256gcm_functions),
&gt; &gt;     ALG(PROV_NAMES_AES_192_GCM, ossl_aes192gcm_functions),
&gt; &gt;     ALG(PROV_NAMES_AES_128_GCM, ossl_aes128gcm_functions),
&gt; &gt; 
&gt; &gt;     +ALGC(PROV_NAMES_AES_128_CBC_HMAC_SHA256,
&gt; &gt; ossl_aes128cbc_hmac_sha256_functions,
&gt; &gt;         ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt; &gt;     +ALGC(PROV_NAMES_AES_256_CBC_HMAC_SHA256,
&gt; &gt; ossl_aes256cbc_hmac_sha256_functions,
&gt; &gt;          ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt; &gt;     { { NULL, NULL, NULL }, NULL }
&gt; &gt; };
&gt; 
&gt; I think Accel lib still need this change to solve handshake issue, right?

 yes, we added these changes too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22857</commentid>
    <comment_count>20</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-03 04:26:54 +0000</bug_when>
    <thetext>(In reply to yi1.li@intel.com from comment #18)
&gt; (In reply to sountharyan from comment #15)
&gt; &gt; Hi @yi1.li@intel.com, 
&gt; &gt; 
&gt; &gt; Consuming OpensslLibFullAccel resolved the handshake error. Thanks for your
&gt; &gt; support.
&gt; &gt; 
&gt; &gt; But below warning messages are printed.
&gt; &gt; 
&gt; &gt; OpensslLibFullAccel.lib(x86cpuid.obj) : warning LNK4210: .CRT section
&gt; &gt; exists; there may be unhandled static initializers or terminators
&gt; &gt; 
&gt; &gt; Thanks,
&gt; &gt; Sountharya
&gt; 
&gt; This is a harmless warning, and if I remember correctly it has existed since
&gt; openssl1.1. Just ignore it


Okay. Thanks for your comments.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22858</commentid>
    <comment_count>21</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-03 04:32:02 +0000</bug_when>
    <thetext>(In reply to sountharyan from comment #19)
&gt; (In reply to yi1.li@intel.com from comment #17)
&gt; &gt; (In reply to yi1.li@intel.com from comment #7)
&gt; &gt; 
&gt; &gt; &gt; static const OSSL_ALGORITHM_CAPABLE deflt_ciphers[] = {
&gt; &gt; &gt; ...
&gt; &gt; &gt; 
&gt; &gt; &gt;     ALG(PROV_NAMES_AES_256_GCM, ossl_aes256gcm_functions),
&gt; &gt; &gt;     ALG(PROV_NAMES_AES_192_GCM, ossl_aes192gcm_functions),
&gt; &gt; &gt;     ALG(PROV_NAMES_AES_128_GCM, ossl_aes128gcm_functions),
&gt; &gt; &gt; 
&gt; &gt; &gt;     +ALGC(PROV_NAMES_AES_128_CBC_HMAC_SHA256,
&gt; &gt; &gt; ossl_aes128cbc_hmac_sha256_functions,
&gt; &gt; &gt;         ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt; &gt; &gt;     +ALGC(PROV_NAMES_AES_256_CBC_HMAC_SHA256,
&gt; &gt; &gt; ossl_aes256cbc_hmac_sha256_functions,
&gt; &gt; &gt;          ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt; &gt; &gt;     { { NULL, NULL, NULL }, NULL }
&gt; &gt; &gt; };
&gt; &gt; 
&gt; &gt; I think Accel lib still need this change to solve handshake issue, right?
&gt; 
&gt;  yes, we added these changes too and also added -DAESNI_ASM flags.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22859</commentid>
    <comment_count>22</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-03 04:44:54 +0000</bug_when>
    <thetext>(In reply to sountharyan from comment #21)
&gt; (In reply to sountharyan from comment #19)
&gt; &gt; (In reply to yi1.li@intel.com from comment #17)
&gt; &gt; &gt; (In reply to yi1.li@intel.com from comment #7)
&gt; &gt; &gt; 
&gt; &gt; &gt; &gt; static const OSSL_ALGORITHM_CAPABLE deflt_ciphers[] = {
&gt; &gt; &gt; &gt; ...
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt;     ALG(PROV_NAMES_AES_256_GCM, ossl_aes256gcm_functions),
&gt; &gt; &gt; &gt;     ALG(PROV_NAMES_AES_192_GCM, ossl_aes192gcm_functions),
&gt; &gt; &gt; &gt;     ALG(PROV_NAMES_AES_128_GCM, ossl_aes128gcm_functions),
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt;     +ALGC(PROV_NAMES_AES_128_CBC_HMAC_SHA256,
&gt; &gt; &gt; &gt; ossl_aes128cbc_hmac_sha256_functions,
&gt; &gt; &gt; &gt;         ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt; &gt; &gt; &gt;     +ALGC(PROV_NAMES_AES_256_CBC_HMAC_SHA256,
&gt; &gt; &gt; &gt; ossl_aes256cbc_hmac_sha256_functions,
&gt; &gt; &gt; &gt;          ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt; &gt; &gt; &gt;     { { NULL, NULL, NULL }, NULL }
&gt; &gt; &gt; &gt; };
&gt; &gt; &gt; 
&gt; &gt; &gt; I think Accel lib still need this change to solve handshake issue, right?
&gt; &gt; 
&gt; &gt;  yes, we added these changes too and also added -DAESNI_ASM flags.

I checked code again -DAESNI_ASM is unnecessary, my bad please ignore it.
Would you like send patch to edk2 community to fix this issue by email?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22860</commentid>
    <comment_count>23</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-03 04:49:26 +0000</bug_when>
    <thetext>(In reply to yi1.li@intel.com from comment #22)
&gt; (In reply to sountharyan from comment #21)
&gt; &gt; (In reply to sountharyan from comment #19)
&gt; &gt; &gt; (In reply to yi1.li@intel.com from comment #17)
&gt; &gt; &gt; &gt; (In reply to yi1.li@intel.com from comment #7)
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; static const OSSL_ALGORITHM_CAPABLE deflt_ciphers[] = {
&gt; &gt; &gt; &gt; &gt; ...
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt;     ALG(PROV_NAMES_AES_256_GCM, ossl_aes256gcm_functions),
&gt; &gt; &gt; &gt; &gt;     ALG(PROV_NAMES_AES_192_GCM, ossl_aes192gcm_functions),
&gt; &gt; &gt; &gt; &gt;     ALG(PROV_NAMES_AES_128_GCM, ossl_aes128gcm_functions),
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt;     +ALGC(PROV_NAMES_AES_128_CBC_HMAC_SHA256,
&gt; &gt; &gt; &gt; &gt; ossl_aes128cbc_hmac_sha256_functions,
&gt; &gt; &gt; &gt; &gt;         ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt; &gt; &gt; &gt; &gt;     +ALGC(PROV_NAMES_AES_256_CBC_HMAC_SHA256,
&gt; &gt; &gt; &gt; &gt; ossl_aes256cbc_hmac_sha256_functions,
&gt; &gt; &gt; &gt; &gt;          ossl_cipher_capable_aes_cbc_hmac_sha256),
&gt; &gt; &gt; &gt; &gt;     { { NULL, NULL, NULL }, NULL }
&gt; &gt; &gt; &gt; &gt; };
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I think Accel lib still need this change to solve handshake issue, right?
&gt; &gt; &gt; 
&gt; &gt; &gt;  yes, we added these changes too and also added -DAESNI_ASM flags.
&gt; 
&gt; I checked code again -DAESNI_ASM is unnecessary, my bad please ignore it.
&gt; Would you like send patch to edk2 community to fix this issue by email?


Sure, I will send the patch to edk2 community.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22861</commentid>
    <comment_count>24</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-03 10:45:18 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

While consuming OpensslLibFullAccel.inf, met an error like to include .inc files.
.inc files consumes .pl (perl files). perl files are not supported with our side. Whether .inc files are necessary or not. kindly provide your comments


&quot;providers/implementations/ciphers/cipher_aes_hw_aesni.inc&quot;
&quot;providers/implementations/ciphers/cipher_aes_ccm_hw_aesni.inc&quot;
&quot;providers/implementations/ciphers/cipher_aes_gcm_hw_aesni.inc&quot;
&quot;providers/implementations/ciphers/cipher_aes_gcm_hw_vaes_avx512.inc&quot;

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22865</commentid>
    <comment_count>25</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-04 01:30:37 +0000</bug_when>
    <thetext>(In reply to sountharyan from comment #24)
&gt; Hi @yi1.li@intel.com,
&gt; 
&gt; While consuming OpensslLibFullAccel.inf, met an error like to include .inc
&gt; files.
&gt; .inc files consumes .pl (perl files). perl files are not supported with our side. Whether .inc files are necessary or not. without adding this files handshake error is resolved.
kindly provide your comments ASAP.
&gt; 
&gt; &quot;providers/implementations/ciphers/cipher_aes_hw_aesni.inc&quot;
&gt; &quot;providers/implementations/ciphers/cipher_aes_ccm_hw_aesni.inc&quot;
&gt; &quot;providers/implementations/ciphers/cipher_aes_gcm_hw_aesni.inc&quot;
&gt; &quot;providers/implementations/ciphers/cipher_aes_gcm_hw_vaes_avx512.inc&quot;
&gt; 
&gt; Thanks,
&gt; Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22878</commentid>
    <comment_count>26</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-06 21:16:18 +0000</bug_when>
    <thetext>Sorry I just come back from PRC holidays.

inc file is similar to .h file, it does not depend on any pl script.
I don&apos;t quite understand your question, I don&apos;t think you need to make any changes to the OpensslLibFullAccel.inf like &apos;adding inc files&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22881</commentid>
    <comment_count>27</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-08 00:58:38 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

Below build error we faced while consuming OpensslLibFullAccel lib. To avoid this error we commented out few .inc files. We have a doubt on, we really need .inc files? 


OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved external symbol ossl_vaes_vpclmulqdq_capable
OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved external symbol ossl_aes_gcm_finalize_avx512
OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved external symbol ossl_aes_gcm_decrypt_avx512
OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved external symbol ossl_aes_gcm_update_aad_avx512
OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved external symbol ossl_aes_gcm_setiv_avx512
OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved external symbol ossl_aes_gcm_init_avx512
OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved external symbol ossl_aes_gcm_encrypt_avx512
OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved external symbol ossl_gcm_gmult_avx512

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22882</commentid>
    <comment_count>28</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-08 01:00:30 +0000</bug_when>
    <thetext>(In reply to sountharyan from comment #27)
&gt; Hi @yi1.li@intel.com,
&gt; 
&gt; Below build error we faced while consuming OpensslLibFullAccel lib. To avoid
&gt; this error we commented out few .inc files. We have a doubt on, Is inc files are really needed.
&gt; 
&gt; 
&gt; OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved
&gt; external symbol ossl_vaes_vpclmulqdq_capable
&gt; OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved
&gt; external symbol ossl_aes_gcm_finalize_avx512
&gt; OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved
&gt; external symbol ossl_aes_gcm_decrypt_avx512
&gt; OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved
&gt; external symbol ossl_aes_gcm_update_aad_avx512
&gt; OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved
&gt; external symbol ossl_aes_gcm_setiv_avx512
&gt; OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved
&gt; external symbol ossl_aes_gcm_init_avx512
&gt; OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved
&gt; external symbol ossl_aes_gcm_encrypt_avx512
&gt; OpensslLibFullAccel.lib(cipher_aes_gcm_hw.obj) : error LNK2001: unresolved
&gt; external symbol ossl_gcm_gmult_avx512
&gt; 
&gt; Thanks,
&gt; Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22883</commentid>
    <comment_count>29</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-08 01:09:42 +0000</bug_when>
    <thetext>Are you using right openssl version 3.0.9?
AVX512 introduced in openssl3.2, but edk2 only compatible with 3.0.9 currently. and 3.0.9 dont have avx512 related files.

Please goto &apos;&apos;edk2\CryptoPkg\Library\OpensslLib\openssl&apos;&apos; and run &apos;&apos;git log&apos;&apos;, the correct commit id should be: de90e54bbe82e5be4fb9608b6f5c308bb837d355   Prepare for release of 3.0.9</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22884</commentid>
    <comment_count>30</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-08 01:14:58 +0000</bug_when>
    <thetext>(In reply to yi1.li@intel.com from comment #29)
&gt; Are you using right openssl version 3.0.9?
&gt; AVX512 introduced in openssl3.2, but edk2 only compatible with 3.0.9
&gt; currently. and 3.0.9 dont have avx512 related files.
&gt; 
&gt; Please goto &apos;&apos;edk2\CryptoPkg\Library\OpensslLib\openssl&apos;&apos; and run &apos;&apos;git
&gt; log&apos;&apos;, the correct commit id should be:
&gt; de90e54bbe82e5be4fb9608b6f5c308bb837d355   Prepare for release of 3.0.9


We are using openssl 3.1.4 version</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22885</commentid>
    <comment_count>31</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-08 01:19:49 +0000</bug_when>
    <thetext>I see. The default version in EDK2 is openssl3.0.9, any other higher version has not been verified. I believe this problem will go away if continue to use default version.
If you need to upgrade the openssl version, please submit another BZ.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22913</commentid>
    <comment_count>32</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-16 02:19:15 +0000</bug_when>
    <thetext>Hi yi1.li@intel.com,

Is CryptoPkg maximum supported version is TLS 1.2? 
TLS 1.3 is not supported in EDK2 CryptoPkg. Is our understanding correct.

#define TLS10_PROTOCOL_VERSION_MAJOR  0x03
#define TLS10_PROTOCOL_VERSION_MINOR  0x01
#define TLS11_PROTOCOL_VERSION_MAJOR  0x03
#define TLS11_PROTOCOL_VERSION_MINOR  0x02
#define TLS12_PROTOCOL_VERSION_MAJOR  0x03
#define TLS12_PROTOCOL_VERSION_MINOR  0x03

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22921</commentid>
    <comment_count>33</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-17 05:21:59 +0000</bug_when>
    <thetext>(In reply to sountharyan from comment #32)
&gt; Hi yi1.li@intel.com, Laszlo Ersek &lt;lersek@redhat.com&gt;
&gt; 
&gt; Is CryptoPkg maximum supported version is TLS 1.2? 
&gt; TLS 1.3 is not supported in EDK2 CryptoPkg. Is our understanding correct.
&gt; 
&gt; #define TLS10_PROTOCOL_VERSION_MAJOR  0x03
&gt; #define TLS10_PROTOCOL_VERSION_MINOR  0x01
&gt; #define TLS11_PROTOCOL_VERSION_MAJOR  0x03
&gt; #define TLS11_PROTOCOL_VERSION_MINOR  0x02
&gt; #define TLS12_PROTOCOL_VERSION_MAJOR  0x03
&gt; #define TLS12_PROTOCOL_VERSION_MINOR  0x03
&gt; 
&gt; Thanks,
&gt; Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23087</commentid>
    <comment_count>34</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-06-03 00:03:22 +0000</bug_when>
    <thetext>pushed: https://github.com/tianocore/edk2/commit/746cc5cc40bef22d606cd22d1feb10d73a7b3d11</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1486</attachid>
            <date>2024-03-28 00:37:59 +0000</date>
            <delta_ts>2024-03-28 00:37:59 +0000</delta_ts>
            <desc>Tls debug messages Log</desc>
            <filename>CryptoPkg_Log.txt</filename>
            <type>text/plain</type>
            <size>116347</size>
            <attacher>sountharyan</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1487</attachid>
            <date>2024-04-03 03:46:18 +0000</date>
            <delta_ts>2024-04-03 03:46:18 +0000</delta_ts>
            <desc>warning_messages_Build_log</desc>
            <filename>Warning_log.txt</filename>
            <type>text/plain</type>
            <size>212181</size>
            <attacher>sountharyan</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4584</bug_id>
          
          <creation_ts>2023-11-01 03:37:30 +0000</creation_ts>
          <short_desc>Add LoongArch common library and virtual machine to edk2</short_desc>
          <delta_ts>2024-07-04 03:25:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ArmVirtPkg</cf_package>
    
    <cf_package>EmbeddedPkg</cf_package>
    
    <cf_package>MdePkg</cf_package>
    
    <cf_package>OvmfPkg</cf_package>
    
    <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22112</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-11-01 03:37:30 +0000</bug_when>
    <thetext>Add LoongArch common library and drivers into MdePkg and UefiCpuPkg, such as FPU, exception, CPUCFG, CPUTimer, MMU, MP, CpuDxe etc.
Add LoongArch virtual machine to OvmfPkg named LoongArchVirt, which carried private libraries and drivers.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22113</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-11-01 03:41:09 +0000</bug_when>
    <thetext>I&apos;m doing this work.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22172</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-11-21 09:05:57 +0000</bug_when>
    <thetext>Patches on the list:

[edk2-devel] [PATCH v1 00/29] Enable LoongArch virtual machine in edk2
msgid &lt;20231103010302.4052990-1-lichao@loongson.cn&gt;
https://edk2.groups.io/g/devel/message/110582

[edk2-devel] [PATCH v2 00/30] Enable LoongArch virtual machine in edk2
msgid &lt;20231106032521.2251143-1-lichao@loongson.cn&gt;
https://edk2.groups.io/g/devel/message/110704

[edk2-devel] [PATCH v3 00/39] Enable LoongArch virtual machine in edk2
msgid &lt;20231117095742.3605778-1-lichao@loongson.cn&gt;
https://edk2.groups.io/g/devel/message/111353
msgid &lt;20231117095844.3607074-1-lichao@loongson.cn&gt;
https://edk2.groups.io/g/devel/message/111354</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23175</commentid>
    <comment_count>3</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-07-04 03:25:36 +0000</bug_when>
    <thetext>All of the code has been merged, closing this issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4441</bug_id>
          
          <creation_ts>2023-05-03 11:32:14 +0000</creation_ts>
          <short_desc>EFI_RNG_PROTOCOL Describe the DRBG algorithm used in the Arm RNDR instruction.</short_desc>
          <delta_ts>2023-10-26 16:31:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jose Marinho">Jose.Marinho</reporter>
          <assigned_to name="Jose Marinho">Jose.Marinho</assigned_to>
          <cc>ardb</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>pierre.gondois</cc>
    
    <cc>samer.el-haj-mahmoud</cc>
    
    <cc>sami.mujawar</cc>
          
          <cf_industrystandardspecifications>UEFI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21472</commentid>
    <comment_count>0</comment_count>
      <attachid>1364</attachid>
    <who name="Jose Marinho">Jose.Marinho</who>
    <bug_when>2023-05-03 11:32:14 +0000</bug_when>
    <thetext>Created attachment 1364
ECR_Arm_RNDR_GUID_EFI_RNG_PROTOCOL_v1

Enable the EFI_RNG_PROTOCOL implementation to correctly describe the DRBG algorithm when the protocol implementation exposes the output of the Arm RNDR instruction via the GetRNG.

The exact DRBG algorithm that outputs to the RNDR instruction is not mandated by the Arm Architecture.
This ECR introduces a default value to describe an Arm RNDR DRBG implementation (EFI_RNG_ALGORITHM_ARM_RNDR).
The Host FW port is expected to override the default value with the concrete DRBG algorithm.

A guest FW should be platform-agnostic, and hence it may need to resort to the default EFI_RNG_ALGORITHM_ARM_RNDR.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21518</commentid>
    <comment_count>1</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2023-05-09 09:55:26 +0000</bug_when>
    <thetext>Corresponding USWG ECR: https://mantis.uefi.org/mantis/view.php?id=2386</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21526</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 21:41:52 +0000</bug_when>
    <thetext>Jose Marinho has worked on spec change.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21946</commentid>
    <comment_count>3</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2023-09-29 04:59:27 +0000</bug_when>
    <thetext>Related to the bugzilla:
https://edk2.groups.io/g/devel/topic/100684678#107709</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22068</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:31:56 +0000</bug_when>
    <thetext>Apparently fixed within commit range 2ce5ae43c216..ff7ddc02b273.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1364</attachid>
            <date>2023-05-03 11:32:14 +0000</date>
            <delta_ts>2023-05-03 11:32:14 +0000</delta_ts>
            <desc>ECR_Arm_RNDR_GUID_EFI_RNG_PROTOCOL_v1</desc>
            <filename>Arm_RNDR_GUID_EFI_RNG_PROTOCOL.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>51969</size>
            <attacher name="Jose Marinho">Jose.Marinho</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4282</bug_id>
          
          <creation_ts>2023-01-09 09:08:00 +0000</creation_ts>
          <short_desc>Platform Redfish Host Interface library for USBNIC</short_desc>
          <delta_ts>2023-04-17 21:23:39 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20553</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-01-09 09:08:00 +0000</bug_when>
    <thetext>Implement the platform Redfish host interface library that
uses IPMI commands to get the network information of 
BMC-exposed USB NIC; for building up the SMBIOS type 42
record.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20582</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-10 21:37:46 +0000</bug_when>
    <thetext>Abner will take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21372</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-17 21:23:39 +0000</bug_when>
    <thetext>Fix at f8fb208a-b7a8264a</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4128</bug_id>
          
          <creation_ts>2022-10-28 05:10:05 +0000</creation_ts>
          <short_desc>Make FspHelper.nasm to be shareable with other drivers</short_desc>
          <delta_ts>2024-02-01 07:04:10 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>ted.kuo</reporter>
          <assigned_to>ted.kuo</assigned_to>
          <cc>amy.chan</cc>
    
    <cc>chasel.chiu</cc>
    
    <cc>chinni.b.duggapu</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19865</commentid>
    <comment_count>0</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2022-10-28 05:10:05 +0000</bug_when>
    <thetext>The functions in FspHelper.nasm can be used by other drivers. Moving FspHelper.nasm to a new library called BaseFspHelperLib so that the functions can be shared with other drivers.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19901</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-01 21:44:19 +0000</bug_when>
    <thetext>Ted: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22492</commentid>
    <comment_count>2</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2024-02-01 06:59:09 +0000</bug_when>
    <thetext>SHA-1: 03a69eb9f4e2a74704a1e6ee9a2c20db275f865d

* MinPlatformPkg: Support SecFspWrapperPlatformSecLib in X64

https://bugzilla.tianocore.org/show_bug.cgi?id=4623
1.Added PeiCoreEntry.nasm, SecEntry.nasm and Stack.nasm for X64.
2.Made changes in common files to support both IA32 and X64.
3.Added the PCDs below for FSP-T UPD revisions and reset vector in FSP.
 - PcdFspWrapperResetVectorInFsp
 - PcdFspWrapperBfvforResetVectorInFsp
 - PcdFsptUpdHeaderRevision
 - PcdFsptArchUpdRevision

Reviewed-by: Sai Chaganty &lt;rangasai.v.chaganty@intel.com&gt;
Cc: Chasel Chiu &lt;chasel.chiu@intel.com&gt;
Reviewed-by: Nate DeSimone &lt;nathaniel.l.desimone@intel.com&gt;
Cc: Eric Dong &lt;eric.dong@intel.com&gt;
Reviewed-by: Ashraf Ali S &lt;ashraf.ali.s@intel.com&gt;
Cc: Chinni B Duggapu &lt;chinni.b.duggapu@intel.com&gt;
Cc: Liming Gao &lt;gaoliming@byosoft.com.cn&gt;
Signed-off-by: Ted Kuo &lt;ted.kuo@intel.com&gt;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22493</commentid>
    <comment_count>3</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2024-02-01 07:02:10 +0000</bug_when>
    <thetext>Please ignore comment#2.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22494</commentid>
    <comment_count>4</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2024-02-01 07:04:10 +0000</bug_when>
    <thetext>There is no use case to share the file with other drivers for now. Hence moved the ticket to won&apos;t fix.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4769</bug_id>
          
          <creation_ts>2024-04-26 05:20:15 +0000</creation_ts>
          <short_desc>Undefined behavior in SmiManage() - reading uninitialized variable</short_desc>
          <delta_ts>2024-05-13 05:53:12 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Grzegorz Trzebiatowski">grzegorz.trzebiatowski</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22988</commentid>
    <comment_count>0</comment_count>
    <who name="Grzegorz Trzebiatowski">grzegorz.trzebiatowski</who>
    <bug_when>2024-04-26 05:20:15 +0000</bug_when>
    <thetext>Problem is located in
https://github.com/tianocore/edk2/blob/c0dfe3ec1f364dbdaf6b241e01343e560b21dd03/MdeModulePkg/Core/PiSmmCore/Smi.c#L137

WillReturn variable is not initialized. In some code paths it is not assigned anything before being read at L251.

SmiManage called with HandlerType==NULL is supposed to execute all SMI root handlers. But if initial state of WillReturn happens to be non-zero, SmiManage will only execute the first root handler and will exit. Remaining root handlers are not executed, potentially leading to infinite SMI loop because there&apos;s no one to quiesce SMI.

Problem was introduced in commit 70892b13b28cdb0a10c82f3d3aca560a38dce5c9</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23023</commentid>
    <comment_count>1</comment_count>
    <who name="Grzegorz Trzebiatowski">grzegorz.trzebiatowski</who>
    <bug_when>2024-05-13 05:53:12 +0000</bug_when>
    <thetext>No longer an issue, fixed as side effect of https://github.com/intel-restricted/firmware.boot.uefi.iafw.externalmirror.edk2/commit/227b2abea0d4888381cc67106005f9614c382073</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4001</bug_id>
          
          <creation_ts>2022-07-19 15:16:27 +0000</creation_ts>
          <short_desc>Missing NULL check on allocating memory for FileName at in PosixFileSetInfo</short_desc>
          <delta_ts>2022-07-21 20:02:28 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Miki Shindo">miki.shindo</reporter>
          <assigned_to name="Miki Shindo">miki.shindo</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>miki.shindo</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>EmulatorPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19273</commentid>
    <comment_count>0</comment_count>
    <who name="Miki Shindo">miki.shindo</who>
    <bug_when>2022-07-19 15:16:27 +0000</bug_when>
    <thetext>NULL pointer check is missing on memory allocation of the size for FileName in ASCII string format at PosixFileSetInfo.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19280</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-07-19 21:38:25 +0000</bug_when>
    <thetext>Miki is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19321</commentid>
    <comment_count>2</comment_count>
      <attachid>1011</attachid>
    <who name="Miki Shindo">miki.shindo</who>
    <bug_when>2022-07-21 20:01:35 +0000</bug_when>
    <thetext>Created attachment 1011
Patch for adding NULL check on memory  allocation

This patch has been merged to EDK2 master.

https://github.com/tianocore/edk2/commit/7ef91af84c04b1e5a17631bd1811c9bc1945dfdc</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19322</commentid>
    <comment_count>3</comment_count>
    <who name="Miki Shindo">miki.shindo</who>
    <bug_when>2022-07-21 20:02:28 +0000</bug_when>
    <thetext>closing this ticket. The patch has been merged.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1011</attachid>
            <date>2022-07-21 20:01:35 +0000</date>
            <delta_ts>2022-07-21 20:01:35 +0000</delta_ts>
            <desc>Patch for adding NULL check on memory  allocation</desc>
            <filename>0001-EmulatorPkg-PosixFileSystem-Add-NULL-check-on-memory.patch</filename>
            <type>application/octet-stream</type>
            <size>1077</size>
            <attacher name="Miki Shindo">miki.shindo</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4612</bug_id>
          
          <creation_ts>2023-12-04 03:17:22 +0000</creation_ts>
          <short_desc>MinPlatformPkg : Remove PeiDxeTpmPlatformHierarchyLib</short_desc>
          <delta_ts>2023-12-05 21:14:47 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>chris.chiang</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>chasel.chiu</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>eric.dong</cc>
    
    <cc>gaoliming</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22216</commentid>
    <comment_count>0</comment_count>
    <who name="">chris.chiang</who>
    <bug_when>2023-12-04 03:17:22 +0000</bug_when>
    <thetext>Remove PeiDxeTpmPlatformHierarchyLib in Tcg/Library</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22218</commentid>
    <comment_count>1</comment_count>
    <who name="">chris.chiang</who>
    <bug_when>2023-12-04 22:26:46 +0000</bug_when>
    <thetext>Already pushed commit https://github.com/tianocore/edk2-platforms/commit/f446fff05003f69a4396b2ec375301ecb5f63a2a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22221</commentid>
    <comment_count>2</comment_count>
    <who name="">chris.chiang</who>
    <bug_when>2023-12-05 21:14:47 +0000</bug_when>
    <thetext>close the ticket</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4470</bug_id>
          
          <creation_ts>2023-05-26 04:30:34 +0000</creation_ts>
          <short_desc>SMM perf record is copied multiple times to FPDT table if multiple ReadyToBoot events are signaled</short_desc>
          <delta_ts>2023-10-26 16:06:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ray Ni">ray.ni</reporter>
          <assigned_to name="Dun Tan">dun.tan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21585</commentid>
    <comment_count>0</comment_count>
    <who name="Ray Ni">ray.ni</who>
    <bug_when>2023-05-26 04:30:34 +0000</bug_when>
    <thetext>During post, DxeCorePerformanceLib holds all DXE perf records and is also responsible for producing the FPDT ACPI table.

SmmCorePerformanceLib holds all SMM perf records, which are copied to DxeCorePerformanceLib at ReadyToBoot callback.

The issue is that when the records are copied to DXE memory from SMRAM, the source records in SMRAM are not cleared, resulting in the same data being copied again when the user re-enters UEFI Shell.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21597</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-30 21:44:27 +0000</bug_when>
    <thetext>Ray: can you point the specific source code for this issue?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21729</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:17:20 +0000</bug_when>
    <thetext>Dun: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22063</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:06:31 +0000</bug_when>
    <thetext>Fixed in commit 0c4d0b6c8a05a6a62c0dca042f8e15e579e6f4af.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4327</bug_id>
          
          <creation_ts>2023-01-26 16:10:41 +0000</creation_ts>
          <short_desc>Move Maintainers.txt to top level directory</short_desc>
          <delta_ts>2023-01-31 16:34:10 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Stuart Yoder">stuart.yoder</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>Abhi.Singh</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20923</commentid>
    <comment_count>0</comment_count>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2023-01-26 16:10:41 +0000</bug_when>
    <thetext>The edk2-test Maintainers file is buried under uefi-sct https://github.com/tianocore/edk2-test/blob/master/uefi-sct/Maintainers.txt. This is not consistent with other TianoCore repos (which place Maintainers in the top-level directory) and makes it harder for submitters to find.

Please move it one level up to https://github.com/tianocore/edk2-test</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20924</commentid>
    <comment_count>1</comment_count>
      <attachid>1304</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-01-26 17:59:08 +0000</bug_when>
    <thetext>Created attachment 1304
Proposed Patch to move Maintainers to top level of directory</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20969</commentid>
    <comment_count>2</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-01-31 16:34:10 +0000</bug_when>
    <thetext>The patch has been merged to edk2-test</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1304</attachid>
            <date>2023-01-26 17:59:08 +0000</date>
            <delta_ts>2023-01-26 17:59:08 +0000</delta_ts>
            <desc>Proposed Patch to move Maintainers to top level of directory</desc>
            <filename>0001-uefi-sct-Move-Maintainers.txt-to-top-level-directory.patch</filename>
            <type>text/plain</type>
            <size>982</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4150</bug_id>
          
          <creation_ts>2022-11-14 09:28:35 +0000</creation_ts>
          <short_desc>ASSERT in ArmTrngLib prevents normal boot</short_desc>
          <delta_ts>2022-11-15 21:37:58 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Pierre Gondois">pierre.gondois</reporter>
          <assigned_to name="Pierre Gondois">pierre.gondois</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ArmPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20012</commentid>
    <comment_count>0</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2022-11-14 09:28:35 +0000</bug_when>
    <thetext>GetArmTrngVersion() is used to check the presence of an Arm
Trng. If not found, an ASSERT prevents from booting in DEBUG
builds.
This assert should be removed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20027</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-15 21:37:58 +0000</bug_when>
    <thetext>It has been merged by https://github.com/tianocore/edk2/pull/3641</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4796</bug_id>
          
          <creation_ts>2024-06-24 23:07:18 +0000</creation_ts>
          <short_desc>UefiCpuPkg/ExceptionHandler: Fix a context error in LoongArch64</short_desc>
          <delta_ts>2024-06-25 21:25:16 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>qiandongyan</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23151</commentid>
    <comment_count>0</comment_count>
    <who name="">qiandongyan</who>
    <bug_when>2024-06-24 23:07:18 +0000</bug_when>
    <thetext>On the LoongArch platform:
  the a0 register can be used as both a function parameter and a return value.
    
Due to parameter EFI_SYSTEM_CONTEXT being overwritten by an invalid context address, when calling GetExceptionType, incorrect parameter address causes memory access exception.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23158</commentid>
    <comment_count>1</comment_count>
    <who name="">qiandongyan</who>
    <bug_when>2024-06-25 21:25:16 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5819</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4025</bug_id>
          
          <creation_ts>2022-08-22 03:14:19 +0000</creation_ts>
          <short_desc>CryptoPkg: Add HMAC-SHA384 cipher support</short_desc>
          <delta_ts>2022-09-23 03:03:37 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="qi1.zhang@intel.com">qi1.zhang</reporter>
          <assigned_to name="qi1.zhang@intel.com">qi1.zhang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19415</commentid>
    <comment_count>0</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-08-22 03:14:19 +0000</bug_when>
    <thetext>CryptoPkg: Add HMAC-SHA384 cipher support</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19416</commentid>
    <comment_count>1</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-08-22 03:15:32 +0000</bug_when>
    <thetext>CryptoPkg: Add HMAC-SHA384 cipher support.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19616</commentid>
    <comment_count>2</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-09-23 03:03:37 +0000</bug_when>
    <thetext>Merged in PR:
https://github.com/tianocore/edk2/pull/3385</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4642</bug_id>
          
          <creation_ts>2024-01-11 20:51:32 +0000</creation_ts>
          <short_desc>CryptoPkg: Clang build error: inttypes.h not found</short_desc>
          <delta_ts>2024-03-10 23:55:52 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to>wenxing.hou</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>wenxing.hou</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22353</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-11 20:51:32 +0000</bug_when>
    <thetext>Building ... /opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/IntrinsicLib/IntrinsicLib.inf [X64]
In file included from /opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/MbedTlsLib/mbedtls/library/ssl_client.c:31:
In file included from /opt/TCAgent/work/10830aecf937d0c7/Edk2/CryptoPkg/Library/MbedTlsLib/mbedtls/include/mbedtls/debug.h:124:
/home/sys_cr/llvm12/lib/clang/12.0.0/include/inttypes.h:21:15: fatal error: &apos;inttypes.h&apos; file not found
#include_next &lt;inttypes.h&gt;
              ^~~~~~~~~~~~
&quot;/home/sys_cr/llvm12/bin/clang&quot; -MMD -MF</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22354</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-01-11 20:52:28 +0000</bug_when>
    <thetext>Assigned to Wenxing</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22367</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-16 09:51:02 +0000</bug_when>
    <thetext>Please take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22768</commentid>
    <comment_count>3</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-10 23:55:52 +0000</bug_when>
    <thetext>Fixed by https://github.com/tianocore/edk2/commit/0c6d29be8b1731ff6880d59e0189184395e45968</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4494</bug_id>
          
          <creation_ts>2023-06-28 21:42:26 +0000</creation_ts>
          <short_desc>Remove assembly/tool logic that creates AP waking vector in 4G-20h</short_desc>
          <delta_ts>2023-10-26 16:41:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ray Ni">ray.ni</reporter>
          <assigned_to>zhiguang.liu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
    
    <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21703</commentid>
    <comment_count>0</comment_count>
    <who name="Ray Ni">ray.ni</who>
    <bug_when>2023-06-28 21:42:26 +0000</bug_when>
    <thetext>Today GenFv finds free 4K aligned space in FV for AP waking vector and updates 4G-20h to do a &quot;JMP&quot; to the 4K space.
There is no usage of this today. And the hardware might not support decoding the flash range under 1MB, then the AP waking vector cannot work.

We can remove the logic to avoid confusing and save spaces in reset vector.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21737</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:31:17 +0000</bug_when>
    <thetext>Zhiguang is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22074</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:41:24 +0000</bug_when>
    <thetext>apparently fixed in commit range 29cce3356aec..db38c7de64d4.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4353</bug_id>
          
          <creation_ts>2023-03-02 17:31:54 +0000</creation_ts>
          <short_desc>SEV-SNP AP creation fixes</short_desc>
          <delta_ts>2023-06-09 09:02:13 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>thomas.lendacky</reporter>
          <assigned_to>thomas.lendacky</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21140</commentid>
    <comment_count>0</comment_count>
    <who name="">thomas.lendacky</who>
    <bug_when>2023-03-02 17:31:54 +0000</bug_when>
    <thetext>Resolve some issues in the SEV-SNP AP creation support. Specifically:
- Due to a hardware erratum, a VM save area (VMSA) must not be allocated on
  a 2MB boundary. Work around this by allocating 2 pages and using the page
  that is not on a 2MB boundary and freeing the other.
- During transition to the OS, APs are parked. This happens after the memory
  map has been created and the allocation used during AP parking is not reflected
  in the map. Instead of allocation VMSAs each time an AP is started, re-use the
  existing VMSA.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21237</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-03-21 22:00:23 +0000</bug_when>
    <thetext>Tom will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21650</commentid>
    <comment_count>2</comment_count>
    <who name="">thomas.lendacky</who>
    <bug_when>2023-06-09 09:02:13 +0000</bug_when>
    <thetext>Patches merged as:
3323359a811a (&quot;UefiCpuPkg/MpInitLib: Reuse VMSA allocation to avoid unreserved allocation&quot;)
67a6f414aa0e (&quot;UefiCpuPkg/MpInitLib: Ensure SEV-SNP VMSA allocations are not 2MB aligned&quot;)</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4177</bug_id>
          
          <creation_ts>2022-11-30 03:06:16 +0000</creation_ts>
          <short_desc>evaluate the feasibility of using mbedtls as crypto library</short_desc>
          <delta_ts>2024-05-28 05:18:16 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>jiewen.yao</reporter>
          <assigned_to>wenxing.hou</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>mhaeuser</cc>
    
    <cc>timothy_hoppen</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20145</commentid>
    <comment_count>0</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-11-30 03:06:16 +0000</bug_when>
    <thetext>[Background]
According to https://www.openssl.org/policies/releasestrat.html, Version 1.1.1 will be supported until 2023-09-11 (LTS).

openssl 3.0 has size issue. The binary size is increased dramatically according to POC data (https://bugzilla.tianocore.org/show_bug.cgi?id=3466, https://edk2.groups.io/g/devel/topic/87479913, https://github.com/kraxel/edk2/tree/archive/openssl3-v1)

openssl 1.1
-  399582 SecureBootConfigDxe
-  472182 SecurityStubDxe
-  532626 VariableSmm
-  656382 TlsDxe

openssl 3.0
+  809886 SecureBootConfigDxe
+  912310 SecurityStubDxe
+  970898 VariableSmm
+ 1125758 TlsDxe

It will bring problem to the old platform, which only has limited size.

[Option]
One alternative is to use mbedtls (https://github.com/Mbed-TLS/mbedtls).

The POC is at https://github.com/jyao1/edk2/tree/DeviceSecurity/CryptoMbedTlsPkg

It has much smaller size than openssl. One POC - RSA based pre-memory verification: &quot;The pre-memory phase openssl is 230K, but mbedtls just 50K.&quot;

The known limitation is that mbedtls does not have PKCS7 support. But we can add a PKCS7 wrapper around mbedtls, such as https://patchwork.ozlabs.org/project/skiboot/patch/20200612202514.15032-18-erichte@linux.ibm.com/.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20239</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-12-20 21:50:11 +0000</bug_when>
    <thetext>jiewen.yao@intel.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20614</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-10 22:45:09 +0000</bug_when>
    <thetext>Other mbedTLS gap: no SHA3/ParallelHash, no SM3.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20989</commentid>
    <comment_count>3</comment_count>
    <who name="Marvin Häuser">mhaeuser</who>
    <bug_when>2023-02-04 05:20:54 +0000</bug_when>
    <thetext>Sorry for the spam, but just for completeness’ sake, the PKCS7 patch was updated in a V6: https://patchwork.ozlabs.org/project/skiboot/patch/20200916162131.22478-18-erichte@linux.ibm.com/
… and also has gotten two updates since it was posted: https://github.com/open-power/skiboot/tree/master/libstb/crypto/pkcs7

Limited(!) support has been merged by the authors: https://github.com/Mbed-TLS/mbedtls/pull/3431

Generation was posted here, if relevant: https://github.com/Mbed-TLS/mbedtls/pull/3970</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20990</commentid>
    <comment_count>4</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-02-04 05:28:05 +0000</bug_when>
    <thetext>Ah. That&apos;s good info, thanks Marvin to point out. :-)

(My knowledge is out of date quickly these days.)

I also found SHA-3 patch is there https://github.com/Mbed-TLS/mbedtls/issues/3752. No sure when it can be merged.

Feel free to more information there, please.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21029</commentid>
    <comment_count>5</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-02-10 21:23:12 +0000</bug_when>
    <thetext>Staging branch is created for collaboration - https://github.com/tianocore/edk2-staging/tree/OpenSSL11_EOL</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21643</commentid>
    <comment_count>6</comment_count>
    <who name="Marvin Häuser">mhaeuser</who>
    <bug_when>2023-06-07 17:49:09 +0000</bug_when>
    <thetext>SHA-3 was merged: https://github.com/Mbed-TLS/mbedtls/pull/5820</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22081</commentid>
    <comment_count>7</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 17:27:31 +0000</bug_when>
    <thetext>Fixed in commit range 95c9f470ca6e..eebd446875a4.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22850</commentid>
    <comment_count>8</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-02 04:04:47 +0000</bug_when>
    <thetext>Re-open due to not all mbedtls feature complete.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23066</commentid>
    <comment_count>9</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-28 05:18:16 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5645 has been merged.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4825</bug_id>
          
          <creation_ts>2024-08-06 16:50:24 +0000</creation_ts>
          <short_desc>NetworkPkg: Improve GetBootFile() code flow</short_desc>
          <delta_ts>2024-08-27 12:19:42 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Saloni Kasbekar">saloni.kasbekar</reporter>
          <assigned_to name="Saloni Kasbekar">saloni.kasbekar</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23298</commentid>
    <comment_count>0</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-08-06 16:50:24 +0000</bug_when>
    <thetext>Introduce state machine to improve the code flow in GetBootFile()</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23299</commentid>
    <comment_count>1</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-08-06 16:50:50 +0000</bug_when>
    <thetext>Assign to myself.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23300</commentid>
    <comment_count>2</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-08-06 17:31:26 +0000</bug_when>
    <thetext>PR link - https://github.com/tianocore/edk2/pull/6056</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23345</commentid>
    <comment_count>3</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-08-27 12:19:42 +0000</bug_when>
    <thetext>PR submitted.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4050</bug_id>
          
          <creation_ts>2022-09-06 23:59:48 +0000</creation_ts>
          <short_desc>SignedCapsulePkg: Add CI YAML file</short_desc>
          <delta_ts>2022-10-12 22:18:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kubacki">michael.kubacki</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SignedCapsulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19505</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-06 23:59:48 +0000</bug_when>
    <thetext>This package still does not have a CI YAML file. This change is tracking
a minimal CI YAML file being added so the package can take part in edk2
CI.

Since it currently has not been run against CI, some CI failures may need to
be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19506</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-09-06 23:59:59 +0000</bug_when>
    <thetext>I will send a patch soon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19767</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-12 22:18:34 +0000</bug_when>
    <thetext>Merged to edk2/master in commit b3d379d18884e9767851087ac88fe27fd2f03dd5 to f931506815548cee5a3929856bfc98266c39999c.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4670</bug_id>
          
          <creation_ts>2024-02-02 11:14:06 +0000</creation_ts>
          <short_desc>Illegal printf code %LX</short_desc>
          <delta_ts>2024-02-16 01:22:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Heinrich Schuchardt">xypron.glpk</reporter>
          <assigned_to name="Heinrich Schuchardt">xypron.glpk</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>xypron.glpk</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22509</commentid>
    <comment_count>0</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2024-02-02 11:14:06 +0000</bug_when>
    <thetext>In most places we use %lx to print out 64bit numbers. Some code uses %LX but this does not work:

BS.AllocatePages - AllocateMaxAddress return Address -- PASS
6A06E702-8564-48D6-BD05-87E716C42549
/home/user/SctPkg/TestCase/UEFI/EFI/BootServices/MemoryAllocationServices/BlackBoxTest/MemoryAllocationServicesBBTestFunction.c:558:TPL - 16, MemType - 4294967295, PhysicalStart - 0x?X, NumberOfPages - 0x?X, Memory - 0x?X

BS.AllocatePages - Type is AllocateMaxAddress 2 -- PASS


In uefi-sct/SctPkg/Library/SctLib/Print.c only &apos;l&apos; is supported but no &apos;L&apos;.
&apos;x&apos; and &apos;X&apos; are both supported. &apos;X&apos; set the width to 16 or 8 depending on the bitness of the target.

We should replace all occurrences of %LX by %lX.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22511</commentid>
    <comment_count>1</comment_count>
      <attachid>1470</attachid>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2024-02-02 12:06:01 +0000</bug_when>
    <thetext>Created attachment 1470
[PATCH edk2-test 1/1] uefi-sct/SctPkg: correct %LX SctPrint code

The patch is also available on the mailing list as https://edk2.groups.io/g/devel/message/115062 .</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22512</commentid>
    <comment_count>2</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2024-02-02 12:08:00 +0000</bug_when>
    <thetext>Please, review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22608</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-02-16 01:22:00 +0000</bug_when>
    <thetext>Thank you, Heinrich.
The patch is reviewed and upstreamed by the commit:
https://github.com/tianocore/edk2-test/commit/19e53ca9a39c5cb2deed1dc1d7758a6b0241991c

Closing this issue</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1470</attachid>
            <date>2024-02-02 12:06:01 +0000</date>
            <delta_ts>2024-02-02 12:06:01 +0000</delta_ts>
            <desc>[PATCH edk2-test 1/1] uefi-sct/SctPkg: correct %LX SctPrint code</desc>
            <filename>0001-uefi-sct-SctPkg-correct-LX-SctPrint-code.patch</filename>
            <type>text/plain</type>
            <size>42979</size>
            <attacher name="Heinrich Schuchardt">xypron.glpk</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4526</bug_id>
          
          <creation_ts>2023-08-16 01:51:03 +0000</creation_ts>
          <short_desc>Replace the OVMF-specific SataControllerDxe with the generic one in MdeModulePkg</short_desc>
          <delta_ts>2023-08-16 01:51:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>gaoliming</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21832</commentid>
    <comment_count>0</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:51:03 +0000</bug_when>
    <thetext>They were both forked from the same code, and are code-and-functionality similar.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21833</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:51:29 +0000</bug_when>
    <thetext>This patch has been fixed at ded1d54..41abf</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4389</bug_id>
          
          <creation_ts>2023-03-24 21:06:38 +0000</creation_ts>
          <short_desc>Add google mocks support to UnitTestFrameworkPkg GoogleTestLib</short_desc>
          <delta_ts>2023-04-25 22:00:44 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UnitTestFrameworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21262</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-03-24 21:06:38 +0000</bug_when>
    <thetext>Extend the GooggleTestLib in the UnitTestFrameworkPkg to support
gmock.  gmock is for C++ code, so some extensions are required
to make it work for C code.  These extensions include SubhookLib
and FunctionMockLib.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21425</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 22:00:44 +0000</bug_when>
    <thetext>Mike has fixed it.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4200</bug_id>
          
          <creation_ts>2022-12-22 00:32:30 +0000</creation_ts>
          <short_desc>IntelFsp2Pkg: Coverity scan flags OVERRUN issue</short_desc>
          <delta_ts>2023-06-02 02:25:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ranbir Singh">saini.ranbirs</reporter>
          <assigned_to name="Ranbir Singh">saini.ranbirs</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20256</commentid>
    <comment_count>0</comment_count>
      <attachid>1062</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 00:32:30 +0000</bug_when>
    <thetext>Created attachment 1062
HTML files reflecting the issues

1 issue has been captured by Coverity scan for IntelFsp2Pkg. 

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.

File - Edk2/IntelFsp2Pkg/Library/BaseFspCommonLib/FspCommonLib.c
Function - SetFspMeasurePoint

FspData-&gt;PerfIdx is getting increased for every call unconditionally in the function SetFspMeasurePoint and hence memory access can happen for out of bound FspData-&gt;PerfData[] array entries also.

Example -
   Assume a call is made to SetFspMeasurePoint when the FspData-&gt;PerfIdx last 
   value is 31. It gets incremented to 32 at line 400. Any subsequent call to 
   SetFspMeasurePoint leads to FspData-&gt;PerfData[32] getting accessed which is
   out of the array as well as the structure boundary.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20257</commentid>
    <comment_count>1</comment_count>
      <attachid>1063</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2022-12-22 00:44:57 +0000</bug_when>
    <thetext>Created attachment 1063
Proposed patch to resolve the issues pointed by Coverity for IntelFsp2Pkg


Proposed mitigations -

1. Valid performance timestamp return should be placed inside if block and invalid 
   timestamp return value (say 0xFF00000000000000) outside if block.
   The attached patch does this.

2. Another option is to change the SetFspMeasurePoint function return type to void 
   considering the fact there nowhere in the edk2 code the return value has been 
   used and, in this case, only FspData-&gt;PerfIdx needs to be incremented at the 
   end inside the if block.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20347</commentid>
    <comment_count>2</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-02 01:59:47 +0000</bug_when>
    <thetext>(In reply to Ranbir Singh from comment #1)
&gt; Created attachment 1063 [details]
&gt; Proposed patch to resolve the issues pointed by Coverity for IntelFsp2Pkg
&gt; 
&gt; 
&gt; Proposed mitigations -
&gt; 
&gt; 1. Valid performance timestamp return should be placed inside if block and
&gt; invalid 
&gt;    timestamp return value (say 0xFF00000000000000) outside if block.
&gt;    The attached patch does this.

With the changes as reflected by the attached patch, Coverity scan does not reflect the same OVERRUN issue as observed originally.

&gt; 
&gt; 2. Another option is to change the SetFspMeasurePoint function return type
&gt; to void 
&gt;    considering the fact there nowhere in the edk2 code the return value has
&gt; been 
&gt;    used and, in this case, only FspData-&gt;PerfIdx needs to be incremented at
&gt; the 
&gt;    end inside the if block.

This option may be chosen only if deemed more appropriate than option 1.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20428</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:38:47 +0000</bug_when>
    <thetext>Ranbir: please send the patch to edk2 mail list for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20448</commentid>
    <comment_count>4</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-04 01:57:51 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #3)
&gt; Ranbir: please send the patch to edk2 mail list for code review.

Patch sent to EDK2 mail list with mail subject as -

[PATCH] IntelFsp2Pkg/Library/BaseFspCommonLib: Fix OVERRUN Coverity issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20755</commentid>
    <comment_count>5</comment_count>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 04:36:00 +0000</bug_when>
    <thetext>(In reply to Ranbir Singh from comment #4)
&gt; (In reply to gaoliming from comment #3)
&gt; &gt; Ranbir: please send the patch to edk2 mail list for code review.
&gt; 
&gt; Patch sent to EDK2 mail list with mail subject as -
&gt; 
&gt; [PATCH] IntelFsp2Pkg/Library/BaseFspCommonLib: Fix OVERRUN Coverity issue

Marking this patch as obsolete as new updated patch will be uploaded.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20756</commentid>
    <comment_count>6</comment_count>
      <attachid>1214</attachid>
    <who name="Veeresh Sangolli">veeresh.sangolli</who>
    <bug_when>2023-01-24 04:41:37 +0000</bug_when>
    <thetext>Created attachment 1214
Proposed patch to resolve the issues pointed by Coverity for IntelFsp2Pkg.

1. Valid performance timestamp return should be placed inside if block and
 invalid 
    timestamp return value (say 0xFF00000000000000) outside if block.
    The attached patch does this.


With the changes as reflected by the attached patch, Coverity scan does not reflect the same OVERRUN issue as observed originally.


2. Another option is to change the SetFspMeasurePoint function return type
 to void considering the fact there nowhere in the edk2 code the return value has been used and, in this case, only FspData-&gt;PerfIdx needs to be incremented at the end inside the if block.


This option may be chosen only if deemed more appropriate than option 1.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21628</commentid>
    <comment_count>7</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-06-02 02:25:11 +0000</bug_when>
    <thetext>
Patch merged as -

https://github.com/tianocore/edk2/commit/48c53994e649d51a388dc414944c9a9b717a1c3c</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1062</attachid>
            <date>2022-12-22 00:32:30 +0000</date>
            <delta_ts>2022-12-22 00:32:30 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>IntelFsp2Pkg - Coverity Issue.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>8397</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1063</attachid>
            <date>2022-12-22 00:44:57 +0000</date>
            <delta_ts>2023-01-24 04:36:37 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity for IntelFsp2Pkg</desc>
            <filename>0001-IntelFsp2Pkg-Fix-BaseFspCommonLib-coverity-issues.patch</filename>
            <type>text/plain</type>
            <size>1470</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1214</attachid>
            <date>2023-01-24 04:41:37 +0000</date>
            <delta_ts>2023-01-24 04:41:37 +0000</delta_ts>
            <desc>Proposed patch to resolve the issues pointed by Coverity for IntelFsp2Pkg.</desc>
            <filename>0001-IntelFsp2Pkg-Library-BaseFspCommonLib-Fix-OVERRUN-Co.patch</filename>
            <type>text/plain</type>
            <size>2357</size>
            <attacher name="Veeresh Sangolli">veeresh.sangolli</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4850</bug_id>
          
          <creation_ts>2024-09-13 03:59:46 +0000</creation_ts>
          <short_desc>ShellPkg: missing linefeed in reset message</short_desc>
          <delta_ts>2024-10-23 20:59:08 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Heinrich Schuchardt">xypron.glpk</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>xypron.glpk</cc>
    
    <cc>zhichao.gao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23396</commentid>
    <comment_count>0</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2024-09-13 03:59:46 +0000</bug_when>
    <thetext>When running &apos;reset -s&apos; no lineffeed is printed. This results in the Linux command line prompt not being printed at the start of a new line:
    
        Shell&gt; reset -s
        Reset with &lt;null string&gt; (0 bytes)user@workstation:/tmp$
    
The missing linefeed should be added.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23397</commentid>
    <comment_count>1</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2024-09-13 04:35:22 +0000</bug_when>
    <thetext>Pull request
https://github.com/tianocore/edk2/pull/6200

[PATCH 1/1] ShellPkg: add missing linefeed in reset message 
https://edk2.groups.io/g/devel/message/120562</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23487</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-10-23 20:59:08 +0000</bug_when>
    <thetext>It has been fixed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4698</bug_id>
          
          <creation_ts>2024-02-23 12:09:47 +0000</creation_ts>
          <short_desc>Deprecated Crypto Algorithm Used for PRNG</short_desc>
          <delta_ts>2024-06-03 00:02:07 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="John Mathews">john.mathews</reporter>
          <assigned_to name="yi1.li@intel.com">yi1.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202302</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22632</commentid>
    <comment_count>0</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-02-23 12:09:47 +0000</bug_when>
    <thetext>In “CryptRandTsc.c” file, there is a potential issue.
https://github.com/tianocore/edk2/blob/11ad164bcea6b0ed3628d595090f84892c367086/CryptoPkg/Library/BaseCryptLib/Rand/CryptRandTsc.c#L47

It checks if SHA-1 is supported assuming the RAND_seed (Seed, (UINT32)SeedSize) is based on SHA-1. If indeed SHA-1 is used it is a problem since SHA-1 is deprecated by NIST for any cryptographic use. Also, this could lead to returning error if SHA1 is removed from OpenSSL to reduce size.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22712</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 21:56:15 +0000</bug_when>
    <thetext>yi1.li@intel.com: please check it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22753</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-08 04:14:10 +0000</bug_when>
    <thetext>I believe this is deprecated code from ancient openssl1.0 version.

The default drbg type of randlib has been switched to aes_256_ctr in openssl1.1.1, so sha1 is not really used in EDK2.

I will submit patch to remove that misleading code.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23085</commentid>
    <comment_count>3</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-06-03 00:02:07 +0000</bug_when>
    <thetext>pushed: https://github.com/tianocore/edk2/commit/3b36aa96de1d5f7a4660bec5c0cbad2616183dd6</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4699</bug_id>
          
          <creation_ts>2024-02-23 12:13:12 +0000</creation_ts>
          <short_desc>Delete PK is failing</short_desc>
          <delta_ts>2024-05-07 13:40:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Doug Flick">dougflick</reporter>
          <assigned_to name="Doug Flick">dougflick</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22633</commentid>
    <comment_count>0</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-23 12:13:12 +0000</bug_when>
    <thetext>This commit added support for the SHA384 and SHA512 algorithms, and the logic to detect the Digest Algorithm was changed.
https://github.com/tianocore/edk2/commit/bbf182229587958b17336c114e0a1525c4f90f3d

This function CreateTimeBasedPayload(..) creates a “Authenticated Variable” but doesn’t include any signature data.
https://github.com/tianocore/edk2/blob/8ccd63d14da5678a4b95df0aa954a2378355af9b/SecurityPkg/Library/SecureBootVariableLib/SecureBootVariableLib.c#L266
 
This function that was added will fail to find the OID because the Delete PK payload is special and doesn’t have signature data.
 
```c
FindHashAlgorithmIndex (
  IN     UINT8   *SigData,
  IN     UINT32  SigDataSize
  )
{
  UINT8  i;
 
  for (i = 0; i &lt; (sizeof (mHashInfo) / sizeof (EFI_HASH_INFO)); i++) {
    if (  (  (SigDataSize &gt;= (13 + mHashInfo[i].OidLength))
          &amp;&amp; (  ((*(SigData + 1) &amp; TWO_BYTE_ENCODE) == TWO_BYTE_ENCODE)
             &amp;&amp; (CompareMem (SigData + 13, mHashInfo[i].OidValue, mHashInfo[i].OidLength) == 0)))
       || (  ((SigDataSize &gt;= (32 +  mHashInfo[i].OidLength)))
          &amp;&amp; (  ((*(SigData + 20) &amp; TWO_BYTE_ENCODE) == TWO_BYTE_ENCODE)
             &amp;&amp; (CompareMem (SigData + 32, mHashInfo[i].OidValue, mHashInfo[i].OidLength) == 0))))
    {
      break;
    }
  }
 
  return i;
}
```
Later when this is used
 
```c
  HashAlgId = FindHashAlgorithmIndex (SigData, SigDataSize);
  if ((Attributes &amp; EFI_VARIABLE_TIME_BASED_AUTHENTICATED_WRITE_ACCESS) != 0) {
    if (HashAlgId &gt;= (sizeof (mHashInfo) / sizeof (EFI_HASH_INFO))) {
      return EFI_SECURITY_VIOLATION;
    }
  }
```
It returns EFI_SECURITY_VIOLATION. The previous code had faulty logic which would let this work without signature data in the special case it was the PK.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22635</commentid>
    <comment_count>1</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-23 12:16:50 +0000</bug_when>
    <thetext>Functionally what this means is that a Platform owner may not un-enroll the PK without the payload being properly signed (Which is pretty uncommon).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22710</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 21:55:13 +0000</bug_when>
    <thetext>dougflick@microsoft.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23015</commentid>
    <comment_count>3</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-05-07 13:40:29 +0000</bug_when>
    <thetext>This appears to be due to a downstream issue with our code and the upstream during a rebase. Appears that we were depending on behavior that shouldn&apos;t have worked in the first place. A local codefix corrects the issue. Thus not an issue in EDK2.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4417</bug_id>
          
          <creation_ts>2023-04-19 22:57:30 +0000</creation_ts>
          <short_desc>Move Network modules from Dxe firmware volume to Network firmware volume in the universal payload elf</short_desc>
          <delta_ts>2023-04-20 22:14:16 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Linus Wu">linusx.wu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>linusx.wu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21380</commentid>
    <comment_count>0</comment_count>
    <who name="Linus Wu">linusx.wu</who>
    <bug_when>2023-04-19 22:57:30 +0000</bug_when>
    <thetext>Since UefiPayload had supported multiple FV,
move Network.fdf.inc to new firmware volume and
add this network FV into elf file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21381</commentid>
    <comment_count>1</comment_count>
    <who name="Linus Wu">linusx.wu</who>
    <bug_when>2023-04-19 23:08:04 +0000</bug_when>
    <thetext>This task is ongoing in progress.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21384</commentid>
    <comment_count>2</comment_count>
    <who name="Linus Wu">linusx.wu</who>
    <bug_when>2023-04-20 22:14:16 +0000</bug_when>
    <thetext>This task is done by https://github.com/tianocore/edk2/pull/4290.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4237</bug_id>
          
          <creation_ts>2023-01-01 08:14:13 +0000</creation_ts>
          <short_desc>OvmfPkg commit 9fdc70af6ba8 breaks log analysis and code cohesion</short_desc>
          <delta_ts>2023-01-15 06:49:47 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>regression</keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>ardb</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>kraxel</cc>
    
    <cc>mcb30</cc>
    
    <cc>mhaeuser</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20337</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-01 08:14:13 +0000</bug_when>
    <thetext>Consider the following code change in 9fdc70af6ba8 (&quot;OvmfPkg: Update
AcpiPlatformDxe to alter MADT table&quot;, 2022-04-02), in the
InstallQemuFwCfgTables() function -- large context included on purpose:

&gt;| diff --git a/OvmfPkg/AcpiPlatformDxe/QemuFwCfgAcpi.c b/OvmfPkg/AcpiPlatformDxe/QemuFwCfgAcpi.c
&gt;| index b885965a601e..c8dee17c13e6 100644
&gt;| --- a/OvmfPkg/AcpiPlatformDxe/QemuFwCfgAcpi.c
&gt;| +++ b/OvmfPkg/AcpiPlatformDxe/QemuFwCfgAcpi.c
&gt;| @@ -1229,95 +1232,104 @@ InstallQemuFwCfgTables (
&gt;|    //
&gt;|    // second pass: identify and install ACPI tables
&gt;|    //
&gt;|    Installed = 0;
&gt;|    for (LoaderEntry = LoaderStart; LoaderEntry &lt; LoaderEnd; ++LoaderEntry) {
&gt;|      if (LoaderEntry-&gt;Type == QemuLoaderCmdAddPointer) {
&gt;|        Status = Process2ndPassCmdAddPointer (
&gt;|                   &amp;LoaderEntry-&gt;Command.AddPointer,
&gt;|                   Tracker,
&gt;|                   AcpiProtocol,
&gt;|                   InstalledKey,
&gt;|                   &amp;Installed,
&gt;|                   SeenPointers
&gt;|                   );
&gt;|        if (EFI_ERROR (Status)) {
&gt;|          goto UninstallAcpiTables;
&gt;|        }
&gt;|      }
&gt;|    }
&gt;|
&gt;|    //
&gt;|    // Translating the condensed QEMU_LOADER_WRITE_POINTER commands to ACPI S3
&gt;|    // Boot Script opcodes has to be the last operation in this function, because
&gt;|    // if it succeeds, it cannot be undone.
&gt;|    //
&gt;|    if (S3Context != NULL) {
&gt;|      Status = TransferS3ContextToBootScript (S3Context);
&gt;|      if (EFI_ERROR (Status)) {
&gt;|        goto UninstallAcpiTables;
&gt;|      }
&gt;|
&gt;|      //
&gt;|      // Ownership of S3Context has been transferred.
&gt;|      //
&gt;|      S3Context = NULL;
&gt;|    }
&gt;|
&gt;|  UninstallAcpiTables:
&gt;|    if (EFI_ERROR (Status)) {
&gt;|      //
&gt;|      // roll back partial installation
&gt;|      //
&gt;|      while (Installed &gt; 0) {
&gt;|        --Installed;
&gt;|        AcpiProtocol-&gt;UninstallAcpiTable (AcpiProtocol, InstalledKey[Installed]);
&gt;|      }
&gt;|    } else {
&gt;| -    DEBUG ((DEBUG_INFO, &quot;%a: installed %d tables\n&quot;, __FUNCTION__, Installed));
&gt;| +    //
&gt;| +    // Install a protocol to notify that the ACPI table provided by Qemu is
&gt;| +    // ready.
&gt;| +    //
&gt;| +    gBS-&gt;InstallProtocolInterface (
&gt;| +           &amp;mQemuAcpiHandle,
&gt;| +           &amp;gQemuAcpiTableNotifyProtocolGuid,
&gt;| +           EFI_NATIVE_INTERFACE,
&gt;| +           &amp;mAcpiNotifyProtocol
&gt;| +           );
&gt;|    }
&gt;|
&gt;|    for (SeenPointerEntry = OrderedCollectionMin (SeenPointers);
&gt;|         SeenPointerEntry != NULL;
&gt;|         SeenPointerEntry = SeenPointerEntry2)
&gt;|    {
&gt;|      SeenPointerEntry2 = OrderedCollectionNext (SeenPointerEntry);
&gt;|      OrderedCollectionDelete (SeenPointers, SeenPointerEntry, NULL);
&gt;|    }
&gt;|
&gt;|    OrderedCollectionUninit (SeenPointers);
&gt;|
&gt;|  FreeKeys:
&gt;|    FreePool (InstalledKey);
&gt;|
&gt;|  RollbackWritePointersAndFreeTracker:
&gt;|    //
&gt;|    // In case of failure, revoke any allocation addresses that were communicated
&gt;|    // to QEMU previously, before we release all the blobs.
&gt;|    //
&gt;|    if (EFI_ERROR (Status)) {
&gt;|      LoaderEntry = WritePointerSubsetEnd;
&gt;|      while (LoaderEntry &gt; LoaderStart) {
&gt;|        --LoaderEntry;
&gt;|        if (LoaderEntry-&gt;Type == QemuLoaderCmdWritePointer) {
&gt;|          UndoCmdWritePointer (&amp;LoaderEntry-&gt;Command.WritePointer);
&gt;|        }
&gt;|      }
&gt;|    }
&gt;|
&gt;|    //
&gt;|    // Tear down the tracker infrastructure. Each fw_cfg blob will be left in
&gt;|    // place only if we&apos;re exiting with success and the blob hosts data that is
&gt;|    // not directly part of some ACPI table.
&gt;|    //
&gt;|    for (TrackerEntry = OrderedCollectionMin (Tracker); TrackerEntry != NULL;
&gt;|         TrackerEntry = TrackerEntry2)
&gt;|    {
&gt;|      VOID  *UserStruct;
&gt;|      BLOB  *Blob;
&gt;|
&gt;|      TrackerEntry2 = OrderedCollectionNext (TrackerEntry);
&gt;|      OrderedCollectionDelete (Tracker, TrackerEntry, &amp;UserStruct);
&gt;|      Blob = UserStruct;
&gt;|
&gt;|      if (EFI_ERROR (Status) || Blob-&gt;HostsOnlyTableData) {
&gt;|        DEBUG ((

The code change introduces three BLATANT errors:

- It removes the important DEBUG_INFO message about having installed &lt;n&gt;
  ACPI tables. This INFO message is important for log analysis, as a
  long-standing &quot;bookmark&quot; in the log. Removing an INFO message for no
  good reason is *retarded*.

- The code change *pretends* that gBS-&gt;InstallProtocolInterface() cannot
  fail. It can clearly fail with EFI_OUT_OF_RESOURCES. Ignoring protocol
  member function return values anywhere except maybe error paths is
  *retarded*.

- The cohesion of the larger function context is violated. There is a
  comment *higher up* that says

&gt;|    //
&gt;|    // Translating the condensed QEMU_LOADER_WRITE_POINTER commands to ACPI S3
&gt;|    // Boot Script opcodes has to be the last operation in this function, because
&gt;|    // if it succeeds, it cannot be undone.

  Accordingly, gBS-&gt;InstallProtocolInterface() must be performed
  *before* that step, its return value must be checked, and if the
  protocol installation fails, a jump to the UninstallAcpiTables label
  must be taken.

  Furthermore, if the TransferS3ContextToBootScript() call fails, a new
  label / jump must be introduced, just above UninstallAcpiTables, so
  that *on error*, the protocol be uninstalled (rolled back).

Such blatant disregard to the existent code is nothing short of
infuriating. One pours their heart and soul into one of the most
complicated bits of OVMF logic, just to see it ravaged in the name of
the next grand feature. Code comprehension 101? How is it possible that
even a surgically intended code change like commit 9fdc70af6ba8
deteriorates the code so much? I&apos;m now afraid to look elsewhere in edk2.

Please fix this shit as soon as possible.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20338</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-01 08:30:38 +0000</bug_when>
    <thetext>There are further issues with this commit. The QEMU_ACPI_TABLE_NOTIFY_PROTOCOL structure is entirely superfluous; NULL protocol interfaces have been used in edk2 repeatedly. A protocol instance can exist in the protocol database with a NULL associated interface. Therefore the QEMU_ACPI_TABLE_NOTIFY_PROTOCOL type, the &quot;QemuAcpiTableNotify.h&quot; header, and the &quot;mAcpiNotifyProtocol&quot; global variable should be removed. (Just having the protocol GUID declared in the OvmfPkg DEC file is sufficient for making &quot;gQemuAcpiTableNotifyProtocolGuid&quot; visible and usable in source code, so the header file is useless, with the structure type removed.)

Even the UEFI spec says &quot;NULL can be used if a structure is not associated with Protocol&quot;. And the Notify field in the QEMU_ACPI_TABLE_NOTIFY_PROTOCOL structure is not used anywhere.

It also makes absolutely no sense to pollute &quot;QemuFwCfgAcpi.c&quot; with a global variable, such as &quot;mQemuAcpiHandle&quot;. The handle is not needed for anything, beyond the scope of the InstallQemuFwCfgTables(). (Even with the proper rollback logic added for the protocol uninstallation, as described above, a local variable will suffice for storing the handle.)

It&apos;s an outrage that such a *heap* of beginner-level, cavalier mistakes were introduced in &quot;QemuFwCfgAcpi.c&quot;, in the name of TDX.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20340</commentid>
    <comment_count>2</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-01-01 19:52:00 +0000</bug_when>
    <thetext>Thanks Laszlo for your comments. I will carefully study the code and provide the fix as soon as possible.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20403</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-03 04:30:42 +0000</bug_when>
    <thetext>IN_PROGRESS per comment 2.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20404</commentid>
    <comment_count>4</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-03 05:47:39 +0000</bug_when>
    <thetext>Can we use EFI_ACPI_SDT_PROTOCOL.RegisterNotify()?

If so, we can revert QEMU_ACPI_TABLE_NOTIFY_PROTOCOL.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20407</commentid>
    <comment_count>5</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-03 06:35:04 +0000</bug_when>
    <thetext>Hello Jiewen,

I think keeping the protocol per se (with a NULL interface) is better. An Event Group *could* work as an alternative.

EFI_ACPI_SDT_PROTOCOL.RegisterNotify() takes a callback function that is called *immediately* &quot;whenever a new ACPI table is installed&quot; (per PI spec). It does not consider TPLs.

But we need to consider TPLs here.

InstallQemuFwCfgTables() can *uninstall*, on its error path, all the ACPI tables it just installed. It contains complete rollback logic.

As I described above, the desired order of operations is the following (quoting only the &quot;tail&quot; of the success path):

- loop calling Process2ndPassCmdAddPointer()
- InstallProtocolInterface()
- TransferS3ContextToBootScript()

Then, on the error path, if TransferS3ContextToBootScript() fails, the protocol too must be uninstalled.

In &quot;OvmfPkg/TdxDxe/TdxDxe.c&quot;, AlterAcpiTable() is the notification function for the installation of the protocol in question. It is queued at TPL_CALLBACK -- and that remains necessary.

EFI_ACPI_SDT_PROTOCOL.RegisterNotify() would ignore TPLs, so it&apos;s not a good choice.

On QEMU platforms that include a PCI Host, the ACPI table installation must be delayed until after Platform BDS enumerates the PCI root bridges. (The ACPI payload downloaded from QEMU, in the DSDT, depends on the PCI resource assignments.) Therefore Platform BDS signals &quot;gRootBridgesConnectedEventGroupGuid&quot; after it has connected the PCI root bridges, and that&apos;s when the following call chain is queued, at TPL_CALLBACK:

OnRootBridgesConnected()     [OvmfPkg/AcpiPlatformDxe/EntryPoint.c]
  InstallAcpiTables()        [OvmfPkg/AcpiPlatformDxe/AcpiPlatform.c]
    InstallQemuFwCfgTables() [OvmfPkg/AcpiPlatformDxe/QemuFwCfgAcpi.c]

Because of this, when the protocol is installed in InstallQemuFwCfgTables(), AlterAcpiTable() is not *immediately* called in TdxDxe, it is already only queued. Speaking strictly, it would be necessary to raise the TPL in InstallQemuFwCfgTables() to TPL_CALLBACK until after the function succeeds entirely, but in practice this has not been needed because InstallQemuFwCfgTables() already runs at TPL_CALLBACK, due to the above.

The point is that whenever AlterAcpiTable() finally runs in TdxDxe, AlterAcpiTable() must be prepared for a *spurious* activation. The MADT table may no longer be there; more foundationally, the protocol itself may no longer be there.

I *think* that AlterAcpiTable() already deals fine with the MADT not existing at the time of invocation, so that&apos;s great. That&apos;s why I&apos;m saying that an Event Group could be an alternative to the protocol -- AlterAcpiTable() would cope with a missing MADT just the same.

But a callback registered with EFI_ACPI_SDT_PROTOCOL.RegisterNotify() would immediately see the MADT just installed by InstallQemuFwCfgTables() -- in effect, interrupt InstallQemuFwCfgTables() --, and update the MADT, *even if* TransferS3ContextToBootScript() failed later, and led to the ACPI platform driver uninstalling all the tables it just installed.

In other words, using EFI_ACPI_SDT_PROTOCOL.RegisterNotify() could lead to a situation where AlterAcpiTable() replaced the MADT *before* InstallQemuFwCfgTables() were done, and then InstallQemuFwCfgTables() could *uninstall the wrong* MADT, if TransferS3ContextToBootScript() failed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20409</commentid>
    <comment_count>6</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-03 07:00:39 +0000</bug_when>
    <thetext>OK. I am fine to keep it.



Another thing: I am thinking, what is the value of the error handling code.

&gt; InstallQemuFwCfgTables() can *uninstall*, on its error path, all the ACPI tables it just installed. It contains complete rollback logic.

For example, why we need to *uninstall* all ACPI table? Why not put an ASSERT() in error path?

Current OS requires ACPI table, which means an OS will refuse to boot in case of no ACPI installed.

Because the ACPI is so critical, I would rather stop to figure out why fail immediately, than keep booting to OS then stuck there.


I am not sure why we need such complicated error handling.
What test do we run for those error conditions ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20411</commentid>
    <comment_count>7</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-03 07:33:11 +0000</bug_when>
    <thetext>&gt; what is the value of the error handling code
&gt; Why not put an ASSERT() in error path?

Sorry, I&apos;m unable to explan this, if you don&apos;t see it already.

We all remember central code in edk2, even in SMM code, where error checking after every function call amounted to ASSERT_EFI_ERROR(). I wouldn&apos;t like to rehash all those discussions. My apologies.

The error path has been actively triggered in the past, for example when QEMU exposed broken ACPI content / linker-loader script. The debug messages helped us track down the QEMU bug. Even without ACPI tables installed, you can get as far as the UEFI shell or the Setup TUI for example, which do not depend on ACPI tables being installed. Those tools can be used for further investigation.

Ignoring proper error handling is just a cop-out. You first think it&apos;s a waste of time, it&apos;s untestable, and so on, and eventually the shortcuts and the technical debt comes back to bite you. So, my ultimate answer is: I do error paths like this because this is the right way. By principle.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20412</commentid>
    <comment_count>8</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-03 07:35:07 +0000</bug_when>
    <thetext>... not to mention you can still boot a linux kernel (via fw_cfg, or the UEFI shell, etc) and the Linux kernel *can* limp along quite far without ACPI, for various kinds of analyses.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20413</commentid>
    <comment_count>9</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-03 09:13:40 +0000</bug_when>
    <thetext>&gt; for example when QEMU exposed broken ACPI content / linker-loader script. The debug messages helped us track down the QEMU bug.

I have no doubt about the usefulness of debug message. As a developer, I am very supportive of that. :-)


&gt; Ignoring proper error handling is just a cop-out.

I would say, ROI consideration.

I have seen cases that error handling itself is totally wrong. If error really happened, the code just runs into a different error state, which brings no benefit but confusing.

Anyway, if you have validated all those errors and you can ensure the system can continue boot to shell and give your opportunity to use the debug tool, I am OK with that.

But if the code will assert somewhere else later with weird issue, I would rather fail at the first error place.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20439</commentid>
    <comment_count>10</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-01-03 23:00:50 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #5)
&gt; 
&gt; As I described above, the desired order of operations is the following
&gt; (quoting only the &quot;tail&quot; of the success path):
&gt; 
&gt; - loop calling Process2ndPassCmdAddPointer()
&gt; - InstallProtocolInterface()
&gt; - TransferS3ContextToBootScript()
&gt; 
&gt; Then, on the error path, if TransferS3ContextToBootScript() fails, the
&gt; protocol too must be uninstalled.
&gt; 

Thanks much Laszlo. The explanation is very clear and the fix will be submitted soon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20466</commentid>
    <comment_count>11</comment_count>
    <who name="Michael Brown">mcb30</who>
    <bug_when>2023-01-04 04:46:42 +0000</bug_when>
    <thetext>(In reply to jiewen.yao from comment #9)
&gt; &gt; Ignoring proper error handling is just a cop-out.
&gt; 
&gt; I would say, ROI consideration.

The best ROI is _always_ to fail cleanly (with proper error handling) and to log a very obvious error message.

The clean failure prevents unexpected or even undefined behaviour from other parts of the system, which could otherwise produce very misleading failure symptoms.

The obvious error message makes it easy to identify the root cause of the problem.


Ignoring proper error handling is lazy and dangerous.  It&apos;s the kind of attitude for which I would instantly fail any candidate at the interview stage.  It&apos;s slightly worrying to see it exhibited in someone with push access to the EDK2 repository.

On the plus side, this suggests that Intel-authored EDK2 code is likely to be a very productive place to search for Secure Boot exploits.  :)

Michael</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20468</commentid>
    <comment_count>12</comment_count>
    <who name="Marvin Häuser">mhaeuser</who>
    <bug_when>2023-01-04 05:31:11 +0000</bug_when>
    <thetext>... and even if you really, really ***really*** cannot possibly, under no circumstances, recover into a state that is useful for literally anything, it&apos;d be better to ASSERT and deadloop for DEBUG (you can always exit the deadloop with a debugger attached) or to just reset the platform for RELEASE (might as well hope this was a one-time error and we&apos;ll have better luck next time). If the situation is bad enough to warrant an ASSERT (a critical internal constraint violation), what will the user run into when it&apos;s no-op in production?

In fact, in our bootloader code (and this is also an approach other teams have taken), we often substitute clean-up error-handling with a platform reset, because we cannot trust the clean-up actually works (mostly due to firmware bugs) and rather just &quot;try again with a fresh start&quot;. (My point is not at all that this should be done here, but that even if we imagine an extreme situation where clean-up error-handling would literally be nothing but a waste of space, this *still* would not be the proper way to handle it.)


PS: If such a route is ever taken for a proper reason, please do not actually use plain ASSERT. ASSERT is for internal constraints and the semantics basically are &quot;our assumptions are wrong, there *must* be a bug somewhere&quot;. Things like OOM are not *necessarily* a bug, it might just be there is too little RAM to reasonably execute all plausible paths. However, this *might* indicate a leak, which would be a bug. For this case, we started using a separate macro we called &quot;RAISE&quot;, which basically means &quot;this is plausible to happen, but requires immediate analysis as to why it did (for assumed sane inputs)&quot;. The main reason for the separation is for tasks like fuzz-testing, you really want to shut such RAISE conditions out, as things like OOM are *intended* to be provoked (e.g., by unreasonably large &quot;size&quot; fields).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20485</commentid>
    <comment_count>13</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-01-04 09:15:32 +0000</bug_when>
    <thetext>[PATCH V1 1/1] OvmfPkg/AcpiPlatformDxe: Add back log and fix code cohesion
https://edk2.groups.io/g/devel/message/97943</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20556</commentid>
    <comment_count>14</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-01-09 18:55:06 +0000</bug_when>
    <thetext>[PATCH V2 0/6] Refactor installation of gQemuAcpiTableNotifyProtocol
https://edk2.groups.io/g/devel/message/98182</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20557</commentid>
    <comment_count>15</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-09 22:50:46 +0000</bug_when>
    <thetext>By meditation, I believe to have made advances towards compassion.

I apologize for the language I used in comment#0. I should have known better. I&apos;m sorry.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20580</commentid>
    <comment_count>16</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-01-10 20:28:51 +0000</bug_when>
    <thetext>[PATCH V3 0/6] Refactor installation of gQemuAcpiTableNotifyProtocol
https://edk2.groups.io/g/devel/message/98258</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20646</commentid>
    <comment_count>17</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-12 13:40:13 +0000</bug_when>
    <thetext>(removing myself from the CC list)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20671</commentid>
    <comment_count>18</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-15 06:49:47 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/3897

Commit range ba08910df107..7cd55f300915.

Thanks.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4105</bug_id>
          
          <creation_ts>2022-10-12 13:27:16 +0000</creation_ts>
          <short_desc>SctPkg: Stall_Func test can cause disk timeouts and testing failure</short_desc>
          <delta_ts>2022-11-11 11:02:57 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</reporter>
          <assigned_to name="Edhay">edhaya.chandran</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19764</commentid>
    <comment_count>0</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2022-10-12 13:27:16 +0000</bug_when>
    <thetext>Stall_Func when executing at the highest priority level blocks all interrupts including any active or pending disk IO. Blocking these IO operations for too long can cause these drivers to time out and mark the disk as corrupted and render any further testing impossible. The timeout interval is set to be 5 seconds for any pending IO operation, meaning the delay in stall func should be less than this value. It is proposed that the 10 second delay be reduced to 4 seconds or lesser to avoid encountering this type of issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19910</commentid>
    <comment_count>1</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2022-11-02 09:57:16 +0000</bug_when>
    <thetext>Related patch: https://edk2.groups.io/g/discuss/message/1115</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19923</commentid>
    <comment_count>2</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-03 09:27:51 +0000</bug_when>
    <thetext>The reasoning for 5 seconds as confirmed by Robert Wood (Issue raiser):

&quot;4000000 is somewhat arbitrary. The goal was to be &lt; 5 seconds since 5 seconds is the IO timeout limit. The extra second between 5 and 4 was to allow a one second buffer to avoid slight variances in delay inadvertently causing IO timeouts. I wanted to be as close to the original 10 seconds as possible since I do not know the reason why the test was originally written with a 10 second delay.&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19924</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-03 10:11:18 +0000</bug_when>
    <thetext>The next step by the forum would be to build SCT with the patch at  devel@edk2.groups.io | [PATCH v1 1/1] MiscBootServices: Stall_Func: Reduces the stall interval for Stall_Func
and run regression on three reference hardwares. Once verified, we will upstream the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19974</commentid>
    <comment_count>4</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-09 03:03:04 +0000</bug_when>
    <thetext>When testing the patch, there were issues found in verifying the elapsed time.
The patch contents have been updated and tested. 
The same is attached for reference</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19976</commentid>
    <comment_count>5</comment_count>
      <attachid>1050</attachid>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-09 03:06:05 +0000</bug_when>
    <thetext>Created attachment 1050
Proposed patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20004</commentid>
    <comment_count>6</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-11 11:02:57 +0000</bug_when>
    <thetext>The solution is tested by Robert and I.
The patch is upstreamed through the below commit:
https://github.com/tianocore/edk2-test/commit/1d181ad0d82520c099435ff08a8e829b44f493cc

Closing the issue.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1050</attachid>
            <date>2022-11-09 03:06:05 +0000</date>
            <delta_ts>2022-11-09 03:06:05 +0000</delta_ts>
            <desc>Proposed patch</desc>
            <filename>updated_patch.patch</filename>
            <type>application/octet-stream</type>
            <size>2556</size>
            <attacher name="Edhay">edhaya.chandran</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4740</bug_id>
          
          <creation_ts>2024-03-28 04:39:23 +0000</creation_ts>
          <short_desc>Need update OPTIONAL location in CryptoPkg/BasecryptLibMbedtls</short_desc>
          <delta_ts>2024-04-02 00:39:48 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>wenxing.hou</reporter>
          <assigned_to>wenxing.hou</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22835</commentid>
    <comment_count>0</comment_count>
    <who name="">wenxing.hou</who>
    <bug_when>2024-03-28 04:39:23 +0000</bug_when>
    <thetext>REF: https://bugzilla.tianocore.org/show_bug.cgi?id=3760 

In edk2/CryptoPkg/Library/BaseCryptLibMbedTls/Pk
/CryptPkcs1OaepNull.c, the OPTIONAL location need be updated.

BOOLEAN
EFIAPI
Pkcs1v2Encrypt (
  IN   CONST UINT8  *PublicKey,
  IN   UINTN        PublicKeySize,
  IN   UINT8        *InData,
  IN   UINTN        InDataSize,
  IN   CONST UINT8  *PrngSeed,
  OPTIONAL
  IN   UINTN        PrngSeedSize,
  OPTIONAL
  OUT  UINT8        **EncryptedData,
  OUT  UINTN        *EncryptedDataSize
  )

So does CryptX509Null.c.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22840</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-28 21:14:24 +0000</bug_when>
    <thetext>Please take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22845</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-02 00:39:48 +0000</bug_when>
    <thetext>pushed: https://github.com/tianocore/edk2/commit/278250045b45e98764b2e3c5171af784ea060553</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4588</bug_id>
          
          <creation_ts>2023-11-04 21:13:19 +0000</creation_ts>
          <short_desc>Remove CSM support from OvmfPkg</short_desc>
          <delta_ts>2023-12-07 13:09:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          <see_also>https://bugzilla.tianocore.org/show_bug.cgi?id=1754</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Laszlo Ersek">laszlo.ersek</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22128</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-11-04 21:13:19 +0000</bug_when>
    <thetext>CSM content in OvmfPkg is no longer maintainer and should be removed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22131</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-11-05 05:28:34 +0000</bug_when>
    <thetext>I&apos;ll work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22149</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-11-10 18:59:01 +0000</bug_when>
    <thetext>[PATCH 00/37] OvmfPkg: remove the CSM (after edk2-stable202311)
Message-Id: &lt;20231110235820.644381-1-lersek@redhat.com&gt;
https://edk2.groups.io/g/devel/message/111071</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22150</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-11-12 20:44:55 +0000</bug_when>
    <thetext>This is a new feature.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22234</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-12-07 13:09:21 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #2)
&gt; [PATCH 00/37] OvmfPkg: remove the CSM (after edk2-stable202311)
&gt; Message-Id: &lt;20231110235820.644381-1-lersek@redhat.com&gt;
&gt; https://edk2.groups.io/g/devel/message/111071

Merged as commit range 238690a30d02..eccdab611c01, via &lt;https://github.com/tianocore/edk2/pull/5122&gt;.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4443</bug_id>
          
          <creation_ts>2023-05-04 21:05:48 +0000</creation_ts>
          <short_desc>More Google Mock Library (PciHostBridgeLib, HobLib, PeiServicesLib) support from Edk2</short_desc>
          <delta_ts>2023-05-09 23:09:28 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Gua Guo">gua.guo</reporter>
          <assigned_to name="Gua Guo">gua.guo</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
    
    <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21477</commentid>
    <comment_count>0</comment_count>
    <who name="Gua Guo">gua.guo</who>
    <bug_when>2023-05-04 21:05:48 +0000</bug_when>
    <thetext>Based on REF: https://bugzilla.tianocore.org/show_bug.cgi?id=4389, it provides google mock support on Edk2.

We need to based on the solution to provide more google mock library for consumer code to depend on.

1. PciHostBridgeLib Google Mock Library
2. HobLib Google Mock Library
3. PeiServicesLib Google Mock Library</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21532</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 21:51:22 +0000</bug_when>
    <thetext>Merged by https://github.com/tianocore/edk2/pull/4335</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21550</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-09 23:09:28 +0000</bug_when>
    <thetext>This is a new feature.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4129</bug_id>
          
          <creation_ts>2022-10-28 11:49:38 +0000</creation_ts>
          <short_desc>FILE_GUID overrides in DSC file do not work for UnitTestFrameworkPkg based host unit tests</short_desc>
          <delta_ts>2022-11-01 10:54:05 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>4130</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>bob.c.feng</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.kubacki</cc>
    
    <cc>sean.brogan</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UnitTestFrameworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19866</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-28 11:49:38 +0000</bug_when>
    <thetext>If a host unit test DSC file attempts to use the same hot unit test
INF file more than once with a FILE_GUID override, the executables
generated use the same output path/filename, so only a single 
executable is generated.

The root cause is that build_rule.txt for modules of type HOST_APPLICATION
does nor specify the executable output path/filename.  It depends on
the DSC file to specify the path/filename.

UnitTestFrameworkPkg/UnitTestFrameworkPkgHost.dsc.inc uses 
$(BIN_DIR)/$(BASE_NAME) as the output path/filename which does
not include the FILE_GUID as part of the path or name.

One possible solution is to use $(BIN_DIR)/$(MODULE_NAME_GUID) instead
so the executable file and symbol file names include bot the base name
and the FILE_GUID as part of the file name.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19867</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-28 11:49:58 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19891</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-01 10:52:13 +0000</bug_when>
    <thetext>Patch review email

https://edk2.groups.io/g/devel/message/95705</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19892</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-01 10:54:05 +0000</bug_when>
    <thetext>Commit: 

https://github.com/tianocore/edk2/commit/85dba961c761021755cd2aa6bc98b8e789f751ef

PR: 

https://github.com/tianocore/edk2/pull/3555</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4770</bug_id>
          
          <creation_ts>2024-05-05 23:33:38 +0000</creation_ts>
          <short_desc>Add FdtNorFlashQemuLib without hard code version in OmvfPkg</short_desc>
          <delta_ts>2024-06-06 03:19:58 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23005</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-05-05 23:33:38 +0000</bug_when>
    <thetext>NorFlashQemuLib in ArmVirtPkg version has some hard code, move the library to OvmfPkg/Library and use setting PCD variables to replace the hard code.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23006</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-05-05 23:34:20 +0000</bug_when>
    <thetext>I&apos;m working on this feature.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23074</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-29 21:02:31 +0000</bug_when>
    <thetext>Chao: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23080</commentid>
    <comment_count>3</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-05-29 21:50:02 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #2)
&gt; Chao: please work on it.

The patch set was merged at May 17 2024, so this issue is closed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23084</commentid>
    <comment_count>4</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-06-02 23:31:30 +0000</bug_when>
    <thetext>This question has been closed due to incorrect operation, reopen it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23093</commentid>
    <comment_count>5</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-06-06 03:19:58 +0000</bug_when>
    <thetext>The patch set was merged, close.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4002</bug_id>
          
          <creation_ts>2022-07-19 18:47:14 +0000</creation_ts>
          <short_desc>&quot;UEFI Firmware Project for Intel Atom® Processor E3900 Series Processor Platforms&quot; no longer works on UP Squared board</short_desc>
          <delta_ts>2022-07-19 21:45:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>Placeholder</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Xeno Kovah">xeno</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>UDK 2018</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>UDK 2018</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19276</commentid>
    <comment_count>0</comment_count>
      <attachid>1008</attachid>
    <who name="Xeno Kovah">xeno</who>
    <bug_when>2022-07-19 18:47:14 +0000</bug_when>
    <thetext>Created attachment 1008
UP2InfiniteLoopFailure.PNG

&quot;UEFI Firmware Project for Intel Atom® Processor E3900 Series Processor Platforms&quot; is available at [0]. And it lists AAEON UP Squared (UP2) as a primary target board, as well as distributing prebuild debug and release built images.

It has been observed by others[1] and myself, that while these images as from 2018, they worked circa into 2020 [2]. But these images, as well as images built from source [3], no longer work on UP2 boards purchased in the last few months. I speculate that this due to either a CPU stepping[4] or more likely a DRAM[5] change by AAEON in mid 2020. In particular [5] says that AAEON BIOS v5.0 is the first which incorporated new RAM support, and experimentally I cannot successfully boot official images &lt; v5.0 that have been physically flashed onto a board. But I can boot images &gt; 5.0.

My experience matches that provided in the serial logs at [1], where if I follow the instructions from [3] and build from source, I am left with an image that boots to the point of a &quot;FspFindFspHeader&quot; message, after which it does not boot further. 

I have used DCI-based debugging to find that the system is stuck in an infinite loop at address 0xFEF9803 as shown in the attached &quot;UP2InfiniteLoopFailure.PNG&quot;. That binary code is within an unknown module with file GUID 3381FC3F-8791-41E5-8871-A960A4ED24B7 as shown in the attached &quot;UP2InfiniteLoopFailureLocationUEFITool.PNG&quot;)

Based on diffing the logs for success vs. failure given in [1], the primary difference is as follows:

successful.log:
***** Calling UpdateFspmUpd *****
UpdateFspmUpd - NvsBufferPtr
UpdateFspmUpd - gEfiPlatformInfoGuid
***** Up2 - UpdateFspmUpd,BoardId = 1
Ddr4Id is: 02

failed.log:
***** Calling UpdateFspmUpd *****
UpdateFspmUpd - gEfiPlatformInfoGuid
***** Up2 - UpdateFspmUpd,BoardId = 1
Ddr4Id is: 03

By googling for the missing &quot;UpdateFspmUpd - NvsBufferPtr&quot;, I found the following commit which indicates it was made to support UP2 [6]. The relevant code has to do with DRAM initialization, which is why I believe the board revision made at [5] is the likely culprit.

AAEON BIOSes v5.0 and greater seem to work both on the new UP2 hardware, and older hardware, whereas earlier BIOSes only work on earlier hardware. So I assume AAEON have been given the necessary update to support the changed DRAM vendor. I would like to request that this update be made open source so that the debug build can be built from source according to [0][3] again.

(I and others would like to be able to use the UP2 as a MinnowBoard alternative as a cheap hardware platform for future classes that teach UEFI. A successor class to [7].) And  a nice bonus would be if [0] could be updated with newer binaries, and its build instructions updated to account for the fact that links to the Intel Ethernet Driver and AX88179 USB-to-LAN adapter have broken in the intervening years.

Thanks

Xeno

[0] https://www.intel.com/content/www/us/en/developer/articles/tool/uefi-firmware-project-for-intel-atom-processor-e3900-series-processor-platforms.html
[1] https://forum.up-community.org/discussion/4806/opensource-uefi-bios-by-intel-appears-to-be-unusable-now#latest
[2] https://www.asset-intertech.com/resources/blog/2020/05/open-source-firmware-explorations-using-dci-on-the-aaeon-up-squared-board/
[3] https://www.asset-intertech.com/resources/blog/2020/06/the-up-squared-chronicles-episode-2-building-the-uefi-image/
[4] https://up-board.org/pcn-up-squared-series-cpu-stepping/
[5] https://up-board.org/pcn-up-squared-dram-emmc-bios/
[6] https://patchew.org/EDK2/20180810083718.11176-1-david.wei@intel.com/
[7] https://ost2.fyi/Arch4021</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19277</commentid>
    <comment_count>1</comment_count>
      <attachid>1009</attachid>
    <who name="Xeno Kovah">xeno</who>
    <bug_when>2022-07-19 18:47:28 +0000</bug_when>
    <thetext>Created attachment 1009
UP2InfiniteLoopFailureLocationUEFITool.PNG</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19278</commentid>
    <comment_count>2</comment_count>
    <who name="Xeno Kovah">xeno</who>
    <bug_when>2022-07-19 18:54:43 +0000</bug_when>
    <thetext>Oh, and also all the &quot;Download ...&quot; links at [0] are currently broken, and it requires other googling to find alt links like https://www.intel.com/content/www/us/en/download/674458/intel-atom-processor-e3900-series-apollo-lake-binary-objects-r-71.html for the binary objects which are necessary to build from source.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19281</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-07-19 21:45:11 +0000</bug_when>
    <thetext>This platform is no longer supported in edk2-platform. So, close it.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1008</attachid>
            <date>2022-07-19 18:47:14 +0000</date>
            <delta_ts>2022-07-19 18:47:14 +0000</delta_ts>
            <desc>UP2InfiniteLoopFailure.PNG</desc>
            <filename>UP2InfiniteLoopFailure.PNG</filename>
            <type>image/png</type>
            <size>65392</size>
            <attacher name="Xeno Kovah">xeno</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1009</attachid>
            <date>2022-07-19 18:47:28 +0000</date>
            <delta_ts>2022-07-19 18:47:28 +0000</delta_ts>
            <desc>UP2InfiniteLoopFailureLocationUEFITool.PNG</desc>
            <filename>UP2InfiniteLoopFailureLocationUEFITool.PNG</filename>
            <type>image/png</type>
            <size>63794</size>
            <attacher name="Xeno Kovah">xeno</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4615</bug_id>
          
          <creation_ts>2023-12-07 15:32:26 +0000</creation_ts>
          <short_desc>EINJv2 Changes</short_desc>
          <delta_ts>2024-10-02 19:23:42 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</reporter>
          <assigned_to name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>harb</cc>
    
    <cc>Jose.Marinho</cc>
    
    <cc>leo.duran</cc>
    
    <cc>rgough</cc>
          
          <cf_industrystandardspecifications>ACPI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22236</commentid>
    <comment_count>0</comment_count>
      <attachid>1446</attachid>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2023-12-07 15:32:26 +0000</bug_when>
    <thetext>Created attachment 1446
EINJV2_ECR

This ECR addresses a set of issues found in EINJv2 as defined in ACPI spec v6.5:
• Is not evident how to determine the maximum number of Component Syndrome Array entries supported by the platform.
• EINJV2_GET_ERROR_TYPE does not return severities per supported error type.
• EINJV2_SET_ERROR_TYPE does not have a mechanism to identify the platform for support of vendor-specific data.
• Adding another “SET_ERROR_TYPE” action increases arbitration complexity for both the OS and platform firmware.
• The “Error Injection Version 2 Operation&quot; section is missing steps around the trigger error action table.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22268</commentid>
    <comment_count>1</comment_count>
    <who name="LeoDuran@AMD">leo.duran</who>
    <bug_when>2023-12-14 15:05:44 +0000</bug_when>
    <thetext>Detection of EINJV2 support:
---------------------------
EINJv2 is supported by the platform if bit 30 (EINJv2 Error Type) is set in the standard 32-bit error type bitmap returned by the GET_ERROR_TYPE action.

Proposed debugfs changes for Linux if EINJv2 support is detected:
---------------------------------------------------------------
1) change &quot;available_error_type&quot;:
Returns the standard error type bitmap from the GET_ERROR_TYPE action (as it already does), and also returns the EINJv2 error type bitmap from the EINJV2_GET_ERROR_TYPE action.

2) create &quot;einjv2_component_count&quot;:
The value from this file is used to set the &quot;Component Array Count&quot; field of EINJv2 Extension Structure. This file is created so that it allows &quot;seek&quot; and binary &quot;read/write&quot; operations.

3) create &quot;einjv2_component_array&quot; 
The contents of this file are used to set the &quot;Component Array&quot; field of the EINJv2 Extension Structure. This file is created so that it allows &quot;seek&quot; and binary &quot;read/write&quot; operations.
NOTES: 
(a) The maximum size of this file equals the value from the &quot;Length&quot; field of EINJv2 Extension Structure,
minus the offset to the &quot;Component Array&quot; field of EINJv2 Extension Structure (which is currently 6 bytes).
(b) As the EINJ module writes to the &quot;Component Array&quot; field, it copies a maximum number of entries based on the &quot;Component Array Count&quot; value,
not to exceed the maximum allowed length of the &quot;Component Array&quot; field.

Example of Memory error injection using standard (v1) interface:
---------------------------------------------------------------
# cd /sys/kernel/debug/apei/einj
# cat available_error_type		# See which errors can be injected
Bitmap from GET_ERROR_TYPE:
0x00000002	Processor Uncorrectable non-fatal
0x00000008	Memory Correctable
0x00000010	Memory Uncorrectable non-fatal
0x40000000	EINJv2 Error Type
Bitmap from EINJV2_GET_ERROR_TYPE:
0x00000002	EINJv2 Memory Error
# echo 0x12345000 &gt; param1		# Set memory address for injection
# echo 0xfffffffffffff000 &gt; param2	# Mask - anywhere on this page
# echo 0x2 &gt; flag            	# Memory Address and Range fields valid
# echo 0x8 &gt; error_type			# Choose Memory Correctable error
# echo 1 &gt; error_inject			# Inject now

Example of Memory error injection using EINJv2 (v2) interface:
---------------------------------------------------------------
# cd /sys/kernel/debug/apei/einj
# cat available_error_type		# See which errors can be injected
Bitmap from GET_ERROR_TYPE:
0x00000002	Processor Uncorrectable non-fatal
0x00000008	Memory Correctable
0x00000010	Memory Uncorrectable non-fatal
0x40000000	EINJv2 Error Type
Bitmap from EINJV2_GET_ERROR_TYPE:
0x00000002	EINJv2 Memory Error
# echo 0xFFFFFFF0000 &gt; param1   # Set memory address for injection
# echo 0x0 &gt; param2         	# No range mask
# echo 0xA &gt; flag            	# EINJv2 field valid, Memory Address valid
# echo 0x1 &gt; einjv2_component_count  # Set Component Array Count
#################################
## Injection tool uses file operations to write Component ID and Syndrome entries to &quot;einjv2_component_array&quot;
## For example: 
## Component ID (@ offset 0): 0x00000000000000000000000000000004
## Component Syndrome (@ offset 16): 0x000000000000000000000000A5A5A5A5
#################################
# echo 0x2 &gt; error_type			# Choose EINJv2 Memory Error
# echo 1 &gt; error_inject			# Inject now</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22311</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-02 21:52:15 +0000</bug_when>
    <thetext>The proposed document should be markdown format.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22370</commentid>
    <comment_count>3</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2024-01-16 11:51:21 +0000</bug_when>
    <thetext>This is being discussed in ASWG as: https://mantis.uefi.org/mantis/view.php?id=2435</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22661</commentid>
    <comment_count>4</comment_count>
    <who name="Rob Gough">rgough</who>
    <bug_when>2024-02-27 16:45:10 +0000</bug_when>
    <thetext>The structure shown in table 18.35 has a 32-bit field at a non-32-byte aligned address.
It&apos;s also a little odd that the length field is 3 bytes- this is uncommon in ACPI structures.
I recommend extending the Length field to 4 bytes, and the Revision field to 2 bytes. This will cause the Component Array entries (32-byte structures) to start at offset 8 of the structure.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22662</commentid>
    <comment_count>5</comment_count>
    <who name="LeoDuran@AMD">leo.duran</who>
    <bug_when>2024-02-27 16:50:18 +0000</bug_when>
    <thetext>Thanks, Rob... I don&apos;t see a problem with your proposal, and it seems clean.
So let&apos;s see if we can intercept that change.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22663</commentid>
    <comment_count>6</comment_count>
      <attachid>1478</attachid>
    <who name="Rob Gough">rgough</who>
    <bug_when>2024-02-27 17:19:31 +0000</bug_when>
    <thetext>Created attachment 1478
Original ECR plus an adjustment to alignment in table 18.35

Thanks Leo
I made those minor edits to the table- strikethrough of the original values is retained.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22672</commentid>
    <comment_count>7</comment_count>
    <who name="Rob Gough">rgough</who>
    <bug_when>2024-02-29 18:48:23 +0000</bug_when>
    <thetext>Switching back to IN_PROGRESS to capture the updated ECR attachment.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23157</commentid>
    <comment_count>8</comment_count>
      <attachid>1521</attachid>
    <who name="LeoDuran@AMD">leo.duran</who>
    <bug_when>2024-06-25 14:06:27 +0000</bug_when>
    <thetext>Created attachment 1521
EINJV2_ECR_Code_First_v3

Fix typo: Should be &quot;_GET&quot; instead of &quot;_SET&quot; for Action in section 18.6.4.1.

If the GET_ERROR_TYPE action returns the DWORD with Bit [30] set, it means that EINJv2 error types are supported, and as a result, the EINJV2_GET_ERROR_TYPE action must be present in the EINJ Action Table (see Table 18.25). The following table defines the error type bitmap returned by the EINJV2_GET_ERROR_TYPE action.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23419</commentid>
    <comment_count>9</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2024-10-02 19:23:42 +0000</bug_when>
    <thetext>Approved as errata at the March 14 ASWG meeting</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1446</attachid>
            <date>2023-12-07 15:32:26 +0000</date>
            <delta_ts>2024-06-25 14:06:27 +0000</delta_ts>
            <desc>EINJV2_ECR</desc>
            <filename>EINJV2_ECR_Code_First.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>64692</size>
            <attacher name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1478</attachid>
            <date>2024-02-27 17:19:31 +0000</date>
            <delta_ts>2024-02-27 17:19:31 +0000</delta_ts>
            <desc>Original ECR plus an adjustment to alignment in table 18.35</desc>
            <filename>EINJV2_ECR_Code_First_v2.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>64769</size>
            <attacher name="Rob Gough">rgough</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1521</attachid>
            <date>2024-06-25 14:06:27 +0000</date>
            <delta_ts>2024-06-25 14:06:27 +0000</delta_ts>
            <desc>EINJV2_ECR_Code_First_v3</desc>
            <filename>EINJV2_ECR_Code_First_v3.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>68394</size>
            <attacher name="LeoDuran@AMD">leo.duran</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4328</bug_id>
          
          <creation_ts>2023-01-30 11:12:52 +0000</creation_ts>
          <short_desc>Correct instances of RANDOM_NAME_PROTOCOL to RANDOM_NUMBER_PROTOCOL</short_desc>
          <delta_ts>2023-02-13 02:00:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Edhay">edhaya.chandran</reporter>
          <assigned_to name="Edhay">edhaya.chandran</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20943</commentid>
    <comment_count>0</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-01-30 11:12:52 +0000</bug_when>
    <thetext>There are more instances of RANDOM_NAME_PROTOCOL to be corrected to RANDOM_NUMBER_PROTOCOL

uefi-sct\SctPkg\TestCase\UEFI\EFI\Protocol\RandomNumber\BlackBoxTest\RandomNumberBBTestConformance.c
  226,22:                    L&quot;RANDOM_NAME_PROTOCOL.GetInfo - GetInfo() is not supported or EFI_DEVICE_ERROR&quot;,
  306,20:                  L&quot;RANDOM_NAME_PROTOCOL.GetRNG - GetRNG() returns EFI_INVALID_PARAMETER when RNGValueLength is 0&quot;,
  329,20:                  L&quot;RANDOM_NAME_PROTOCOL.GetRNG - GetRNG() returns EFI_INVALID_PARAMETER when RNGValue is NULL&quot;,
  355,20:                  L&quot;RANDOM_NAME_PROTOCOL.GetRNG - GetRNG() returns EFI_INVALID_PARAMETER when RNGValueLength is 0&quot;,
  378,20:                  L&quot;RANDOM_NAME_PROTOCOL.GetRNG - GetRNG() returns EFI_INVALID_PARAMETER when RNGValue is NULL&quot;,

uefi-sct\SctPkg\TestCase\UEFI\EFI\Protocol\RandomNumber\BlackBoxTest\RandomNumberBBTestConformance.c
  226,22:                    L&quot;RANDOM_NAME_PROTOCOL.GetInfo - GetInfo() is not supported or EFI_DEVICE_ERROR&quot;,
  306,20:                  L&quot;RANDOM_NAME_PROTOCOL.GetRNG - GetRNG() returns EFI_INVALID_PARAMETER when RNGValueLength is 0&quot;,
  329,20:                  L&quot;RANDOM_NAME_PROTOCOL.GetRNG - GetRNG() returns EFI_INVALID_PARAMETER when RNGValue is NULL&quot;,
  355,20:                  L&quot;RANDOM_NAME_PROTOCOL.GetRNG - GetRNG() returns EFI_INVALID_PARAMETER when RNGValueLength is 0&quot;,
  378,20:                  L&quot;RANDOM_NAME_PROTOCOL.GetRNG - GetRNG() returns EFI_INVALID_PARAMETER when RNGValue is NULL&quot;,</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20944</commentid>
    <comment_count>1</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-01-30 11:13:30 +0000</bug_when>
    <thetext>To be fixed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20968</commentid>
    <comment_count>2</comment_count>
      <attachid>1317</attachid>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-01-31 12:06:15 +0000</bug_when>
    <thetext>Created attachment 1317
Proposed patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21032</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-02-13 01:59:03 +0000</bug_when>
    <thetext>The issue is closed.
The patch is upstream by the below commit:
https://github.com/tianocore/edk2-test/commit/56093929e99cadab5cd95f560d67fe61663d67d4</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21033</commentid>
    <comment_count>4</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-02-13 02:00:04 +0000</bug_when>
    <thetext>Resolved.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1317</attachid>
            <date>2023-01-31 12:06:15 +0000</date>
            <delta_ts>2023-01-31 12:06:15 +0000</delta_ts>
            <desc>Proposed patch</desc>
            <filename>0001-UEFI-SCT-SctPkg-Replaced-the-incorrect-references-RA.patch</filename>
            <type>text/plain</type>
            <size>6529</size>
            <attacher name="Edhay">edhaya.chandran</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4151</bug_id>
          
          <creation_ts>2022-11-14 12:21:24 +0000</creation_ts>
          <short_desc>Faulty Rng algo selection for Arm</short_desc>
          <delta_ts>2023-10-26 16:32:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Pierre Gondois">pierre.gondois</reporter>
          <assigned_to name="Pierre Gondois">pierre.gondois</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20013</commentid>
    <comment_count>0</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2022-11-14 12:21:24 +0000</bug_when>
    <thetext>PcdCpuRngSupportedAlgorithm is set to the Zero Guid for KvmTool
since it is not possible to predict which algorithm will be
implemented for Arm&apos;s FEAT_RNG in the host. Current handling is:
- skipping the Zero Guid, which should not happen to handle
  KvmTool&apos;s case,
- triggering an ASSERT if no algorithm was found. However having
  no Rng algorithm is a valid case,</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20026</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-15 21:37:21 +0000</bug_when>
    <thetext>pierre.gondois@arm.com takes it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21338</commentid>
    <comment_count>2</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2023-04-07 06:31:08 +0000</bug_when>
    <thetext>V2: https://edk2.groups.io/g/devel/message/96434
V3: https://edk2.groups.io/g/devel/message/96617
V4: https://edk2.groups.io/g/devel/message/100806

The PcdCpuRngSupportedAlgorithm should describe the algorithm implemented by CPU
instructions. It is currently used to represent the algorithm implemented by the RngLib. The RngLib could be implemented using the BaseRngLibTimerLib.

To solve this, adding new GetRngLibGuid() function in the RngLib would allow to accurately identify witch Rng algorithm is implemented. A v5 will be posted soon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21942</commentid>
    <comment_count>3</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2023-09-29 04:56:37 +0000</bug_when>
    <thetext>Merged at https://edk2.groups.io/g/devel/topic/100684678#107709</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21945</commentid>
    <comment_count>4</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2023-09-29 04:59:05 +0000</bug_when>
    <thetext>Cf https://edk2.groups.io/g/devel/topic/100684678#107709</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22069</commentid>
    <comment_count>5</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:32:00 +0000</bug_when>
    <thetext>Apparently fixed within commit range 2ce5ae43c216..ff7ddc02b273.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4797</bug_id>
          
          <creation_ts>2024-06-24 23:21:22 +0000</creation_ts>
          <short_desc>MdePkg/BaseLib: Fix an instruction write width error in LoongArch64</short_desc>
          <delta_ts>2024-06-25 21:26:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>qiandongyan</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23152</commentid>
    <comment_count>0</comment_count>
    <who name="">qiandongyan</who>
    <bug_when>2024-06-24 23:21:22 +0000</bug_when>
    <thetext>Cpucfg fetch is a 32-bit register, and AsmCpucfg&apos;s function
  declaration is a 32-bit address storage operation in BaseLib.h,
So, fix it by replacing stptr.d with stptr.w instrcution.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23159</commentid>
    <comment_count>1</comment_count>
    <who name="">qiandongyan</who>
    <bug_when>2024-06-25 21:26:26 +0000</bug_when>
    <thetext>REF: https://github.com/tianocore/edk2/pull/5819</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4026</bug_id>
          
          <creation_ts>2022-08-22 23:57:09 +0000</creation_ts>
          <short_desc>ShellPkg smbiosview type 9 unexpected field displayed and miss Slot Pitch field</short_desc>
          <delta_ts>2023-09-27 02:31:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Horace Lien">horacex.lien</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>horacex.lien</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19420</commentid>
    <comment_count>0</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2022-08-22 23:57:09 +0000</bug_when>
    <thetext>I have two questions for this topic.

1. ShellPkg smbiosview Type9 will display some slot information.
However, these functions should be add SMBIOS version condition to suppress display information. Currently, these functions follow SMBIOS 3.2 condition to display.
It is increased from SMBIOS 3.4
DisplaySystemSlotPhysicalWidth()
DisplaySystemSlotInformation()
It is increased from SMBIOS 3.5
DisplaySystemSlotHeight()

2. Miss display information for &quot;Slot Pitch&quot; field
&quot;Slot Pitch&quot; is from SMBIOS 3.4, this information is not currently displayed.

Thanks</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19495</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-06 22:06:15 +0000</bug_when>
    <thetext>horacex.lien@intel.com: will you contribute the patch to fix them?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19528</commentid>
    <comment_count>2</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2022-09-07 21:45:18 +0000</bug_when>
    <thetext>Hi gaoliming,

I just see this issue, is there anyone else who can help with this?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21941</commentid>
    <comment_count>3</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2023-09-27 02:31:43 +0000</bug_when>
    <thetext>Reject since it is been too long</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4652</bug_id>
          
          <creation_ts>2024-01-21 21:20:38 +0000</creation_ts>
          <short_desc>PciIoMap does not return status from mIoMmuProtocol-&gt;SetAttribute</short_desc>
          <delta_ts>2024-01-29 12:14:52 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Sheng Wei">w.sheng</reporter>
          <assigned_to name="Sheng Wei">w.sheng</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22392</commentid>
    <comment_count>0</comment_count>
    <who name="Sheng Wei">w.sheng</who>
    <bug_when>2024-01-21 21:20:38 +0000</bug_when>
    <thetext>For file /Edk2/MdeModulePkg/Bus/Pci/PciBusDxe/PciIo.c,
Function PciIoMap () does not return the status from mIoMmuProtocol-&gt;SetAttribute ().
PciIoMap() need to feedback the return value of mIoMmuProtocol-&gt;SetAttribute().</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22435</commentid>
    <comment_count>1</comment_count>
    <who name="Sheng Wei">w.sheng</who>
    <bug_when>2024-01-28 21:38:54 +0000</bug_when>
    <thetext>patch is merged.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22436</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2024-01-29 12:14:52 +0000</bug_when>
    <thetext>049695a0b1e2 (&quot;MdeModulePkg/PciBusDxe: Add feedback status for PciIoMap&quot;, 2024-01-25)</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4502</bug_id>
          
          <creation_ts>2023-07-18 04:34:54 +0000</creation_ts>
          <short_desc>SplitFspBin.py cannot support FSP binary with child FV included</short_desc>
          <delta_ts>2023-10-26 15:58:25 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>ted.kuo</reporter>
          <assigned_to>ted.kuo</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21718</commentid>
    <comment_count>0</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2023-07-18 04:34:54 +0000</bug_when>
    <thetext>FSP rebase failed with SplitFspBin.py when FSP binary has child FV included.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21727</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:16:24 +0000</bug_when>
    <thetext>ted.kuo@intel.com, please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22061</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 15:58:25 +0000</bug_when>
    <thetext>Apparently fixed in commit 2c7fd32676272e22ed44fdfc8fa7e47f5c7a93b8.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4178</bug_id>
          
          <creation_ts>2022-11-30 16:09:53 +0000</creation_ts>
          <short_desc>UnitTestFrameworklPkg DEC - Make GoogleTestLib and UnitTestPersistenceLib public</short_desc>
          <delta_ts>2022-12-01 16:02:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.kubacki</cc>
    
    <cc>ray.ni</cc>
    
    <cc>sean.brogan</cc>
    
    <cc>zhiguang.liu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UnitTestFrameworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20153</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-30 16:09:53 +0000</bug_when>
    <thetext>GoogleTestLib is declared in [LibraryClasses.Common.Private] that
makes it private to the UnitTestFrameworkPkg.  GoogleTestLib must 
be used by by unit tests in other packages and other repositories,
so update it to be in public [LibraryClasses] section.

UnitTestPersistenceLib is also declared in [LibraryClasses.Common.Private].
The only implementation of this class is in the UnitTestFrameworkPkg and
it uses the Simple File System Protocol to save/restore state.  This
works well of target based tests that run from the UEFI Shell when a
file system is available, but does not work for PEI, DXE, SMM target
based unit tests.  Change to library class to be public in [LibraryClasses]
section to allow other packages to use this class header files and 
provide implement that use alternate persistent storage devices.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20154</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-30 16:11:07 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20155</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-30 16:20:56 +0000</bug_when>
    <thetext>Patch review email:
https://edk2.groups.io/g/devel/message/96764</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20166</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-12-01 16:02:43 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/3686

Commit: https://github.com/tianocore/edk2/commit/a1d57239140f09a8b2cc386f9421f6f4e634435f</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4051</bug_id>
          
          <creation_ts>2022-09-07 22:17:16 +0000</creation_ts>
          <short_desc>SMBIOS Type 4 CurrentSpeed field can be various to reflect processor current speed in turbo mode case</short_desc>
          <delta_ts>2022-09-13 22:15:02 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Heng Luo">heng.luo</reporter>
          <assigned_to name="Heng Luo">heng.luo</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19530</commentid>
    <comment_count>0</comment_count>
    <who name="Heng Luo">heng.luo</who>
    <bug_when>2022-09-07 22:17:16 +0000</bug_when>
    <thetext>In turbo mode case, the current speed is not always same, CPU frequency can run at any value &gt;= p1 if turbo enabled, which is recorded in the MSR 198. It means SMBIOS Type 4 CurrentSpeed field can be various to reflect processor current speed in turbo mode case</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19533</commentid>
    <comment_count>1</comment_count>
    <who name="Heng Luo">heng.luo</who>
    <bug_when>2022-09-08 02:01:28 +0000</bug_when>
    <thetext>
The Type4 CurrentSpeed field may be various. So adds it into the filter table.
Patch review: https://edk2.groups.io/g/devel/message/93516</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19562</commentid>
    <comment_count>2</comment_count>
    <who name="Heng Luo">heng.luo</who>
    <bug_when>2022-09-13 22:15:02 +0000</bug_when>
    <thetext>patch is merged
https://github.com/tianocore/edk2/pull/3318</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4671</bug_id>
          
          <creation_ts>2024-02-03 17:34:57 +0000</creation_ts>
          <short_desc>Building LOONGARCH64 SCT with GCC 13.2 fails due to fallback to GCC4.9 profile</short_desc>
          <delta_ts>2024-02-03 18:14:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Heinrich Schuchardt">xypron.glpk</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>lichao</cc>
    
    <cc>xypron.glpk</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22515</commentid>
    <comment_count>0</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2024-02-03 17:34:57 +0000</bug_when>
    <thetext>uefi-sct/SctPkg/build.sh determines the used GCC.

It compare the version to the string &quot;5&quot;. If the version is higher in a string comparison, the version is translated to 5.

The string value &quot;13.2.0&quot; is less then &quot;5&quot;.

This results in falling back to building with GCC49. Building with GCC49 is not defined for the LoongArch64 architectures.

We must replace the string comparison by a numeric comparison.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22516</commentid>
    <comment_count>1</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2024-02-03 18:14:04 +0000</bug_when>
    <thetext>There was something wrong in my script. Closing as invalid.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4527</bug_id>
          
          <creation_ts>2023-08-17 21:42:21 +0000</creation_ts>
          <short_desc>MadtMpWk-&gt;MailBoxVersion = 1;  should be 0 according to the ACPI spec 6.5</short_desc>
          <delta_ts>2023-10-26 16:40:04 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>jiewen.yao</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21836</commentid>
    <comment_count>0</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-08-17 21:42:21 +0000</bug_when>
    <thetext>ACPI 6.5 - https://uefi.org/specs/ACPI/6.5/05_ACPI_Software_Programming_Model.html?highlight=mailboxversion#multiprocessor-wakeup-structure

The MailBoxVersion  is 0.


https://github.com/tianocore/edk2/blob/master/OvmfPkg/TdxDxe/TdxAcpiTable.c#L189

MadtMpWk-&gt;MailBoxVersion = 1;

It should be changed to 0.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21911</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-09-13 01:42:35 +0000</bug_when>
    <thetext>merged https://github.com/tianocore/edk2/pull/4825</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22072</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:40:04 +0000</bug_when>
    <thetext>commit b844b106e2a20c709ece1b2b89b2ae0e84a0e401</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4391</bug_id>
          
          <creation_ts>2023-03-28 14:07:50 +0000</creation_ts>
          <short_desc>IntelFsp2Pkg: LoadMicrocodeDefault() causing unnecessary delay.</short_desc>
          <delta_ts>2023-04-04 13:41:37 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21276</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-28 14:07:50 +0000</bug_when>
    <thetext>Current implementation caused unnecessary delay in some scenarios which needs optimization.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21277</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-28 14:08:18 +0000</bug_when>
    <thetext>working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21278</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-28 14:21:40 +0000</bug_when>
    <thetext>code review sent:
https://edk2.groups.io/g/devel/message/102059</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21293</commentid>
    <comment_count>3</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-31 19:12:44 +0000</bug_when>
    <thetext>V3 patch sent: https://edk2.groups.io/g/devel/message/102334</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21310</commentid>
    <comment_count>4</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-04-04 13:41:37 +0000</bug_when>
    <thetext>patch merged:
https://github.com/tianocore/edk2/commit/7df447930c42addaf2cc0d32916141d95ded677e</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4852</bug_id>
          
          <creation_ts>2024-09-14 01:58:14 +0000</creation_ts>
          <short_desc>HttpBootCallbackProtocol uninstall code in HttpBootImpl.c is bugged and fails to uninstall</short_desc>
          <delta_ts>2024-10-20 04:49:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Mike Beaton">mjsbeaton</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23399</commentid>
    <comment_count>0</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-09-14 01:58:14 +0000</bug_when>
    <thetext>The existing HttpBootUninstallCallback passes the wrong handle (the PrivateData root controller handle, not the correct child IPv4 or IPv6 NIC controller handle) when uninstalling https://github.com/tianocore/edk2/blob/69139e39bc9bd7410ee71a830b812fb74d21bdb4/NetworkPkg/HttpBootDxe/HttpBootImpl.c#L82, and also passes the address of a pointer to the interface to be removed rather than the pointer itself https://github.com/tianocore/edk2/blob/69139e39bc9bd7410ee71a830b812fb74d21bdb4/NetworkPkg/HttpBootDxe/HttpBootImpl.c#L84. For both these reasons, it always fails with EFI_NOT_FOUND.

See HttpBootInstallCallback above in the file for closely matching logic indicating what should be done with the handles in the uninstall: https://github.com/tianocore/edk2/blob/69139e39bc9bd7410ee71a830b812fb74d21bdb4/NetworkPkg/HttpBootDxe/HttpBootImpl.c#L12-L61

These bugs result in the behaviour that if multiple HTTP boot attempts are made, on the second and subsequent attempts the instance of this protocol installed by the first attempt is re-used. As long as only one driver using the protocol is installed, this ends up producing the same results as if the protocol had been uninstalled then reinstalled correctly.

This is clearly not the intended behaviour and will not work as expected for anyone looking to receive notify events on installs of this protocol, for example; nor would it work correctly in the (unlikely) event that one instance of the HTTP boot driver was used after a different instance.

I have produced a PR fixing this https://github.com/tianocore/edk2/pull/6202. The incorrect previous behaviour and the corrected new behaviour were verified by single step debugging on the OVMF platform.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23467</commentid>
    <comment_count>1</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-10-20 04:49:11 +0000</bug_when>
    <thetext>Fixed by https://github.com/tianocore/edk2/commit/73dbb68006caf538d1b69a11e306b161526932f3.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4076</bug_id>
          
          <creation_ts>2022-09-21 05:12:29 +0000</creation_ts>
          <short_desc>Add support for RISC-V qemu virt machine</short_desc>
          <delta_ts>2023-02-16 23:20:38 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sunil V L">sunilvl</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19606</commentid>
    <comment_count>0</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-21 05:12:29 +0000</bug_when>
    <thetext>This BZ is created for adding support for RISC-V virt machine in edk2 repo.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19647</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:14:52 +0000</bug_when>
    <thetext>Sunil, please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21089</commentid>
    <comment_count>2</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2023-02-16 23:20:38 +0000</bug_when>
    <thetext>Merged as part of https://github.com/tianocore/edk2/pull/4023</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4077</bug_id>
          
          <creation_ts>2022-09-22 02:40:20 +0000</creation_ts>
          <short_desc>Remove enforcement of final GoIdle transition for CRB TPM commands.</short_desc>
          <delta_ts>2022-10-26 13:51:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Rodrigo Gonzalez del Cueto">rodrigo.gonzalez.del.cueto</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19607</commentid>
    <comment_count>0</comment_count>
    <who name="Rodrigo Gonzalez del Cueto">rodrigo.gonzalez.del.cueto</who>
    <bug_when>2022-09-22 02:40:20 +0000</bug_when>
    <thetext>Following the design described in the TCG PC Client Device Driver Design Principles for TPM 2.0, the driver implementation of the CRB protocol does not require enforcing completing the transition to goIdle at the end of a command
sequence.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19608</commentid>
    <comment_count>1</comment_count>
    <who name="Rodrigo Gonzalez del Cueto">rodrigo.gonzalez.del.cueto</who>
    <bug_when>2022-09-22 02:43:40 +0000</bug_when>
    <thetext>See: TCG PC Client Device Driver Design Principles for TPM 2.0
Version 1.1, Revision 0.04, November 22, 2021.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19609</commentid>
    <comment_count>2</comment_count>
    <who name="Rodrigo Gonzalez del Cueto">rodrigo.gonzalez.del.cueto</who>
    <bug_when>2022-09-22 03:40:42 +0000</bug_when>
    <thetext>Proposed patch: https://edk2.groups.io/g/devel/message/94113</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19847</commentid>
    <comment_count>3</comment_count>
    <who name="Rodrigo Gonzalez del Cueto">rodrigo.gonzalez.del.cueto</who>
    <bug_when>2022-10-26 13:51:26 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/commit/7aa06237b856fd6f8187cc1715a3fe08ab4e98ed</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4700</bug_id>
          
          <creation_ts>2024-02-23 12:15:35 +0000</creation_ts>
          <short_desc>No check on return value for TpmMeasureAndLogDataWithFlags()</short_desc>
          <delta_ts>2024-03-15 10:55:39 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="John Mathews">john.mathews</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>du.lin</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202302</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2WrapperPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22634</commentid>
    <comment_count>0</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-02-23 12:15:35 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/blob/11ad164bcea6b0ed3628d595090f84892c367086/IntelFsp2WrapperPkg/Library/BaseFspMeasurementLib/FspMeasurementLib.c#L191

TpmMeasureAndLogDataWithFlags() computes the measure the code and log it into PCR 0. TpmMeasureAndLogData() computes the hash for the configuration. The same &quot;Status&quot; variable is used to store the return values for both of the functions. There is no error handling if TpmMeasureAndLogDataWithFlags() returns an error Status.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22711</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 21:55:37 +0000</bug_when>
    <thetext>chasel.chiu@intel.com: please check it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22782</commentid>
    <comment_count>2</comment_count>
    <who name="">du.lin</who>
    <bug_when>2024-03-13 01:48:09 +0000</bug_when>
    <thetext>A patch has been sent to edk2_devel mail list: https://edk2.groups.io/g/devel/message/116685.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22799</commentid>
    <comment_count>3</comment_count>
    <who name="">du.lin</who>
    <bug_when>2024-03-15 10:55:39 +0000</bug_when>
    <thetext>The patch has been submitted to Edk2 upstream:
SHA-1: ccbbc2a5c84a0330b28b726ef0936fc16937005a.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4241</bug_id>
          
          <creation_ts>2023-01-03 01:52:39 +0000</creation_ts>
          <short_desc>Remove platform specific logic via protocol for bds</short_desc>
          <delta_ts>2023-02-23 03:03:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>mars_cc_lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20369</commentid>
    <comment_count>0</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-01-03 01:52:39 +0000</bug_when>
    <thetext>Since UefiPayloadPkg had supported multiple firmware volume, remove the platform specific logic via protocol for bds.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20370</commentid>
    <comment_count>1</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-01-03 01:52:56 +0000</bug_when>
    <thetext>I&apos;m working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21109</commentid>
    <comment_count>2</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-02-23 03:03:00 +0000</bug_when>
    <thetext>The change had implemented and close this bugzilla.
https://github.com/tianocore/edk2/pull/3846</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4107</bug_id>
          
          <creation_ts>2022-10-18 04:52:06 +0000</creation_ts>
          <short_desc>edk2-libc help built-in function in python uefi is not working as expected</short_desc>
          <delta_ts>2023-02-22 03:01:33 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ajay Kadapathri">ajay.kadapathri</reporter>
          <assigned_to name="Ajay Kadapathri">ajay.kadapathri</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>n.jayaprakash</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19780</commentid>
    <comment_count>0</comment_count>
    <who name="Ajay Kadapathri">ajay.kadapathri</who>
    <bug_when>2022-10-18 04:52:06 +0000</bug_when>
    <thetext>Currently, the Py3 UEFI code available in edk2-libc has an issue with the help built-in function, it doesn&apos;t provide the human readable help information. This bug needs to be fixed so that the help function could be used to get the right information about python constructs.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19781</commentid>
    <comment_count>1</comment_count>
    <who name="Ajay Kadapathri">ajay.kadapathri</who>
    <bug_when>2022-10-18 04:56:52 +0000</bug_when>
    <thetext>I will be working on resolving this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21100</commentid>
    <comment_count>2</comment_count>
    <who name="Ajay Kadapathri">ajay.kadapathri</who>
    <bug_when>2023-02-22 03:01:33 +0000</bug_when>
    <thetext>This has been fixed and the changes are merged to the edk2-libc master / main repo.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4741</bug_id>
          
          <creation_ts>2024-03-28 04:52:41 +0000</creation_ts>
          <short_desc>Update Md5/Sha1/Sha2 by using the new API from Mbedtls in BasecryptoMbedtls</short_desc>
          <delta_ts>2024-04-02 00:40:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>wenxing.hou</reporter>
          <assigned_to>wenxing.hou</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22836</commentid>
    <comment_count>0</comment_count>
    <who name="">wenxing.hou</who>
    <bug_when>2024-03-28 04:52:41 +0000</bug_when>
    <thetext>Both Md5, Sha1 and Sha2 use the old api in mbedtls by including mbedtls/compat-2.x.h.

The old API is defined to the new API:
#define mbedtls_sha256_starts_ret     mbedtls_sha256_starts
#define mbedtls_sha256_update_ret     mbedtls_sha256_update

It is better to use the new api, because the old api may be deprecated in the future.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22842</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-28 22:17:43 +0000</bug_when>
    <thetext>please take it</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22846</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-02 00:40:31 +0000</bug_when>
    <thetext>pushed: https://github.com/tianocore/edk2/commit/d402de2222c3b9f52712df63dffc9a510c8fe68e</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4591</bug_id>
          
          <creation_ts>2023-11-06 04:23:57 +0000</creation_ts>
          <short_desc>[MdePkg] Add NVMe Sanitize command support to Nvme.h</short_desc>
          <delta_ts>2023-12-14 21:42:16 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Tina Chen">tina.chen</reporter>
          <assigned_to name="Tina Chen">tina.chen</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>sean.brogan</cc>
    
    <cc>tina.chen</cc>
    
    <cc>xiao.x.chen</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22133</commentid>
    <comment_count>0</comment_count>
    <who name="Tina Chen">tina.chen</who>
    <bug_when>2023-11-06 04:23:57 +0000</bug_when>
    <thetext>1. Refer NVME spec 2.0c chapter 5.24, add Sanitize Command related definition.
2. Refer NVME spec 2.0c chapter 5.16, add Get Log Page Command related definition for Sanitize status support.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22134</commentid>
    <comment_count>1</comment_count>
    <who name="Tina Chen">tina.chen</who>
    <bug_when>2023-11-06 04:25:19 +0000</bug_when>
    <thetext>Changed status to CONFIRMED</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22136</commentid>
    <comment_count>2</comment_count>
    <who name="Sean Brogan">sean.brogan</who>
    <bug_when>2023-11-07 13:54:05 +0000</bug_when>
    <thetext>have you looked at the work we are shipping here: https://github.com/microsoft/mu_basecore/pull/107

I would like to align</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22142</commentid>
    <comment_count>3</comment_count>
    <who name="Tina Chen">tina.chen</who>
    <bug_when>2023-11-09 02:56:07 +0000</bug_when>
    <thetext>Hi Sean,

Thanks for sharing.
Align some definitions with the patch you shared.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22270</commentid>
    <comment_count>4</comment_count>
    <who name="Tina Chen">tina.chen</who>
    <bug_when>2023-12-14 21:42:16 +0000</bug_when>
    <thetext>Code change merged: 

https://github.com/tianocore/edk2/commit/ef3fde64aa78598a4c21556629936fb228390e8c</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4130</bug_id>
          
          <creation_ts>2022-10-28 14:28:24 +0000</creation_ts>
          <short_desc>Simplify CryptoPkg host-based unit tests by using FILE_GUID in DSC file to test multiple OpensslLib instances</short_desc>
          <delta_ts>2022-11-01 23:36:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          <dependson>4129</dependson>
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jian.j.wang</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19868</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-28 14:28:24 +0000</bug_when>
    <thetext>A temp change was made to add a 2nd host based unit test INF file to run the same unit tests with 2 different OpensslLib instances.  This was required due to a bug in use of FILE_GUID override for INFs with module type HOST_APPLICATION.

Bug #4179 resolves this issue and can allow this temp change to be removed
and increase OpensslLib test coverage.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19869</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-28 14:29:21 +0000</bug_when>
    <thetext>Assign to owner.

Add dependency on 4129</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19870</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-28 14:31:50 +0000</bug_when>
    <thetext>Recommended changes:

Remove INF CryptoPkg/Test/UnitTest/Library/BaseCryptLib/TestBaseCryptLibHostAccel.inf

Update CryptoPkg/Test/CryptoPkgHostUnitTest.dsc to use
CryptoPkg/Test/UnitTest/Library/BaseCryptLib/TestBaseCryptLibHost.inf
multiple times with FILE_GUID overrides to run unit tests against
all the OpensslLib instances.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19893</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-01 11:04:32 +0000</bug_when>
    <thetext>Code review email

https://edk2.groups.io/g/devel/message/95708</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19907</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-01 23:35:43 +0000</bug_when>
    <thetext>Commit:
https://github.com/tianocore/edk2/commit/8487ec0ee71516e4c7094c39303db6a2bc765d20

PR:
https://github.com/tianocore/edk2/pull/3574</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19908</commentid>
    <comment_count>5</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-01 23:36:00 +0000</bug_when>
    <thetext>Completed</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4771</bug_id>
          
          <creation_ts>2024-05-06 05:18:38 +0000</creation_ts>
          <short_desc>AlderlakeOpenBoardPkg: Update to reference RaptorLakeFspBinPkg FSP.</short_desc>
          <delta_ts>2024-05-06 13:25:49 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>Placeholder</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dora Hsueh">dorax.hsueh</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23007</commentid>
    <comment_count>0</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2024-05-06 05:18:38 +0000</bug_when>
    <thetext>Due to AlderLakeFspBinPkg will not be maintained going forward, ADL Openboard will reference RaptorLakeFspBinPkg FSP.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23008</commentid>
    <comment_count>1</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-05-06 13:09:32 +0000</bug_when>
    <thetext>Dora is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23009</commentid>
    <comment_count>2</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-05-06 13:10:15 +0000</bug_when>
    <thetext>Patch sent: https://edk2.groups.io/g/devel/message/118591</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23010</commentid>
    <comment_count>3</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-05-06 13:25:49 +0000</bug_when>
    <thetext>Pushed: https://github.com/tianocore/edk2-platforms/commit/7e51d29</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4004</bug_id>
          
          <creation_ts>2022-07-21 14:17:22 +0000</creation_ts>
          <short_desc>EDKII HII Browser does not apply configuration values for F9 action</short_desc>
          <delta_ts>2022-07-21 14:40:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Reference Implementation</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4005</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Sandesh Shetty">sandesh.shetty</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>UEFI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19316</commentid>
    <comment_count>0</comment_count>
    <who name="Sandesh Shetty">sandesh.shetty</who>
    <bug_when>2022-07-21 14:17:22 +0000</bug_when>
    <thetext>Steps for reproducing issue:

1. Choose any device/platform BIOS menu on Emulator where the configuration can be changed.

2. Code changes required:
Go to the supporting HII driver&apos;s HIIConfigAccess.Callback() function and set the output parameter &apos;ActionRequest&apos; to EFI_BROWSER_ACTION_REQUEST_FORM_APPLY for action EFI_BROWSER_ACTION_DEFAULT_STANDARD (invoked when F9 is pressed).

3. Change the value of any device/platform configuration in the BIOS menu.

4. Press F9 to reset the values to default.

5. Check if &apos;Configuration Changed&apos; notification is shown on the BIOS menu at the bottom right-hand side corner.

Expected behavior:
Default values set using HIIConfigAccess.Callback() should be applied immediately if EFI_BROWSER_ACTION_REQUEST_FORM_APPLY is set.
&apos;Configuration Changed&apos; notification should not be shown by the HII Browser on the BIOS screen.

Actual behavior:
&apos;Configuration Changed&apos; notification is shown by the HII Browser on the BIOS screen.

Special Notes:
Currently, the EDK2 HII Browser implementation of HIIConfigAccess.Callback() function ignores all actions except EFI_BROWSER_ACTION_CHANGED for output parameter &apos;ActionRequest&apos;.

Use Case:
In our HII driver, the storage questions are used only to take inputs from the user and they do not correspond to any device configuration or setting.
We have added action buttons in our forms to invoke device protocol functions and the user inputs (storage question values) are passed as arguments to this function.
So, we don’t want the ‘Configuration Changed’ notification to be shown in the HII form window when the storage question value changes.
Currently, these storage question values are changed only under actions EFI_BROWSER_ACTION_CHANGED and EFI_BROWSER_ACTION_DEFAULT_STANDARD.
We have been able to suppress the ‘Configuration Changed’ notification only for EFI_BROWSER_ACTION_CHANGED, by setting the output parameter ‘ActionRequest’ to EFI_BROWSER_ACTION_REQUEST_FORM_APPLY.
‘Configuration Changed’ notification would be misleading or confusing for our users.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19318</commentid>
    <comment_count>1</comment_count>
    <who name="Sandesh Shetty">sandesh.shetty</who>
    <bug_when>2022-07-21 14:40:45 +0000</bug_when>
    <thetext>Duplicate of https://bugzilla.tianocore.org/show_bug.cgi?id=4005.
Marking this as resolved.

*** This bug has been marked as a duplicate of bug 4005 ***</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4330</bug_id>
          
          <creation_ts>2023-01-31 05:13:46 +0000</creation_ts>
          <short_desc>LoongArch64 UINT64 and INT64 are not strictly defined</short_desc>
          <delta_ts>2023-02-01 21:50:25 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20966</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-01-31 05:13:46 +0000</bug_when>
    <thetext>LoongArch64 UINT64 is defined unsigned as long and INT64 defined as long, not strict, needs fixing.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20967</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-01-31 05:15:07 +0000</bug_when>
    <thetext>I&apos;m working on this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20982</commentid>
    <comment_count>2</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2023-02-01 21:50:25 +0000</bug_when>
    <thetext>Merged, close it.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4152</bug_id>
          
          <creation_ts>2022-11-14 21:58:52 +0000</creation_ts>
          <short_desc>Enable Separate-Fv in OvmfPkg/IntelTdx</short_desc>
          <delta_ts>2023-01-17 22:06:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20015</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-11-14 21:58:52 +0000</bug_when>
    <thetext>In current DXE FV there are 100+ drivers. Some of the drivers are not used in Td guest. (Such as USB support drivers, network related drivers, etc).

From the security perspective if a driver is not used, we&apos;d should prevent it from being loaded/started. There are 2 benefits: 
1. Reduce the attack surface
2. Improve the boot performance

So we proposal the Separate-Fv which separates DXEFV into 2 FVs: DXEFV and NCCFV.
All the drivers which are not needed by a Confidential Computing guest are moved from DXEFV to NCCFV.

When booting a CC guest only the drivers in DXEFV will be loaded and started. For a Non-CC guest both DXEFV and NCCFV drivers will be loaded and started.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20016</commentid>
    <comment_count>1</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-11-15 01:12:34 +0000</bug_when>
    <thetext>Min is working on this feature.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20025</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-15 21:36:00 +0000</bug_when>
    <thetext>min.m.xu@intel.com: is this a new feature?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20039</commentid>
    <comment_count>3</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-11-15 22:08:54 +0000</bug_when>
    <thetext>Yes, this is a new feature.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20707</commentid>
    <comment_count>4</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-17 22:06:03 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3916</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4799</bug_id>
          
          <creation_ts>2024-06-25 05:36:21 +0000</creation_ts>
          <short_desc>Enable Tcg2Acpi and Tcg2StandaloneMm in incoming x86 standalone mm</short_desc>
          <delta_ts>2024-07-02 01:37:38 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dun Tan">dun.tan</reporter>
          <assigned_to name="Dun Tan">dun.tan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23155</commentid>
    <comment_count>0</comment_count>
    <who name="Dun Tan">dun.tan</who>
    <bug_when>2024-06-25 05:36:21 +0000</bug_when>
    <thetext>---Goal of this task
Enable Tcg2Acpi and Tcg2StandaloneMm in incoming x86 standalone mm
1.Replace the dynamic pcd usage in Tcg2StandaloneMm driver with HOB usage.
2.Allocate Runtime buffer and unblock the communication buffer in PEI phase which is used in Tcg2Acpi driver.

---Background
The patch set is not to solve any existing issue. It’s to enable Tcg2Acpi and Tcg2StandaloneMm in the incoming X86 standalone MM. There will be a PR including a set of patches to enable standalone MM for X86. In the new infrastructure, non-mm buffer used in mm environment should be allocated and unblocked in early phase before the standalone mm env setup. That’s why we need this patch set to be merged first.

---Test I&apos;ve done
Boot Intel internal platform with standalone mm into shell. The code behavior in following modules is as expected.
Platform: Intel internal platform with standalone mm
Physical presence related tcg2 modules:
    SecurityPkg/Tcg/Tcg2Config/Tcg2ConfigPei.inf
    SecurityPkg/Tcg/Tcg2Acpi/Tcg2Acpi.inf
    SecurityPkg/Tcg/Tcg2Smm/Tcg2StandaloneMm.inf
PCD configuration：
    PcdTpmInstanceGuid--&gt;gEfiTpmDeviceInstanceTpm20DtpmGuid
    PcdTcgPhysicalPresenceInterfaceVer--&gt;&quot;1.3&quot;

---If any compatibility issue for existing platforms
I checked related platform DSC file that include tcg2 related modules and did not find any compatibility issue for existing platforms.
There is a similar module OvmfPkg\Tcg\Tcg2Config\Tcg2ConfigPei.inf in ArmVirtQemu.dsc. But the DSC file doesn&apos;t include physical presence related modules(Tcg2Acpi.inf and Tcg2StandaloneMm.inf). So I did not make the changes in this Tcg2ConfigPei of ovmfpkg that I made in Tcg2ConfigPei of securitypkg.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23156</commentid>
    <comment_count>1</comment_count>
    <who name="Dun Tan">dun.tan</who>
    <bug_when>2024-06-25 05:46:26 +0000</bug_when>
    <thetext>This bugzila is for the PR https://github.com/tianocore/edk2/pull/5728</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23161</commentid>
    <comment_count>2</comment_count>
    <who name="Ray Ni">ray.ni</who>
    <bug_when>2024-06-28 02:03:14 +0000</bug_when>
    <thetext>change to confirmed state.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23164</commentid>
    <comment_count>3</comment_count>
    <who name="Dun Tan">dun.tan</who>
    <bug_when>2024-06-30 23:29:22 +0000</bug_when>
    <thetext>---Test I&apos;ve done
I also did test to verify TCG PP feature with traditional SMM today. With the code change applied, I boot Intel internal server platform with traditional smm into OS. The code behavior in the TCG PP feature related modules were as expected.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23170</commentid>
    <comment_count>4</comment_count>
    <who name="Dun Tan">dun.tan</who>
    <bug_when>2024-07-02 01:37:38 +0000</bug_when>
    <thetext>Change to resolved state.
The related PR has been merged. https://github.com/tianocore/edk2/pull/5728</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4027</bug_id>
          
          <creation_ts>2022-08-23 02:30:18 +0000</creation_ts>
          <short_desc>IntelSiliconPkg: use the correct argements for the DEBUG macros</short_desc>
          <delta_ts>2022-08-24 02:19:59 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>IntelSiliconPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ashraf Ali S">ashraf.ali.s</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>ashraf.ali.s</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19421</commentid>
    <comment_count>0</comment_count>
    <who name="Ashraf Ali S">ashraf.ali.s</who>
    <bug_when>2022-08-23 02:30:18 +0000</bug_when>
    <thetext>use the correct argements for the DEBUG macros.

1) Edk2Platforms/Silicon/Intel/IntelSiliconPkg/Feature/PcieSecurity/IntelPciDeviceSecurityDxe/IntelPciDeviceSecurityDxe.c -&gt; DEBUG((DEBUG_INFO, &quot;ExtendDigestRegister...\n&quot;, ExtendDigestRegister));

2) Edk2Platforms/Silicon/Intel/IntelSiliconPkg/Feature/VTd/IntelVTdDxe/VtdReg.c -&gt; 

a) DEBUG ((DEBUG_INFO, &quot; VerReg:\n&quot;, VerReg-&gt;Uint32));

b) DEBUG((DEBUG_INFO, &quot; CapReg:\n&quot;, CapReg-&gt;Uint64));

c) DEBUG((DEBUG_INFO, &quot; ECapReg:\n&quot;, ECapReg-&gt;Uint64));</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19428</commentid>
    <comment_count>1</comment_count>
    <who name="Ashraf Ali S">ashraf.ali.s</who>
    <bug_when>2022-08-24 01:50:17 +0000</bug_when>
    <thetext>it&apos;s a valid change required to update the debug macro parameter.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19429</commentid>
    <comment_count>2</comment_count>
    <who name="Ashraf Ali S">ashraf.ali.s</who>
    <bug_when>2022-08-24 02:19:59 +0000</bug_when>
    <thetext>Changes has been pushed.

https://github.com/tianocore/edk2-platforms/commit/e12240390fdee2e8910fc2f740dc4ebf8120a201</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4653</bug_id>
          
          <creation_ts>2024-01-24 04:54:48 +0000</creation_ts>
          <short_desc>MdeModulePkg/Core/DxeIplPeim: Enhance the Code in DxeIplFindDxeCore Function</short_desc>
          <delta_ts>2024-07-23 04:52:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jason Lin">jason1.lin</reporter>
          <assigned_to name="Jason Lin">jason1.lin</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22397</commentid>
    <comment_count>0</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-01-24 04:54:48 +0000</bug_when>
    <thetext>After code review of the this function code, there exist below items could be enhanced.

[1] Debug and Release BIOS behavior is not aligned
-&gt; In line 492, system would be ASSERT and hang when all the available FVs get visit.
-&gt; Compared to Release build, ASSERT would not take effect.
-&gt; SUT would be stuck in infinite looping.


[2] Potential Overflow might happen when DxeCore not found in Release build
-&gt; Continue as [1], SUT would be in infinite looping once the DxeLoad not found.
-&gt; The &quot;Instance&quot; variable (UINTN) would be added in infinite looping until overflow.
-&gt; We shall stop the system once all the available FVs get visit and cannot find the DxeLoad.


[3] Infinite Progress Code would be signal once DxeCore not found in Release Build
-&gt; Continue as [2], in the infinite looping the same progress code would be signal infinite also.
-&gt; Same progress code shall be signal once enough.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22398</commentid>
    <comment_count>1</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-01-24 04:55:26 +0000</bug_when>
    <thetext>Tentative patch would be sent out.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23254</commentid>
    <comment_count>2</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-07-23 04:52:32 +0000</bug_when>
    <thetext>PR had been raised (https://github.com/tianocore/edk2/pull/5881) and merged.
It is part of the EDK-II codebase.
SHA1-ID: b3441e01003ab91df816263df98f9675b2cd2aa1

Move the status to &quot;Resolved&quot; and &quot;Fixed&quot;</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4503</bug_id>
          
          <creation_ts>2023-07-18 06:38:21 +0000</creation_ts>
          <short_desc>Tianocore wiki : Stuart build instruction has a minor documentation issue</short_desc>
          <delta_ts>2023-08-24 00:58:02 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Documentation</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>michael.kubacki</cc>
    
    <cc>n.jayaprakash</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          <cf_documents>Wiki Pages</cf_documents>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21719</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-07-18 06:38:21 +0000</bug_when>
    <thetext>There is a minor documentation issue in the following webpage of Tiano core 
https://github.com/tianocore/tianocore.github.io/wiki/How-to-Build-With-Stuart

The section &quot;How to Build in edk2 with Stuart&quot; in the above webpage,
has the following instructions.

Change into the edk2 directory.

cd edk

The &quot;cd edk&quot; is not the right command here.

It needs to be updated as &quot;cd edk2&quot; to rectify the documentation issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21720</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-07-18 06:39:18 +0000</bug_when>
    <thetext>Confirming the documentation issue.
will submit a patch request for the same</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21721</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-07-18 06:39:52 +0000</bug_when>
    <thetext>Assigning it to me.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21723</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-07-18 11:36:17 +0000</bug_when>
    <thetext>@Michael Kubacki
You seem to have last edited this page. 
You might be able to fix this typo issue quickly. Please have a look at the page
https://github.com/tianocore/tianocore.github.io/wiki/How-to-Build-With-Stuart</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21852</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-24 00:58:02 +0000</bug_when>
    <thetext>Fixed the issue by updating the wiki page : https://github.com/tianocore/tianocore.github.io/wiki/How-to-Build-With-Stuart</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4179</bug_id>
          
          <creation_ts>2022-12-02 18:46:58 +0000</creation_ts>
          <short_desc>Incorrect implementation in the TDX RTMR implementation</short_desc>
          <delta_ts>2022-12-17 21:07:40 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>ARGU</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20177</commentid>
    <comment_count>0</comment_count>
    <who name="">ARGU</who>
    <bug_when>2022-12-02 18:46:58 +0000</bug_when>
    <thetext>There are a couple of problems in TdMapPcrToMrIndex. This is supposed to return the mapping from PCR index to CC MR index which according to the spec is:
    //
    // In the current version, we use the below mapping for TDX:
    //
    // TPM PCR Index | CC Measurement Register Index | TDX-measurement register
    //  ------------------------------------------------------------------------
    // 0             |   0                           |   MRTD
    // 1, 7          |   1                           |   RTMR[0]
    // 2~6           |   2                           |   RTMR[1]
    // 8~15          |   3                           |   RTMR[2]
    //

The Ovmf implementation is:
•	Returning  EFI_INVALID_PARAMETER for 0 and 6. tdx-virtual-firmware-design-guide-rev-1.01.pdf says that 6 is N/A so maybe this is okay but we should still handle 0 I think.
•	Not handling the case where PCR index is 16. This should be EFI_INVALID_PARAMETER but instead, it is returned as uninitialized.
•	Returning a value that is less 1 than what the table says. For example, it is returning an index of 0 for PCRIndex 1 and 7. I would have expected the implementation to return 1 here according to the table above.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20180</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-12-02 19:24:59 +0000</bug_when>
    <thetext>*** Bug 4180 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20189</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-12-06 01:07:51 +0000</bug_when>
    <thetext>Also need fix https://bugzilla.tianocore.org/show_bug.cgi?id=4184</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20219</commentid>
    <comment_count>3</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-12-17 21:07:40 +0000</bug_when>
    <thetext>Fixed in https://github.com/tianocore/edk2/pull/3773</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4827</bug_id>
          
          <creation_ts>2024-08-09 20:09:05 +0000</creation_ts>
          <short_desc>edk2-stable202405 breaks OVMF network boot support</short_desc>
          <delta_ts>2024-08-13 01:49:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Mike Beaton">mjsbeaton</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23309</commentid>
    <comment_count>0</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-08-09 20:09:05 +0000</bug_when>
    <thetext>Commit 4c4ceb2ceb80c42fd5545b2a4bd80321f07f4345 (NetworkPkg: SECURITY PATCH CVE-2023-45237) breaks network boot support in OvmfPkg.

Before this commit, within the OvmfPkg directory, we could build OVMF with full network boot support with (e.g.):

./build.sh -b NOOPT -D DEBUG_ON_SERIAL_PORT \
-D NETWORK_HTTP_BOOT_ENABLE -D NETWORK_TLS_ENABLE -D NETWORK_IP6_ENABLE

And then we can run it with:

sudo ./build.sh -b NOOPT qemu -serial stdio

(optionally plus additional OS-specific qemu commands to set up an NIC, though this is not required to replicate the issue) and we find PXE and HTTP Boot options in the OVMF Boot Manager UI.

After this commit, we can build and start OVMF with the same commands, but no PXE or HTTP Boot options are present. Most of the relevant (network stack) drivers are not loading, but there are no ASSERTs, nor any instances of &quot;failed to generate random number&quot;, which seems at least at first surprising, given the commit (plus the fact that the above commands are compiling and running OVMF in NOOPT with serial debugging).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23310</commentid>
    <comment_count>1</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-08-09 20:39:50 +0000</bug_when>
    <thetext>I believe the added Depex on gEfiRngProtocolGuid in DxeNetLib.inf is what is causing the network stack drivers not to load. On removing it, the network drivers load and we see &quot;Failed to locate EFI_RNG_PROTOCOL: Not Found&quot;, followed by an ASSERT.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23311</commentid>
    <comment_count>2</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-08-10 03:25:47 +0000</bug_when>
    <thetext>Sorry, `sudo` not needed in command to run OVMF. (Copy and paste typo starting from from command with options to add bridged network support in macOS, which does require sudo.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23312</commentid>
    <comment_count>3</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-08-10 05:12:38 +0000</bug_when>
    <thetext>As I understand it, OVMF now requires the qemu `-device virtio-rng-pci` option in order for its network boot stack to load.

In other cases (in order to satisfy the dependency on an instance of gEfiRngProtocolGuid which the EDK 2 network stack now has), it may be required to load the SecurityPkg/RandomNumberGenerator/RngDxe/RngDxe.inf driver in order for the network stack to start.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23315</commentid>
    <comment_count>4</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-08-13 01:49:24 +0000</bug_when>
    <thetext>I still feel that the required usage changes here (specifically, requiring an additional qemu flag before OVMF network boot will run) are non-obvious, but I don&apos;t currently have any suggestion as to what to change to make this more obvious, and the change seems intended, so closing this bug report as invalid.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4052</bug_id>
          
          <creation_ts>2022-09-08 14:40:38 +0000</creation_ts>
          <short_desc>Update HTTP Boot Device Path in UEFI specification</short_desc>
          <delta_ts>2023-06-15 16:56:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Saloni Kasbekar">saloni.kasbekar</reporter>
          <assigned_to name="Saloni Kasbekar">saloni.kasbekar</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>UEFI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          <cf_documents>Other Document</cf_documents>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19537</commentid>
    <comment_count>0</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-08 14:40:38 +0000</bug_when>
    <thetext>Need to add below snippet to Section 24.7.3.1 to support addition of proxy server URI in the device path - 


In order to support HTTP Boot via a proxy server, a second Uri() path can be added to the device path. In this case, the boot file path would be appended to the proxy server&apos;s URI. For example:
PciRoot(0x0)/Pci(0x19, 0x0)/MAC(001230F4B4FF, 0x0)/IPv4(192.168.1.100, TCP, DHCP, 192.168.1.5,
192.168.1.1, 255.255.255.0)/Uri(http://192.168.1.100)/Uri(http://proxy-server.com/shell.efi)
PciRoot(0x0)/Pci(0x19, 0x0)/MAC(001230F4B4FF, 0x0)/IPv6(2015::100, TCP, StatefulAutoConfigure,
2015::5, 2015::10, 64)/Uri(http://2015::100)/Uri(http://proxy-server.com/shell.efi)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19575</commentid>
    <comment_count>1</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-15 15:14:18 +0000</bug_when>
    <thetext>*** Bug 4064 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19576</commentid>
    <comment_count>2</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-15 15:19:03 +0000</bug_when>
    <thetext>Minor update to the proposal to add below snippet to Section 24.7.3.1 to support addition of proxy server URI in the device path - 


In order to support HTTP Boot via a proxy server, a second Uri() path can be added to the device path that contains the proxy server&apos;s path. In this case, the boot file path would be appended to the proxy server&apos;s URI. For example:
PciRoot(0x0)/Pci(0x19, 0x0)/MAC(001230F4B4FF, 0x0)/IPv4(192.168.1.100, TCP, DHCP, 192.168.1.5,
192.168.1.1, 255.255.255.0)/Uri(http://192.168.1.100)/Uri(http://proxy-server.com/shell.efi)
PciRoot(0x0)/Pci(0x19, 0x0)/MAC(001230F4B4FF, 0x0)/IPv6(2015::100, TCP, StatefulAutoConfigure,
2015::5, 2015::10, 64)/Uri(http://2015::100)/Uri(http://proxy-server.com/shell.efi)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19577</commentid>
    <comment_count>3</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-15 15:21:11 +0000</bug_when>
    <thetext>Change bug to Edk2 Code First Documentation bug as a part of the Code first process.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19579</commentid>
    <comment_count>4</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-15 15:22:05 +0000</bug_when>
    <thetext>Reference implementation tracked at https://bugzilla.tianocore.org/show_bug.cgi?id=3951</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19586</commentid>
    <comment_count>5</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2022-09-16 12:27:41 +0000</bug_when>
    <thetext>Update to the proposal to add below snippet to Section 24.7.3.1 to support addition of proxy server URI in the device path. New update adds file path to endpoint URI (and not proxy server URI) - 

In order to support HTTP Boot via a proxy server, a second Uri() path can be added to the device path that contains the proxy server&apos;s path.
For example:
PciRoot(0x0)/Pci(0x19, 0x0)/MAC(001230F4B4FF, 0x0)/IPv4(192.168.1.100, TCP, DHCP, 192.168.1.5,
192.168.1.1, 255.255.255.0)/Uri(http://192.168.1.100/shell.efi)/Uri(http://proxy-server.com)
PciRoot(0x0)/Pci(0x19, 0x0)/MAC(001230F4B4FF, 0x0)/IPv6(2015::100, TCP, StatefulAutoConfigure,
2015::5, 2015::10, 64)/Uri(http://2015::100/shell.efi)/Uri(http://proxy-server.com)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19650</commentid>
    <comment_count>6</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:18:58 +0000</bug_when>
    <thetext>Saloni has worked on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21667</commentid>
    <comment_count>7</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2023-06-15 16:56:24 +0000</bug_when>
    <thetext>Spec change approved by UEFI WG.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4673</bug_id>
          
          <creation_ts>2024-02-04 17:10:44 +0000</creation_ts>
          <short_desc>edk2/NetworkPkg: Out-of-bounds read when processing IA_NA/IA_TA options in a DHCPv6 Advertise message</short_desc>
          <delta_ts>2024-02-14 13:04:38 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Kevin D Davis">kevin.davis</reporter>
          <assigned_to name="Doug Flick">dougflick</assigned_to>
          <cc>dougflick</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>john.mathews</cc>
    
    <cc>louis.shen</cc>
    
    <cc>terry.lee</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>edk2-stable202302</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22520</commentid>
    <comment_count>0</comment_count>
    <who name="Kevin D Davis">kevin.davis</who>
    <bug_when>2024-02-04 17:10:44 +0000</bug_when>
    <thetext>When trying to boot using PXE over IPv6, the EDK2 firmware starts
by sending DHCPv6 Solicit me229ssages. DHCPv6 servers answer with an
Advertise message. Advertise messages are handled in EDK2 by the
Dhcp6HandleAdvertiseMsg function in [NetworkPkg/Dhcp6Dxe/Dhcp6Io.c],
which calls Dhcp6SeekStsOption in order to search for Status codes in the
received message. A Status code may appear as an option in the DHCPv6
1
message, or as an option inside another option, such as the IA_NA or IA_TA
options.
When seeking for Status codes encapsulated in IA_NA or IA_TA options, the
vulnerable function Dhcp6SeekStsOption in NetworkPkg/Dhcp6Dxe/Dhcp6Io.c
does the following:
EFI_STATUS
Dhcp6SeekStsOption (
IN DHCP6_INSTANCE *Instance,
IN EFI_DHCP6_PACKET *Packet,
OUT UINT8 **Option
)
{
[...]
//
// Seek in encapsulated options, IA_NA and IA_TA.
//
*Option = Dhcp6SeekIaOption (
Packet-&gt;Dhcp6.Option,
Packet-&gt;Length - sizeof (EFI_DHCP6_HEADER),
&amp;Instance-&gt;Config-&gt;IaDescriptor
);
if (*Option == NULL) {
return EFI_SUCCESS;
}
[...]
if (Instance-&gt;Config-&gt;IaDescriptor.Type == Dhcp6OptIana) {
[1] IaInnerOpt = *Option + 16;
[2] IaInnerLen = (UINT16)(NTOHS (ReadUnaligned16 ((UINT16 *)(*Option + 2))) - 12);
} else {
[3] IaInnerOpt = *Option + 8;
[4] IaInnerLen = (UINT16)(NTOHS (ReadUnaligned16 ((UINT16 *)(*Option + 2))) - 4);
}
[5] *Option = Dhcp6SeekOption (IaInnerOpt, IaInnerLen, Dhcp6OptStatusCode);
[...]
The IA_NA and IA_TA options in an Advertise message are trusted without
doing basic sanity checks, e.g.: - in the case of IA_NA options: - that the option
is at least 16 bytes in length before setting IaInnerOpt to *Option + 16, at [1].
- that the value of the optlen field of the option is at least 12, before subtracting
12 from it, at [2].
- in the case of `IA_TA` options:
- that the option is at least 8 bytes in length before setting `IaInnerOpt` to `*Option2
- that the value of the `optlen` field of the option is at least 4, before subtracting 4The lack of checking for sane values in the optlen field of these options allows
to trigger an integer underflow, by setting the optlen field to a value &lt; 12 (in
the case of IA_NA) or &lt; 4 (in the case of IA_TA).
As an example, if we send a DHCPv6 Advertise message containing an IA_NA option with its optlen field set to 15, when the code above calls Dhcp6SeekOption
at [5] to scan forward for status options, the IaInnerLen parameter will be set
to 0xFFFF (15 - 16), and as a result function Dhcp6SeekOption will attempt to
read memory well past the end of the received packet.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22526</commentid>
    <comment_count>1</comment_count>
    <who name="Kevin D Davis">kevin.davis</who>
    <bug_when>2024-02-05 13:18:19 +0000</bug_when>
    <thetext>The above description may be incorrect.

Note this is not the same as previous bug. Same bug in a different place.

When trying to boot using PXE over IPv6, the EDK2 firmware starts
by sending DHCPv6 Solicit messages. DHCPv6 servers answer with an
Advertise message. Advertise messages are handled in EDK2 by the
Dhcp6HandleAdvertiseMsg function in [NetworkPkg/Dhcp6Dxe/Dhcp6Io.c],
which calls Dhcp6UpdateIaInfo in order to update the information it has
recorded about IAs from the IA options contained in the newly received message.
In Dhcp6UpdateIaInfo in [NetworkPkg/Dhcp6Dxe/Dhcp6Io.c], it first checks status code
encapsulated in IA_NA or IA_TA option as the following:

EFI_STATUS
Dhcp6UpdateIaInfo (
  IN OUT DHCP6_INSTANCE    *Instance,
  IN     EFI_DHCP6_PACKET  *Packet
  )
{
[...]
  Option = Dhcp6SeekIaOption (
             Packet-&gt;Dhcp6.Option,
             Packet-&gt;Length - sizeof (EFI_DHCP6_HEADER),
             &amp;Instance-&gt;Config-&gt;IaDescriptor
             );
  if (Option == NULL) {
    return EFI_DEVICE_ERROR;
  }
[...]
  if (Instance-&gt;Config-&gt;IaDescriptor.Type == Dhcp6OptIana) {
    [...]

    [1]IaInnerOpt = Option + 16;
    [2]IaInnerLen = (UINT16)(NTOHS (ReadUnaligned16 ((UINT16 *)(Option + 2))) - 12);
  } else {
    [...]
    [3]IaInnerOpt = Option + 8;
    [4]IaInnerLen = (UINT16)(NTOHS (ReadUnaligned16 ((UINT16 *)(Option + 2))) - 4);
  }
  [...]
  [5]Option  = Dhcp6SeekOption (IaInnerOpt, IaInnerLen, Dhcp6OptStatusCode);
  [...]
The IA_NA and IA_TA options in a received message are trusted without
doing basic sanity checks, e.g.:
- in the case of IA_NA options:
- that the option is at least 16 bytes in length before setting IaInnerOpt to Option + 16, at [1].
- that the value of the optlen field of the option is at least 12, before subtracting 12 from it, at [2].
- in the case of `IA_TA` options:
- that the option is at least 8 bytes in length before setting `IaInnerOpt` to `Option + 8`, at [3]
- that the value of the `optlen` field of the option is at least 4, before subtracting 4, at [4]
The lack of checking for sane values in the optlen field of these options allows
to trigger an integer underflow, by setting the optlen field to a value &lt; 12 (in
the case of IA_NA) or &lt; 4 (in the case of IA_TA).
As an example, if a received message containing an IA_NA option with its optlen field set to 15, when the code above calls Dhcp6SeekOption
at [5] to scan forward for status options, the IaInnerLen parameter will be set
to 0xFFFF (15 - 16), and as a result function Dhcp6SeekOption will attempt to
read memory well past the end of the received packet.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22545</commentid>
    <comment_count>2</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-07 14:35:27 +0000</bug_when>
    <thetext>While my patches do affect this code (renaming defines) this pattern is problematic and should be addressed. I can see about fixing it in the NetworkPkg fixes I have up at the moment today since I&apos;m introducing a function that provides the necessary checks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22550</commentid>
    <comment_count>3</comment_count>
      <attachid>1472</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-08 13:01:46 +0000</bug_when>
    <thetext>Created attachment 1472
Reusing existing function for this pattern that was used for CVE-2023-45229</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22552</commentid>
    <comment_count>4</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-02-08 16:25:20 +0000</bug_when>
    <thetext>As this is very closely related to CVE-2023-45229, which is already public, see no need to embargo.  Making this BZ public.
CVE-2023-45229 was very recently mitigated under BZ 4518.  We Will fix this as an enhancement to the patches for BZ 4518.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22556</commentid>
    <comment_count>5</comment_count>
    <who name="Terry Lee">terry.lee</who>
    <bug_when>2024-02-08 18:27:41 +0000</bug_when>
    <thetext>Doug,

Thanks for uploading the patch.  In the future there could be additional callers of Dhcp6SeekIaOption(), and there could be situations where the potential vulnerability is not obvious (suppose a future caller does not immediately attempt to seek the inner options, saves the data, and later some other code operates on the saved data to seek the inner options).  Dhcp6SeekIaOption() is specific to IA options, and the only IA options I see defined are IA_NA, IA_TA, and IA_PD (which the UEFI network stack doesn&apos;t seem to use).  Instead of performing the security check separately via Dhcp6SeekInnerOptionSafe(), it would be better to perform the checks within Dhcp6SeekIaOption() for IA_NA, IA_TA, and IA_PD (return NULL if invalid size is found).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22557</commentid>
    <comment_count>6</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-08 18:39:30 +0000</bug_when>
    <thetext>That&apos;s probably a good suggestion for enhancements to the networking pkg.

I&apos;ve already sent my patches to the mailing list and I know there is concern about getting changes in before the code freeze. That being said, I do think we should be tracking additional enhancements like this. Tasks like this would be great for people wanting to break in / contribute to EDK2 if we were able to mark them as Low-Priority / Easy like we can do on github issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22576</commentid>
    <comment_count>7</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-13 16:31:49 +0000</bug_when>
    <thetext>Up on the mailing list as a patch series</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22592</commentid>
    <comment_count>8</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-14 13:04:38 +0000</bug_when>
    <thetext>Merged into EDk2</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1472</attachid>
            <date>2024-02-08 13:01:46 +0000</date>
            <delta_ts>2024-02-08 13:01:46 +0000</delta_ts>
            <desc>Reusing existing function for this pattern that was used for CVE-2023-45229</desc>
            <filename>0001-NetworkPkg-Dhcp6Dxe-SECURITY-PATCH-CVE-2023-45229-Re.patch</filename>
            <type>text/plain</type>
            <size>10331</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4528</bug_id>
          
          <creation_ts>2023-08-20 07:34:57 +0000</creation_ts>
          <short_desc>Recent OVMF build.sh change breaks useful functionality</short_desc>
          <delta_ts>2023-10-26 16:10:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Mike Beaton">mjsbeaton</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>rebecca</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
    
    <cf_release_observed>edk2-stable202305</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21838</commentid>
    <comment_count>0</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2023-08-20 07:34:57 +0000</bug_when>
    <thetext>Prior to  https://github.com/tianocore/edk2/commit/173a7a7daaad560cd69e1000faca1d2b91774c46  :

`./build.sh -a X64 -b RELEASE` (or whichever arch and build target are required) built OVMF

then:

`./build.sh -a X64 -b RELEASE qemu {my-qemu-flags}` ran OVMF, using the correct qemu executable and built binary for the arch and target (failing if this had not yet been built, e.g. by the previous command).

The recent commit makes it so that every use of `./build.sh ... qemu ...` rebuilds, before running qemu with the built binary.

This is a problem because:

a) It wastes some unnecessary time
b) It trashes (i.e. rebuilds) the NVRAM contents of the virtual machine, each time it is re-run in this way

I believe the previous behaviour was almost certainly intentional, and useful as it was.

FWIW, it is also documented as it was in multiple places on the web ... including in the README for OvmfPkg itself: https://github.com/tianocore/edk2/tree/master/OvmfPkg . I would _strongly_ vote for restoring the previous behaviour, rather than updating the README.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22011</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 23:10:16 +0000</bug_when>
    <thetext>Add the change owner rebecca@bsdio.co for the comments.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22064</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:10:26 +0000</bug_when>
    <thetext>Fixed in commit 4d196352f35ac516b477e568265b4e537b0283d8.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4392</bug_id>
          
          <creation_ts>2023-03-28 14:46:36 +0000</creation_ts>
          <short_desc>MdePkg: Support FDT library.</short_desc>
          <delta_ts>2023-05-05 02:31:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Benny Lin">benny.lin</assigned_to>
          <cc>benny.lin</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21279</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-28 14:46:36 +0000</bug_when>
    <thetext>FDT has been widely used in industry and this request is to add FDT support in EDK2 by submodule 3rd party libfdt (https://github.com/devicetree-org/pylibfdt/tree/main/libfdt)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21289</commentid>
    <comment_count>1</comment_count>
    <who name="Benny Lin">benny.lin</who>
    <bug_when>2023-03-30 11:58:00 +0000</bug_when>
    <thetext>Will send patches for the changes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21420</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:54:49 +0000</bug_when>
    <thetext>Benny is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21481</commentid>
    <comment_count>3</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-05-05 02:31:43 +0000</bug_when>
    <thetext>merged:
https://github.com/tianocore/edk2/commit/10416bf46e7e7b82472c3f1205572c6e628fcc01
https://github.com/tianocore/edk2/commit/5d586606c7cf5fa4a086917329ca7618a788c064
https://github.com/tianocore/edk2/commit/ff7cb2d7c98f8b832180e054848459fc24a0910a</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4853</bug_id>
          
          <creation_ts>2024-09-20 17:40:36 +0000</creation_ts>
          <short_desc>Addition of PcdStandaloneMmEnable has broken build of BoardPkg(s)</short_desc>
          <delta_ts>2024-09-23 12:22:44 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Nathaniel L DeSimone">nathaniel.l.desimone</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23401</commentid>
    <comment_count>0</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-09-20 17:40:36 +0000</bug_when>
    <thetext>When the PcdStandaloneMmEnable FeaturePcd was added, it was not added to MinPlatformFeaturesPcd.dsc.inc

Because of this, any existing BoardPkg that does not have Standalone MM support will no longer build because the default value of FALSE is not declared during DSC parsing.

The fix is to add the PCD to MinPlatformFeaturesPcd.dsc.inc</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23402</commentid>
    <comment_count>1</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-09-20 17:40:53 +0000</bug_when>
    <thetext>Confirmed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23403</commentid>
    <comment_count>2</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-09-20 17:41:08 +0000</bug_when>
    <thetext>I am working on the patch now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23405</commentid>
    <comment_count>3</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-09-23 12:22:44 +0000</bug_when>
    <thetext>Patch merged: https://github.com/tianocore/edk2-platforms/pull/207</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4078</bug_id>
          
          <creation_ts>2022-09-23 04:10:22 +0000</creation_ts>
          <short_desc>Enhancing the logic for AtaPassThruGetNextPort()/AtaPassThruGetNextDevice()</short_desc>
          <delta_ts>2022-11-01 21:58:37 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="karunakar">karunakar_poosapalli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>hao.a.wu</cc>
    
    <cc>karunakar_poosapalli</cc>
    
    <cc>michael.a.rothman</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19618</commentid>
    <comment_count>0</comment_count>
    <who name="karunakar">karunakar_poosapalli</who>
    <bug_when>2022-09-23 04:10:22 +0000</bug_when>
    <thetext>1. Based on current Design of AtaPassThruGetNextDevice , the caller of GetNextDevice must wait until status is EFI_NOT_FOUND.
2. If any calling driver or application calls AtaPassThru-&gt;GetNextDevice() and didn&apos;t wait until Status is EFI_NOT_FOUND and calls GetNextDevice() only for success case(Calling only once), 
the AtaPassThruGetNextDevice logic will effect next immediate calling driver with returning EFI_NOT_FOUND as previous call was ended with success case itself with setiting Instance-&gt;PreviousPortMultiplier = 0xFFFF 

3. Based on AtaPassThruGetNextDevice current design it expects calling driver or application must call GetNextDevice() unitl it returns EFI_NOT_FOUND
   But there are some examples where If a calling driver is interested in say WD disk among all Micron disks, driver can continue the GetNextPort()-&gt;GetNextDevice()-&gt;GetIdentifyData() loop until it finds WD and just break away. 
   Driver can not be mandated to look into all ports/devices further. Right ?
   
   Because of test driver/Application or a module which intended to call GetNextDevice() only once, Because of this next drivers using GetNextDevice() should not get impacted and get invalid behaviour right?
   
   
 As the driver flow or modules dispaching can’t just remember a Port/PortMultiplierPort and randomly call GetNextPort()-&gt;GetNextDevice(). 
 I think EDK2 driver to restart cleanly for the next driver coming in.

Please share your thoughts in enhancing the logic for AtaPassThruGetNextPort()/AtaPassThruGetNextDevice()</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19646</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:08:27 +0000</bug_when>
    <thetext>Include Hao and Ray for disucssion.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19664</commentid>
    <comment_count>2</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-29 04:35:44 +0000</bug_when>
    <thetext>For each new traverse of ports/devices, please:
1. Assign &apos;Port&apos; with a value of 0xFFFF for function AtaPassThruGetNextPort()
2. Assign &apos;PortMultiplierPort&apos; with a value of 0xFFFF for function AtaPassThruGetNextDevice()</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19666</commentid>
    <comment_count>3</comment_count>
    <who name="karunakar">karunakar_poosapalli</who>
    <bug_when>2022-09-29 09:14:44 +0000</bug_when>
    <thetext>Hi Hao Wu,

Your suggestion is to assign &apos;Port&apos; with a value of 0xFFF&quot; each new traverse of ports/devices.
Does this assignment is from the calling driver or in the native AtaPassThruGetNextPort(), AtaPassThruGetNextDevice interfaces?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19667</commentid>
    <comment_count>4</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-29 09:37:31 +0000</bug_when>
    <thetext>(In reply to karunakar from comment #3)
&gt; Hi Hao Wu,
&gt; 
&gt; Your suggestion is to assign &apos;Port&apos; with a value of 0xFFF&quot; each new traverse
&gt; of ports/devices.
&gt; Does this assignment is from the calling driver or in the native
&gt; AtaPassThruGetNextPort(), AtaPassThruGetNextDevice interfaces?

The assignment should be done when calling the GetNextPort and GetNextDevice services of the EFI_ATA_PASS_THRU_PROTOCOL.

Details can be referred in the &quot;ATA Pass Thru Protocol&quot; section of the UEFI spec.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19668</commentid>
    <comment_count>5</comment_count>
    <who name="karunakar">karunakar_poosapalli</who>
    <bug_when>2022-09-29 09:54:36 +0000</bug_when>
    <thetext>(In reply to Hao Wu from comment #4)

Hi Hao Wu,
Even though if we assign assign &apos;Port/PortMultiplierPort&apos; with a value of 0xFFF&quot; each new traverse from the calling module, it doesn&apos;t help.

We&apos;ve tested the application by assigning Port/PortMultiplierPort&apos; with a value of 0xFFF, with this case also AtaPassThruGetNextDevice current design expects calling driver or application must call GetNextDevice() until it returns EFI_NOT_FOUND.

Please refer to the description for more details.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19669</commentid>
    <comment_count>6</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-29 11:05:04 +0000</bug_when>
    <thetext>(In reply to karunakar from comment #5)
&gt; (In reply to Hao Wu from comment #4)
&gt; 
&gt; Hi Hao Wu,
&gt; Even though if we assign assign &apos;Port/PortMultiplierPort&apos; with a value of
&gt; 0xFFF&quot; each new traverse from the calling module, it doesn&apos;t help.
&gt; 
&gt; We&apos;ve tested the application by assigning Port/PortMultiplierPort&apos; with a
&gt; value of 0xFFF, with this case also AtaPassThruGetNextDevice current design
&gt; expects calling driver or application must call GetNextDevice() until it
&gt; returns EFI_NOT_FOUND.
&gt; 
&gt; Please refer to the description for more details.


I checked the implementation of AtaPassThruGetNextPort(). It seems to me that it does not have the limitation on being called continuously until EFI_NOT_FOUND is returned.

As for AtaPassThruGetNextDevice(), due to the requirement for the &apos;PortMultiplierPort&apos; parameter for the EFI_ATA_PASS_THRU_PROTOCOL.PassThru() service:
The port multiplier port number of the ATA device to send the command. If there is no port multiplier, then specify 0xFFFF.

For the case when the device is connected to the port directly (no port multiplier), the implementation for EFI_ATA_PASS_THRU_PROTOCOL.GetNextDevice() needs to:

Preparation:
PortMultiplierPort = 0xFFFF;

1st call of GetNextDevice (PassThru, Port, &amp;PortMultiplierPort):
Return EFI_SUCCESS &amp; put value 0xFFFF in PortMultiplierPort.

2nd call of GetNextDevice (PassThru, Port, &amp;PortMultiplierPort):
Return EFI_NOT_FOUND

which leads to below special check within AtaPassThruGetNextDevice():
  if (Instance-&gt;PreviousPortMultiplier == 0xFFFF) {
    //
    // If a device is directly attached on a port, previous call to this
    // function will return the value 0xFFFF for PortMultiplierPort. In
    // this case, there should be no more device on the port multiplier.
    //
    Instance-&gt;PreviousPortMultiplier = 0;
    return EFI_NOT_FOUND;
  }

I think this causes the limitation on AtaPassThruGetNextDevice() you mentioned.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19670</commentid>
    <comment_count>7</comment_count>
    <who name="karunakar">karunakar_poosapalli</who>
    <bug_when>2022-09-29 11:12:30 +0000</bug_when>
    <thetext>(In reply to Hao Wu from Just previous comment)
&gt; which leads to below special check within AtaPassThruGetNextDevice():
&gt;  if (Instance-&gt;PreviousPortMultiplier == 0xFFFF) {
&gt;    //
&gt;    // If a device is directly attached on a port, previous call to this
&gt;    // function will return the value 0xFFFF for PortMultiplierPort. In
&gt;    // this case, there should be no more device on the port multiplier.
&gt;    //
&gt;    Instance-&gt;PreviousPortMultiplier = 0;
&gt;    return EFI_NOT_FOUND;
&gt;  }

&gt;I think this causes the limitation on AtaPassThruGetNextDevice() you mentioned.

Exactly, the above case causes the limitation or kind of sharing the unexpected/Wrong behavior/Results to the next calling Driver.

I was thinking if can enhance the logic for AtaPassThruGetNextPort()/AtaPassThruGetNextDevice() to handle the behavior irrespective of calling drivers&apos; call flow.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19674</commentid>
    <comment_count>8</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-29 20:41:38 +0000</bug_when>
    <thetext>My take is that AtaPassThruGetNextPort is fine (without the limitation you mentioned), could you help to double confirm?

For AtaPassThruGetNextDevice (or more generally, EFI_ATA_PASS_THRU_PROTOCOL.GetNextDevice), it has a limitation that the service cannot tell the difference between the below 2 cases:

1. Caller (of GetNextDevice) passes 0xFFFF to PortMultiplierPort as input, expecting to start a new traverse of the devices behind a ATA controller port.

2. Caller previously executed the step 1. The result for step 1 is: GetNextDevice returns with EFI_SUCCESS and put value 0xFFFF in PortMultiplierPort, indicating there is a ATA device directly connected to the port (without port multiplier).
Then caller then issues a subsequent call to GetNextDevice, with PortMultiplierPort set to the value (which is 0xFFFF) returned by previous call of GetNextDevice. Doing so is trying to get the next device on the port.
But since there is no port multiplier, only 1 device exists behind the port, so this time GetNextDevice() should return EFI_NOT_FOUND.

For the two GetNextDevice calls mentioned in case 1&amp;2, the input parameters are the same. So with the current EFI_ATA_PASS_THRU_PROTOCOL definition in the UEFI spec, I cannot come up with an approach to distinguish the above 2 cases at this moment.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19675</commentid>
    <comment_count>9</comment_count>
    <who name="karunakar">karunakar_poosapalli</who>
    <bug_when>2022-09-30 00:11:35 +0000</bug_when>
    <thetext>(In reply to Hao Wu from Just previous comment)
&gt; My take is that AtaPassThruGetNextPort is fine (without the limitation you
&gt; mentioned), could you help to double confirm?

&gt;For AtaPassThruGetNextDevice (or more generally, &gt;EFI_ATA_PASS_THRU_PROTOCOL.GetNextDevice), it has a limitation that the service &gt;cannot tell the difference between the below 2 cases:

&gt; .
&gt; .

&gt; For the two GetNextDevice calls mentioned in case 1&amp;2, the input parameters are &gt; the same. So with the current EFI_ATA_PASS_THRU_PROTOCOL definition in the UEFI &gt; spec, I cannot come up with an approach to distinguish the above 2 cases at this &gt; moment.

In My opinion also AtaPassThruGetNextPort() looks fine to me.

The only concern with GetNextDevice, it should give the right information for the next drivers coming up. 
With this behavior sometimes we may face critical issues like No Harddrive detected. 

We can have a discussion to update the PASS_THRU_PROTOCOL definition in the UEFI spec, to handle the different scenarios seamlessly.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19676</commentid>
    <comment_count>10</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-30 02:16:00 +0000</bug_when>
    <thetext>Sorry Liming, could you help to bring the below open to the stakeholders of UEFI Specification for suggestions/feedbacks?

According to karunakar&apos;s comments, I think the definition of EFI_ATA_PASS_THRU_PROTOCOL (especially with regard to the &apos;PortMultiplierPort&apos; parameter usage description for PassThru() and GetNextDevice() services) might cause issue with the GetNextDevice service not being able to properly handle case that device directly connected to a port (with no port multiplier).

Details can be referred from the comment:
https://bugzilla.tianocore.org/show_bug.cgi?id=4078#c8</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19732</commentid>
    <comment_count>11</comment_count>
    <who name="karunakar">karunakar_poosapalli</who>
    <bug_when>2022-10-10 04:41:01 +0000</bug_when>
    <thetext>Hi Team,

Sorry, I was on vacation last week. Are there any discussions happening on this?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19748</commentid>
    <comment_count>12</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-11 21:43:21 +0000</bug_when>
    <thetext>Include UEFI spec maintainer Rothman to give the comments.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19843</commentid>
    <comment_count>13</comment_count>
    <who name="karunakar">karunakar_poosapalli</who>
    <bug_when>2022-10-26 11:31:12 +0000</bug_when>
    <thetext>I&apos;ve submitted a ticket in Mantis for discussion 
https://mantis.uefi.org/mantis/view.php?id=2359</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19906</commentid>
    <comment_count>14</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-01 21:58:37 +0000</bug_when>
    <thetext>Close it, because this issue has been sent to UEFI .</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4701</bug_id>
          
          <creation_ts>2024-02-23 12:25:26 +0000</creation_ts>
          <short_desc>FspmWrapperInit lacks error handling for release builds</short_desc>
          <delta_ts>2024-03-15 10:58:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="John Mathews">john.mathews</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>du.lin</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202302</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2WrapperPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22636</commentid>
    <comment_count>0</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-02-23 12:25:26 +0000</bug_when>
    <thetext>Throughout this function, error handling is limited to ASSERT statements only, which may only be effective in debug builds. Consider adding proper error handling for release builds.

Memory allocation failures:
https://github.com/tianocore/edk2/blob/11ad164bcea6b0ed3628d595090f84892c367086/IntelFsp2WrapperPkg/FspmWrapperPeim/FspmWrapperPeim.c#L199
https://github.com/tianocore/edk2/blob/11ad164bcea6b0ed3628d595090f84892c367086/IntelFsp2WrapperPkg/FspmWrapperPeim/FspmWrapperPeim.c#L205</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22709</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-03-05 21:54:31 +0000</bug_when>
    <thetext>chasel.chiu@intel.com: please check it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22783</commentid>
    <comment_count>2</comment_count>
    <who name="">du.lin</who>
    <bug_when>2024-03-13 01:52:44 +0000</bug_when>
    <thetext>A patch has been sent to the edk2-devel mailing list: https://edk2.groups.io/g/devel/message/116686.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22790</commentid>
    <comment_count>3</comment_count>
    <who name="">du.lin</who>
    <bug_when>2024-03-13 22:35:34 +0000</bug_when>
    <thetext>The patch has been updated to address review comments: https://edk2.groups.io/g/devel/message/116723.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22800</commentid>
    <comment_count>4</comment_count>
    <who name="">du.lin</who>
    <bug_when>2024-03-15 10:58:00 +0000</bug_when>
    <thetext>The patch has been submitted to Edk2 upstream:
SHA-1: 3840c35e34d1c992268092b6366e26f2acc55a75.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4564</bug_id>
          
          <creation_ts>2023-10-10 09:26:39 +0000</creation_ts>
          <short_desc>bogus RealTimeClockLib class interface: LibRtcVirtualNotifyEvent</short_desc>
          <delta_ts>2023-10-18 13:05:40 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Laszlo Ersek">laszlo.ersek</assigned_to>
          <cc>abner.chang</cc>
    
    <cc>ardb</cc>
    
    <cc>daniel.schaefer</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>quic_llindhol</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>EmbeddedPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21970</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-10 09:26:39 +0000</bug_when>
    <thetext>As of commit 4ddd8ac3a29d, the RealTimeClockLib class header declares a function called LibRtcVirtualNotifyEvent().

In all of edk2 and edk2-platforms (@ d6e36a151ff8), there isn&apos;t a single *cross-module* call to this function.

There are plenty of RealTimeClockLib instances, in both edk2 and edk2-platforms, and all of them handle &quot;going virtual&quot; (that is, converting their pointers to virtual addresses) internally. They may have functions called &quot;LibRtcVirtualNotifyEvent&quot;, but all of those could be (should be) STATIC ones, and not implementations of a public library interface.

The RealTimeClockLib class is consumed by &quot;EmbeddedPkg/RealTimeClockRuntimeDxe/RealTimeClockRuntimeDxe.inf&quot; exclusively, and that driver doesn&apos;t call LibRtcVirtualNotifyEvent().

Here&apos;s what I plan to do:

- in all of edk2-platforms and edk2, rename the LibRtcVirtualNotifyEvent function declarations and definitions to module-internal names, and make them STATIC

- add forward-declarations, or hoist the definitions of these functions, so that the callback installations for VirtualAddressChangeEvent continue to resolve (i.e., so that those references not rely on the public API declaration in the lib class header any longer)

- remove LibRtcVirtualNotifyEvent from the lib class header.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21971</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-10 09:47:02 +0000</bug_when>
    <thetext>Worse, some of the RealTimeClockLib instances themselves overwrite the gRT fields, in LibRtcInitialize(). What the heck.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21974</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-12 05:14:03 +0000</bug_when>
    <thetext>root message:

EmbeddedPkg/RealTimeClockLib: drop LibRtcVirtualNotifyEvent from lib class
http://mid.mail-archive.com/687bbaf5-3c2b-6d27-44a5-d19541ce97bd@redhat.com
https://listman.redhat.com/archives/edk2-devel-archive/2023-October/068840.html
https://edk2.groups.io/g/devel/message/109539

sub-series (sent in reply to the root message):

[edk2-platforms PATCH 00/19] let LibRtcVirtualNotifyEvent() be dropped
Message-Id: &lt;20231012090950.108577-1-lersek@redhat.com&gt;

[edk2-non-osi PATCH 0/1] Hisilicon: rename OemMiscLib class dependencies to HisiOemMiscLib
Message-Id: &lt;20231012091035.108712-1-lersek@redhat.com&gt;

[PATCH 0/5] EmbeddedPkg/RealTimeClockLib: drop LibRtcVirtualNotifyEvent from lib class
Message-Id: &lt;20231012091057.108728-1-lersek@redhat.com&gt;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21977</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-12 05:17:49 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #1)
&gt; Worse, some of the RealTimeClockLib instances themselves overwrite the gRT
&gt; fields, in LibRtcInitialize(). What the heck.

This is out of scope for this BZ, and is being redirected to &lt;https://bugzilla.tianocore.org/show_bug.cgi?id=4565#c1&gt;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21989</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-18 13:05:40 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #2)
&gt; root message:
&gt; 
&gt; EmbeddedPkg/RealTimeClockLib: drop LibRtcVirtualNotifyEvent from lib class
&gt; http://mid.mail-archive.com/687bbaf5-3c2b-6d27-44a5-d19541ce97bd@redhat.com
&gt; https://listman.redhat.com/archives/edk2-devel-archive/2023-October/068840.html
&gt; https://edk2.groups.io/g/devel/message/109539
&gt; 
&gt; sub-series (sent in reply to the root message):
&gt; 
&gt; [edk2-platforms PATCH 00/19] let LibRtcVirtualNotifyEvent() be dropped
&gt; Message-Id: &lt;20231012090950.108577-1-lersek@redhat.com&gt;

Pushed by Ard as commit range d6e36a151ff8..06f6274d5642.

&gt; [edk2-non-osi PATCH 0/1] Hisilicon: rename OemMiscLib class dependencies to HisiOemMiscLib
&gt; Message-Id: &lt;20231012091035.108712-1-lersek@redhat.com&gt;

Pushed by Ard as commit ddae61c7547d.

&gt; [PATCH 0/5] EmbeddedPkg/RealTimeClockLib: drop LibRtcVirtualNotifyEvent from lib class
&gt; Message-Id: &lt;20231012091057.108728-1-lersek@redhat.com&gt;

Merged via &lt;https://github.com/tianocore/edk2/pull/4926&gt;; commit range 747a08eae26b..7fe49887c4d2.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4419</bug_id>
          
          <creation_ts>2023-04-21 15:14:50 +0000</creation_ts>
          <short_desc>uefi-sct/SctPkg: TCGMOR Sct Test Implementation</short_desc>
          <delta_ts>2024-07-17 15:31:42 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Abhi Singh">Abhi.Singh</reporter>
          <assigned_to name="Abhi Singh">Abhi.Singh</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21385</commentid>
    <comment_count>0</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-04-21 15:14:50 +0000</bug_when>
    <thetext>The TCG PC Client Platform Reset Attack Mitigation Spec v1.10 is based on UEFI Variables, and there should be a way to test for the variables and functionality based on the TCG specification.

Bugzilla to TCG MOR SCT Proposal Draft: https://bugzilla.tianocore.org/show_bug.cgi?id=4374

The Initial Patch tests the ability of the platform to correctly create the MOR variable on reset and the requirement for the platform to clear MOR bit0 on reset.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21386</commentid>
    <comment_count>1</comment_count>
      <attachid>1355</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-04-21 15:50:12 +0000</bug_when>
    <thetext>Created attachment 1355
Initial Patch for TCGMOR SCT Test</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21835</commentid>
    <comment_count>2</comment_count>
      <attachid>1393</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-08-17 12:13:40 +0000</bug_when>
    <thetext>Created attachment 1393
SCT Platform Reset Check Test</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21839</commentid>
    <comment_count>3</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-08-21 10:31:02 +0000</bug_when>
    <thetext>Github PR for patch: https://github.com/tianocore/edk2-test/pull/76</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21845</commentid>
    <comment_count>4</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-08-22 22:04:18 +0000</bug_when>
    <thetext>github PR for V2 of patch: https://github.com/tianocore/edk2-test/pull/78</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21846</commentid>
    <comment_count>5</comment_count>
      <attachid>1396</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-08-22 22:08:12 +0000</bug_when>
    <thetext>Created attachment 1396
Patch v2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21927</commentid>
    <comment_count>6</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2023-09-21 12:51:03 +0000</bug_when>
    <thetext>Patch Cover Letter, there are 6 patches in the set

Mailing List: https://edk2.groups.io/g/devel/message/108950</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21953</commentid>
    <comment_count>7</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-10-05 10:09:13 +0000</bug_when>
    <thetext>Update: Abhi is working on the code review comments.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22445</commentid>
    <comment_count>8</comment_count>
      <attachid>1467</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2024-01-30 18:30:26 +0000</bug_when>
    <thetext>Created attachment 1467
patch v3

updated patches that were sent out to edk2 mailing list</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22446</commentid>
    <comment_count>9</comment_count>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2024-01-30 18:31:44 +0000</bug_when>
    <thetext>Updated Github PR: https://github.com/tianocore/edk2-test/pull/81</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22806</commentid>
    <comment_count>10</comment_count>
      <attachid>1483</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2024-03-18 15:29:47 +0000</bug_when>
    <thetext>Created attachment 1483
patch v4</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22902</commentid>
    <comment_count>11</comment_count>
      <attachid>1490</attachid>
    <who name="Abhi Singh">Abhi.Singh</who>
    <bug_when>2024-04-10 11:04:42 +0000</bug_when>
    <thetext>Created attachment 1490
patch set v5 for TCG MOR SCT test</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23239</commentid>
    <comment_count>12</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-07-17 15:31:42 +0000</bug_when>
    <thetext>The feature was upstreamed by the commits:
https://github.com/tianocore/edk2-test/commit/04fd2f8488ded849f6bcbce507e6cf59a4f7e646
and group

Author: Abhi Singh

Closing this ticket</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1355</attachid>
            <date>2023-04-21 15:50:12 +0000</date>
            <delta_ts>2023-08-17 12:13:40 +0000</delta_ts>
            <desc>Initial Patch for TCGMOR SCT Test</desc>
            <filename>0001-uefi-sct-SctPkg-TCGMOR-Platform-Reset-Check-Test.patch</filename>
            <type>text/plain</type>
            <size>25582</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1393</attachid>
            <date>2023-08-17 12:13:40 +0000</date>
            <delta_ts>2023-08-22 22:08:12 +0000</delta_ts>
            <desc>SCT Platform Reset Check Test</desc>
            <filename>0001-uefi-sct-SctPkg-TCG-MemoryOverwriteRequest.patch</filename>
            <type>text/plain</type>
            <size>50367</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1396</attachid>
            <date>2023-08-22 22:08:12 +0000</date>
            <delta_ts>2024-03-18 15:29:47 +0000</delta_ts>
            <desc>Patch v2</desc>
            <filename>TCG MemoryOverwriteRequest SCT Test Patch v2.zip</filename>
            <type>text/plain</type>
            <size>25005</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1467</attachid>
            <date>2024-01-30 18:30:26 +0000</date>
            <delta_ts>2024-03-18 15:29:47 +0000</delta_ts>
            <desc>patch v3</desc>
            <filename>patch_v3.zip</filename>
            <type>text/plain</type>
            <size>27352</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1483</attachid>
            <date>2024-03-18 15:29:47 +0000</date>
            <delta_ts>2024-04-10 11:04:42 +0000</delta_ts>
            <desc>patch v4</desc>
            <filename>TCGMOR_v4.zip</filename>
            <type>text/plain</type>
            <size>27224</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1490</attachid>
            <date>2024-04-10 11:04:42 +0000</date>
            <delta_ts>2024-04-10 11:04:42 +0000</delta_ts>
            <desc>patch set v5 for TCG MOR SCT test</desc>
            <filename>patch_v5.zip</filename>
            <type>text/plain</type>
            <size>27522</size>
            <attacher name="Abhi Singh">Abhi.Singh</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4742</bug_id>
          
          <creation_ts>2024-03-28 06:47:27 +0000</creation_ts>
          <short_desc>Rsapss implementation has cross dependency with other apis in CryptoPkg/BaseCryptLibMbedTls</short_desc>
          <delta_ts>2024-04-02 00:39:15 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>wenxing.hou</reporter>
          <assigned_to>wenxing.hou</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22837</commentid>
    <comment_count>0</comment_count>
    <who name="">wenxing.hou</who>
    <bug_when>2024-03-28 06:47:27 +0000</bug_when>
    <thetext>In CryptoPkg/Library/BaseCryptLibMbedTls/Pk/CryptRsaPss.c, the RsaPssVerify API implementation depend on wrapped hash API rather than original hash API.

It may cause some issue when the platform close the wrapped hash API by PCD.



    case SHA512_DIGEST_SIZE:
      md_alg     = MBEDTLS_MD_SHA512;
      ShaCtxSize = Sha512GetContextSize ();
      ShaCtx     = AllocateZeroPool (ShaCtxSize);

      Status = Sha512Init (ShaCtx);
      if (!Status) {
        return FALSE;
      }</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22841</commentid>
    <comment_count>1</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-28 21:15:19 +0000</bug_when>
    <thetext>please take it</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22844</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-04-02 00:39:15 +0000</bug_when>
    <thetext>pushed: https://github.com/tianocore/edk2/commit/8f698f0a646124ede518d3e255ef725de1239639</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4593</bug_id>
          
          <creation_ts>2023-11-08 15:36:36 +0000</creation_ts>
          <short_desc>[edk2-stable202311] Update GetMaintainer to handle case where a package has only reviewers and no maintainers</short_desc>
          <delta_ts>2023-11-17 02:56:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>quic_llindhol</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22138</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-11-08 15:36:36 +0000</bug_when>
    <thetext>BaseTools/Scripts/GetMaintainer.py does not return the &lt;default&gt; maintainers
if a package only has reviewers.  All code reviews must have maintainers,
and the &lt;default&gt; maintainers that are the stewards should be added to
the returned set of addresses if a package only specifies reviewers.

A recent update to Maintainers.txt put the NetworkPkg, SourceLevelDebugPkg,
and SignedCasulePkg into this state.

https://github.com/tianocore/edk2/commit/038499a2681c1adab5a508da34621f74c52bc05c

In order for GetMaintainers.py to be used by other python scripts, the
get_maintainers() API should return the list of maintainers, reviewers,
and lists separately.

During the analysis of get_maintainers() to return maintainers and reviewers
and lists separately, a logic bug was noticed where a maintainer address eas
incorrectly appended to lists instead of maintainers.

Also, the GetMaintainer.py script should always produce repeatable output
when run from the command line.  The output should be sorted alphabetically.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22139</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-11-08 15:37:10 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22163</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-11-17 02:55:43 +0000</bug_when>
    <thetext>Resolved in commit range 589f2e49e5f9..1cb580be85d0.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22164</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-11-17 02:56:36 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #2)
&gt; Resolved in commit range 589f2e49e5f9..1cb580be85d0.

Sorry: the commit range is 589f2e49e5f9..33deaa3b845f.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4446</bug_id>
          
          <creation_ts>2023-05-05 12:45:37 +0000</creation_ts>
          <short_desc>MdeModulePkg CpasuleApp is missing EFIAPI in function that is passed as parameter</short_desc>
          <delta_ts>2023-05-07 20:47:01 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21482</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-05 12:45:37 +0000</bug_when>
    <thetext>When building with X64 CLANGDWARF, the following error is generated die
to missing EFIAPI on CompareFileNameInAlphabet() is is passed as 
a function pointer.


        &quot;C:\Program Files\LLVM\bin\clang&quot;  -g -Os -fshort-wchar -fno-builtin -fno-strict-aliasing -Wall -Werror -Wno-array-bounds -include AutoGen.h -fno-common -ffunction-sections -fdata-sections -DSTRING_ARRAY_NAME=CapsuleAppStrings -Wno-parentheses-equality -Wno-tautological-compare -Wno-tautological-constant-out-of-range-compare -Wno-empty-body -Wno-unused-const-variable -Wno-varargs -Wno-unknown-warning-option -Wno-unused-but-set-variable -Wno-unused-const-variable -Wno-unaligned-access -fno-stack-protector -mms-bitfields -Wno-address -Wno-shift-negative-value -Wno-unknown-pragmas -Wno-incompatible-library-redeclaration -fno-asynchronous-unwind-tables -mno-sse -mno-mmx -msoft-float -mno-implicit-float -ftrap-function=undefined_behavior_has_been_optimized_away_by_clang -funsigned-char -fno-ms-extensions -Wno-null-dereference -Wno-deprecated-non-prototype -m64 &quot;-DEFIAPI=__attribute__((ms_abi))&quot; -mno-red-zone -mcmodel=small -fpie -Oz -flto -target x86_64-pc-linux-gnu -g -c -o c:\work\github\tianocore\edk2\Build\MdeModule\DEBUG_CLANGDWARF\X64\MdeModulePkg\Application\CapsuleApp\CapsuleApp\OUTPUT\.\CapsuleDump.obj -Ic:\work\github\tianocore\edk2\MdeModulePkg\Application\CapsuleApp  -Ic:\work\github\tianocore\edk2\Build\MdeModule\DEBUG_CLANGDWARF\X64\MdeModulePkg\Application\CapsuleApp\CapsuleApp\DEBUG  -Ic:\work\github\tianocore\edk2\MdePkg  -Ic:\work\github\tianocore\edk2\MdePkg\Include  -Ic:\work\github\tianocore\edk2\MdePkg\Test\UnitTest\Include  -Ic:\work\github\tianocore\edk2\MdePkg\Test\Mock\Include  -Ic:\work\github\tianocore\edk2\MdePkg\Include\X64  -Ic:\work\github\tianocore\edk2\MdeModulePkg  -Ic:\work\github\tianocore\edk2\MdeModulePkg\Include  -Ic:\work\github\tianocore\edk2\MdeModulePkg\Library\BrotliCustomDecompressLib\brotli\c\include c:\work\github\tianocore\edk2\MdeModulePkg\Application\CapsuleApp\CapsuleDump.c
c:\work\github\tianocore\edk2\MdeModulePkg\Application\CapsuleApp\CapsuleDump.c:797:5: error: cast between incompatible calling conventions &apos;cdecl&apos; and &apos;ms_abi&apos;; calls through this pointer may abort at runtime [-Werror,-Wcast-calling-convention]
    (SORT_COMPARE)CompareFileNameInAlphabet
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
c:\work\github\tianocore\edk2\MdeModulePkg\Application\CapsuleApp\CapsuleDump.c:635:1: note: consider defining &apos;CompareFileNameInAlphabet&apos; with the &apos;ms_abi&apos; calling convention
CompareFileNameInAlphabet (
^
EFIAPI
1 error generated.
NMAKE : fatal error U1077: &apos;&quot;C:\Program Files\LLVM\bin\clang.EXE&quot;&apos; : return code &apos;0x1&apos;
Stop.


build.py...
 : error 7000: Failed to execute command
        nmake tbuild [c:\work\github\tianocore\edk2\Build\MdeModule\DEBUG_CLANGDWARF\X64\MdeModulePkg\Application\CapsuleApp\CapsuleApp]


build.py...
 : error F002: Failed to build module
        c:\work\github\tianocore\edk2\MdeModulePkg\Application\CapsuleApp\CapsuleApp.inf [X64, CLANGDWARF, DEBUG]</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21483</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-05 12:45:54 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21484</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-05 12:53:11 +0000</bug_when>
    <thetext>The issue is that the function parameter is type SORT_COMPARE
and SORT_COMPARE is declared as EFIAPI and CompareFileNameInAlphabet()
does not have EFIAPI.

The fix is to add EFIAPI to CompareFileNameInAlphabet()</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21485</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-05 12:53:29 +0000</bug_when>
    <thetext>Breaks CLANGDWARF X64 builds</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21502</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-07 20:47:01 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/4346

Commit: https://github.com/tianocore/edk2/commit/66494e532450c1205be93015740580c1e7b8877a</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4134</bug_id>
          
          <creation_ts>2022-10-31 13:30:19 +0000</creation_ts>
          <short_desc>Add GoogleTest unit test support to UnitTestFrameworkPkg</short_desc>
          <delta_ts>2022-11-13 23:33:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>bob.c.feng</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>michael.kubacki</cc>
    
    <cc>sean.brogan</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
    
    <cf_package>UnitTestFrameworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19884</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-31 13:30:19 +0000</bug_when>
    <thetext>GoogleTest is a host based unit testing framework that can be 
used to implement unit tests for C code.

Code: https://github.com/google/googletest
Docs: https://google.github.io/googletest

GoogleTest requires less source code to register test suites 
and unit tests which allows developers to focus more on unit
test implementations.  There are also a number of visual tools
to help implement, debug, and execute unit tests.

This feature request is to incrementally add support for 
GoogleTest to the UnitTestFrameworkPkg that allows unit test
developers to select either the exiting unit test framework 
or the new GoogleTest framework.

Also update .pytool to build and execute and collect results
from GoogleTest based unit tests.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19885</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-31 13:31:28 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19886</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-10-31 13:32:03 +0000</bug_when>
    <thetext>Change to feature request</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19995</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-11-10 23:31:35 +0000</bug_when>
    <thetext>Email patch reviews

V3: https://edk2.groups.io/g/devel/message/96112
V2: https://edk2.groups.io/g/devel/message/95964
V1: https://edk2.groups.io/g/devel/message/95939</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20007</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-13 23:33:14 +0000</bug_when>
    <thetext>It has been merged by https://github.com/tianocore/edk2/pull/3568</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4775</bug_id>
          
          <creation_ts>2024-05-15 11:28:04 +0000</creation_ts>
          <short_desc>non-ASCII characters from header file causing build error under specific scenario</short_desc>
          <delta_ts>2024-06-05 14:04:39 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>hong-chih.hsueh</reporter>
          <assigned_to>hong-chih.hsueh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23032</commentid>
    <comment_count>0</comment_count>
    <who name="">hong-chih.hsueh</who>
    <bug_when>2024-05-15 11:28:04 +0000</bug_when>
    <thetext>There are some non-ASCII characters exist in MdePkg/Include/Register/Amd/Cpuid.h and MdePkg/Include/Register/Intel/ArchitecturalMsr.h header files.

If the &quot;Language for non-Unicode programs&quot; in Windows is not configured as &quot;English&quot;, build error observed with these non-ASCII characters.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23033</commentid>
    <comment_count>1</comment_count>
    <who name="">hong-chih.hsueh</who>
    <bug_when>2024-05-15 11:31:21 +0000</bug_when>
    <thetext>Here is a online tool that can check non-ascii characters:
https://pages.cs.wisc.edu/~markm/ascii.html</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23071</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-29 20:58:47 +0000</bug_when>
    <thetext>hong-chih.hsueh@amd.com : please provide the patch to fix it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23089</commentid>
    <comment_count>3</comment_count>
    <who name="">hong-chih.hsueh</who>
    <bug_when>2024-06-04 11:40:18 +0000</bug_when>
    <thetext>Here is the pull request to fix it
https://github.com/tianocore/edk2/pull/5737

Thank you!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23091</commentid>
    <comment_count>4</comment_count>
    <who name="">hong-chih.hsueh</who>
    <bug_when>2024-06-05 14:04:39 +0000</bug_when>
    <thetext>Pull request has been merged.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4006</bug_id>
          
          <creation_ts>2022-07-22 02:56:08 +0000</creation_ts>
          <short_desc>UefiPayloadPkg: Add macro to support selection of CryptoDxe driver</short_desc>
          <delta_ts>2022-08-09 22:02:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Payton Hsieh">paytonx.hsieh</reporter>
          <assigned_to name="Payton Hsieh">paytonx.hsieh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19323</commentid>
    <comment_count>0</comment_count>
    <who name="Payton Hsieh">paytonx.hsieh</who>
    <bug_when>2022-07-22 02:56:08 +0000</bug_when>
    <thetext>Add CRYPTO_PROTOCOL_SUPPORT to decide CryptoDxe built into UPL.efi
If CRYPTO_PROTOCOL_SUPPORT is true, BIOS will use crypto protocol
instead of building OpensslLib into drivers.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19379</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-09 21:59:42 +0000</bug_when>
    <thetext>paytonx.hsieh@intel.com: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19380</commentid>
    <comment_count>2</comment_count>
    <who name="Payton Hsieh">paytonx.hsieh</who>
    <bug_when>2022-08-09 22:02:21 +0000</bug_when>
    <thetext>Merged: https://github.com/tianocore/edk2/pull/3139</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4617</bug_id>
          
          <creation_ts>2023-12-09 10:16:52 +0000</creation_ts>
          <short_desc>CLANGDWARF OVMF package builds but will not run since commit 140e4422b16482f0bcafdc20d42141434d450450</short_desc>
          <delta_ts>2024-10-23 05:06:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Mike Beaton">mjsbeaton</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>ardb</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22246</commentid>
    <comment_count>0</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2023-12-09 10:16:52 +0000</bug_when>
    <thetext>CLANGDWARF OVMF builds but will not run since commit 140e4422b16482f0bcafdc20d42141434d450450.

The problem is that after starting OVMF, it simply repeatedly outputs the line:

```
SecCoreStartupWithStack(0xFFFCC000, 0x820000)
```

To demonstrate the problem, from a clean check-out:

```
cd OvmfPkg
./build.sh -a X64 -b NOOPT -t CLANGDWARF -D DEBUG_ON_SERIAL_PORT=1
./build.sh -a X64 -b NOOPT -t CLANGDWARF qemu -serial stdio
```

The problem behaviour has been replicated building using any of:

 - clang 14 on Ubuntu 22.04.3
 - clang 15 on Ubuntu 23.04
 - clang 16 on Fedora 38
 - clang 17 on Fedora 39

Note that CLANGPDB and GCC versions of OVMF still work fine.

It may be worth noting that discussion of the change in the commit at issue centred around whether GCC still builds and works, which it does: https://edk2.groups.io/g/devel/topic/98404595 . It is not obvious - to me at least - that the change in the commit should affect clang, but it clearly does.

From a little more debugging at this end, the restart happens during the call to LogPerformanceMeasurementEnabled within this macro: https://github.com/tianocore/edk2/blob/85a5141a320980e1479343a62731517e197f784e/MdeModulePkg/Core/Pei/PeiMain/PeiMain.c#L401

That call does not return, and instead OVMF restarts.

Using additional macros to comment out the performance code causes the problem to be deferred to slightly later, and leads me to believe that the issue is not to do with the performance measurement code as such, but (perhaps?) to do with calls out to separate compilation modules.

Simply reverting the change fixes the issue, so perhaps the original code (removed by the problem commit) could be re-instated just for CLANGDWARF? (Although of course it would be good to be clearer about exactly how and why this issue occurs.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22251</commentid>
    <comment_count>1</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-12-09 17:17:34 +0000</bug_when>
    <thetext>Please try the change below:

--- a/BaseTools/Conf/tools_def.template
+++ b/BaseTools/Conf/tools_def.template
@@ -1930,8 +1930,8 @@ RELEASE_CLANGDWARF_X64_CC_FLAGS       = DEF(CLANGDWARF_ALL_CC_FLAGS) -m64 &quot;-DEFI
 RELEASE_CLANGDWARF_X64_DLINK_FLAGS    = DEF(CLANGDWARF_IA32_X64_DLINK_FLAGS) -flto -Wl,-O3 -Wl,-melf_x86_64 -Wl,--oformat,elf64-x86-64 -Wl,-pie -mcmodel=small -Wl,--apply-dynamic-relocs
 RELEASE_CLANGDWARF_X64_DLINK2_FLAGS   = DEF(CLANGDWARF_X64_DLINK2_FLAGS) -O3 -fuse-ld=lld
 
-NOOPT_CLANGDWARF_X64_CC_FLAGS         = DEF(CLANGDWARF_ALL_CC_FLAGS) -m64 &quot;-DEFIAPI=__attribute__((ms_abi))&quot; -mno-red-zone -mcmodel=small -fpie -fdirect-access-external-data -O0 DEF(CLANGDWARF_X64_TARGET) -g
-NOOPT_CLANGDWARF_X64_DLINK_FLAGS      = DEF(CLANGDWARF_IA32_X64_DLINK_FLAGS) -Wl,-O0 -Wl,-melf_x86_64 -Wl,--oformat,elf64-x86-64 -Wl,-pie -mcmodel=small -Wl,--apply-dynamic-relocs
+NOOPT_CLANGDWARF_X64_CC_FLAGS         = DEF(CLANGDWARF_ALL_CC_FLAGS) -m64 &quot;-DEFIAPI=__attribute__((ms_abi))&quot; -mno-red-zone -mcmodel=large -fno-pie -fdirect-access-external-data -O0 DEF(CLANGDWARF_X64_TARGET) -g
+NOOPT_CLANGDWARF_X64_DLINK_FLAGS      = DEF(CLANGDWARF_IA32_X64_DLINK_FLAGS) -Wl,-O0 -Wl,-melf_x86_64 -Wl,--oformat,elf64-x86-64 -Wl,--apply-dynamic-relocs
 NOOPT_CLANGDWARF_X64_DLINK2_FLAGS     = DEF(CLANGDWARF_X64_DLINK2_FLAGS) -O0 -fuse-ld=lld
 
 ##################


(Note that you may have to update Conf/target.txt explicitly if it is not symlinked to the above file in your setup)

This will have a negative impact on code size, but in my testing, it appears to work around the visibility issue by not using GOT based references in the first place. And code size is not a concern for NOOPT builds anyway.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22252</commentid>
    <comment_count>2</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2023-12-09 18:01:36 +0000</bug_when>
    <thetext>I can confirm that that change works for me.

However it might be worth noting that following (i.e. enabled LTO, as for DEBUG and RELEASE) also resolves the issue. That perhaps may not be sane for NOOPT builds? Though from a very quick test, it doesn&apos;t have any obvious impact on single-stepping within OVMF.


--- a/BaseTools/Conf/tools_def.template
+++ b/BaseTools/Conf/tools_def.template
@@ -1930,8 +1930,8 @@ RELEASE_CLANGDWARF_X64_CC_FLAGS       = DEF(CLANGDWARF_ALL_CC_FLAGS) -m64 &quot;-DEFI
 RELEASE_CLANGDWARF_X64_DLINK_FLAGS    = DEF(CLANGDWARF_IA32_X64_DLINK_FLAGS) -flto -Wl,-O3 -Wl,-melf_x86_64 -Wl,--oformat,elf64-x86-64 -Wl,-pie -mcmodel=small -Wl,--apply-dynamic-relocs
 RELEASE_CLANGDWARF_X64_DLINK2_FLAGS   = DEF(CLANGDWARF_X64_DLINK2_FLAGS) -O3 -fuse-ld=lld
 
-NOOPT_CLANGDWARF_X64_CC_FLAGS         = DEF(CLANGDWARF_ALL_CC_FLAGS) -m64 &quot;-DEFIAPI=__attribute__((ms_abi))&quot; -mno-red-zone -mcmodel=small -fpie -fdirect-access-external-data -O0 DEF(CLANGDWARF_X64_TARGET) -g
-NOOPT_CLANGDWARF_X64_DLINK_FLAGS      = DEF(CLANGDWARF_IA32_X64_DLINK_FLAGS) -Wl,-O0 -Wl,-melf_x86_64 -Wl,--oformat,elf64-x86-64 -Wl,-pie -mcmodel=small -Wl,--apply-dynamic-relocs
+NOOPT_CLANGDWARF_X64_CC_FLAGS         = DEF(CLANGDWARF_ALL_CC_FLAGS) -m64 &quot;-DEFIAPI=__attribute__((ms_abi))&quot; -mno-red-zone -mcmodel=small -fpie -fdirect-access-external-data -O0 -flto DEF(CLANGDWARF_X64_TARGET) -g
+NOOPT_CLANGDWARF_X64_DLINK_FLAGS      = DEF(CLANGDWARF_IA32_X64_DLINK_FLAGS) -flto -Wl,-O0 -Wl,-melf_x86_64 -Wl,--oformat,elf64-x86-64 -Wl,-pie -mcmodel=small -Wl,--apply-dynamic-relocs
 NOOPT_CLANGDWARF_X64_DLINK2_FLAGS     = DEF(CLANGDWARF_X64_DLINK2_FLAGS) -O0 -fuse-ld=lld
 
 ##################</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22253</commentid>
    <comment_count>3</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2023-12-09 18:24:37 +0000</bug_when>
    <thetext>If I can add one more comment, you mentioned fixing the visibility of the symbols. I found where it OVMF restarted (as reported above) with a combination of enabling existing verbose logging within OVMF, plus additional old-fashioned prints (`DEBUG ((DEBUG_INFO, &quot;...&quot;));`) sprinkled into the code. From this, I can confirm that execution actually entered LogPerformanceMeasurementEnabled (i.e. I got output from a print within it) but did not return from it (no output from &apos;print&apos; immediately afterwards, inserted into the relevant macro), instead OVMF restarted. While very weird this seems (at least to may naive understanding) not to be an issue of the required symbols not being visible, but ... well, something else!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22255</commentid>
    <comment_count>4</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-12-10 02:52:46 +0000</bug_when>
    <thetext>(In reply to Mike Beaton from comment #3)
&gt; While very weird
&gt; this seems (at least to may naive understanding) not to be an issue of the
&gt; required symbols not being visible, but ... well, something else!

The GenFw tool that performs the ELF to PE/COFF conversion operates on static relocations, whereas GOT entries are annotated using dynamic relocations (which are typically consumed by a dynamic loader rather than a build time linker). This handling of GOT entries is a bit fragile, which is why I tried to avoid it entirely on AArch64. On X64, linker relaxations prevent the need for GOT entries, but these appear to be disabled too in NOOPT (as it is considered an optimization, apparently)

The use of hidden visibility inhibits the generation of GOT based symbol references as well, which is why I originally added it in the first place. No GOT entries means no absolute symbol references in compiler generated code, reducing the surface where GenFw can mess things up.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23475</commentid>
    <comment_count>5</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2024-10-23 05:06:31 +0000</bug_when>
    <thetext>Fixed by https://github.com/tianocore/edk2/pull/6355</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4332</bug_id>
          
          <creation_ts>2023-02-01 08:25:11 +0000</creation_ts>
          <short_desc>Potential DoS triggering CI</short_desc>
          <delta_ts>2023-10-18 15:39:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Thierry Laronde">tlaronde</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>kraxel</cc>
    
    <cc>miki.demeter</cc>
    
    <cc>sean.brogan</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20974</commentid>
    <comment_count>0</comment_count>
    <who name="Thierry Laronde">tlaronde</who>
    <bug_when>2023-02-01 08:25:11 +0000</bug_when>
    <thetext>I&apos;m new to contributing to EDK II and I was surprised to see that I was asked (and was indeed able) to trigger CI check tests without, to my knowledge, having been specifically authorized to do so or having been clearly &quot;identified&quot;.

The CI check test consumes resources. Is this not a potential way for almost anybody to create a DoS? whether on Azure or, at least, for the share of resources allocated to Tianocore, simply by multiplying CI check tests triggering---from one user or from hundreds of fake accounts?

for security, when in doubt, it&apos;s better to report or ask.

Done ;-)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21034</commentid>
    <comment_count>1</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-02-13 11:17:57 +0000</bug_when>
    <thetext>Cc&apos;ing CI maintainers for attention and comments.

I happen to have two (draft) pull requests open right now, and only one of them is making progress.  So it seems there is some kind of (per user?) limitation in place.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21303</commentid>
    <comment_count>2</comment_count>
    <who name="Sean Brogan">sean.brogan</who>
    <bug_when>2023-04-03 13:39:02 +0000</bug_when>
    <thetext>We continue to monitor our CI and if someone was abusive by submitting 100s of PRs we can make adjustments to our policies.  There are policies that can block first time contributors.  Our CI services are currently all cloud resources so we can handle this as needed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21990</commentid>
    <comment_count>3</comment_count>
    <who name="Sean Brogan">sean.brogan</who>
    <bug_when>2023-10-18 15:39:29 +0000</bug_when>
    <thetext>as mentioned, we have policy options here if it becomes a problem.  I hope it does not because they all are less convenient.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4153</bug_id>
          
          <creation_ts>2022-11-15 04:50:25 +0000</creation_ts>
          <short_desc>UefiPayloadPkg: The Universal Payload Information section is not aligned at 4-byte boundary</short_desc>
          <delta_ts>2022-11-28 02:00:52 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Victor Hsu">victorx.hsu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20018</commentid>
    <comment_count>0</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-15 04:50:25 +0000</bug_when>
    <thetext>The Universal Payload Information section is not aligned at 4-byte boundary</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20019</commentid>
    <comment_count>1</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-15 04:50:36 +0000</bug_when>
    <thetext>WIP</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20020</commentid>
    <comment_count>2</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-15 05:04:51 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/3640</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20110</commentid>
    <comment_count>3</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-28 02:00:52 +0000</bug_when>
    <thetext>solution merged</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4803</bug_id>
          
          <creation_ts>2024-07-03 04:43:08 +0000</creation_ts>
          <short_desc>edk2-libc : Release the first binary version of the Python UEFI package through edk2-libc releases feature</short_desc>
          <delta_ts>2024-07-12 10:12:25 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Documentation</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          <cf_documents>Wiki Pages</cf_documents>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23172</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-03 04:43:08 +0000</bug_when>
    <thetext>Create a release of the Python UEFI package using the recent GitHub build actions. 
The release package shall be named as PyUEFI Interpreter v3.6.8.1 with the version tag v3.6.8.1 where the first three dotted digits indicate standard C-Python version 3.6.8 on which the released is based. The last digit indicates the release number for the UEFI port of this specific version of the Python Interpreter.

The release package shall contain the details of the bugs went into the release.
It shall have the download links to the build artifacts from the GitHub actions
It shall have the usage instructions</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23173</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-03 04:43:56 +0000</bug_when>
    <thetext>Jayaprakash Nevara will be working on this release.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23218</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-12 10:12:25 +0000</bug_when>
    <thetext>The first binary package release of Python UEFI v3.6.8.1 made through the edk2-libc repo releases https://github.com/tianocore/edk2-libc/releases/tag/v3.6.8.1

There is no commit required for the the edk2-libc repo for this BZ.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4030</bug_id>
          
          <creation_ts>2022-08-24 07:56:09 +0000</creation_ts>
          <short_desc>Update libraries consumed by the capsule driver in UPL</short_desc>
          <delta_ts>2022-09-11 22:16:27 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Kasim Liu">kasimx.liu</reporter>
          <assigned_to name="Kasim Liu">kasimx.liu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19431</commentid>
    <comment_count>0</comment_count>
    <who name="Kasim Liu">kasimx.liu</who>
    <bug_when>2022-08-24 07:56:09 +0000</bug_when>
    <thetext>To replace the Libraries let the UPL can support the capsule function.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19492</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-06 21:53:56 +0000</bug_when>
    <thetext>kasimx.liu@intel.com: please take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19551</commentid>
    <comment_count>2</comment_count>
    <who name="Kasim Liu">kasimx.liu</who>
    <bug_when>2022-09-11 22:16:27 +0000</bug_when>
    <thetext>It&apos;s resolved by https://github.com/tianocore/edk2/pull/3269.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4654</bug_id>
          
          <creation_ts>2024-01-24 17:38:50 +0000</creation_ts>
          <short_desc>SEV-SNP Support for running under an SVSM</short_desc>
          <delta_ts>2024-05-07 10:44:52 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>thomas.lendacky</reporter>
          <assigned_to>thomas.lendacky</assigned_to>
          <cc>ardb</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>kraxel</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22418</commentid>
    <comment_count>0</comment_count>
    <who name="">thomas.lendacky</who>
    <bug_when>2024-01-24 17:38:50 +0000</bug_when>
    <thetext>SEV-SNP provides a feature known as VM Privilege Level (VMPL). The VMPL feature allows for services to be run in the guest at different privilege levels. For example, a virtual TPM can be run in the guest at VMPL0 while the guest OS is running at the less privileged level of VMPL2, thus isolating the service from the guest OS.

The current OVMF support of SEV-SNP assumes that the code is running at VMPL0, the highest privilege level. Certain operations within the guest (e.g. page validation, etc.) can only be performed at VMPL0. Therefore, in order for the guest OS to run at a lower VMPL level, it must be able to invoke a service running at VMPL0 to perform the operation.

This Secure VM Service Module (SVSM) is such a service. An SVSM must follow the Secure VM Service Module for SEV-SNP Guests specification [1] which provides the interface required for the guest OS to request service.

This feature request is to provide support to run an SEV-SNP guest under an SVSM.

[1] https://www.amd.com/content/dam/amd/en/documents/epyc-technical-docs/specifications/58019.pdf</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22452</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-30 21:37:40 +0000</bug_when>
    <thetext>Tom: does this patch plan to catch this stable tag?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22482</commentid>
    <comment_count>2</comment_count>
    <who name="">thomas.lendacky</who>
    <bug_when>2024-01-31 10:48:52 +0000</bug_when>
    <thetext>I think we&apos;re a bit too close to the edk2-stable202402 feature freeze. So targeting for the edk2-stable202405 is ok with me.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22483</commentid>
    <comment_count>3</comment_count>
    <who name="">thomas.lendacky</who>
    <bug_when>2024-01-31 10:53:33 +0000</bug_when>
    <thetext>v1 submitted: https://edk2.groups.io/g/devel/message/114626</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22760</commentid>
    <comment_count>4</comment_count>
    <who name="">thomas.lendacky</who>
    <bug_when>2024-03-08 10:26:55 +0000</bug_when>
    <thetext>v2 submitted: https://edk2.groups.io/g/devel/message/115835</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22761</commentid>
    <comment_count>5</comment_count>
    <who name="">thomas.lendacky</who>
    <bug_when>2024-03-08 10:30:41 +0000</bug_when>
    <thetext>v3 submitted: https://edk2.groups.io/g/devel/message/116525</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23013</commentid>
    <comment_count>6</comment_count>
    <who name="">thomas.lendacky</who>
    <bug_when>2024-05-07 10:44:52 +0000</bug_when>
    <thetext>Series merged:
  c212fec9cf08..0afb87434938</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4360</bug_id>
          
          <creation_ts>2023-03-07 17:18:51 +0000</creation_ts>
          <short_desc>Fix CPU exception in MicrocodeMeasurementDxe.inf</short_desc>
          <delta_ts>2023-03-21 21:51:40 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Darbin Reyes">darbin.reyes</reporter>
          <assigned_to name="Darbin Reyes">darbin.reyes</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21157</commentid>
    <comment_count>0</comment_count>
      <attachid>1335</attachid>
    <who name="Darbin Reyes">darbin.reyes</who>
    <bug_when>2023-03-07 17:18:51 +0000</bug_when>
    <thetext>Created attachment 1335
Screenshot of erroneous format specifier.

Overview: Incorrect format specifier used in DEBUG print causes CPU exception, system hangs near &quot;Ready to Boot Event&quot;.

Steps to Reproduce: Either of the following two methods:

1) boot in a context such that MicrocodeMeasurementDxe.c/TpmMeasureAndLogData() returns an EFI_ERROR.

2) Replace invocation of MicrocodeMeasurementDxe.c/TpmMeasureAndLogData() with any EFI_ERROR e.g. EFI_NOT_FOUND.

Actual Results: Boot should continue to the UEFI shell or OS.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21231</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-03-21 21:51:40 +0000</bug_when>
    <thetext>Fix in PR 4129 and edk2 fd1820b7ea09e53e404d6f56bb8bc4b51a5dd83e</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1335</attachid>
            <date>2023-03-07 17:18:51 +0000</date>
            <delta_ts>2023-03-07 17:18:51 +0000</delta_ts>
            <desc>Screenshot of erroneous format specifier.</desc>
            <filename>ucodebug.png</filename>
            <type>image/png</type>
            <size>113166</size>
            <attacher name="Darbin Reyes">darbin.reyes</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4180</bug_id>
          
          <creation_ts>2022-12-02 18:46:58 +0000</creation_ts>
          <short_desc>Incorrect implementation in the TDX RTMR implementation</short_desc>
          <delta_ts>2022-12-02 19:24:59 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>4179</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>ARGU</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20178</commentid>
    <comment_count>0</comment_count>
    <who name="">ARGU</who>
    <bug_when>2022-12-02 18:46:58 +0000</bug_when>
    <thetext>There are a couple of problems in TdMapPcrToMrIndex. This is supposed to return the mapping from PCR index to CC MR index which according to the spec is:
    //
    // In the current version, we use the below mapping for TDX:
    //
    // TPM PCR Index | CC Measurement Register Index | TDX-measurement register
    //  ------------------------------------------------------------------------
    // 0             |   0                           |   MRTD
    // 1, 7          |   1                           |   RTMR[0]
    // 2~6           |   2                           |   RTMR[1]
    // 8~15          |   3                           |   RTMR[2]
    //

The Ovmf implementation is:
•	Returning  EFI_INVALID_PARAMETER for 0 and 6. tdx-virtual-firmware-design-guide-rev-1.01.pdf says that 6 is N/A so maybe this is okay but we should still handle 0 I think.
•	Not handling the case where PCR index is 16. This should be EFI_INVALID_PARAMETER but instead, it is returned as uninitialized.
•	Returning a value that is less 1 than what the table says. For example, it is returning an index of 0 for PCRIndex 1 and 7. I would have expected the implementation to return 1 here according to the table above.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20179</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-12-02 19:24:59 +0000</bug_when>
    <thetext>duplicated with https://bugzilla.tianocore.org/show_bug.cgi?id=4179

*** This bug has been marked as a duplicate of bug 4179 ***</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4828</bug_id>
          
          <creation_ts>2024-08-12 04:24:59 +0000</creation_ts>
          <short_desc>Support Type5 for Memory Microcontroller Firmware Image entry in FitGen Tool</short_desc>
          <delta_ts>2024-09-01 23:27:30 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>IntelSiliconPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Horace Lien">horacex.lien</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23314</commentid>
    <comment_count>0</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-08-12 04:24:59 +0000</bug_when>
    <thetext>Following Firmware Interface Table spec updated, we need to support Type5 for Memory Microcontroller Firmware Image entry in FitGen Tool.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23355</commentid>
    <comment_count>1</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-09-01 23:27:30 +0000</bug_when>
    <thetext>PR https://github.com/tianocore/edk2-platforms/pull/180
The PR already merged, thanks you.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4676</bug_id>
          
          <creation_ts>2024-02-07 01:56:42 +0000</creation_ts>
          <short_desc>Define EFI Variable Guid which stores Spcr Device Path in SpcrFeaturePkg</short_desc>
          <delta_ts>2024-02-18 21:53:30 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>SpcrFeaturePkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Tsai, Aidan">aidanx.tsai</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22539</commentid>
    <comment_count>0</comment_count>
    <who name="Tsai, Aidan">aidanx.tsai</who>
    <bug_when>2024-02-07 01:56:42 +0000</bug_when>
    <thetext>SpcrFeaturePkg will get SPCR device path via GetSpcrDevice() from platform.
Platform may save SPCR device path in EFI variable, GUID of this variable should be defined by SpcrFeaturePkg.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22627</commentid>
    <comment_count>1</comment_count>
    <who name="Tsai, Aidan">aidanx.tsai</who>
    <bug_when>2024-02-18 21:53:30 +0000</bug_when>
    <thetext>The way to provide SPCR device path from Platform to SpcrFeaturePkg is decided by Platform side, so the GUID of the EFI variable should defined in Platform side.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4529</bug_id>
          
          <creation_ts>2023-08-21 22:57:42 +0000</creation_ts>
          <short_desc>edk2-libc - file descriptor leak in rename()</short_desc>
          <delta_ts>2023-08-23 05:23:13 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>dimitry.kloper</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>n.jayaprakash</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21840</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-21 22:57:42 +0000</bug_when>
    <thetext>rename() call leads to a function that makes open() for source file to be renamed. The resulting file descriptor is never closed. If you have to rename a couple of files this will quickly exhaust the descriptor table.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21841</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-21 22:59:53 +0000</bug_when>
    <thetext>Dimitry has provided a fix to this issue and raised a PR https://github.com/tianocore/edk2-libc/pull/6

I will be creating an email patch and send it for community review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21842</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-21 23:23:14 +0000</bug_when>
    <thetext>Email patch sent for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21847</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-23 05:22:41 +0000</bug_when>
    <thetext>Fix merged to master.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21848</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-23 05:23:13 +0000</bug_when>
    <thetext>The issue has been fixed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4394</bug_id>
          
          <creation_ts>2023-03-29 12:37:16 +0000</creation_ts>
          <short_desc>MdeModulePkg SdMmcPciHcDxe: SD/MMC capability debug print is incorrect</short_desc>
          <delta_ts>2023-05-29 00:54:44 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Giri Mudusuru">girim</reporter>
          <assigned_to name="Giri Mudusuru">girim</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>hao.a.wu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21288</commentid>
    <comment_count>0</comment_count>
    <who name="Giri Mudusuru">girim</who>
    <bug_when>2023-03-29 12:37:16 +0000</bug_when>
    <thetext>MdeModulePkg/Bus/Pci/SdMmcPciHcDxe/SdMmcPciHci.c DumpCapabilityReg() in debug mode prints 32 bit pointer instead of 64 bit capability

Here is a patch for this issue.
--- a/MdeModulePkg/Bus/Pci/SdMmcPciHcDxe/SdMmcPciHci.c
+++ b/MdeModulePkg/Bus/Pci/SdMmcPciHcDxe/SdMmcPciHci.c
@@ -30,7 +30,7 @@ DumpCapabilityReg (
   //
   // Dump Capability Data
   //
-  DEBUG ((DEBUG_INFO, &quot; == Slot [%d] Capability is 0x%x ==\n&quot;, Slot, Capability));
+  DEBUG ((DEBUG_INFO, &quot; == Slot [%d] Capability is 0x%llx ==\n&quot;, Slot, *(UINT64 *)Capability));</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21424</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 22:00:16 +0000</bug_when>
    <thetext>Giri: this change is good. Will you send the patch to edk2 mail list?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21430</commentid>
    <comment_count>2</comment_count>
    <who name="Giri Mudusuru">girim</who>
    <bug_when>2023-04-26 01:53:12 +0000</bug_when>
    <thetext>Thanks Liming, yes will send patch to edk2 mail list.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21563</commentid>
    <comment_count>3</comment_count>
    <who name="Giri Mudusuru">girim</who>
    <bug_when>2023-05-12 05:57:49 +0000</bug_when>
    <thetext>Sent patch to edk2 mail list.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21586</commentid>
    <comment_count>4</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2023-05-29 00:54:09 +0000</bug_when>
    <thetext>Patch sent at: https://edk2.groups.io/g/devel/message/104785</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21587</commentid>
    <comment_count>5</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2023-05-29 00:54:44 +0000</bug_when>
    <thetext>Resolved via:
PR - https://github.com/tianocore/edk2/pull/4439
Commit - https://github.com/tianocore/edk2/commit/e1f5c6249af08c1df2c6257e4bb6abbf6134318c</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4854</bug_id>
          
          <creation_ts>2024-09-23 17:49:36 +0000</creation_ts>
          <short_desc>Build failure with Intel platforms on VS2019</short_desc>
          <delta_ts>2024-09-23 19:55:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Nathaniel L DeSimone">nathaniel.l.desimone</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23406</commentid>
    <comment_count>0</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-09-23 17:49:36 +0000</bug_when>
    <thetext>Build issues are currently seen on Intel platforms due to PR 5957. This PR introduces the requirement for any instance of SecCore to include StackCheckLibNull, which is not currently included on Intel platform builds.

The fix is to add this library to SecCore.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23407</commentid>
    <comment_count>1</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-09-23 17:49:57 +0000</bug_when>
    <thetext>Working on the fix.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23408</commentid>
    <comment_count>2</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-09-23 18:26:19 +0000</bug_when>
    <thetext>PR sent: https://github.com/tianocore/edk2-platforms/pull/208</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23409</commentid>
    <comment_count>3</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-09-23 19:55:03 +0000</bug_when>
    <thetext>Patch merged.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4080</bug_id>
          
          <creation_ts>2022-09-23 18:05:35 +0000</creation_ts>
          <short_desc>Add missing library mappings for CRYPTO_SERVICES set to ALL or MIN_DXE_MIN_SMM</short_desc>
          <delta_ts>2022-09-23 22:48:39 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19623</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-09-23 18:05:35 +0000</bug_when>
    <thetext>Update CryptoPkg.dsc file to add SyncronizationLib and MmServicesTableLib
mappings.  Without these mappings, the SMM builds generate a build break
because the new parallel hash algorithm uses MP Services and spin locks.

The following build commands reproduce these failures:

build -a IA32 -a X64 -n 5 -t VS2019 -p CryptoPkg\CryptoPkg.dsc -D CRYPTO_SERVICES=ALL

build -a IA32 -a X64 -n 5 -t VS2019 -p CryptoPkg\CryptoPkg.dsc -D CRYPTO_SERVICES=MIN_DXE_MIN_SMM</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19624</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-09-23 18:07:09 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19625</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-09-23 18:14:06 +0000</bug_when>
    <thetext>Patch email review: https://edk2.groups.io/g/devel/message/94258

PR: https://github.com/tianocore/edk2/pull/3397</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19627</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2022-09-23 22:48:39 +0000</bug_when>
    <thetext>Commit: 

https://github.com/tianocore/edk2/commit/582a7c9995a8fd036a3583ba485467f5a0316cca

PR: https://github.com/tianocore/edk2/pull/3397</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4708</bug_id>
          
          <creation_ts>2024-02-23 13:18:16 +0000</creation_ts>
          <short_desc>GetBiosId problematic handling of NULL input</short_desc>
          <delta_ts>2024-02-27 19:02:16 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>BoardModulePkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="John Mathews">john.mathews</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202302</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22644</commentid>
    <comment_count>0</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-02-23 13:18:16 +0000</bug_when>
    <thetext>The GetBiosId function treats the BiosIdImage argument as optional, thus if the incoming address is NULL it will continue and return whether the function is successful.  This can be problematic if the caller does not ensure the address passed in is Not NULL and the value is intended to be used. 

EFI_STATUS
EFIAPI
GetBiosId (
  OUT BIOS_ID_IMAGE     *BiosIdImage OPTIONAL
  )
{
  EFI_STATUS    Status;
  BIOS_ID_IMAGE TempBiosIdImage;
  VOID          *Address;
  UINTN         Size;

  Address = NULL;
  Size = 0;

  if (BiosIdImage == NULL) {
    //
    // It is NULL as input, so no BIOS ID will be returned.
    // Use temp buffer to hold the BIOS ID.
    //
    BiosIdImage = &amp;TempBiosIdImage;
  }

Same found in both PEI and DXE GetBiosId functions.
https://github.com/tianocore/edk2-platforms/blob/7f42d4034c8f4266da691df69dce18234f752cb4/Platform/Intel/BoardModulePkg/Library/BiosIdLib/PeiBiosIdLib.c#L32
https://github.com/tianocore/edk2-platforms/blob/7f42d4034c8f4266da691df69dce18234f752cb4/Platform/Intel/BoardModulePkg/Library/BiosIdLib/DxeBiosIdLib.c#L37</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22664</commentid>
    <comment_count>1</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-02-27 19:02:16 +0000</bug_when>
    <thetext>Withdrawing this BZ, after discussion with Erik Bjorge.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4565</bug_id>
          
          <creation_ts>2023-10-10 09:49:45 +0000</creation_ts>
          <short_desc>duplicate installation of EFI_REAL_TIME_CLOCK_ARCH_PROTOCOL in RealTimeClockLib instances</short_desc>
          <delta_ts>2023-10-24 12:50:42 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Laszlo Ersek">laszlo.ersek</assigned_to>
          <cc>ardb</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>quic_llindhol</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ArmPlatformPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21972</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-10 09:49:45 +0000</bug_when>
    <thetext>Found in edk2 at 4ddd8ac3a29d, and in edk2-platforms at d6e36a151ff8:

Edk2&apos;s EmbeddedPkg/RealTimeClockRuntimeDxe performs the following steps
(that are relevant here):

- fills in the GetTime, SetTime, GetWakeupTime, SetWakeupTime members of
  the runtime services table

- installs EFI_REAL_TIME_CLOCK_ARCH_PROTOCOL with a NULL protocol
  interface.

Both of these steps are correct; refer to the following sections in PI
v1.8:

&gt;| II         Driver Execution Environment Core Interface
&gt;| II-9       DXE Foundation
&gt;| II-9.7     Dependencies
&gt;| II-9.7.2   UEFI Runtime Services Dependencies
&gt;| II-9.7.2.4 GetTime()
&gt;| II-9.7.2.5 SetTime()
&gt;| II-9.7.2.6 GetWakeupTime()
&gt;| II-9.7.2.7 SetWakeupTime()
&gt;|
&gt;| When the DXE Foundation is notified that the
&gt;| EFI_REAL_TIME_CLOCK_ARCH_PROTOCOL has been installed, then the
&gt;| Runtime Service [*] is available. The DXE driver that produces the
&gt;| EFI_REAL_TIME_CLOCK_ARCH_PROTOCOL is responsible for directly
&gt;| updating the [*] field of the UEFI Runtime Services Table. The DXE
&gt;| Foundation is only responsible for updating the 32-bit CRC of the
&gt;| UEFI Runtime Services Table.

(Substitute each of GetTime() / SetTime() / GetWakeupTime() /
SetWakeupTime() for [*] in the above.)

RealTimeClockRuntimeDxe depends on the RealTimeClockLib class for actual
RTC access; in particular, the driver calls, in its entry point
InitializeRealTimeClock(), the library init function LibRtcInitialize().

The problem is that a large number of RealTimeClockLib instances,
covering both edk2 and edk2-platforms, install *their own*
EFI_REAL_TIME_CLOCK_ARCH_PROTOCOL. That&apos;s totally bogus; there is no
need for more than one EFI_REAL_TIME_CLOCK_ARCH_PROTOCOL (with a NULL
interface at that...) in the protocol database.

What I intend to do: remove the gEfiRealTimeClockArchProtocolGuid
installations from all RealTimeClockLib instances in edk2 and
edk2-platforms.

A handy command for locating the affected lib instances:

$ git grep -l -w gEfiRealTimeClockArchProtocolGuid -- $(
    for I in $(git grep -w -l &apos;RealTimeClockLib&apos; -- &apos;*inf&apos;); do
      dirname $I
    done \
    | sort -u
  )

This looks up those INF files that reference RealTimeClockLib, and then
recursively greps their *containing directories* for
&quot;gEfiRealTimeClockArchProtocolGuid&quot;.

In edk2, the only relevant hit is:

&gt;| ArmPlatformPkg/Library/PL031RealTimeClockLib/PL031RealTimeClockLib.c

In edk2-platforms, the situation is terrible:

&gt;| Platform/Hisilicon/D03/Library/DS3231RealTimeClockLib/DS3231RealTimeClockLib.c
&gt;| Platform/Loongson/LoongArchQemuPkg/Library/LsRealTimeClockLib/LsRealTimeClockLib.c
&gt;| Platform/Loongson/LoongArchQemuPkg/Library/LsRealTimeClockLib/LsRealTimeClockLib.inf
&gt;| Silicon/Hisilicon/Library/DS3231RealTimeClockLib/DS3231RealTimeClockLib.c
&gt;| Silicon/Hisilicon/Library/RX8900RealTimeClockLib/RX8900RealTimeClockLib.c
&gt;| Silicon/Hisilicon/Library/VirtualRealTimeClockLib/RealTimeClockLib.c
&gt;| Silicon/Marvell/Armada7k8k/Library/RealTimeClockLib/RealTimeClockLib.c
&gt;| Silicon/Phytium/FT2000-4Pkg/Library/RealTimeClockLib/RealTimeClockLib.c
&gt;| Silicon/TexasInstruments/Omap35xxPkg/Library/RealTimeClockLib/RealTimeClockLib.c

obviously because they copied ArmPlatformPkg (or each other).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21976</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-12 05:17:24 +0000</bug_when>
    <thetext>In the scope of this BZ, also eliminate gRT field assignments from LibRtcInitialize() everywhere. gRT field assignments belong to RealTimeClockRuntimeDxe, together with EFI_REAL_TIME_CLOCK_ARCH_PROTOCOL installation (see comment#0).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21994</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 22:41:45 +0000</bug_when>
    <thetext>lersek@redhat.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22022</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-19 08:26:15 +0000</bug_when>
    <thetext>git grep -E -l &apos;LIBRARY_CLASS *= *\&lt;RealTimeClockLib\&gt;&apos; -- &apos;*inf&apos; \
| xargs -- dirname -- \
| sort -u \
| xargs -- git grep -E -H -n -w &apos;gEfiRealTimeClockArchProtocolGuid|GetTime|SetTime|GetWakeupTime|SetWakeupTime&apos; --</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22027</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-20 08:20:21 +0000</bug_when>
    <thetext>* [PATCH] ArmPlatformPkg/PL031RealTimeClockLib: remove superfluous instance init steps

http://mid.mail-archive.com/20231020121748.44862-1-lersek@redhat.com
https://listman.redhat.com/archives/edk2-devel-archive/2023-October/069136.html
https://edk2.groups.io/g/devel/message/109835

* [edk2-platforms PATCH 0/7] drop needless init steps in RealTimeClockLib instances

http://mid.mail-archive.com/20231020121903.44986-1-lersek@redhat.com
https://listman.redhat.com/archives/edk2-devel-archive/2023-October/069138.html
https://edk2.groups.io/g/devel/message/109837</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22029</commentid>
    <comment_count>5</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-24 09:22:00 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #4)

&gt; * [edk2-platforms PATCH 0/7] drop needless init steps in RealTimeClockLib instances
&gt; 
&gt; http://mid.mail-archive.com/20231020121903.44986-1-lersek@redhat.com
&gt; https://listman.redhat.com/archives/edk2-devel-archive/2023-October/069138.html
&gt; https://edk2.groups.io/g/devel/message/109837

Commit range fdbe20318f27..b68199ec5895.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22030</commentid>
    <comment_count>6</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-24 12:50:42 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #4)
&gt; * [PATCH] ArmPlatformPkg/PL031RealTimeClockLib: remove superfluous instance init steps
&gt; 
&gt; http://mid.mail-archive.com/20231020121748.44862-1-lersek@redhat.com
&gt; https://listman.redhat.com/archives/edk2-devel-archive/2023-October/069136.html
&gt; https://edk2.groups.io/g/devel/message/109835

Merged via &lt;https://github.com/tianocore/edk2/pull/4950&gt; as commit d85bf54b7f46.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4243</bug_id>
          
          <creation_ts>2023-01-03 06:35:58 +0000</creation_ts>
          <short_desc>TDVF need integrate feature in config-B to config-A</short_desc>
          <delta_ts>2023-02-04 06:33:06 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>jiewen.yao</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20408</commentid>
    <comment_count>0</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-03 06:35:58 +0000</bug_when>
    <thetext>According to https://github.com/tianocore/edk2/blob/master/OvmfPkg/IntelTdx/README, config-B includes more security feature, such as RTMR based measurement.

We need enable those to config-A as well.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20425</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:34:45 +0000</bug_when>
    <thetext>Min will take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20991</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-02-04 06:33:06 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3993</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4111</bug_id>
          
          <creation_ts>2022-10-20 03:23:52 +0000</creation_ts>
          <short_desc>Coding style check error in Intel side</short_desc>
          <delta_ts>2022-10-25 21:53:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>lichao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19796</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-10-20 03:23:52 +0000</bug_when>
    <thetext>There are some coding style issues after merging the LoongArch patches, witch may cause compilation errors in Intel side.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19797</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-10-20 03:30:13 +0000</bug_when>
    <thetext>I&apos;m working on this, and the error is clear.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19831</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-25 21:45:21 +0000</bug_when>
    <thetext>Chao: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19838</commentid>
    <comment_count>3</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-10-25 21:53:19 +0000</bug_when>
    <thetext>Liming: This bug has been resolved and has been merged by EDK2, so it can be closed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4447</bug_id>
          
          <creation_ts>2023-05-05 22:34:07 +0000</creation_ts>
          <short_desc>Update CLANGPDB_WARNING_OVERRIDES in tools_def.txt to match CLANGDWARF_WARNING_OVERRIDES</short_desc>
          <delta_ts>2023-05-07 20:48:07 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21486</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-05 22:34:07 +0000</bug_when>
    <thetext>CLANGBDB builds get warnings using DEBUG_CODE_BEGIN() macros from DebugLib.h

c:\work\github\tianocore\edk2\UefiCpuPkg\Library\BaseXApicLib\BaseXApicLib.c:246:3: error: variable &apos;__DebugCodeLocal&apos; set but not used [-Werror,-Wunused-but-set-variable]
  DEBUG_CODE_BEGIN ();
  ^
c:\work\github\tianocore\edk2\MdePkg\Include\Library/DebugLib.h:537:68: note: expanded from macro &apos;DEBUG_CODE_BEGIN&apos;
#define DEBUG_CODE_BEGIN()  do { if (DebugCodeEnabled ()) { UINT8  __DebugCodeLocal


CLANGDWARF does not have this same issue.   Need to update warning disables
for CLANGPDB to match CLANGDWARF</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21487</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-05 22:34:23 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21503</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-07 20:47:36 +0000</bug_when>
    <thetext>Confirmed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21504</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-07 20:48:07 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/4347

Commit:https://github.com/tianocore/edk2/commit/8e985ac3fdb2b117968ac1fa1f54666e166af8ac</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4135</bug_id>
          
          <creation_ts>2022-11-01 00:49:29 +0000</creation_ts>
          <short_desc>Improved Smbios Type 9 data under smbiosview command</short_desc>
          <delta_ts>2022-11-10 23:22:10 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>sainadhn</reporter>
          <assigned_to>sainadhn</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>sainadhn</cc>
    
    <cc>sundaresans</cc>
    
    <cc>vasudevans</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19889</commentid>
    <comment_count>0</comment_count>
      <attachid>1045</attachid>
    <who name="">sainadhn</who>
    <bug_when>2022-11-01 00:49:29 +0000</bug_when>
    <thetext>Created attachment 1045
ProposedPatch

1. Few Smbios Type 9 fields are added without spec version check. 

2. The published fields are not in the order as defined in spec.

   Published as below:
    DisplaySystemSlotHeight (Type9ExtendedStruct-&gt;SlotHeight, Option);
    DisplaySystemSlotPhysicalWidth(Type9ExtendedStruct-&gt;SlotPhysicalWidth,Option);
    DisplaySystemSlotInformation (Type9ExtendedStruct-&gt;SlotInformation, Option);
   
   Defined in Spec as below order:
    Slot Information 
    Slot Physical Width
    Slot Pitch 
    Slot Height 

3. Slot Pitch field is not published.

We will contribute the patch, please find the proposed patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19898</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-01 21:39:31 +0000</bug_when>
    <thetext>sainadhn@ami.com, please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19909</commentid>
    <comment_count>2</comment_count>
    <who name="">sainadhn</who>
    <bug_when>2022-11-02 00:35:20 +0000</bug_when>
    <thetext>gaoliming@byosoft.com.cn, Patch has been sent to &lt;devel@edk2.groups.io&gt; and available in devel groups messages.

https://edk2.groups.io/g/devel/message/95840

Please help to review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19942</commentid>
    <comment_count>3</comment_count>
    <who name="">sainadhn</who>
    <bug_when>2022-11-04 07:33:53 +0000</bug_when>
    <thetext>gaoliming@byosoft.com.cn, created pull request and passed all CI checks.

https://github.com/tianocore/edk2/pull/3593</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19992</commentid>
    <comment_count>4</comment_count>
    <who name="">sainadhn</who>
    <bug_when>2022-11-10 23:22:10 +0000</bug_when>
    <thetext>Changes merged to Edk2 master with below commit.

https://github.com/tianocore/edk2/commit/c17c3c24d8c7dd2107bfcca86179d5375dceb42b

Resolving this issue.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1045</attachid>
            <date>2022-11-01 00:49:29 +0000</date>
            <delta_ts>2022-11-01 00:49:29 +0000</delta_ts>
            <desc>ProposedPatch</desc>
            <filename>ShellPkgChanges.rar</filename>
            <type>application/octet-stream</type>
            <size>51120</size>
            <attacher>sainadhn</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4619</bug_id>
          
          <creation_ts>2023-12-09 12:13:58 +0000</creation_ts>
          <short_desc>edk2-libc: writeio function in edk2module.c not working as expected</short_desc>
          <delta_ts>2023-12-11 04:55:27 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22248</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-12-09 12:13:58 +0000</bug_when>
    <thetext>The writeio function available in edk2module.c under edk2-libc/AppPkg/Applications/Python/Python-3.6.8/PyMod-3.6.8/Modules/ 
doesn&apos;t work as expected.

On further debugging found that it makes use of the IoLib function&apos;s IoWrite8, IoWrite16 and IoWrite32 functions to write Byte, Word and a Double word to an IO port. 


The function signature of IoWrite8 functions goes like this.
UINT8
EFIAPI
IoWrite8 (
  IN      UINTN  Port,
  IN      UINT8  Value
  );

It takes the port address as the first parameter followed by the value to be written to the port. Same is the case with the other variants of this function.

But the edk2module.c&apos;s writeio function sends the parameters in revered order as to IoWrite* functions shown in the below code snippet:

edk2_writeio(PyObject *self, PyObject *args)
{
  unsigned int addr, sz, value;
  short addrs;

  if (!PyArg_ParseTuple(args, &quot;III&quot;, &amp;addr, &amp;sz, &amp;value))
    return NULL;

  Py_BEGIN_ALLOW_THREADS
  addrs = (short)(addr &amp; 0xffff);
  if (1 == sz) IoWrite8((unsigned char)(value &amp; 0xFF), addrs);
  else if (2 == sz) IoWrite16((unsigned short)(value &amp; 0xFFFF), addrs);
  else if (4 == sz) IoWrite32(value, addrs);
  Py_END_ALLOW_THREADS

  Py_INCREF(Py_None);
  return Py_None;
}

This needs to be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22249</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-12-09 12:44:14 +0000</bug_when>
    <thetext>Verified that this is an issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22250</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-12-09 12:45:23 +0000</bug_when>
    <thetext>Identified the fix and verified the fix on a local build.
Submitted a patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22257</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-12-11 04:55:27 +0000</bug_when>
    <thetext>The Patch has been merged to master.
commit 4667a82f0d873221f8b25ea701ce57a29270e4cb</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4475</bug_id>
          
          <creation_ts>2023-06-01 17:20:24 +0000</creation_ts>
          <short_desc>UEFI specification is not clear on precedent of return codes for QueryVariableInfo</short_desc>
          <delta_ts>2024-09-05 15:20:53 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Stuart Yoder">stuart.yoder</reporter>
          <assigned_to name="Stuart Yoder">stuart.yoder</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>xypron.glpk</cc>
          
          <cf_industrystandardspecifications>UEFI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21626</commentid>
    <comment_count>0</comment_count>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2023-06-01 17:20:24 +0000</bug_when>
    <thetext>The SCT AuthVariableDERConfTest test ORs the following attributes and passes them to QueryVariableInfo():
  EFI_VARIABLE_NON_VOLATILE
  EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS

There are 2 separate issues with those attributes. Unfortunately, the UEFI spec is vague and open to interpretation as to how this is to be handled.

The 2.10 spec says the following about EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS:

//NOTE: EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS is deprecated
//and should be considered reserved.

For SetVariable() the spec is clear that EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS is deprecated and should not be supported.

For QueryVariableInfo() there is no explicit statement in the spec.  But, if the attribute is to be treated as reserved, it certainly seems like a firmware implementation should not support it.

Is it valid for firmware to return EFI_UNSUPPORTED if EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS is passed in?

But, the second issue is that EFI_VARIABLE_NON_VOLATILE by itself is invalid, which should result in EFI_INVALID_PARAMETER.

So, the question is should firmware return EFI_UNSUPPORTED or EFI_INVALID_PARAMETER?  What is the precedence of these return values.

The implementations in EDK2 and edk2-test both suggest that firmware should return EFI_UNSUPPORTED for this case.  But, the spec should make this explicit.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21751</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:43:29 +0000</bug_when>
    <thetext>stuart.yoder@arm.com: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23384</commentid>
    <comment_count>2</comment_count>
    <who name="Stuart Yoder">stuart.yoder</who>
    <bug_when>2024-09-05 15:20:53 +0000</bug_when>
    <thetext>This was resolved through the UEFI spec committee in a separate bug tracking system.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4333</bug_id>
          
          <creation_ts>2023-02-01 14:55:21 +0000</creation_ts>
          <short_desc>Update edk2-pytool-library and edk2-pytool-extensions</short_desc>
          <delta_ts>2023-02-16 18:29:17 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Joey Vagedes">joeyvagedes</reporter>
          <assigned_to name="Joey Vagedes">joeyvagedes</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20978</commentid>
    <comment_count>0</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-02-01 14:55:21 +0000</bug_when>
    <thetext>edk2-pytool-library needs updated to v0.13.0. v0.13.0 has a breaking change that needs to be addressed in BaseTools/Plugin/WindowsVsToolChain.py</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20979</commentid>
    <comment_count>1</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-02-01 14:59:31 +0000</bug_when>
    <thetext>Additionally updates edk2-pytool-library to v0.21.2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20980</commentid>
    <comment_count>2</comment_count>
      <attachid>1319</attachid>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-02-01 15:00:30 +0000</bug_when>
    <thetext>Created attachment 1319
Patch to update per filed bug</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20981</commentid>
    <comment_count>3</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-02-01 15:25:56 +0000</bug_when>
    <thetext>patch sent to mailing list to bump edk2-pytool-extensions to v0.21.2 and edk2-pytool-library to v0.13.0</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21062</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-02-14 22:07:26 +0000</bug_when>
    <thetext>Joey Vagedes is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21086</commentid>
    <comment_count>5</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-02-16 12:33:46 +0000</bug_when>
    <thetext>PR located here https://github.com/tianocore/edk2/pull/4053 is ready to be merged.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21087</commentid>
    <comment_count>6</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-02-16 18:28:07 +0000</bug_when>
    <thetext>Merged. Commit: https://github.com/tianocore/edk2/commit/02fcfdce1e5ce86f1951191883e7e30de5aa08be</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21088</commentid>
    <comment_count>7</comment_count>
    <who name="Joey Vagedes">joeyvagedes</who>
    <bug_when>2023-02-16 18:29:17 +0000</bug_when>
    <thetext>PR has been accepted and merged into EDK2.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1319</attachid>
            <date>2023-02-01 15:00:30 +0000</date>
            <delta_ts>2023-02-01 15:00:30 +0000</delta_ts>
            <desc>Patch to update per filed bug</desc>
            <filename>0001-BaseTools-Update-WindowsVsToolChain-plugin.patch</filename>
            <type>text/plain</type>
            <size>2901</size>
            <attacher name="Joey Vagedes">joeyvagedes</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4156</bug_id>
          
          <creation_ts>2022-11-15 22:09:40 +0000</creation_ts>
          <short_desc>Refer to SMBIOS v3.6, update ProcessorUpgradeTable in Edk2\ShellPkg\Library\UefiShellDebug1CommandsLib\SmbiosView\QueryTable.c</short_desc>
          <delta_ts>2022-12-06 04:50:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="xueshengfeng">shengfengx.xue</reporter>
          <assigned_to name="xueshengfeng">shengfengx.xue</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20040</commentid>
    <comment_count>0</comment_count>
    <who name="xueshengfeng">shengfengx.xue</who>
    <bug_when>2022-11-15 22:09:40 +0000</bug_when>
    <thetext>SMBIOS Socket not completely defined according to the SMBIOS support v3.6.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20042</commentid>
    <comment_count>1</comment_count>
    <who name="xueshengfeng">shengfengx.xue</who>
    <bug_when>2022-11-15 22:13:56 +0000</bug_when>
    <thetext>SMBIOS support v3.6:
https://www.dmtf.org/sites/default/files/standards/documents/DSP0134_3.6.0.pdf</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20141</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-29 22:03:18 +0000</bug_when>
    <thetext>shengfengx.xue@intel.com: please provide the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20142</commentid>
    <comment_count>3</comment_count>
    <who name="xueshengfeng">shengfengx.xue</who>
    <bug_when>2022-11-29 22:37:58 +0000</bug_when>
    <thetext>Patch has been merged: https://github.com/tianocore/edk2/pull/3667</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20193</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-12-06 04:50:31 +0000</bug_when>
    <thetext>It has been fixed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4806</bug_id>
          
          <creation_ts>2024-07-10 17:10:22 +0000</creation_ts>
          <short_desc>Track HttpInstance URL buffer length</short_desc>
          <delta_ts>2024-07-11 17:53:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Saloni Kasbekar">saloni.kasbekar</reporter>
          <assigned_to name="Saloni Kasbekar">saloni.kasbekar</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23184</commentid>
    <comment_count>0</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-07-10 17:10:22 +0000</bug_when>
    <thetext>In EfiHttpRequest(), length of target URLs was always compared to
fixed-size value, even after allocating a larger URL buffer.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23185</commentid>
    <comment_count>1</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-07-10 17:11:05 +0000</bug_when>
    <thetext>Assign to myself.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23186</commentid>
    <comment_count>2</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-07-10 18:19:18 +0000</bug_when>
    <thetext>PR link - https://github.com/tianocore/edk2/pull/5899</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23215</commentid>
    <comment_count>3</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-07-11 17:53:32 +0000</bug_when>
    <thetext>Merged.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4031</bug_id>
          
          <creation_ts>2022-08-25 09:28:17 +0000</creation_ts>
          <short_desc>Ignore OptionRom in  Sev guest</short_desc>
          <delta_ts>2023-02-09 07:38:36 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Joey Lee">jlee</reporter>
          <assigned_to name="Joey Lee">jlee</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jlee</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19432</commentid>
    <comment_count>0</comment_count>
      <attachid>1018</attachid>
    <who name="Joey Lee">jlee</who>
    <bug_when>2022-08-25 09:28:17 +0000</bug_when>
    <thetext>Created attachment 1018
0001-OvmfPkg-IncompatiblePciDeviceSupportDxe-Ignore-Optio.patch

It&apos;s similar to the c477b2783f patch for Td guest.

Host VMM may inject OptionRom which is untrusted in Sev guest. So PCI
OptionRom needs to be ignored if it is Sev guest. According to
&quot;Table 20. ACPI 2.0 &amp; 3.0 QWORD Address Space Descriptor Usage&quot;
PI spec 1.7, type-specific flags can be set to 0 when Address
Translation Offset == 6 to skip device option ROM.

Without patching, Sev guest may shows invalid MMIO opcode error
as following:

Invalid MMIO opcode (F6)
ASSERT /home/abuild/rpmbuild/BUILD/edk2-edk2-stable202202/OvmfPkg/Library/VmgExitLib/VmgExitVcHandler.c(1041): ((BOOLEAN)(0==1))</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19433</commentid>
    <comment_count>1</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2022-08-25 09:29:06 +0000</bug_when>
    <thetext>I have attached patch on bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19442</commentid>
    <comment_count>2</comment_count>
      <attachid>1019</attachid>
    <who name="Joey Lee">jlee</who>
    <bug_when>2022-08-28 23:51:08 +0000</bug_when>
    <thetext>Created attachment 1019
0001-OvmfPkg-IncompatiblePciDeviceSupportDxe-Ignore-Optio-v2.patch

Thanks for Gerd Hoffmann&apos;s review and suggestion on devel@edk2.groups.io. 

This is v2 patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19489</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-06 21:49:46 +0000</bug_when>
    <thetext>Lee: please take it, and send the patch to edk2 mail list for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21007</commentid>
    <comment_count>4</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-02-09 07:38:36 +0000</bug_when>
    <thetext>The patch be merged to edk2 mainline:

commit ceb52713b00a4bec1a4ab551636b8d297139ea6f
Author: Chun-Yi Lee &lt;joeyli.kernel@gmail.com&gt;
Date:   Thu Dec 15 22:27:23 2022 +0800

    OvmfPkg/PlatformInitLib: Fix integrity checking failed of NvVarStore

Set this bug to fixed.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1018</attachid>
            <date>2022-08-25 09:28:17 +0000</date>
            <delta_ts>2022-08-25 09:28:17 +0000</delta_ts>
            <desc>0001-OvmfPkg-IncompatiblePciDeviceSupportDxe-Ignore-Optio.patch</desc>
            <filename>0001-OvmfPkg-IncompatiblePciDeviceSupportDxe-Ignore-Optio.patch</filename>
            <type>text/plain</type>
            <size>2772</size>
            <attacher name="Joey Lee">jlee</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1019</attachid>
            <date>2022-08-28 23:51:08 +0000</date>
            <delta_ts>2022-08-28 23:51:08 +0000</delta_ts>
            <desc>0001-OvmfPkg-IncompatiblePciDeviceSupportDxe-Ignore-Optio-v2.patch</desc>
            <filename>0001-OvmfPkg-IncompatiblePciDeviceSupportDxe-Ignore-Optio-v2.patch</filename>
            <type>text/plain</type>
            <size>2972</size>
            <attacher name="Joey Lee">jlee</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4655</bug_id>
          
          <creation_ts>2024-01-25 00:47:07 +0000</creation_ts>
          <short_desc>UFS device Init fail in PEI phase.</short_desc>
          <delta_ts>2024-07-23 04:56:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Arun K">arunk</reporter>
          <assigned_to name="Jason Lin">jason1.lin</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>hao.a.wu</cc>
    
    <cc>jason1.lin</cc>
    
    <cc>ray.ni</cc>
    
    <cc>srinin</cc>
    
    <cc>srinivasanm</cc>
    
    <cc>sundaresans</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202305</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22419</commentid>
    <comment_count>0</comment_count>
    <who name="Arun K">arunk</who>
    <bug_when>2024-01-25 00:47:07 +0000</bug_when>
    <thetext>Hynix UFS 3.1 device fails to work in the PEI phase. but it&apos;s working fine in the DXE state. 

We checked the code flow between PEI and DXE states.
In the DXE driver, after the UFS flag init, we are waiting up to 600ms to make sure the Device Init flag is clear. but this part of the code is not there in the PEI driver. after adding this code in PEI, the UFS device works fine in PEI.
so, could you please add this part of the code in PEI also? 

//
// The host enables the device initialization completion by setting fDeviceInit flag.
//
Status = UfsSetFlag (Private, UfsFlagDevInit);
if (EFI_ERROR (Status)) {
return Status;
}

//
// There are cards that can take upto 600ms to clear fDeviceInit flag.
//
Timeout = UFS_INIT_COMPLETION_TIMEOUT;
do {
Status = UfsReadFlag (Private, UfsFlagDevInit, &amp;DeviceInitStatus);
if (EFI_ERROR (Status)) {
return Status;
}

MicroSecondDelay (1);
Timeout--;
} while (DeviceInitStatus != 0 &amp;&amp; Timeout != 0);

if (Timeout == 0) {
DEBUG ((DEBUG_ERROR, &quot;UfsFinishDeviceInitialization DeviceInitStatus=%x EFI_TIMEOUT \n&quot;, DeviceInitStatus));
return EFI_TIMEOUT;
} else {
DEBUG ((DEBUG_INFO, &quot;UfsFinishDeviceInitialization Timeout left=%x EFI_SUCCESS \n&quot;, Timeout));
return EFI_SUCCESS;
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22454</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-30 21:39:40 +0000</bug_when>
    <thetext>arunk@ami.com: please send your fix to edk2 mail list for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23255</commentid>
    <comment_count>2</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-07-23 04:56:24 +0000</bug_when>
    <thetext>Contributed code change to fill gap between PEI and DXE module mentioned above.
PR raised (https://github.com/tianocore/edk2/pull/5870) and merged.
It is as a part of EDK-II codebase.
SHA1-ID: 11c50d6ca10a1410c2db187078fa7139e29e3042

Move the status into &quot;Resolved&quot; and &quot;Fixed&quot;.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4361</bug_id>
          
          <creation_ts>2023-03-07 21:10:21 +0000</creation_ts>
          <short_desc>Add RedfishPkg version of PcdDebugPrintErrorLevel</short_desc>
          <delta_ts>2023-04-23 10:15:17 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          <dependson>4362</dependson>
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>igork</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>RedfishPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21159</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-03-07 21:10:21 +0000</bug_when>
    <thetext>Add RedfishPkg PcdDebugPrintErrorLevel to control the debug message output by RedfishPkg modules, such as dump Redfish host interface information, JSON payload, HTTP transfer and etc.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21230</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-03-21 21:47:54 +0000</bug_when>
    <thetext>Abner will take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21394</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-23 10:15:17 +0000</bug_when>
    <thetext>Replaced by BZ #4420.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4829</bug_id>
          
          <creation_ts>2024-08-13 02:09:34 +0000</creation_ts>
          <short_desc>7f17a15 (2024/02/22) breaks building OVMF with -D NETWORK_ENABLE=0</short_desc>
          <delta_ts>2024-10-20 04:44:53 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Mike Beaton">mjsbeaton</reporter>
          <assigned_to name="Mike Beaton">mjsbeaton</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23316</commentid>
    <comment_count>0</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-08-13 02:09:34 +0000</bug_when>
    <thetext>7f17a155640a2a9e1f7b0f3522628ee2c6f62624 (OvmfPkg: Shell*.inc: allow building without network support) breaks building OVMF with `-D NETWORK_ENABLE=0`.

Before this commit we can build OVMF with the following command in the OvmfPkg directory:

./build.sh -D NETWORK_ENABLE=0

After the commit the same command fails early with:

/home/user/OpenSource/edk2/OvmfPkg/OvmfPkgX64.dsc(15): error F001: Pcd (gEfiNetworkPkgTokenSpaceGuid.PcdAllowHttpConnections) defined in DSC is not declared in DEC files referenced in INF files in FDF. Arch: [&apos;X64&apos;]

(It appears fixing this just needs some additional conditionals, round this Pcd and two others which fail similarly when this one is fixed.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23367</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-09-04 20:40:28 +0000</bug_when>
    <thetext>Mike Beaton : please propose the code change.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23390</commentid>
    <comment_count>2</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-09-10 08:21:22 +0000</bug_when>
    <thetext>@gaoliming: Thank you. This is proposed by https://github.com/tianocore/edk2/pull/6087, which is now marked Approved. It generated the related issue https://github.com/tianocore/edk2/pull/6092 which I am working on.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23465</commentid>
    <comment_count>3</comment_count>
    <who name="Mike Beaton">mjsbeaton</who>
    <bug_when>2024-10-20 04:44:53 +0000</bug_when>
    <thetext>Fixed by https://github.com/tianocore/edk2/commit/14d7ae94bc1d3367703a674b862748cb117b71c8.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4054</bug_id>
          
          <creation_ts>2022-09-09 06:06:19 +0000</creation_ts>
          <short_desc>Add LoongArch virtual machine support to edk2-platforms</short_desc>
          <delta_ts>2022-11-28 08:25:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>Placeholder</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19541</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-09-09 06:06:19 +0000</bug_when>
    <thetext>The LoongArch support code for qemu has been integrated into the qemu open source community, adding LoongArch VM support in edk2-platform can compile the LoongArch&apos;s VM firmware for qemu.

LoongArch is the general processor architecture of Loongson.
You can get the latest LoongArch documents or LoongArch tools at https://github.com/loongson/.

You can also view the code through the Loongson community.
The edk2 code in Loongson community:
https://github.com/loongson/edk2/tree/LoongArch
The edk2-platform code in Loonson community:
https://github.com/loongson/edk2-platforms
The qemu code in Loongson community:
https://gitlab.com/qemu-project/qemu.git
The LoongArch Documentation in Loongson community:
https://github.com/loongson/LoongArch-Documentation/tree/main/docs
The all patches at:
https://github.com/loongson/edk2-platforms/tree/devel-LoongArch-patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19657</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:32:30 +0000</bug_when>
    <thetext>Chao is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20113</commentid>
    <comment_count>2</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-11-28 08:25:45 +0000</bug_when>
    <thetext>EDK2 Platforms has merged the patchset, so close it.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4677</bug_id>
          <alias>CVE-2024-1298</alias>
          <creation_ts>2024-02-07 13:34:31 +0000</creation_ts>
          <short_desc>Potential UINT32 overflow and subsequent divide by 0</short_desc>
          <delta_ts>2024-06-04 23:00:32 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="John Mathews">john.mathews</reporter>
          <assigned_to name="Pakkirisamy, ShanmugavelX">shanmugavelx.pakkirisamy</assigned_to>
          <cc>BrianM</cc>
    
    <cc>cacihelton13</cc>
    
    <cc>dandan.bi</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jian.j.wang</cc>
    
    <cc>kevin.davis</cc>
    
    <cc>louis.shen</cc>
    
    <cc>rencyx.reji</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>edk2-stable202305</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22544</commentid>
    <comment_count>0</comment_count>
      <attachid>1471</attachid>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-02-07 13:34:31 +0000</bug_when>
    <thetext>Created attachment 1471
Patch file from PR https://github.com/tianocore/edk2/pull/4705

Binarly BRLY-2023-021
https://github.com/binarly-io/Vulnerability-REsearch/blob/main/EDK2/BRLY-2023-021.md

MdeModulePkg/Universal/Acpi/FirmwarePerformanceDataTablePei/FirmwarePerformancePei.c

An attacker with the ability to modify physical memory can control the value of AcpiS3ResumeRecord-&gt;ResumeCount. If the attacker sets the value of ResumeCount to MAX_UINT32 (0xFFFFFFFF), and ResumeCount is subsequently incremented, its new value will be 0 (due to UINT32 overflow). Since there is no check for overflow, when ResumeCount is 0 and passed as the second argument to DivU64x32(), it will trigger a division by 0, and cause a system crash, leading to a DoS.

A PR was previously created, but has never been merged:
https://github.com/tianocore/edk2/pull/4705</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22655</commentid>
    <comment_count>1</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-02-26 12:23:31 +0000</bug_when>
    <thetext>Given that Binarly has already made BRLY-2023-021 public, I think this does not need to be embargoed.  We can make this a public EDK2 BZ.  
If no objections, will open this up after the next Infosec meeting on March 6.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22740</commentid>
    <comment_count>2</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-03-06 13:22:29 +0000</bug_when>
    <thetext>Discussed in Infosec mtg 3/6. Consensus is this issue is already public, so no embargo. Opening the BZ.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22979</commentid>
    <comment_count>3</comment_count>
      <attachid>1495</attachid>
    <who name="Pakkirisamy, ShanmugavelX">shanmugavelx.pakkirisamy</who>
    <bug_when>2024-04-25 08:51:33 +0000</bug_when>
    <thetext>Created attachment 1495
Version2

Tested on the real platform (Fishhawkfalls WorkStation) with the attached patch.

Without any patches, the system AcpiS3ResumeRecord-&gt;ResumeCount reaches its max value and Resume count reset to zero.
When the ResumeCount == 0 then, DivU64x32 function shows PEI_ASSERT.

With the proposed Version2 patch, it shows up the error message &quot;FPDT: S3 ResumeCount reaches the MAX_UINT32 value. So, S3 ResumeCount record reset to Zero&quot; and it skips the DivU64x32() and it continues to boot back to OS.
ResumeCount also will be incremented in the upcoming S3 cycle.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22980</commentid>
    <comment_count>4</comment_count>
      <attachid>1496</attachid>
    <who name="Pakkirisamy, ShanmugavelX">shanmugavelx.pakkirisamy</who>
    <bug_when>2024-04-25 09:16:53 +0000</bug_when>
    <thetext>Created attachment 1496
UnitTest

Unit Test:

Passing Case:
1. Flash the binary with patch (Version2).
2. Boot to EFI Shell &amp; Run the TestAcpiS3ResumeCount.efi application and it will increase the ResumeCount. (Attached Snap - TestApplication_To_Update_ResumeCount.JPG)
3. Exit and boot to Windows OS and Start -&gt; Open Event Viewer -&gt; Windows Logs -&gt; System -&gt; Clear Log... (Attached Snap - Clearing_EventViewer.JPG)
4. Put the system to Sleep (Start -&gt; Sleep)
5. Wake the system with power button/mouse/keyboard and once the system boot back to OS.
6. Open Event Viewer -&gt; Windows Logs -&gt; System checks on the Event ID 131. (or) Open Powershell and run the below command it will show up the list of S3 Event. (Attached Snap - PowerShell_EventViewer.JPG)
   &quot; Get-WinEvent -FilterHashtable @{ LogName=&apos;System&apos;; ID=&apos;131&apos; } &quot; --&gt; Without quotes
7. Continue to do Steps from 4 to 6 for 3 cycle and check the Max resume count and the resume count resets to zero and it will be incremented for every S3 cycle. (Attached Snap - PowerShell_EventViewer.JPG)

Negative Case:
1. Flash the binary without patch.
2. Boot to EFI Shell &amp; Run the TestAcpiS3ResumeCount.efi application and it will increase the ResumeCount. (Attached Snap - TestApplication_To_Update_ResumeCount.JPG)
3. Exit and boot to Windows OS and Start -&gt; Open Event Viewer -&gt; Windows Logs -&gt; System -&gt; Clear Log... (Attached Snap - Clearing_EventViewer.JPG)
4. Put the system to Sleep (Start -&gt; Sleep)
5. Wake the system with power button/mouse/keyboard and once the system boot back to OS.
6. Open Event Viewer -&gt; Windows Logs -&gt; System check on the Event ID 131. (or) Open Powershell and run the below command it will show up the list of S3 Event. (Attached Snap - PowerShell_EventViewer.JPG)
   &quot; Get-WinEvent -FilterHashtable @{ LogName=&apos;System&apos;; ID=&apos;131&apos; } &quot; --&gt; Without quotes
7. Continue to do Steps from 4 to 6 for 3 cycle and when the Resume count reaches MAX_UINT32 value and then system hits PEI_ASSERT.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22991</commentid>
    <comment_count>5</comment_count>
    <who name="Brian Mullen">BrianM</who>
    <bug_when>2024-05-01 12:32:02 +0000</bug_when>
    <thetext>We have communicated to to the supply chain this will be included in the may stable tag. Can we ensure it makes it? Orgs throughout the supply chain have been prepping for remediation activities for this issue and to change plans at this time would be disruptive.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23018</commentid>
    <comment_count>6</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-05-08 10:40:11 +0000</bug_when>
    <thetext>Patch version2 was sent to the edk2 mailing list for review.
https://edk2.groups.io/g/devel/topic/105977011</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23048</commentid>
    <comment_count>7</comment_count>
    <who name="Louis Shen">louis.shen</who>
    <bug_when>2024-05-21 03:00:55 +0000</bug_when>
    <thetext>Will this issue be assigned a CVE-ID for downstream supply chain communication and information alignment?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23056</commentid>
    <comment_count>8</comment_count>
    <who name="John Mathews">john.mathews</who>
    <bug_when>2024-05-23 12:57:39 +0000</bug_when>
    <thetext>Louis, yes, that is planned. We will share an update next week.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23061</commentid>
    <comment_count>9</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-26 22:22:25 +0000</bug_when>
    <thetext>merge in https://github.com/tianocore/edk2/pull/5659</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1471</attachid>
            <date>2024-02-07 13:34:31 +0000</date>
            <delta_ts>2024-02-07 13:34:31 +0000</delta_ts>
            <desc>Patch file from PR https://github.com/tianocore/edk2/pull/4705</desc>
            <filename>4705.patch</filename>
            <type>text/plain</type>
            <size>1931</size>
            <attacher name="John Mathews">john.mathews</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1495</attachid>
            <date>2024-04-25 08:51:33 +0000</date>
            <delta_ts>2024-04-25 08:51:33 +0000</delta_ts>
            <desc>Version2</desc>
            <filename>S3ResumeCount.patch</filename>
            <type>text/plain</type>
            <size>1814</size>
            <attacher name="Pakkirisamy, ShanmugavelX">shanmugavelx.pakkirisamy</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1496</attachid>
            <date>2024-04-25 09:16:53 +0000</date>
            <delta_ts>2024-04-25 09:16:53 +0000</delta_ts>
            <desc>UnitTest</desc>
            <filename>UnitTest-UpdateResumeCount.7z</filename>
            <type>application/octet-stream</type>
            <size>118190</size>
            <attacher name="Pakkirisamy, ShanmugavelX">shanmugavelx.pakkirisamy</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4531</bug_id>
          
          <creation_ts>2023-08-24 11:13:13 +0000</creation_ts>
          <short_desc>edk2-libc : Fix console jump to 0, 0 on lseek(fd, position=0, SEEK_CUR)</short_desc>
          <delta_ts>2023-08-25 13:31:48 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>dimitry.kloper</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>n.jayaprakash</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21853</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-24 11:13:13 +0000</bug_when>
    <thetext>Python code opens console file descriptor and uses lseek()
with position == 0 and SEEK_CUR as &apos;do nothing, check console is alive&apos;
operation.

Current implementation of daConsole ignores whence argument, this is
wrong in case lseek(0, SEEK_CUR) will send cursor to 0, 0.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21854</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-24 11:16:39 +0000</bug_when>
    <thetext>Verified that the issue exists.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21855</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-24 12:32:38 +0000</bug_when>
    <thetext>lseek(fd, 0, SEEK_CUR) changes the position of the cursor on the console to (0,0) which is not correct and needs to be fixed.

where fd is the file descriptor for the standard output which is nothing but console.

Under this scenario, the lseek is supposed to return the current file pointer position / offset of the standard output device / console.

The solution has been provided by Kloper Dimitry.
I have verified the solution and sending the patch for review and merger.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21857</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-08-25 13:31:48 +0000</bug_when>
    <thetext>patch reviewed and merged.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4395</bug_id>
          
          <creation_ts>2023-03-31 19:01:25 +0000</creation_ts>
          <short_desc>IntelFsp2Pkg: TempRamInit API should preserve EBX/RBX register.</short_desc>
          <delta_ts>2023-04-04 12:49:57 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21292</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-31 19:01:25 +0000</bug_when>
    <thetext>FSP specification defines the TempRamInit API preserved register list which including EBX, however current implementation unexpectedly overriding EBX/RBX register that should be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21294</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-03-31 19:17:05 +0000</bug_when>
    <thetext>code review sent: https://edk2.groups.io/g/devel/message/102337</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21309</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2023-04-04 12:49:57 +0000</bug_when>
    <thetext>patch merged:
https://github.com/tianocore/edk2/commit/af98f1fb0311d8e3cc52ab9fc544a8c8ff8f7546</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4859</bug_id>
          
          <creation_ts>2024-10-02 05:44:36 +0000</creation_ts>
          <short_desc>StrSize() cannot return 0</short_desc>
          <delta_ts>2024-12-16 04:59:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Pierre Gondois">pierre.gondois</reporter>
          <assigned_to name="Pierre Gondois">pierre.gondois</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23418</commentid>
    <comment_count>0</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2024-10-02 05:44:36 +0000</bug_when>
    <thetext>StrSize() is implemented in MdePkg/Library/BaseLib/String.c as:

UINTN
EFIAPI
StrSize (
  IN      CONST CHAR16  *String
  )
{
  return (StrLen (String) + 1) * sizeof (*String);
}

so StrSize cannot return 0. There are however numerous checks similar to:
  ASSERT (StrSize (String) != 0);
These check do not actually check anything and should be replaced with StrLen().

This was initially reported at:
https://github.com/tianocore/edk2/pull/5959/commits/82fc15eb756585445208fef484c9f4201faafe89</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23483</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-10-23 20:51:30 +0000</bug_when>
    <thetext>Pierre Gondois : please contribute the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23569</commentid>
    <comment_count>2</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2024-12-16 04:58:40 +0000</bug_when>
    <thetext>There was only one occurrence of the issue.

Fixed by: bf32c2d61f3e13e8e0f33fce431376812c99da81 (&quot;ArmPkg/SemihostFs: StrSize() cannot return 0&quot;)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23570</commentid>
    <comment_count>3</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2024-12-16 04:59:31 +0000</bug_when>
    <thetext>Fixed by: bf32c2d61f3e13e8e0f33fce431376812c99da81 (&quot;ArmPkg/SemihostFs: StrSize() cannot return 0&quot;)</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4082</bug_id>
          
          <creation_ts>2022-09-25 03:29:35 +0000</creation_ts>
          <short_desc>CryptoPkg: Add more Crypto X509 funtions.</short_desc>
          <delta_ts>2022-10-12 02:55:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="qi1.zhang@intel.com">qi1.zhang</reporter>
          <assigned_to name="qi1.zhang@intel.com">qi1.zhang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19628</commentid>
    <comment_count>0</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-09-25 03:29:35 +0000</bug_when>
    <thetext>Need to add more Crypto X509 funtions.

X509GetVersion;
X509GetSerialNumber;
X509GetIssuerName;
X509GetSignatureAlgorithm;
X509GetExtensionData;
X509GetExtendedKeyUsage;
X509GetValidity;
X509SetDateTime;
X509CompareDateTime;
X509GetKeyUsage;
X509VerifyCertChain;
X509GetCertFromCertChain;
Asn1GetTag;
X509GetExtendedBasicConstraints;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19629</commentid>
    <comment_count>1</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-09-25 03:29:58 +0000</bug_when>
    <thetext>WIP</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19760</commentid>
    <comment_count>2</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-10-12 02:55:56 +0000</bug_when>
    <thetext>merged in https://github.com/tianocore/edk2/pull/3470</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4710</bug_id>
          
          <creation_ts>2024-02-23 17:18:12 +0000</creation_ts>
          <short_desc>Device path (PathNode_Conf) test failure with a valid VLAN Device Path</short_desc>
          <delta_ts>2024-12-17 14:37:22 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sunny Wang">Sunny.Wang</reporter>
          <assigned_to name="Edhay">edhaya.chandran</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>xypron.glpk</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22646</commentid>
    <comment_count>0</comment_count>
    <who name="Sunny Wang">Sunny.Wang</who>
    <bug_when>2024-02-23 17:18:12 +0000</bug_when>
    <thetext>When the test check a valid VLAN device path node &quot;Vlan(4040)&quot;, it got failure and the following messages:
   
EFI_DEVICE_PATH_PROTOCOL - Messaging Device Path - Vlan Device Path – FAILURE
.....edk2-test/uefi-sct/SctPkg/TestCase/UEFI/EFI/Protocol/DevicePath/BlackBoxTest/DevicePathBBTestFunction.c:696:Type - 3, Subtype - 20, VlanId - 4040


It looks like the conditional expression in https://github.com/tianocore/edk2-test/blob/f999690054b56780f5efbe0999507d7176bd87f6/uefi-sct/SctPkg/TestCase/UEFI/EFI/Protocol/DevicePath/BlackBoxTest/DevicePathBBTestFunction.c#L685. 

The line 685 should be changed from 
if (Vlan-&gt;VlanId &gt; 4094 || Vlan-&gt;VlanId) {
to 
if (Vlan-&gt;VlanId &gt; 4094)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22747</commentid>
    <comment_count>1</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-03-07 09:16:56 +0000</bug_when>
    <thetext>Check for VlanID to be changed. 
Sunny to provide a patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23422</commentid>
    <comment_count>2</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-10-03 10:25:27 +0000</bug_when>
    <thetext>Edhay to take this up and publish a patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23473</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-10-22 23:41:20 +0000</bug_when>
    <thetext>The patch is published for review:
https://edk2.groups.io/g/devel/message/120661</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23474</commentid>
    <comment_count>4</comment_count>
      <attachid>1551</attachid>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-10-22 23:42:57 +0000</bug_when>
    <thetext>Created attachment 1551
correction of  vlanId check</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23512</commentid>
    <comment_count>5</comment_count>
    <who name="Heinrich Schuchardt">xypron.glpk</who>
    <bug_when>2024-11-05 15:44:29 +0000</bug_when>
    <thetext>Hello Edhaya,

in your patch you suggest the following change.

-      if (Vlan-&gt;VlanId &gt; 4094 || Vlan-&gt;VlanId) {
+      if (Vlan-&gt;VlanId &gt; 4094) {

In IEEE Std 802.1Q™-2005 I read:
&quot;the VID values 0 and FFF are reserved, as indicated in Table 9-2.&quot;

  0 - The null VLAN ID. Indicates that the tag header contains only priority.
  1 - The default PVID value used for classifying frames
      on ingress through a Bridge Port.
FFF - Reserved for implementation use. This VID value shall not be configured
      as a PVID or a member of a VID Set, or transmitted in a tag header.

The allowable range is 1 - 4094.

So I think the correct way to fix this is 

-      if (Vlan-&gt;VlanId &gt; 4094 || Vlan-&gt;VlanId) {
+      if (Vlan-&gt;VlanId &gt; 4094 || Vlan-&gt;VlanId &lt; 1) {

Best regards

Heinrich</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23513</commentid>
    <comment_count>6</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-11-07 10:13:24 +0000</bug_when>
    <thetext>Thank you for the comment, Heinrich.
Will update the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23523</commentid>
    <comment_count>7</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-11-07 15:48:50 +0000</bug_when>
    <thetext>Hi Heinrich, 
The new patch based on your comments is here:
https://edk2.groups.io/g/devel/message/120757

Also in attachment</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23524</commentid>
    <comment_count>8</comment_count>
      <attachid>1555</attachid>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-11-07 15:51:31 +0000</bug_when>
    <thetext>Created attachment 1555
correction of  vlanId check patch V2

Updated with Heinrich&apos;s comment</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23574</commentid>
    <comment_count>9</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-12-17 14:37:22 +0000</bug_when>
    <thetext>The solution is upstreamed through the commit:
https://github.com/tianocore/edk2-test/commit/8ac40d6809a62661ab71a8d9d8a9b58ad06df522</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1551</attachid>
            <date>2024-10-22 23:42:57 +0000</date>
            <delta_ts>2024-10-22 23:42:57 +0000</delta_ts>
            <desc>correction of  vlanId check</desc>
            <filename>0001-edk2-test-uefi-sct-Correct-the-vlanId-check-in-Devic.patch</filename>
            <type>application/octet-stream</type>
            <size>1510</size>
            <attacher name="Edhay">edhaya.chandran</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1555</attachid>
            <date>2024-11-07 15:51:31 +0000</date>
            <delta_ts>2024-11-07 15:51:31 +0000</delta_ts>
            <desc>correction of  vlanId check patch V2</desc>
            <filename>0001-edk2-test-uefi-sct-Correct-the-vlanId-check-in-Device_V2.patch</filename>
            <type>text/plain</type>
            <size>1530</size>
            <attacher name="Edhay">edhaya.chandran</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4244</bug_id>
          
          <creation_ts>2023-01-03 12:21:41 +0000</creation_ts>
          <short_desc>SCT improvement - Print out the PCIe device path for PCIe card/device related SCT failures.</short_desc>
          <delta_ts>2024-07-17 15:24:22 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sunny Wang">Sunny.Wang</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20418</commentid>
    <comment_count>0</comment_count>
    <who name="Sunny Wang">Sunny.Wang</who>
    <bug_when>2023-01-03 12:21:41 +0000</bug_when>
    <thetext>For now, it is hard to know if the SCT failure is caused by a PCIe card/device FW&apos;s UEFI driver or system firmware/BIOS&apos;s UEFI driver because there is no message showing which UEFI driver is tested. We would need to use shell commands &quot;drivers &quot;, &quot;dh&quot;, and &quot;unload&quot; to check this, which takes much time. 

Therefore, the proposed idea here is to call gBS-&gt;HandleProtocol with the tested handle to get then its LoadedImageProtocol or DevicePathProtocol or ComponentName2Protocol then print out the DevicePath or driver/controller name.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23233</commentid>
    <comment_count>1</comment_count>
      <attachid>1526</attachid>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-07-17 15:23:00 +0000</bug_when>
    <thetext>Created attachment 1526
device_path patches</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23234</commentid>
    <comment_count>2</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-07-17 15:23:43 +0000</bug_when>
    <thetext>The patches developed are as attached.
Author: prachotan.bathi@arm.com</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23235</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-07-17 15:24:22 +0000</bug_when>
    <thetext>The solution is as upstreamed by the commit:
https://github.com/tianocore/edk2-test/commit/df9a877d1bcc8fa8f6c4992cf531472d5908af71

Closing the issue.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1526</attachid>
            <date>2024-07-17 15:23:00 +0000</date>
            <delta_ts>2024-07-17 15:23:00 +0000</delta_ts>
            <desc>device_path patches</desc>
            <filename>device_path.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>6173</size>
            <attacher name="Edhay">edhaya.chandran</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4114</bug_id>
          
          <creation_ts>2022-10-23 21:47:02 +0000</creation_ts>
          <short_desc>(edk2-stable202211) IntelFsp2Pkg: Support Input UPD parameter as NULL cases.</short_desc>
          <delta_ts>2022-11-11 00:06:09 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chasel">chasel.chiu</reporter>
          <assigned_to name="Chasel">chasel.chiu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19807</commentid>
    <comment_count>0</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-23 21:47:02 +0000</bug_when>
    <thetext>FSP specification supports input UPD parameter as NULL cases which FSP will fall back to built-in UPD regions. FSP should not return invalid parameter in such cases.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19808</commentid>
    <comment_count>1</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-23 21:47:19 +0000</bug_when>
    <thetext>working on the fix.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19809</commentid>
    <comment_count>2</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-10-23 21:47:42 +0000</bug_when>
    <thetext>working on the fix.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19936</commentid>
    <comment_count>3</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-11-04 00:49:31 +0000</bug_when>
    <thetext>patch merged:
https://github.com/tianocore/edk2/commit/b84f32ae5b475ce657ea1c9db29d4e4ec7711948</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19962</commentid>
    <comment_count>4</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-11-07 21:27:21 +0000</bug_when>
    <thetext>Re-open this BZ as we are investigating one optimized/better implementation for 32bit FSP-T entry point.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19988</commentid>
    <comment_count>5</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-11-10 20:15:30 +0000</bug_when>
    <thetext>PR is waiting for merging: https://github.com/tianocore/e
dk2/pull/3624</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19996</commentid>
    <comment_count>6</comment_count>
    <who name="Chasel">chasel.chiu</who>
    <bug_when>2022-11-11 00:06:09 +0000</bug_when>
    <thetext>Improvement fix Patch merged: https://github.com/tianocore/edk2/commit/3182843f3bc92599fa2ed4fd13ffd3f75907fe9e</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4745</bug_id>
          
          <creation_ts>2024-04-04 03:07:34 +0000</creation_ts>
          <short_desc>edk2-libc : wrmsr function available in edk2module is not working as expected</short_desc>
          <delta_ts>2024-04-24 02:06:10 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22867</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-04 03:07:34 +0000</bug_when>
    <thetext>The any writes to the msr registers using the wrmsr are not properly getting reflected in the msr. 
As per my observation the higher 32 bit values are always set to 0.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22868</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-04 03:08:05 +0000</bug_when>
    <thetext>Confirming the bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22869</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-04 03:08:45 +0000</bug_when>
    <thetext>I will be working on a fix for this bug</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22870</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-04 03:14:39 +0000</bug_when>
    <thetext>After analyzing the code of the function
static PyObject *
edk2_wrmsr(PyObject *self, PyObject *args)
{
  unsigned int vecx, veax, vedx;
  UINT64       data = 0;
  if (!PyArg_ParseTuple(args, &quot;III&quot;, &amp;vecx, &amp;veax, &amp;vedx))
    return NULL;
  data = vedx &lt;&lt; 32 | veax;
  Py_BEGIN_ALLOW_THREADS
  AsmWriteMsr64(vecx, data);
  Py_END_ALLOW_THREADS
  Py_INCREF(Py_None);
  return Py_None;
}

The issue is with the below statement. 

data = vedx &lt;&lt; 32 | veax;

Where the vedx which is an unsigned int, after left shifting by 32 bits its value will be set to 0. Because of this the higher 32 bits of the MSR are always set to 0.

This statement needs to be modified as below
  data = (((UINT64)vedx) &lt;&lt; 32) | veax;

Verified the function by making this change and could see that the wrmsr is working as expected.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22871</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-04 11:52:08 +0000</bug_when>
    <thetext>submitted email patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22930</commentid>
    <comment_count>5</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-18 09:08:12 +0000</bug_when>
    <thetext>sent updated patch by incorporating the review comments</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22947</commentid>
    <comment_count>6</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-24 02:06:10 +0000</bug_when>
    <thetext>Changes merged to the main repo of edk2-libc
commit 93b671275ed676cb6fa15c4dd0d1fcfd9d4101ce</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4595</bug_id>
          
          <creation_ts>2023-11-09 01:15:00 +0000</creation_ts>
          <short_desc>Fix build error when remove &quot;-Wno-sometimes-uninitialized&quot; option</short_desc>
          <delta_ts>2023-11-17 03:06:55 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Jason Hsu">jasonx.hsu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2WrapperPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22141</commentid>
    <comment_count>0</comment_count>
    <who name="Jason Hsu">jasonx.hsu</who>
    <bug_when>2023-11-09 01:15:00 +0000</bug_when>
    <thetext>Fix build error when remove &quot;-Wno-sometimes-uninitialized&quot; option on clang build,
Add variable &quot;FspMultiPhaseApiOffset&quot; initialization.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22165</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-11-17 03:06:55 +0000</bug_when>
    <thetext>Fixed in commit 616f0d503707c2e3fbdbc397ccb16a822f584b03.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4448</bug_id>
          
          <creation_ts>2023-05-05 22:44:41 +0000</creation_ts>
          <short_desc>Add quotes arounbd OBJCOPY_ADDDEBUGFLAG file targets for Windows compatibility</short_desc>
          <delta_ts>2023-05-07 20:49:18 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21488</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-05 22:44:41 +0000</bug_when>
    <thetext>OBJCOPY_ADDDEBUGFLAG can be used for GCC family tool chain on
Windows.  The file path needs to use double quotes around the file
path target or it breaks the build with an error.

This change is compatible with GCC family on Linux.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21489</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-05 22:44:52 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21505</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-07 20:48:24 +0000</bug_when>
    <thetext>Confirmed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21506</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-05-07 20:49:18 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/4348

Commit: https://github.com/tianocore/edk2/commit/8e985ac3fdb2b117968ac1fa1f54666e166af8ac</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4289</bug_id>
          
          <creation_ts>2023-01-11 08:49:36 +0000</creation_ts>
          <short_desc>please clean up / actualize comments after commit 2a0bd3bffc80</short_desc>
          <delta_ts>2023-04-18 05:10:11 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Laszlo Ersek">laszlo.ersek</reporter>
          <assigned_to name="Gerd Hoffmann">kraxel</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20616</commentid>
    <comment_count>0</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-11 08:49:36 +0000</bug_when>
    <thetext>Report against edk2 @ 2cc6d4c8ed54:

For Q35, edk2 commit 2a0bd3bffc80 (&quot;OvmfPkg/PlatformInitLib: q35 mtrr setup fix&quot;, 2022-09-28) lowered the base of the 32-bit area that we mark as uncacheable via MTRRs (up to 4GB), from PcdPciExpressBaseAddress to 2GB.

Issues:

(1) The logic change broke the following comment, in PlatformQemuInitializeRam()        [OvmfPkg/Library/PlatformInitLib/MemDetect.c]:

    //
    // Set the memory range from the start of the 32-bit MMIO area (32-bit PCI
    // MMIO aperture on i440fx, PCIEXBAR on q35) to 4GB as uncacheable.
    //

Request: replace

  &quot;PCIEXBAR on q35&quot;

with

  &quot;PCIEXBAR or 2GB (dependent on low RAM size) on q35&quot;

(2) The new comment

  &quot;32-bit pci mmio window is 2G -&gt; 4G then&quot;

from commit 2a0bd3bffc80 does not reflect what the firmware does.

The firmware still places the 32-bit MMIO aperture above the MMCONFIG area (correctly so), and assigns BARs from there. The statement hinted-at in the above code comment, and in the commit message of 2a0bd3bffc80, almost certainly refers to QEMU commit 4a4418369d6d (&quot;q35: fix mmconfig and PCI0._CRS&quot;, 2019-06-16; original discussions at &lt;http://mid.mail-archive.com/20190528204331.5280-1-kraxel@redhat.com&gt; and &lt;http://mid.mail-archive.com/20190607073429.3436-1-kraxel@redhat.com&gt;)

Request: please clarify the comment in that the 2G-and-up MMIO window placement is performed by QEMU and the guest OS kernel, via QEMU&apos;s DSDT, \SB.PCI0, _CRS. The extension of the uncacheable 32-bit area does not extend the firmware&apos;s 32-bit PCI MMIO aperture.

(3) QEMU commit 4a4418369d6d does not actually start the 32-bit MMIO hole in the DSDT at 2GB, but at the top of the low RAM, for example at 1792 MB.

This means that the updated UC range, from edk2 commit 2a0bd3bffc80, doesn&apos;t go as low as the *guest OS* might place BARs, based on ACPI. However, no ill symptoms seem to originate from that, not at least with a RHEL-7.9 guest kernel.

This raises the question whether edk2 commit 2a0bd3bffc80 -- i.e., lowering the UC area&apos;s base -- makes any difference at all, i.e. whether it was necessary at all.

Request: please further update the comment near (2), that is, in PlatformQemuUc32BaseInitialization() [OvmfPkg/Library/PlatformInitLib/MemDetect.c], with the justification for the new logic from 2a0bd3bffc80.

For example, consider reverting the commit temporarily, reproduce the original symptom, and then write up the symptom in a comment. Per above, even if the MMIO aperture starts lower than the UC area (due to QEMU&apos;s logic from commit 4a4418369d6d), no symptoms are seen.

Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20617</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-11 08:58:47 +0000</bug_when>
    <thetext>Original subthread on the mailing list:

Re: [PATCH v2 2/4] OvmfPkg/PlatformInitLib: Add PlatformGetLowMemoryCB
http://mid.mail-archive.com/4ace3789-7192-0c53-b4b2-f62f907176d0@redhat.com
https://edk2.groups.io/g/devel/message/98295</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20650</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-12 13:41:09 +0000</bug_when>
    <thetext>(removing myself from the CC list)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20705</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-17 10:01:44 +0000</bug_when>
    <thetext>[PATCH v4 0/5] OvmfPkg: check 64bit mmio window for resource conflicts
http://mid.mail-archive.com/20230117121629.2149112-1-kraxel@redhat.com</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20706</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-01-17 10:02:03 +0000</bug_when>
    <thetext>(in progress per the pending patches)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21364</commentid>
    <comment_count>5</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-04-15 07:36:34 +0000</bug_when>
    <thetext>Hi Gerd, can this be closed now?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21377</commentid>
    <comment_count>6</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-04-18 05:10:11 +0000</bug_when>
    <thetext>Yes (commits 71fd87e98a3d68df..e4b3fd905a170b1).</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4136</bug_id>
          
          <creation_ts>2022-11-03 04:42:24 +0000</creation_ts>
          <short_desc>UefiPayloadPkg : Boot mode in PHIT HOB will not be updated</short_desc>
          <delta_ts>2022-11-04 02:45:19 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Victor Hsu">victorx.hsu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19920</commentid>
    <comment_count>0</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-03 04:42:24 +0000</bug_when>
    <thetext>Boot mode in PHIT HOB will not be updated</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19921</commentid>
    <comment_count>1</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-03 04:42:59 +0000</bug_when>
    <thetext>WIP</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19939</commentid>
    <comment_count>2</comment_count>
    <who name="Victor Hsu">victorx.hsu</who>
    <bug_when>2022-11-04 02:45:19 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/3584</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4778</bug_id>
          
          <creation_ts>2024-05-22 20:37:51 +0000</creation_ts>
          <short_desc>MPlib have wrong expectation that bsp should be 0.</short_desc>
          <delta_ts>2024-05-26 22:06:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ning Feng">ning.feng</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23053</commentid>
    <comment_count>0</comment_count>
    <who name="Ning Feng">ning.feng</who>
    <bug_when>2024-05-22 20:37:51 +0000</bug_when>
    <thetext>MPlib have wrong expectation that bsp id should be 0 in MpInitLibInitialize(), SwitchBsp(),ApWakeupFunction. that will caused the data mismatch, if the beginning bsp is not 0.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23054</commentid>
    <comment_count>1</comment_count>
    <who name="Ning Feng">ning.feng</who>
    <bug_when>2024-05-22 22:49:52 +0000</bug_when>
    <thetext>https://edk2.groups.io/g/devel/message/119127</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23055</commentid>
    <comment_count>2</comment_count>
    <who name="Ning Feng">ning.feng</who>
    <bug_when>2024-05-23 01:42:59 +0000</bug_when>
    <thetext>confirm with ray this is real bug and here is the patch to fix it.
https://edk2.groups.io/g/devel/message/119127</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23058</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-26 22:06:21 +0000</bug_when>
    <thetext>Merge https://github.com/tianocore/edk2/pull/5683</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4477</bug_id>
          
          <creation_ts>2023-06-05 02:20:24 +0000</creation_ts>
          <short_desc>NetworkPkg: Incorrect length of EAP Identity from AMT</short_desc>
          <delta_ts>2023-07-27 03:53:37 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to name="yi1.li@intel.com">yi1.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21634</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-06-05 02:20:24 +0000</bug_when>
    <thetext>Tls connection fail over WiFi in AMT OCR flow due to invalid identity.

This was due to missing conversion between unicode and ascii string which resulted in invalid strlen.

The identity from AMT should be ascii string instead of unicode, ref:
https://software.intel.com/sites/manageability/AMT_Implementation_and_Reference_Guide/default.htm?turl=HTMLDocuments%2FWS-Management_Class_Reference%2FAMT_8021XProfile.htm%23RoamingIdentity

At the same time, the Identity size may exceed the maximum value(128bytes), when the identity is Username.

Username
public string Username
General Information:
Within the domain specified by Domain, Identifies the user that is requesting access to the network.
Qualifiers:
-------------
MaxLen=128</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21749</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:41:47 +0000</bug_when>
    <thetext>yi1.li@intel.com: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21778</commentid>
    <comment_count>2</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-07-27 03:53:37 +0000</bug_when>
    <thetext>Done.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4334</bug_id>
          
          <creation_ts>2023-02-01 22:26:41 +0000</creation_ts>
          <short_desc>[openssl] GCC build warning from openssl</short_desc>
          <delta_ts>2023-04-25 22:08:52 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Gang Chen">gang.c.chen</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20983</commentid>
    <comment_count>0</comment_count>
    <who name="Gang Chen">gang.c.chen</who>
    <bug_when>2023-02-01 22:26:41 +0000</bug_when>
    <thetext>There&apos;re several gcc build warning from openssl:

 /home/gchen29/code/ServerGen3/Edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/conf/conf_sap.c:48:19: warning: variable flags set but not used [-Wunused-but-set-variable]
  /home/gchen29/code/ServerGen3/Edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/conf/conf_sap.c:47:17: warning: variable appname set but not used [-Wunused-but-set-variable]
  /home/gchen29/code/ServerGen3/Edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/conf/conf_sap.c:46:17: warning: variable filename set but not used [-Wunused-but-set-variable]
  /home/gchen29/code/ServerGen3/Edk2/CryptoPkg/Library/OpensslLib/openssl/crypto/init.c:763:11: warning: variable handlersym set but not used [-Wunused-but-set-variable]</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20984</commentid>
    <comment_count>1</comment_count>
    <who name="Gang Chen">gang.c.chen</who>
    <bug_when>2023-02-01 22:27:36 +0000</bug_when>
    <thetext>I&apos;ve uploaded fix patch in openssl:https://github.com/openssl/openssl/pull/19153. But it won&apos;t be included in the 1.1.1.x. 
So currently, we need to update the GCC build option as the WA to clean up the GCC build warning.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21061</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-02-14 22:03:07 +0000</bug_when>
    <thetext>Gang: which openssl version includes this fix?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21095</commentid>
    <comment_count>3</comment_count>
    <who name="Gang Chen">gang.c.chen</who>
    <bug_when>2023-02-21 21:09:02 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #2)
&gt; Gang: which openssl version includes this fix?

Hi Liming,

At first, I uploaded the patch https://github.com/openssl/openssl/pull/19153.

Communicated with the maintainers, and they agreed to have it on 1.1.1 branch. Than I uploaded it on 1.1.1 stable branch: https://github.com/openssl/openssl/pull/20347

Let&apos;s monitor the status.
Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21126</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-02-28 21:46:29 +0000</bug_when>
    <thetext>Gang: can you provide the full build log? Now, Edk2\CryptoPkg\Library\OpensslLib\OpensslLib.inf has disabled this warning message for GCC tool chain.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21148</commentid>
    <comment_count>5</comment_count>
      <attachid>1334</attachid>
    <who name="Gang Chen">gang.c.chen</who>
    <bug_when>2023-03-06 00:58:57 +0000</bug_when>
    <thetext>Created attachment 1334
BIOS build log

Thanks for Liming&apos;s comments. 

The build log is attached.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21236</commentid>
    <comment_count>6</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-03-21 21:59:25 +0000</bug_when>
    <thetext>Gang: I see your patch has been merged. Can you explain the difference between -Wno-unused-but-set-variable and -Wno-error=unused-but-set-variable?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21240</commentid>
    <comment_count>7</comment_count>
    <who name="Gang Chen">gang.c.chen</who>
    <bug_when>2023-03-21 22:26:21 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #6)
&gt; Gang: I see your patch has been merged. Can you explain the difference
&gt; between -Wno-unused-but-set-variable and -Wno-error=unused-but-set-variable?

Liming: refer the link https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-Wno-error_003d.

Copied from the link:
Note that specifying -Werror=foo automatically implies -Wfoo. However, -Wno-error=foo does not imply anything.

-Wno-unused-but-set-variable: it will not report warning unused-but-set-variable, and won&apos;t treat it as an error.

-Wno-error=unused-but-set-variable: it will report the warning unused-but-set-variable, but it won&apos;t be treated as an error.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21428</commentid>
    <comment_count>8</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 22:08:52 +0000</bug_when>
    <thetext>It has been fixed at 410ca0ff94a42ee541dd6ceab70ea974eeb7e500</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1334</attachid>
            <date>2023-03-06 00:58:57 +0000</date>
            <delta_ts>2023-03-06 00:58:57 +0000</delta_ts>
            <desc>BIOS build log</desc>
            <filename>BIOSBuild.7z</filename>
            <type>application/octet-stream</type>
            <size>382241</size>
            <attacher name="Gang Chen">gang.c.chen</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4157</bug_id>
          
          <creation_ts>2022-11-17 02:29:16 +0000</creation_ts>
          <short_desc>Disable PciDegrade support for LoongArch64</short_desc>
          <delta_ts>2022-11-30 22:53:35 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20051</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-11-17 02:29:16 +0000</bug_when>
    <thetext>Pcie devices that come with OPROM may require large Mem Space, and downgrading all 64 Bit Bars may result in insufficient space.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20139</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-29 22:00:33 +0000</bug_when>
    <thetext>Chao has sent the patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20160</commentid>
    <comment_count>2</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2022-11-30 22:53:35 +0000</bug_when>
    <thetext>This change has been merged, closing.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4809</bug_id>
          
          <creation_ts>2024-07-12 10:10:45 +0000</creation_ts>
          <short_desc>edk2-libc : add .gitattributes to preserve the right line endings for .sh and .bat files</short_desc>
          <delta_ts>2024-07-22 02:25:58 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23217</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-12 10:10:45 +0000</bug_when>
    <thetext>Due to the environment differences of the developers there is a possibility that the line endings can go wrong for the .bat and .sh files leading to execution failures when running these files on Windows and Linux OS respectively.

Irrespective of the developer environment the line endings for these files needs to be preserved as per the OS expectations like \r\n for .bat files and \n for .sh files.

Git provides a facility to manage these through the .gitattributes files where we need to set the following controls to ensure that the line endings are preserved proerly.

*.bat text eol=crlf
*.sh text eol=lf</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23219</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-12 10:29:31 +0000</bug_when>
    <thetext>Jayaprakash Nevara will be working on this</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23220</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-12 10:29:57 +0000</bug_when>
    <thetext>Sent patch request for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23249</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-22 02:25:58 +0000</bug_when>
    <thetext>A detailed discussions about this happened along with the patch review request.
There is an alignment with the maintainers of edk2-libc and other Tianocore project repos that this change need not go into the edk2-libc repo as of now.
There is a bigger effort going on to normalize the line endings to LF in git repos of Tianocore projects and set the git config to core.autocrlf=auto in the near future.

Hence closing this BZ as wontfix</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4033</bug_id>
          
          <creation_ts>2022-08-26 01:15:17 +0000</creation_ts>
          <short_desc>CryptoPkg: Add Hkdf SHA384 support</short_desc>
          <delta_ts>2022-09-23 03:52:28 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="qi1.zhang@intel.com">qi1.zhang</reporter>
          <assigned_to name="qi1.zhang@intel.com">qi1.zhang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19438</commentid>
    <comment_count>0</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-08-26 01:15:17 +0000</bug_when>
    <thetext>Add Hkdf-SHA384 support and Hkdf-SHA256 extract and expand separately.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19439</commentid>
    <comment_count>1</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-08-26 01:15:41 +0000</bug_when>
    <thetext>Work in progress</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19617</commentid>
    <comment_count>2</comment_count>
    <who name="qi1.zhang@intel.com">qi1.zhang</who>
    <bug_when>2022-09-23 03:52:28 +0000</bug_when>
    <thetext>Merged https://github.com/tianocore/edk2/pull/3387</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4656</bug_id>
          
          <creation_ts>2024-01-25 01:06:33 +0000</creation_ts>
          <short_desc>New fields have been added in SPCR structure based on Revision 4 SPCR table.</short_desc>
          <delta_ts>2024-06-07 06:49:33 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Praveen Sankar N">praveensankarn</reporter>
          <assigned_to name="Praveen Sankar N">praveensankarn</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>felixp</cc>
    
    <cc>gaoliming</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>srinivasanm</cc>
    
    <cc>sundaresans</cc>
    
    <cc>zhiguang.liu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22420</commentid>
    <comment_count>0</comment_count>
      <attachid>1463</attachid>
    <who name="Praveen Sankar N">praveensankarn</who>
    <bug_when>2024-01-25 01:06:33 +0000</bug_when>
    <thetext>Created attachment 1463
Changes are being attached which are related to SPCR table in SerialPortConsoleRedirectionTable.h file.

SPCR structure has been upgraded with new fields based on SPCR table Revision 4. The Structure EFI_ACPI_SERIAL_PORT_CONSOLE_REDIRECTION_TABLE in MdePkg\Include\IndustryStandard\SerialPortConsoleRedirectionTable.h should be updated with the additional fields.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22453</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-30 21:38:28 +0000</bug_when>
    <thetext>praveensankarn@ami.com: please send your patch to edk2 mail list for code review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22629</commentid>
    <comment_count>2</comment_count>
    <who name="Praveen Sankar N">praveensankarn</who>
    <bug_when>2024-02-21 01:53:46 +0000</bug_when>
    <thetext>Hi gaoliming@byosoft.com.cn, 
    The patch has been sent to edk2 mail list successfully. Please let me know the status once you received it.

Thanks,
Praveen</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22908</commentid>
    <comment_count>3</comment_count>
    <who name="Praveen Sankar N">praveensankarn</who>
    <bug_when>2024-04-15 03:20:35 +0000</bug_when>
    <thetext>Hi gaoliming@byosoft.com.cn, 
     Could you please let me know latest update on this issue which involves SPCR table changes for Rev 4 update.

Thanks,
Praveen Sankar</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22938</commentid>
    <comment_count>4</comment_count>
    <who name="Praveen Sankar N">praveensankarn</who>
    <bug_when>2024-04-22 08:38:40 +0000</bug_when>
    <thetext>Hi gaoliming@byosoft.com.cn, 
     The patch has been sent to the ekd2 mail list with one minimal change. Please look into this issue and let me know the status of the issue. 

Thanks,
Praveen Sankar</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23098</commentid>
    <comment_count>5</comment_count>
    <who name="Praveen Sankar N">praveensankarn</who>
    <bug_when>2024-06-07 06:49:33 +0000</bug_when>
    <thetext>SPCR table revision 4 changes have been committed and merged in the release of edk2 Stable-202405.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1463</attachid>
            <date>2024-01-25 01:06:33 +0000</date>
            <delta_ts>2024-01-25 01:06:33 +0000</delta_ts>
            <desc>Changes are being attached which are related to SPCR table in SerialPortConsoleRedirectionTable.h file.</desc>
            <filename>Edk2_Issue_SPCR.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>4964</size>
            <attacher name="Praveen Sankar N">praveensankarn</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4506</bug_id>
          
          <creation_ts>2023-07-21 06:03:04 +0000</creation_ts>
          <short_desc>edk2-libc - uninitialized global variable _res in file res_init.c of BsdSockeLib</short_desc>
          <delta_ts>2023-07-31 07:04:54 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>dimitry.kloper</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21758</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-07-21 06:03:04 +0000</bug_when>
    <thetext>res_init() is called from different places in sockets library. It depends
on global _res variable containing a state.

The problem is that if __BIND_RES_TEXT macro is not defined, _res is not
initialized. Depending on compiler and build optimization this can fill the
variable with garbage that is later used by res_init().</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21759</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-07-21 06:05:44 +0000</bug_when>
    <thetext>Created BZ ticket to for a pull request on edk2-libc https://github.com/tianocore/edk2-libc/pull/8 to follow the edk2 process of using emails for sending the Patch requests.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21786</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-07-31 07:04:17 +0000</bug_when>
    <thetext>patch from the PR:8 has been submitted.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21787</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2023-07-31 07:04:54 +0000</bug_when>
    <thetext>Patch merged</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4362</bug_id>
          
          <creation_ts>2023-03-07 21:13:37 +0000</creation_ts>
          <short_desc>Add BIT23 - Redfish debug message in PcdDebugPrintErrorLevel</short_desc>
          <delta_ts>2023-04-17 21:20:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>4361</blocked>
          <everconfirmed>0</everconfirmed>
          <reporter name="Chang, Abner">abner.chang</reporter>
          <assigned_to name="Chang, Abner">abner.chang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>igork</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21160</commentid>
    <comment_count>0</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-03-07 21:13:37 +0000</bug_when>
    <thetext>Add bit32 in PcdDebugPrintErrorLevel for RedfishPkg debug message.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21229</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-03-21 21:46:20 +0000</bug_when>
    <thetext>Abner will look the existing BIT14 - Network Driver message.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21371</commentid>
    <comment_count>2</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2023-04-17 21:20:56 +0000</bug_when>
    <thetext>Use bug 4414 instead.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4183</bug_id>
          
          <creation_ts>2022-12-05 20:37:56 +0000</creation_ts>
          <short_desc>Modify APIs in UnitTestPersistenceLib to make it easy to become a public library.</short_desc>
          <delta_ts>2022-12-20 22:12:35 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>zhiguang.liu</reporter>
          <assigned_to>zhiguang.liu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UnitTestFrameworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20186</commentid>
    <comment_count>0</comment_count>
    <who name="">zhiguang.liu</who>
    <bug_when>2022-12-05 20:37:56 +0000</bug_when>
    <thetext>UnitTestPersistenceLib is now a private library, and consumes private struct definition. Modify APIs in UnitTestPersistenceLib so it won&apos;t consume private struct definition, and easy to become a public library.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20241</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-12-20 21:52:05 +0000</bug_when>
    <thetext>zhiguang.liu@intel.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20247</commentid>
    <comment_count>2</comment_count>
    <who name="">zhiguang.liu</who>
    <bug_when>2022-12-20 22:12:35 +0000</bug_when>
    <thetext>Merged at https://github.com/tianocore/edk2/commit/1cd902f1f468500eac6c90a13cbf49a5db4ef32e</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4830</bug_id>
          
          <creation_ts>2024-08-14 10:56:24 +0000</creation_ts>
          <short_desc>Expose BrainpoolP512r1 support</short_desc>
          <delta_ts>2024-09-19 19:38:39 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Holland">michael.holland</reporter>
          <assigned_to name="Michael Holland">michael.holland</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23320</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Holland">michael.holland</who>
    <bug_when>2024-08-14 10:56:24 +0000</bug_when>
    <thetext>BrainpoolP512r1 encoding is not supported in EDK2.  If the request to leverage BrainpoolP512r1 is sent, an invalid NID is reported.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23321</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Holland">michael.holland</who>
    <bug_when>2024-08-14 11:41:25 +0000</bug_when>
    <thetext>Bug has been assigned</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23342</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Holland">michael.holland</who>
    <bug_when>2024-08-24 12:37:24 +0000</bug_when>
    <thetext>PR has been issued:  https://github.com/tianocore/edk2/pull/6088</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23400</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Holland">michael.holland</who>
    <bug_when>2024-09-19 19:38:39 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/6088 was merged</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4055</bug_id>
          
          <creation_ts>2022-09-09 17:20:08 +0000</creation_ts>
          <short_desc>VirtioBlk doesn&apos;t work with cache modeling enabled on RDN2 FVP</short_desc>
          <delta_ts>2023-04-21 20:13:50 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Rebecca Cran">rebecca</reporter>
          <assigned_to name="Rebecca Cran">rebecca</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19547</commentid>
    <comment_count>0</comment_count>
      <attachid>1023</attachid>
    <who name="Rebecca Cran">rebecca</who>
    <bug_when>2022-09-09 17:20:08 +0000</bug_when>
    <thetext>Created attachment 1023
Screenshot showing FVP and Arm DS

Configuration:

- RDN2 FVP 11.18.24 from https://developer.arm.com/downloads/-/arm-ecosystem-fvps

- rd-infra tree from https://gitlab.arm.com/arm-reference-solutions/arm-reference-solutions-docs/-/tree/master/docs/infra/rdn2

- pinned-rdn2.xml manifest

- RD-INFRA-2022.08.18 branch/tag

Add the following line to PARAMS in run_model.sh (in rd-infra/model-scripts/rdinfra/platforms/rdn2) to enable cache modeling:

-C css.cache_state_modelled=1

Build and run:

./build-scripts/rdinfra/build-test-busybox.sh -p rdn2 build
./build-scripts/rdinfra/build-test-busybox.sh -p rdn2 package
cd model-scripts/rdinfra
./boot.sh -p rdn2

When the virtio block device is first accessed during the BDS phase, the driver goes into an infinite wait.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19656</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:31:55 +0000</bug_when>
    <thetext>rebecca@bsdio.com: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21388</commentid>
    <comment_count>2</comment_count>
    <who name="Rebecca Cran">rebecca</who>
    <bug_when>2023-04-21 20:13:50 +0000</bug_when>
    <thetext>This appears to have been resolved with the FVP_RD_N2 FVP version 11.19.16.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1023</attachid>
            <date>2022-09-09 17:20:08 +0000</date>
            <delta_ts>2022-09-09 17:20:08 +0000</delta_ts>
            <desc>Screenshot showing FVP and Arm DS</desc>
            <filename>VirtioHang.png</filename>
            <type>image/png</type>
            <size>672625</size>
            <attacher name="Rebecca Cran">rebecca</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4679</bug_id>
          
          <creation_ts>2024-02-13 10:49:39 +0000</creation_ts>
          <short_desc>BaseTools/Scripts/PatchCheck: Check for commits spanning package boundaries</short_desc>
          <delta_ts>2024-03-08 15:21:47 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>rebecca</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22562</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2024-02-13 10:49:39 +0000</bug_when>
    <thetext>As noted in this message to the edk2 mailing list (https://edk2.groups.io/g/devel/message/114915), some commits have changes that span package boundaries. See that message for examples.

edk2 is an upstream project for a large set of industry firmware codebases. Many of these codebases are structured according to project requirements and often do not mirror edk2&apos;s monolithic/disparate collection of packages.

In particular, packages like MdePkg, MdeModulePkg, SecurityPkg, and UefiCpuPkg are especially foundational to building UEFI spec compliant firmware.

When commits span more specialized packages like ArmVirtPkg, OvmfPkg, etc. it makes including these commits in downstream repos a tedious exercise of breaking the commits without a 1:1 correspondence to the upstream. Tianocore has generally done a good job of maintaining bisectability while respecting package boundaries. To ensure only the most exceptional cases span package boundaries, it was decided in the Feb. 12, 2024 Tianocore Tools &amp; CI meeting that a check should be in place at some point in the build and CI process to identify commits that span package boundaries. The natural point to do so was noted as PatchCheck.

A potential algorithm for detecting such patches was given in the thread included below:

  * Use git command to retrieve list of files modified by a patch.
  * Look through parent directories and collect all *.dec files
  * If number of *.dec files &gt; 1 then FAIL
  * If number of *.dec files is 0 or 1, then PASS</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22577</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 18:42:56 +0000</bug_when>
    <thetext>Proposed change:

* Use &quot;git ls-files *.dec&quot; to get list of package DEC files and
  then use os.path.dirname() on each DEC file returned to get the
  list of package root directory.

* Use &quot;git diff-tree --no-commit-id --name-only -r &lt;commit&gt;&quot; to get
  the list of files modified by each commit.

* Check to list of files modified by each commit against the list
  of package roots to determine the set of package root directories 
  a single commit modifies.

* If number of unique package roots found is &gt; 1, the FAIL the check
  and print the set of unique package roots.

One potential issue with this check is that use of a git mv command
to move files/dirs from one package to another would require the 
git mv operation to be split across 2 commits.  One to remove the
content from the source package and one to add content to the target
package. That prevents git blame from being able to trace movement 
of content if the commits are split up that way.

An adjustment to the proposal is to use --diff-filter to evaluate
the files (A)dded and (M)odified to make sure all added and modified
files in a commit do not touch more than one package.  The use
--diff-filter to evaluate (D)eleted files to make sire deleted files
in a commit does not remove files from more than one package.

* Use the following git commands to retrieve list of files added/modified
  and the list of files deleted.

  &quot;git diff-tree --no-commit-id --name-only --diff-filter=AM -r &lt;commit&gt;&quot;
  &quot;git diff-tree --no-commit-id --name-only --diff-filter=D -r &lt;commit&gt;&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22578</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 20:02:54 +0000</bug_when>
    <thetext>Couple more corner cases

1) If a commit modifies a file in a non-package(e.g. BaseTools, .pytool)
   and modifies a file in a package, then that is an error.
2) If a commit modifies a files in more than one non-package, then
   that is also an error.
3) Files in the root of the repo should be ignored for these checks.
   For example, it is common to update Readme or .gitmodules or 
   Maintainers.txt along with files in a specific package or non-package.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22579</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 20:18:54 +0000</bug_when>
    <thetext>Patch review email

https://edk2.groups.io/g/devel/message/115424</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22580</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 20:19:57 +0000</bug_when>
    <thetext>I tested the patch under review against the set of commits that span package boundaries referenced in this bug report.  The results are as follows:

edk2&gt;BaseTools\Scripts\PatchCheck.py 103fa647d159e3d76be2634d2653c2d215dd0d46 
Checking git commit: 103fa647d159e3d76be2634d2653c2d215dd0d46
ArmPkg: Replace CoreId and ClusterId with Mpidr in ARM_CORE_INFO struct
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * ArmPlatformPkg/ArmPlatformPkg.dec
 * ArmPkg/ArmPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 34969dd260b4ecaba8d4a58d32fc07bd0fee57f9 
Checking git commit: 34969dd260b4ecaba8d4a58d32fc07bd0fee57f9
ArmPkg, ArmVirtPkg: put SpellCheck in AuditOnly mode
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * ArmPkg/ArmPkg.dec
 * ArmVirtPkg/ArmVirtPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 7d78a86ecfc6d86244a552b1bad6fb346439116b 
Checking git commit: 7d78a86ecfc6d86244a552b1bad6fb346439116b
ArmPkg: Use PcdPciIoTranslation PCD from MdePkg
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * ArmPkg/ArmPkg.dec
 * ArmVirtPkg/ArmVirtPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py f8d0501ded2ad426cc5c6c1237ec83fc978f8373 
Checking git commit: f8d0501ded2ad426cc5c6c1237ec83fc978f8373
ArmVirtPkg/QemuFwCfgLib: Relocate QemuFwCfgLib to OvmfPkg
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * ArmVirtPkg/ArmVirtPkg.dec
 * OvmfPkg/OvmfPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py d881c6ddf556dfb5032db04733dfa86aa891e7f8 
Checking git commit: d881c6ddf556dfb5032db04733dfa86aa891e7f8
ArmVirtPkg/HighMemDxe: Relocate HighMemDxe to OvmfPkg
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * ArmVirtPkg/ArmVirtPkg.dec
 * OvmfPkg/OvmfPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 77e9b3a7c68cea4eeb64af85e4f695f278172314 
Checking git commit: 77e9b3a7c68cea4eeb64af85e4f695f278172314
ArmVirtPkg/FdtPciPcdProducerLib: Relocate PciPcdProducerLib to OvmfPkg
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * ArmVirtPkg/ArmVirtPkg.dec
 * OvmfPkg/OvmfPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 9a7509e465d648314824733200566190c8814ec6 
Checking git commit: 9a7509e465d648314824733200566190c8814ec6
ArmVirtPkg/FdtPciHostBridgeLib: Relocate FdtPciHostBridgeLib to OvmfPkg/Fdt
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * ArmPkg/ArmPkg.dec
 * OvmfPkg/OvmfPkg.dec
 * ArmVirtPkg/ArmVirtPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py e40fefafa90fb3a9aca77adc697c97cf6a4dd673 
Checking git commit: e40fefafa90fb3a9aca77adc697c97cf6a4dd673
ArmVirtPkg/FdtClintDxe: Move FdtClientDxe to EmbeddedPkg
WARNING - Line 3 of commit message is too long (78 &gt;= 76).
This is one of the series patches to restructure the location of modules under
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * ArmVirtPkg/ArmVirtPkg.dec
 * EmbeddedPkg/EmbeddedPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py f484427d10a5ff6c2437c2f7c671e9e552ad6766 
Checking git commit: f484427d10a5ff6c2437c2f7c671e9e552ad6766
ArmPkg, BaseTools AARCH64: Add BTI ELF note to .hii objects
The commit message format passed all checks.
The code passed all checks.

WARNING - The following binary files will be added into the repository:
  ArmPkg/Library/GnuNoteBti.bin
The commit adds/modifies files in multiple packages:
 * ArmPkg/ArmPkg.dec
 * BaseTools

edk2&gt;BaseTools\Scripts\PatchCheck.py 4c55f6394fafe0494ec24e7c05cb68c938d7852d 
Checking git commit: 4c55f6394fafe0494ec24e7c05cb68c938d7852d
MdePkg: IORT header update for IORT Rev E.d spec
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * MdePkg/MdePkg.dec
 * DynamicTablesPkg/DynamicTablesPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py fa78edc57eb000f7820d5896f61053069b61eba1 
Checking git commit: fa78edc57eb000f7820d5896f61053069b61eba1
IntelFsp2Pkg: Remove UefiCpuLib from module INFs.
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * IntelFsp2Pkg/IntelFsp2Pkg.dec
 * IntelFsp2WrapperPkg/IntelFsp2WrapperPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 5443c2dc310d2c8eb15fb8eefd5057342e78cd0d 
Checking git commit: 5443c2dc310d2c8eb15fb8eefd5057342e78cd0d
MdePkg/Rng: Add GetRngGuid() to RngLib
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * MdeModulePkg/MdeModulePkg.dec
 * MdePkg/MdePkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 53eb26b238541799134aa5846530485c915735da 
Checking git commit: 53eb26b238541799134aa5846530485c915735da
MdePkg: Update MemoryAttributesTable to v2.10
WARNING - Line 10 of commit message is too long (91 &gt;= 76).
Link: https://uefi.org/specs/UEFI/2.10/04_EFI_System_Table.html#efi-memory-attributes-table
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * MdeModulePkg/MdeModulePkg.dec
 * MdePkg/MdePkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 502c01c5028038e4e6b4512e9c66be0ec4d11492 
Checking git commit: 502c01c5028038e4e6b4512e9c66be0ec4d11492
MdePkg: Add UEFI Unaccepted memory definition
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * MdeModulePkg/MdeModulePkg.dec
 * MdePkg/MdePkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py fd306d1dbc36d10f744306e92366d73273c82c8f 
Checking git commit: fd306d1dbc36d10f744306e92366d73273c82c8f
MdeModulePkg: Add PcdTdxSharedBitMask
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * MdeModulePkg/MdeModulePkg.dec
 * OvmfPkg/OvmfPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py e7abb94d1fb8a0e7725b983bbf5ab1334afe7ed1 
Checking git commit: e7abb94d1fb8a0e7725b983bbf5ab1334afe7ed1
CpuException: Add InitializeSeparateExceptionStacks
WARNING - Line 24 of commit message is too long (76 &gt;= 76).
This patch cleans up the code to separate the stack assignment to a new API:
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * UefiCpuPkg/UefiCpuPkg.dec
 * MdeModulePkg/MdeModulePkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 2a09527ebcb459b40bc3661d85aa11c3905526dc 
Checking git commit: 2a09527ebcb459b40bc3661d85aa11c3905526dc
CpuException: Remove InitializeCpuInterruptHandlers
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * UefiCpuPkg/UefiCpuPkg.dec
 * MdeModulePkg/MdeModulePkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 65b5dd828ef2ea5056031b239a4e7a6642f771a3 
Checking git commit: 65b5dd828ef2ea5056031b239a4e7a6642f771a3
SecurityPkg/SecurityPkg.dec: Move PcdCpuRngSupportedAlgorithm to MdePkg
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * SecurityPkg/SecurityPkg.dec
 * MdeModulePkg/MdeModulePkg.dec
 * MdePkg/MdePkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 0f7bccf584d93b2642c0a413a47fc821d1f5dbfd 
Checking git commit: 0f7bccf584d93b2642c0a413a47fc821d1f5dbfd
UefiCpuPkg: Simplify InitializeSeparateExceptionStacks
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * UefiCpuPkg/UefiCpuPkg.dec
 * ArmPkg/ArmPkg.dec
 * MdeModulePkg/MdeModulePkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 2f981bddcbd6adde5f682caf0d3812ba92bc0f73 
Checking git commit: 2f981bddcbd6adde5f682caf0d3812ba92bc0f73
MdeModulePkg: Duplicate BaseRngLibTimerLib to MdeModulePkg
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * ArmVirtPkg/ArmVirtPkg.dec
 * SignedCapsulePkg/SignedCapsulePkg.dec
 * MdeModulePkg/MdeModulePkg.dec
 * OvmfPkg/OvmfPkg.dec
 * SecurityPkg/SecurityPkg.dec
 * EmulatorPkg/EmulatorPkg.dec
 * NetworkPkg/NetworkPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 671b0cea510ad6de02ee9d6dbdf8f9bbb881f35d 
Checking git commit: 671b0cea510ad6de02ee9d6dbdf8f9bbb881f35d
NetworkPkg/HttpBootDxe: Add Support for HTTP Boot Basic Authentication
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * MdePkg/MdePkg.dec
 * NetworkPkg/NetworkPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 8079d4dc4f8ac23e02b02996e326cac4099b3e49 
Checking git commit: 8079d4dc4f8ac23e02b02996e326cac4099b3e49
MdePkg: add SmmCpuRendezvousLib.h and SmmCpuRendezvousLibNull implement.
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * UefiCpuPkg/UefiCpuPkg.dec
 * MdePkg/MdePkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py ea55bd8f66eeca5f4e80c3679bcf1b1007286b8a 
Checking git commit: ea55bd8f66eeca5f4e80c3679bcf1b1007286b8a
UefiCpuPkg: RISC-V: TimerLib: Fix delay function to use 64-bit
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * UefiCpuPkg/UefiCpuPkg.dec
 * MdePkg/MdePkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 39f3c26e8c40e092baeb0ec4d0396498506e0a9e 
Checking git commit: 39f3c26e8c40e092baeb0ec4d0396498506e0a9e
UefiPayloadPkg: Add FIT support
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * MdePkg/MdePkg.dec
 * UefiPayloadPkg/UefiPayloadPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py f0b97e165e0af79ac9eb3c6ac7697f9183afc7cb 
Checking git commit: f0b97e165e0af79ac9eb3c6ac7697f9183afc7cb
Revert &quot;OvmfPkg/Sec: fix stack switch&quot;
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * BaseTools
 * OvmfPkg/OvmfPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py ff36b2550f94dc5fac838cf298ae5a23cfddf204 
Checking git commit: ff36b2550f94dc5fac838cf298ae5a23cfddf204
OvmfPkg/Sec: fix stack switch
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * BaseTools
 * OvmfPkg/OvmfPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py f220dcbba86bfc1222180c61bbd31dd6023433db 
Checking git commit: f220dcbba86bfc1222180c61bbd31dd6023433db
UefiCpuPkg: RISC-V: Support MMU with SV39/48/57 mode
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * UefiCpuPkg/UefiCpuPkg.dec
 * OvmfPkg/OvmfPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 765ba5bf050022de8c44d93e467639d7f5fa237c 
Checking git commit: 765ba5bf050022de8c44d93e467639d7f5fa237c
OvmfPkg/UefiCpuPkg: Add CcExit prefix to the APIs of CcExitLib
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * UefiCpuPkg/UefiCpuPkg.dec
 * OvmfPkg/OvmfPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py a89f558d3c56d9c16e5f5b7d395c1aa36ccd38f2 
Checking git commit: a89f558d3c56d9c16e5f5b7d395c1aa36ccd38f2
OvmfPkg/UefiCpuPkg/UefiPayloadPkg: Rename VmgExitLib to CcExitLib
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * UefiCpuPkg/UefiCpuPkg.dec
 * UefiPayloadPkg/UefiPayloadPkg.dec
 * OvmfPkg/OvmfPkg.dec
The commit deletes files from multiple packages:
 * UefiCpuPkg/UefiCpuPkg.dec
 * OvmfPkg/OvmfPkg.dec

edk2&gt;BaseTools\Scripts\PatchCheck.py 7275993dc64481b1c21d7d70af434bfaafe86e81 
Checking git commit: 7275993dc64481b1c21d7d70af434bfaafe86e81
RedfishPkg/RedfishRestExDxe: return HTTP status code to caller.
The commit message format passed all checks.
The code passed all checks.
The commit adds/modifies files in multiple packages:
 * RedfishPkg/RedfishPkg.dec
 * MdePkg/MdePkg.dec</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22581</commentid>
    <comment_count>5</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 20:22:14 +0000</bug_when>
    <thetext>PR Opened:

https://github.com/tianocore/edk2/pull/5371</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22621</commentid>
    <comment_count>6</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 16:03:02 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/5383

Patch Review: https://edk2.groups.io/g/devel/message/115568</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22625</commentid>
    <comment_count>7</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 16:11:57 +0000</bug_when>
    <thetext>Refined Proposal to provide method to disable this check using
a commit message tag:

The proposal is to define a tag name &apos;Continuous-integration-options:&apos;
that can appear on one or more lines of the commit message and the tag 
value is a list of one or more CI check options. This defines a mechanism
that can be extended as needed. For the specific check under discussion
here, I am proposing an option value of &apos;PatchCheck.ignore-multi-package&apos;
An example commit message line to disable the multiple package check
for the one commit would be:

    Continuous-integration-options: PatchCheck.ignore-multi-package

When PatchCheck evaluates the commit message, if this tag/value is
present, then the multiple package check is still run, but the log
shows results as WARNING messages, and no errors are raised and CI 
receives a PASS result.

Additional details of on analysis of using either a label or a tag

https://edk2.groups.io/g/devel/message/115566</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22767</commentid>
    <comment_count>8</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-03-08 15:21:47 +0000</bug_when>
    <thetext>Merged: https://github.com/tianocore/edk2/pull/5419</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4532</bug_id>
          
          <creation_ts>2023-08-24 23:52:08 +0000</creation_ts>
          <short_desc>UefiPayloadPkg:Enhance the build processing for Universalpayload</short_desc>
          <delta_ts>2023-10-26 18:17:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Kasim Liu">kasimx.liu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21856</commentid>
    <comment_count>0</comment_count>
    <who name="Kasim Liu">kasimx.liu</who>
    <bug_when>2023-08-24 23:52:08 +0000</bug_when>
    <thetext>To Copy the PrebuildUplBinary to Build folder then add/replace Fvs.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21894</commentid>
    <comment_count>1</comment_count>
    <who name="Kasim Liu">kasimx.liu</who>
    <bug_when>2023-09-03 12:02:23 +0000</bug_when>
    <thetext>It&apos;s resolved by  https://github.com/tianocore/edk2/pull/4761</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22083</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 18:17:56 +0000</bug_when>
    <thetext>Fixed in commit 92006e5804a4adff05556a97a951fd7766a1d79f</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4860</bug_id>
          
          <creation_ts>2024-10-03 04:10:47 +0000</creation_ts>
          <short_desc>FatPkg/FatPei: Simplify the GPT Header Check to Align with PartitionDxe Module</short_desc>
          <delta_ts>2024-11-28 21:31:49 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jason Lin">jason1.lin</reporter>
          <assigned_to name="Jason Lin">jason1.lin</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>FatPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23420</commentid>
    <comment_count>0</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-10-03 04:10:47 +0000</bug_when>
    <thetext>Within the current code flow.
The GPT header checking is mismatched between PEI and DXE module within FatPkg.

[FatPkg/FatPei]
- PartHdr-&gt;Header.Signature != EFI_PTAB_HEADER_ID
- PartHdr-&gt;Header.Revision != 0x00010000
- PartHdr-&gt;Header.HeaderSize &lt; 92
- PartHdr-&gt;Header.HeaderSize &gt; ParentBlockDev-&gt;BlockSize
- !PartitionCheckGptHeaderCRC (PartHdr)
- PartHdr-&gt;Header.Reserved != 0
- PartHdr-&gt;MyLBA != Lba
- PartHdr-&gt;AlternateLBA != AlternateLba
- PartHdr-&gt;FirstUsableLBA &lt; 2 + EFI_SIZE_TO_BLOCKS (EFI_GPT_PART_ENTRY_MIN_SIZE, ParentBlockDev-&gt;BlockSize)
- PartHdr-&gt;LastUsableLBA  &gt; ParentBlockDev-&gt;LastBlock - 1 - EFI_SIZE_TO_BLOCKS (EFI_GPT_PART_ENTRY_MIN_SIZE, ParentBlockDev-&gt;BlockSize)
- PartHdr-&gt;FirstUsableLBA &gt; PartHdr-&gt;LastUsableLBA
- PartHdr-&gt;PartitionEntryLBA &lt; 2
- PartHdr-&gt;PartitionEntryLBA &gt; ParentBlockDev-&gt;LastBlock - 1
- (PartHdr-&gt;PartitionEntryLBA &gt;= PartHdr-&gt;FirstUsableLBA) &amp;&amp; (PartHdr-&gt;PartitionEntryLBA &lt;= PartHdr-&gt;LastUsableLBA)
- PartHdr-&gt;SizeOfPartitionEntry%128 != 0
- PartHdr-&gt;SizeOfPartitionEntry != sizeof (EFI_PARTITION_ENTRY)


[FatPkg/EnhancedFatDxe]
- PartHdr-&gt;Header.Signature != EFI_PTAB_HEADER_ID
- !PartitionCheckCrc (BlockSize, &amp;PartHdr-&gt;Header)
- PartHdr-&gt;MyLBA != Lba
- PartHdr-&gt;SizeOfPartitionEntry &lt; sizeof (EFI_PARTITION_ENTRY)
- PartHdr-&gt;NumberOfPartitionEntries &gt; DivU64x32 (MAX_UINTN, PartHdr-&gt;SizeOfPartitionEntry)
- !PartitionCheckGptEntryArrayCRC (BlockIo, DiskIo, PartHeader)

The intension of this ticket is used to simplify the condition in PEI phase and make it aligned with DXE phase.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23421</commentid>
    <comment_count>1</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-10-03 04:24:15 +0000</bug_when>
    <thetext>Correct the DXE module name &quot;Edk2\MdeModulePkg\Universal\Disk\PartitionDxe&quot;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23471</commentid>
    <comment_count>2</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-10-22 22:57:34 +0000</bug_when>
    <thetext>[Usescases]

Below is the table of the information to check the GPT.

|                           | Windows OS -1 | Windows OS -2 | Ubuntu     |
|---------------------------|---------------|---------------|------------|
| Header-&gt;Signature         | 0x20494645    | 0x20494645    | 0x20494645 |
| Header-&gt;Revision          | 0x10000       | 0x10000       | 0x10000    |
| Header-&gt;HeaderSize        | 0x5C          | 0x5C          | 0x5C       |
| Header-&gt;CRC32             | NA            | NA            | NA         |
| Header-&gt;Reserved          | 0x0           | 0x0           | 0x0        |
| MyLBA                     | 0x1           | 0x1           | 0x1        |
| AlternateLBA              | 0x1DCF32AF    | 0xC7FFFFF     | 0x5042021  |
| FirstUsableLBA            | 0x22          | 0x22          | 0x22       |
| LastUsableLBA             | 0x1DCF328E    | 0xC7FFFDE     | 0x5042000  |
| DiskGUID                  | NA            | NA            | NA         |
| PartitionEntryLBA         | 0x2           | 0x2           | 0x2        |
| NumberOfPartitionEntries  | NA            | NA            | NA         |
| SizeOfPartitionEntry      | 0x80          | 0x80          | 0x80       |
| PartitionEntryArrayCRC32  | NA            | NA            | NA         |
| ParentBlockDev-&gt;BlockSize | 0x200         | 0x200         | 0x200      |
| ParentBlockDev-&gt;LastBlock | 0x1DCF32AF    | 0x13FFFFFF    | 0x3A38602F |
|---------------------------|---------------|---------------|------------|
| Result                    | PASSED        | FAILED        | FAILED     |

In some of cases, the LastUsableLBA would not be located in device last block.
This would cause the GPT check failed in PEI phase (FatPei module).
Compared to DXE phase (PartitionDxe module), it could still have passed result.

Due to this we checked further on both of the condition.
We found that the condition used to check between PEI and DXE is mismatched.
Hence, we want to simplify the condition in PEI phase.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23472</commentid>
    <comment_count>3</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-10-22 23:01:19 +0000</bug_when>
    <thetext>Correct the &quot;LastUsableLBA&quot; into &quot;AlternateLBA&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23542</commentid>
    <comment_count>4</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-11-28 21:31:49 +0000</bug_when>
    <thetext>GitHub PR: https://github.com/tianocore/edk2/pull/6282

Change had been merged into EDK-II codebase as below SHA-1 ID,
    - e12a8d83faf7cf79b3dc7585950dd639df333342

Mark this Bugzilla ticket as completed and close it.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4083</bug_id>
          
          <creation_ts>2022-09-26 10:07:43 +0000</creation_ts>
          <short_desc>Reset a parameter when BSP Exit in CPU relaxed mode</short_desc>
          <delta_ts>2022-12-02 03:30:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="zhihao">zhihao.li</reporter>
          <assigned_to name="zhihao">zhihao.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19633</commentid>
    <comment_count>0</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-09-26 10:07:43 +0000</bug_when>
    <thetext>In CPU relaxed mode, it doesn&apos;t reset the value of 
mSmmMpSyncData-&gt;AllApArrivedWithException when BSP exit smm mode.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19643</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:04:09 +0000</bug_when>
    <thetext>Zhihao has worked on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20175</commentid>
    <comment_count>2</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-12-02 03:30:34 +0000</bug_when>
    <thetext>Fixed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4567</bug_id>
          
          <creation_ts>2023-10-15 22:49:15 +0000</creation_ts>
          <short_desc>Add 0x0B/Platform Runtime Mechanism (PRM) in Address Space ID of Generic Address Structure (GAS)</short_desc>
          <delta_ts>2023-10-31 11:21:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>jinlong.xu</reporter>
          <assigned_to>jinlong.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21980</commentid>
    <comment_count>0</comment_count>
    <who name="">jinlong.xu</who>
    <bug_when>2023-10-15 22:49:15 +0000</bug_when>
    <thetext>According to ACPI spec 6.5, add 0x0B/Platform Runtime Mechanism (PRM) in Address Space ID of Generic Address Structure (GAS).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21993</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 22:40:04 +0000</bug_when>
    <thetext> jinlong.xu@intel.com: please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22106</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-31 09:45:55 +0000</bug_when>
    <thetext>Patch on list:

[edk2-devel] [PATCH v2 2/5] MdePkg ACPI65: Add 0x0B/PRM to Generic Address Structure

https://edk2.groups.io/g/devel/message/109833</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22107</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-31 11:21:21 +0000</bug_when>
    <thetext>Merged as commit 2426a356258f0f759eb0661e1f8c0196aac48123 via &lt;https://github.com/tianocore/edk2/pull/4984&gt;.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4245</bug_id>
          
          <creation_ts>2023-01-03 21:23:07 +0000</creation_ts>
          <short_desc>TDVF need measurement VMM input ACPI table before register</short_desc>
          <delta_ts>2023-02-04 06:33:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>jiewen.yao</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20423</commentid>
    <comment_count>0</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-03 21:23:07 +0000</bug_when>
    <thetext>Current code (https://github.com/tianocore/edk2/blob/master/OvmfPkg/AcpiPlatformDxe/QemuFwCfgAcpi.c) just consumes the VMM input data directly. That violates the principle - any VMM input cfg data is untrusted and must be measured to RTMR.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20424</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-03 21:34:22 +0000</bug_when>
    <thetext>Min will take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20992</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-02-04 06:33:34 +0000</bug_when>
    <thetext>merged https://github.com/tianocore/edk2/pull/3997</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4115</bug_id>
          
          <creation_ts>2022-10-24 23:40:45 +0000</creation_ts>
          <short_desc>Enable initial CodeQL support</short_desc>
          <delta_ts>2022-11-28 22:09:18 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Test</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kubacki">michael.kubacki</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19815</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-24 23:40:45 +0000</bug_when>
    <thetext>This BZ tracks enabling the edk2 repo configuration necessary to run the Code Scanning GitHub Action, addition of a .github directory to the edk2 code tree to support GitHub workflows, and the introduction of CodeQL configuration files to support running CodeQL with no queries. This is to allow the basic infrastructure/permissions to be set up so additional query enabling work and corresponding code fixes can be added in the future.

---

A copy of the RFC related to this work is copied below.

- From: https://github.com/tianocore/edk2/discussions/3258#discussioncomment-3682099


#  Adoption of CodeQL in edk2

This RFC proposes adoption of CodeQL as a static analysis tool used in the TianoCore edk2 project.

## Introduction

CodeQL is open source and free for open-source projects. It is maintained by GitHub and naturally has excellent integration with GitHub projects. CodeQL generates a &quot;database&quot; during the firmware build process that enables queries to run against that database. Many open-source queries are officially supported and comprise the vulnerability analysis performed against the database. These queries are maintained here - https://github.com/github/codeql.

Queries are written in an object-oriented query language called QL. CodeQL provides:
1. A [command-line (CLI) interface](https://codeql.github.com/docs/codeql-cli/#codeql-cli)
2. A [VS Code extension](https://codeql.github.com/docs/codeql-for-visual-studio-code/#codeql-for-visual-studio-code) to help write queries and run queries
3. [GitHub action](https://github.com/github/codeql-action) support for repo integration via [code scanning](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/configuring-code-scanning)
4. In addition to other features described in the [CodeQL overview](https://codeql.github.com/docs/codeql-overview/)

[LGTM](https://lgtm.com/) is often paired with CodeQL so you may read about that in documentation. LGTM was acquired by GitHub a few years ago and all of the functionality has been moved to GitHub code scanning. You can read more about this process on the [GitHub blog post](https://github.blog/2022-08-15-the-next-step-for-lgtm-com-github-code-scanning/).

CodeQL is an actively maintained project. Here is a comparison of edk2 commit activity versus CodeQL for reference:

- [CodeQL Commit Activity](https://github.com/github/codeql/graphs/commit-activity)
- [edk2 Commit Activity](https://github.com/github/codeql/graphs/commit-activity)

Because CodeQL does maintain a strong open-source presence, the TianoCore community should be able to file [issues](https://github.com/github/codeql/issues) and [pull requests](https://github.com/github/codeql/pulls) into the project.

## CodeQL Usage in edk2

CodeQL provides the capability to debug the actual queries and for our (Tianocore) community to write our own queries and even contribute back to the upstream repo when appropriate. In other cases, we might choose to keep our own queries in a separate TianoCore repo or within a directory in the edk2 code tree. 

This is all part of CodeQL Scanning and [this page](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/configuring-code-scanning) has information concerning how to configure CodeQL scanning within a GitHub project such as edk2. Information on the particular topic of running additional custom queries is documented [here](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/configuring-code-scanning#running-additional-queries) in that page.

In addition, CodeQL presents the flexibility to:
- Build databases locally
- Retrieve databases from server builds
- Relatively quickly test queries locally against a database for a fast feedback loop
- Suppress false positives
- Customize the files and queries used in the edk2 project and quickly keep this list in sync between the server and local execution

### Dismissing CodeQL Alerts

The following documentation describes how to dismiss alerts:
[Dismissing Alerts](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/managing-code-scanning-alerts-for-your-repository#dismissing--alerts)

&gt; _Note:_ If query has a false positive a GitHub Issue can be submitted in the [CodeQL repo issues page](https://github.com/github/codeql/issues) with the `false-positive` tag to help improve the query.

### CodeQL in Pull Requests

The proposal is to enable CodeQL in a step-by-step fashion. The goal with this approach is to make steady progress enabling CodeQL to become more comprehensive and useful while not impacting day-to-day code contributions.

Throughout the process described in this section, CodeQL Code Scanning will be a mandatory status check for edk2 pull requests.

It is proposed to make no changes to the PR evaluation process already in place that only builds packages with changes in the pull request.

#### Query Target List

The first step is to define a target list of queries for edk2. While CodeQL has the ability run against several languages ([including Python](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/configuring-code-scanning#changing-the-languages-that-are-analyzed)), I propose we enable C/C++ first and then return to evaluate Python analysis.

I propose the following as an initial candidate list:

- [cpp/conditionally-uninitialized-variable](https://github.com/github/codeql/blob/main/cpp/ql/src/Security/CWE/CWE-457/ConditionallyUninitializedVariable.ql)
- [cpp/infinite-loop-with-unsatisfiable-exit-condition](https://github.com/github/codeql/blob/main/cpp/ql/src/Security/CWE/CWE-835/InfiniteLoopWithUnsatisfiableExitCondition.ql)
- [cpp/overflow-buffer](https://github.com/github/codeql/blob/main/cpp/ql/src/Security/CWE/CWE-119/OverflowBuffer.ql)
- [cpp/pointer-overflow-check](https://github.com/github/codeql/blob/main/cpp/ql/src/Likely%20Bugs/Memory%20Management/PointerOverflow.ql)
- [cpp/potential-buffer-overflow](https://github.com/github/codeql/blob/main/cpp/ql/src/Likely%20Bugs/Memory%20Management/PotentialBufferOverflow.ql)
- [cpp/toctou-race-condition](https://github.com/github/codeql/blob/main/cpp/ql/src/Security/CWE/CWE-367/TOCTOUFilesystemRace.ql)
- [cpp/unclear-array-index-validation](https://github.com/github/codeql/blob/main/cpp/ql/src/Security/CWE/CWE-129/ImproperArrayIndexValidation.ql)
- [cpp/unsafe-strncat](https://github.com/github/codeql/blob/main/cpp/ql/src/Likely%20Bugs/Memory%20Management/SuspiciousCallToStrncat.ql)
- [cpp/use-after-free](https://github.com/github/codeql/blob/main/cpp/ql/src/Critical/UseAfterFree.ql)
- [cpp/user-controlled-null-termination-tainted](https://github.com/github/codeql/blob/main/cpp/ql/src/Security/CWE/CWE-170/ImproperNullTerminationTainted.ql)
- [cpp/wrong-number-format-arguments](https://github.com/github/codeql/blob/main/cpp/ql/src/Likely%20Bugs/Format/WrongNumberOfFormatArguments.ql)
- [cpp/wrong-type-format-argument](https://github.com/github/codeql/blob/main/cpp/ql/src/Likely%20Bugs/Format/WrongTypeFormatArguments.ql)

CodeQL query files (.ql files) contain metadata about the query. For example, [cpp/conditionally-uninitialized-variable](https://github.com/github/codeql/blob/main/cpp/ql/src/Security/CWE/CWE-457/ConditionallyUninitializedVariable.ql) states the following about the query:

```plaintext
/**
 * @name Conditionally uninitialized variable
 * @description An initialization function is used to initialize a local variable, but the
 *              returned status code is not checked. The variable may be left in an uninitialized
 *              state, and reading the variable may result in undefined behavior.
 * @kind problem
 * @problem.severity warning
 * @security-severity 7.8
 * @id cpp/conditionally-uninitialized-variable
 * @tags security
 *       external/cwe/cwe-457
 */
```

We can automatically include queries against these criteria using &quot;query filters&quot;. For example, this could include any `problem` query above a certain `security-severity` level. Or all queries with `security` in `tags`.

That would mean new queries checked into the CodeQL repo could cause unexpected build breaks. Since edk2 favors consistency in CI results, I propose we start with the fixed query set proposed at the top of this section.

&gt; _Note:_ Additional queries can be found here as well - https://lgtm.com/search?q=cpp&amp;t=rules

##### Suggesting New Queries

It is proposed new queries be enabled by sending an RFC to the TianoCore development mailing list (devel@edk2.groups.io) with the query link and justification for adopting the query in edk2. Anyone is welcome to suggest new queries.

#### Enable One Query at a Time

Enabling the candidate list of queries immediately will trigger hundreds of alerts. 

Therefore, I recommend we enable one query at a time. The PR to enable each query can be accompanied by the code fixes for the query to pass. If a query is deemed fruitless during enabling testing, it can simply be rejected. The goal is to enable an effective set of queries that improve the codebase. As the list of enabled queries builds, the total CodeQL coverage will increase against active PRs.

I recommend we start with a query that has a very low alert frequency to enable the initial GitHub Action and build momentum for enabling additional queries.

It is proposed that each query be enabled in a &quot;query staging branch&quot; where the query is added to the edk2 query suite and each package contributes their patches to the branch to fix any issues necessary for the query to be successful. Once that branch is ready, it can be converted into a patch series that enables the query for the codebase in a single pull request.

That being said, we can [configure the severities that cause pull request failure](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/configuring-code-scanning#defining-the-severities-causing-pull-request-check-failure). If we find a useful informational query, that could be enabled without impacting the pull request status result. As of this RFC, those queries are not proposed.

#### edk2 Pull Request Example

I put together a [PR 3179: Test CodeQL](https://github.com/tianocore/edk2/pull/3179) that demonstrates a basic CodeQL GitHub action.

You can see the CodeQL link in the PR Checks area ([direct link to results](https://github.com/tianocore/edk2/pull/3179/checks?check_run_id=7817354780)):
![image](https://user-images.githubusercontent.com/21320094/187554321-6fb230f8-a870-468f-911e-861b046a1396.png)

You can also see the run on the [edk2/actions](https://github.com/tianocore/edk2/actions) page:
![image](https://user-images.githubusercontent.com/21320094/187554464-651313ea-8fad-4881-9e4c-fba0b102d444.png)

This initial test was mainly to ensure permissions were set up to allow the action to run and to settle other logistics in getting the action (first GitHub action in edk2) setup and working properly.

#### edk2 Pull Request Time

We can roughly expect CodeQL to take an hour to complete against a pull request. Since this would be the longest running task in a pull request in parallel to other jobs, pull requests should be expected to take around an hour to have all status checks finished. This is not considered an issue since:
1. Results can be checked locally
2. The TianoCore contribution process requires patches to be on the mailing list for a minimum of 24 hours
3. Pull requests can be created at any time to check results

CodeQL has the [ability to ignore certain file paths](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/configuring-code-scanning#avoiding-unnecessary-scans-of-pull-requests) and I recommend we leverage that to avoid running CodeQL on pull requests that only change the maintainers.txt file for example.

#### CodeQL Scheduled Builds

While pull requests will only build packages deemed necessary based on the PR evaluation heuristics used today, the plan is to have a 24 scheduled build that will build all of the packages and place the results in GitHub Code Scanning.

We will use this process to understand if there any differences discovered. Based on the results, we might choose to adjust our strategy for running CodeQL in pull requests to prevent future discrepancies. If differences are present, it is proposed maintainers of the affected package resolve those issues.

### CodeQL Locally

The [CodeQL CLI](https://codeql.github.com/docs/codeql-cli/) can be used as follows to wrap around the edk2 build process (`MdeModulePkg` in this case) to generate a database in the directory `cpp-database`. Example is shown using [stuart](https://github.com/tianocore/edk2-pytool-extensions) build command.

```cmd
codeql database create cpp-database --language=cpp --command=&quot;stuart_ci_build -c .pytool/CISettings.py -p MdeModulePkg -a IA32,X64 TOOL_CHAIN_TAG=VS2019 Target=DEBUG --clean --skip-post-build&quot; --overwrite
```

The following command can be used to generate a [SARIF file](https://codeql.github.com/docs/codeql-cli/sarif-output/) (called `query-results.sarif`) from that database with the results of the [cpp/conditionally-uninitialized-variable](https://github.com/github/codeql/blob/main/cpp/ql/src/Security/CWE/CWE-457/ConditionallyUninitializedVariable.ql) query:

```cmd
codeql database analyze cpp-database codeql\cpp\ql\src\Security\CWE\CWE-457\ConditionallyUninitializedVariable.ql --format=sarifv2.1.0 --output=query-results.sarif
```

SARIF logs can be read by log viewers such as the [Sarif Viewer](https://marketplace.visualstudio.com/items?itemName=MS-SarifVSCode.sarif-viewer) extension for [VS Code](https://code.visualstudio.com/).

---

Once an edk2 query suite (.qls) file is created, that same file can be used for pull requests and by developers locally using the CodeQL CLI to run the same set of queries with the `analyze` command shown above. Developers can add new queries to the file and confirm results before attempting server builds.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19828</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-25 21:41:13 +0000</bug_when>
    <thetext>Michael is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19931</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-11-03 20:27:25 +0000</bug_when>
    <thetext>V1 patch series: https://edk2.groups.io/g/devel/message/95822</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19932</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-11-03 20:27:51 +0000</bug_when>
    <thetext>v2 patch series: https://edk2.groups.io/g/devel/message/95906</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19933</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-11-03 20:35:57 +0000</bug_when>
    <thetext>v3 patch series: https://edk2.groups.io/g/devel/message/95927</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20117</commentid>
    <comment_count>5</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-11-28 22:09:18 +0000</bug_when>
    <thetext>Added in commit 6c1a4a376e97800c555dab9ca9d9651a5676d231</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4746</bug_id>
          
          <creation_ts>2024-04-04 11:57:07 +0000</creation_ts>
          <short_desc>edk2-libc : add rdmsr_ex and wrmsr_ex function to read/write of msrs from specific cpu</short_desc>
          <delta_ts>2024-05-03 03:39:13 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22872</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-04 11:57:07 +0000</bug_when>
    <thetext>The edk2module in the python interpreter project available under edk2-libc repo provides a functions 
 rdmsr  to read a specific msr
 wrmsr  to write data to a specific msr register

But these functions always work on the current BSP processor.

If the user wants to read / write msr registers from different processors. There is no option provided by the edk2module in python interpreter.

Proposal is to extend the edk2module with rdmsr_ex and wrmsr_ex functions which takes a cpu number as one of the inputs along with the current inputs taken by their respective functions. 

Internal using the MPServices protocol provided APIs we need to switch to the processor indicated by the rdmsr_ex and wrmsr_ex functions inputs and issue the read / write msr operations. Once the read/write operations on msr are done, we need to switch back the BSP to the saved BSP processor number.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22873</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-04 11:57:51 +0000</bug_when>
    <thetext>Vishal R will be working on this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22896</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-10 02:20:11 +0000</bug_when>
    <thetext>sent the email patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22973</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-24 23:18:40 +0000</bug_when>
    <thetext>Sent updated patch for review</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22998</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-05-03 03:39:13 +0000</bug_when>
    <thetext>commit b0dd67f86c19f4c09541ceed327324c578a2b6ab</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4598</bug_id>
          
          <creation_ts>2023-11-15 02:27:12 +0000</creation_ts>
          <short_desc>Got ASSERT BaseXApicX2ApicLib.c(1478): (Index != 0) || (LevelType == 0x01) when booting</short_desc>
          <delta_ts>2023-11-15 07:05:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Joey Lee">jlee</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>hongbin1.zhang</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22157</commentid>
    <comment_count>0</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-11-15 02:27:12 +0000</bug_when>
    <thetext>Got the following ASSERT when booting OVMF master branch with qemu-kvm-8.0.2 :

ASSERT /home/joeyli/source_code-git/edk2/UefiCpuPkg/Library/BaseXApicX2ApicLib/BaseXApicX2ApicLib.c(1478): (Index != 0) || (LevelType == 0x01)

After bisecting, found that the related patch is 1fadd18d0c0c65f in edk2-stable202308:

From 1fadd18d0c0c65ffde9e128a486414ba43b3387c Mon Sep 17 00:00:00 2001      
From: &quot;Zhang, Hongbin1&quot; &lt;Hongbin1.Zhang@intel.com&gt;
Date: Mon, 29 May 2023 14:39:38 +0800
Subject: [PATCH 177/271] UefiCpuPkg: Get processor extended information for
 SmmCpuServiceProtocol

Some features like RAS need to use processor extended information
under smm, So add code to support it

Signed-off-by: Hongbin1 Zhang &lt;hongbin1.zhang@intel.com&gt;
Cc: Eric Dong &lt;eric.dong@intel.com&gt;
Reviewed-by: Ray Ni &lt;ray.ni@intel.com&gt;
Cc: Rahul Kumar &lt;rahul1.kumar@intel.com&gt;
Acked-by: Gerd Hoffmann &lt;kraxel@redhat.com&gt;
Cc: Star Zeng &lt;star.zeng@intel.com&gt;
Reviewed-by: Jiaxin Wu &lt;jiaxin.wu@intel.com&gt;

After reverted this patch, edk2-stable202308 ovmf works fine on issue machine.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22158</commentid>
    <comment_count>1</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-11-15 02:31:20 +0000</bug_when>
    <thetext>I have checked the ASSERT code of in OVMF:

UefiCpuPkg/Library/BaseXApicX2ApicLib/BaseXApicX2ApicLib.c:GetProcessorLocation2ByApicId
    //
    // first level reported should be SMT.
    //
    ASSERT ((Index != 0) || (LevelType == CPUID_EXTENDED_TOPOLOGY_LEVEL_TYPE_SMT));
    if (LevelType == CPUID_EXTENDED_TOPOLOGY_LEVEL_TYPE_INVALID) {            
      break;
    }

Then I add debug log to print Index and LevelType on issue virtual machine. It shows:

GetProcessorLocation2ByApicId, Index: 0, LevelType: 0
ASSERT /home/joeyli/source_code-git/edk2/UefiCpuPkg/Library/BaseXApicX2ApicLib/BaseXApicX2ApicLib.c(1479): (Index != 0) || (LevelType == 0x01)

The LevelType returned by cpuid instruction (CPUID V2 Extended Topology Enumeration Leaf) is CPUID_EXTENDED_TOPOLOGY_LEVEL_TYPE_INVALID. But Index 0 (first level) should be with CPUID_EXTENDED_TOPOLOGY_LEVEL_TYPE_SMT. That&apos;s why the ASSERT be exposed.

On issue virtual machine, the MaxStandardCpuIdIndex is 31. It is &gt;= CPUID_V2_EXTENDED_TOPOLOGY. So the logic of &quot;CPUID V2 Extended Topology Enumeration Leaf&quot; be used. But the cpuid should NOT return CPUID_EXTENDED_TOPOLOGY_LEVEL_TYPE_INVALID level type for the first level.

The CPU type on host machine is:

# cat /proc/cpuinfo
...
processor       : 127
vendor_id       : GenuineIntel
cpu family      : 6
model           : 143
model name      : Intel(R) Xeon(R) Gold 6414TDX
stepping        : 6
microcode       : 0x90000c0
cpu MHz         : 994.864
cache size      : 61440 KB
physical id     : 1
siblings        : 64
core id         : 31 
cpu cores       : 32
apicid          : 191
initial apicid  : 191
fpu             : yes
fpu_exception   : yes
cpuid level     : 32
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf tsc_known_freq pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cat_l2 cdp_l3 invpcid_single intel_ppin cdp_l2 ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow vnmi flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect avx_vnni avx512_bf16 wbnoinvd dtherm ida arat pln pts hwp hwp_act_window hwp_epp hwp_pkg_req avx512vbmi umip pku ospke waitpkg avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg tme avx512_vpopcntdq la57 rdpid bus_lock_detect cldemote movdiri movdir64b enqcmd fsrm md_clear serialize tsxldtrk pconfig arch_lbr avx512_fp16 amx_tile flush_l1d arch_capabilities
vmx flags       : vnmi preemption_timer posted_intr invvpid ept_x_only ept_ad ept_1gb flexpriority apicv tsc_offset vtpr mtf vapic ept vpid unrestricted_guest vapic_reg vid ple shadow_vmcs pml ept_mode_based_exec tsc_scaling usr_wait_pause
bugs            : spectre_v1 spectre_v2 spec_store_bypass swapgs
bogomips        : 3395.58
clflush size    : 64
cache_alignment : 64
address sizes   : 47 bits physical, 57 bits virtual
power management:


Part of dmidecode:

Handle 0x0010, DMI type 0, 26 bytes
BIOS Information
        Vendor: Intel Corporation
        Version: SE5C7411.86B.8118.D04.2206151341
        Release Date: 06/15/2022
        Address: 0xF0000
        Runtime Size: 64 kB
        ROM Size: 16 MB
        Characteristics:
                PCI is supported
                PNP is supported
                BIOS is upgradeable
                BIOS shadowing is allowed
                Boot from CD is supported
                Selectable boot is supported
                EDD is supported
                5.25&quot;/1.2 MB floppy services are supported (int 13h)
                3.5&quot;/720 kB floppy services are supported (int 13h)
                3.5&quot;/2.88 MB floppy services are supported (int 13h)
                Print screen service is supported (int 5h)
                8042 keyboard services are supported (int 9h)
                Serial services are supported (int 14h)
                Printer services are supported (int 17h)
                CGA/mono video services are supported (int 10h)
                ACPI is supported
                USB legacy is supported
                LS-120 boot is supported
                ATAPI Zip drive boot is supported
                Function key-initiated network boot is supported
                Targeted content distribution is supported
                UEFI is supported

Handle 0x0011, DMI type 1, 27 bytes
System Information
        Manufacturer: Intel Corporation
        Product Name: D50DNP1SBB
        Version: ....................
        Serial Number: ............
        UUID: 00546322-9709-ed11-906e-a4bf01926a69
        Wake-up Type: Power Switch
        SKU Number: SKU Number
        Family: Family

Handle 0x0012, DMI type 2, 17 bytes
Base Board Information
        Manufacturer: Intel Corporation
        Product Name: D50DNP1SBB
        Version: M44241-404
        Serial Number: BQDP23000172
        Asset Tag: Base Board Asset Tag
        Features:
                Board is a hosting board
                Board is replaceable
        Location In Chassis: Part Component
        Chassis Handle: 0x0000
        Type: Motherboard
        Contained Object Handles: 0</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22159</commentid>
    <comment_count>2</comment_count>
    <who name="Joey Lee">jlee</who>
    <bug_when>2023-11-15 07:05:21 +0000</bug_when>
    <thetext>I have followed Gerd Hoffmann&apos;s suggestion and confirmed that Gerd&apos;s 170d4ce8e9 patch in edk2 mainline works to me on issue machine for fixing problem:

commit 170d4ce8e90abb1eff03852940a69c9d17f8afe5
Author: Gerd Hoffmann &lt;kraxel@redhat.com&gt;
Date:   Tue Oct 17 13:28:07 2023 +0200

    UefiCpuPkg/BaseXApicX2ApicLib: fix CPUID_V2_EXTENDED_TOPOLOGY detection

I have tested 2023-11-15 master branch and also backported the above patch to edk2-stable202308 ovmf. Both of them works to me.

Close this issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4290</bug_id>
          
          <creation_ts>2023-01-12 02:15:49 +0000</creation_ts>
          <short_desc>OvmfTpmSecurityStub.dsc.inc is wrongly controlled by SECURE_BOOT_ENABLE</short_desc>
          <delta_ts>2023-01-13 09:34:26 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="Gerd Hoffmann">kraxel</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>kraxel</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20628</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-01-12 02:15:49 +0000</bug_when>
    <thetext>OvmfTpmSecurityStub.dsc.inc includes the DxeTpmMeasureBootLib.inf and DxeTpm2MeasureBootLib.inf. These 2 libs are used to support TPM measure boot.

Measure boot and secure boot should be orthogonal. Hence OvmfTpmSecurityStub.dsc.inc should not be controlled by SECURE_BOOT_ENABLE. This error is found in:
 - OvmfPkgX64.dsc
 - CloudHvX64.dsc

@Gerd, Hoffmann
MicrovmX64.dsc has the same issue. Not sure is it by design?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20629</commentid>
    <comment_count>1</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-01-12 02:18:51 +0000</bug_when>
    <thetext>This is a regression which is caused by commit b47575801e.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20659</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-13 03:24:07 +0000</bug_when>
    <thetext>Please send patch to fix OvmfPkgX64.dsc and CloudHvX64.dsc at first.

And let @Gerd, Hoffmann confirm MicrovmX64.dsc</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20660</commentid>
    <comment_count>3</comment_count>
    <who name="Gerd Hoffmann">kraxel</who>
    <bug_when>2023-01-13 03:33:48 +0000</bug_when>
    <thetext>https://edk2.groups.io/g/devel/message/98374</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20667</commentid>
    <comment_count>4</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-13 09:33:41 +0000</bug_when>
    <thetext>merged https://github.com/tianocore/edk2/pull/3892</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20668</commentid>
    <comment_count>5</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-01-13 09:34:26 +0000</bug_when>
    <thetext>fixed</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4779</bug_id>
          
          <creation_ts>2024-05-24 05:18:33 +0000</creation_ts>
          <short_desc>Shell command &apos;pci&apos; for gen6 device show incorrect speed information</short_desc>
          <delta_ts>2024-06-18 01:48:37 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Horace Lien">horacex.lien</reporter>
          <assigned_to name="Horace Lien">horacex.lien</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23057</commentid>
    <comment_count>0</comment_count>
      <attachid>1513</attachid>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-05-24 05:18:33 +0000</bug_when>
    <thetext>Created attachment 1513
PCIe Gen6 Dummy dump log

Using shell command &apos;pci&apos; to dump PCIe Gen6 device detail information, the speed field shows &quot;Reserved&quot;.
We need to add new speed value to match Gen6 case.

Fields
&quot;Maximum Link Speed&quot;
&quot;Current Link Speed&quot;

I upload attachment log to dump dummy PCIe Gen6 device, please search &quot;Reserved&quot; on file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23067</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-29 20:55:24 +0000</bug_when>
    <thetext>horacex.lien@intel.com: can you provide the fix for this issue?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23078</commentid>
    <comment_count>2</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-05-29 21:26:14 +0000</bug_when>
    <thetext>Hi gaoliming,

https://github.com/tianocore/edk2/pull/5685
PR is already reviewed, waiting for push.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23128</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-06-18 01:44:28 +0000</bug_when>
    <thetext>horacex.lien@intel.com takes it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23131</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-06-18 01:48:37 +0000</bug_when>
    <thetext>It has been merged.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1513</attachid>
            <date>2024-05-24 05:18:33 +0000</date>
            <delta_ts>2024-05-24 05:18:33 +0000</delta_ts>
            <desc>PCIe Gen6 Dummy dump log</desc>
            <filename>PCIe Gen6 Dummy Dump.log</filename>
            <type>application/octet-stream</type>
            <size>27631</size>
            <attacher name="Horace Lien">horacex.lien</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4011</bug_id>
          
          <creation_ts>2022-08-02 15:01:44 +0000</creation_ts>
          <short_desc>MdeModulePkg: Need configurable AHCI command retries</short_desc>
          <delta_ts>2023-04-02 21:46:42 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Baranee">anbazhagan</reporter>
          <assigned_to name="Baranee">anbazhagan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>hao.a.wu</cc>
    
    <cc>mateusz.albecki</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19352</commentid>
    <comment_count>0</comment_count>
    <who name="Baranee">anbazhagan</who>
    <bug_when>2022-08-02 15:01:44 +0000</bug_when>
    <thetext>AHCI command failures are retried internally which prevents drive password module to process the correct drive password entered on 2nd attempt.

#define AHCI_COMMAND_RETRIES  5

One approach could be a dynamic PCD which allows dependent features to determine whether retry is required and default PCD value could be still set as 5 to retain existing behavior.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19373</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-09 21:43:22 +0000</bug_when>
    <thetext>Baranee: can the fixedatbuild or patchableinmodule pcd resolve this issue?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19374</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-09 21:44:01 +0000</bug_when>
    <thetext>Baranee: can the fixedatbuild or patchableinmodule pcd resolve this issue? This PCD is used in UEFI driver, but UEFI driver doesn&apos;t allow Dynamic PCD.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19387</commentid>
    <comment_count>3</comment_count>
    <who name="Baranee">anbazhagan</who>
    <bug_when>2022-08-10 17:24:02 +0000</bug_when>
    <thetext>(In reply to gaoliming from comment #2)
&gt; Baranee: can the fixedatbuild or patchableinmodule pcd resolve this issue?
&gt; This PCD is used in UEFI driver, but UEFI driver doesn&apos;t allow Dynamic PCD.

Fixedatbuild or patchableinmodule is sufficient for our needs.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19497</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-06 22:08:09 +0000</bug_when>
    <thetext>Baranee: can you provide the patch to inroduce PCD for the retry times?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19516</commentid>
    <comment_count>5</comment_count>
      <attachid>1021</attachid>
    <who name="Baranee">anbazhagan</who>
    <bug_when>2022-09-07 12:59:25 +0000</bug_when>
    <thetext>Created attachment 1021
Patch

Created draft PR - https://github.com/tianocore/edk2/pull/3314</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19532</commentid>
    <comment_count>6</comment_count>
    <who name="Baranee">anbazhagan</who>
    <bug_when>2022-09-08 00:25:12 +0000</bug_when>
    <thetext>v2 draft PR - https://github.com/tianocore/edk2/pull/3320</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19557</commentid>
    <comment_count>7</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-12 22:54:50 +0000</bug_when>
    <thetext>V1 patch sent at: https://edk2.groups.io/g/devel/message/93452
V2 patch sent at: https://edk2.groups.io/g/devel/message/93479</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19558</commentid>
    <comment_count>8</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-09-12 22:55:19 +0000</bug_when>
    <thetext>Resolved via:
PR - https://github.com/tianocore/edk2/pull/3327
Commit - https://github.com/tianocore/edk2/commit/db7afaee91423e988df3160624d04c3c534f294d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19788</commentid>
    <comment_count>9</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-10-18 22:11:14 +0000</bug_when>
    <thetext>Hello Baranee,

Could you help to check if below change (patch link provided below) can resolve this issue when switching back to: &quot;#define AHCI_COMMAND_RETRIES  5&quot;?

Change can be accessed for integration at: https://github.com/tianocore/edk2/commit/f2eb27e00ed55cca03964f13a2839e41e2c1f61f.patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19798</commentid>
    <comment_count>10</comment_count>
    <who name="Baranee">anbazhagan</who>
    <bug_when>2022-10-20 18:06:01 +0000</bug_when>
    <thetext>(In reply to Hao Wu from comment #9)
&gt; Hello Baranee,
&gt; 
&gt; Could you help to check if below change (patch link provided below) can
&gt; resolve this issue when switching back to: &quot;#define AHCI_COMMAND_RETRIES  5&quot;?
&gt; 
&gt; Change can be accessed for integration at:
&gt; https://github.com/tianocore/edk2/commit/
&gt; f2eb27e00ed55cca03964f13a2839e41e2c1f61f.patch

Patch didn’t resolve this bug since AhciRecoverPortError return success on incorrect drive password and continues with additional retries before returning to caller.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19799</commentid>
    <comment_count>11</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2022-10-20 22:27:23 +0000</bug_when>
    <thetext>(In reply to Baranee from comment #10)
&gt; (In reply to Hao Wu from comment #9)
&gt; &gt; Hello Baranee,
&gt; &gt; 
&gt; &gt; Could you help to check if below change (patch link provided below) can
&gt; &gt; resolve this issue when switching back to: &quot;#define AHCI_COMMAND_RETRIES  5&quot;?
&gt; &gt; 
&gt; &gt; Change can be accessed for integration at:
&gt; &gt; https://github.com/tianocore/edk2/commit/
&gt; &gt; f2eb27e00ed55cca03964f13a2839e41e2c1f61f.patch
&gt; 
&gt; Patch didn’t resolve this bug since AhciRecoverPortError return success on
&gt; incorrect drive password and continues with additional retries before
&gt; returning to caller.

Got it, thanks a lot for the testing.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20406</commentid>
    <comment_count>12</comment_count>
    <who name="Mateusz Albecki">mateusz.albecki</who>
    <bug_when>2023-01-03 06:29:26 +0000</bug_when>
    <thetext>I&apos;ve investigated the issue and I think I can make the retry logic work without affecting the security options. Full proposition here: https://edk2.groups.io/g/devel/message/97840</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21301</commentid>
    <comment_count>13</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2023-04-02 21:46:42 +0000</bug_when>
    <thetext>Additional fix for the recovery logic which causes hdd unlock to fail if user supplies incorrect password is merged via:
PR - https://github.com/tianocore/edk2/pull/4207
Commit - https://github.com/tianocore/edk2/commit/eb6a74827200eedc81b8f45f332d6e9f3b3d2906

V1 of the patch sent at: https://edk2.groups.io/g/devel/message/101501
V2 of the patch sent at: https://edk2.groups.io/g/devel/message/101980</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1021</attachid>
            <date>2022-09-07 12:59:25 +0000</date>
            <delta_ts>2022-09-07 12:59:25 +0000</delta_ts>
            <desc>Patch</desc>
            <filename>0001-MdeModulePkg-Use-configurable-PCD-for-AHCI-command-r.patch</filename>
            <type>application/octet-stream</type>
            <size>4152</size>
            <attacher name="Baranee">anbazhagan</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4621</bug_id>
          
          <creation_ts>2023-12-12 02:20:49 +0000</creation_ts>
          <short_desc>Support 0x0D type for FSP Boot Manifest entry in FitGen tool</short_desc>
          <delta_ts>2024-03-11 01:33:58 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>IntelSiliconPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>fan.wang</reporter>
          <assigned_to>fan.wang</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>liqi.liu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22261</commentid>
    <comment_count>0</comment_count>
    <who name="">fan.wang</who>
    <bug_when>2023-12-12 02:20:49 +0000</bug_when>
    <thetext>There is an existing RCR for FIT spec change to define 0x0D type for FSP Boot Manifest entry (section is listed as below):

&quot;Background/Rationale 

FSP binaries for client SOCs will be signed to provide integrity protection and ability to deploy critical fixes on the field, via FSP capsules. As part of the Signed FSP boot flow, FSP components will be hashed and stored in a new manifest – FSP Boot Manifest (FBM). The FBM will be signed by Intel and released along with FSP binary to customers, who can then store it in a location of their choice...

At boot time, Intel RoT (e.g. BootGuard) needs to know the location of FBM, in order to verify the manifest and then perform hash verification of FSP components.  

This request is for a new entry in FIT table – FSP Boot Manifest (Type 0xD) to store the location of FBM.&quot;

In current FitGen tool implementation, 0x0D is defined as &quot;FIT_TABLE_TYPE_BIOS_DATA_AREA&quot; and no evidence existing platforms are using this field, it needs be updated to align with this new RCR.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22312</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-02 21:53:27 +0000</bug_when>
    <thetext>fan.wang@intel.com: please provide the spec link for new type.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22628</commentid>
    <comment_count>2</comment_count>
    <who name="">liqi.liu</who>
    <bug_when>2024-02-19 02:02:01 +0000</bug_when>
    <thetext>Firmware Interface Table - BIOS Specification 1.5 is published.
File Download URL: https://cdrdv2.intel.com/v1/dl/getContent/599500
HTML URL: https://cdrdv2.intel.com/v1/dl/getContent/599500/view</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22770</commentid>
    <comment_count>3</comment_count>
    <who name="">liqi.liu</who>
    <bug_when>2024-03-11 01:33:58 +0000</bug_when>
    <thetext>patch link: https://github.com/tianocore/edk2-platforms/pull/111/commits</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4478</bug_id>
          
          <creation_ts>2023-06-07 05:47:07 +0000</creation_ts>
          <short_desc>Add RISC-V support to CLANGDWARF toolchain</short_desc>
          <delta_ts>2023-08-16 01:07:54 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ard Biesheuvel">ardb</reporter>
          <assigned_to name="Sunil V L">sunilvl</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>rebecca</cc>
    
    <cc>sunilvl</cc>
    
    <cc>xypron.glpk</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21635</commentid>
    <comment_count>0</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-06-07 05:47:07 +0000</bug_when>
    <thetext>The CLANGDWARF toolchain currently supports building for IA32, X64, ARM and AARCH64. 

Due to the fact that it uses both Clang and the LLVM linker LLD, CLANGDWARF can be used on any host architecture to build all of these target architectures without the need to install cross compilers or linkers. This means the threshold for doing cross-architecture test builds and even test runs is lower for contributors than when using GCC based toolchain configurations.

Given that Clang and LLD already implement support for RISC-V target, let&apos;s add it to the CLANGDWARF toolchain configuration as well.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21636</commentid>
    <comment_count>1</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2023-06-07 06:39:11 +0000</bug_when>
    <thetext>Thanks Ard.

I have started working on this. LLD seems to have some issue for RISC-V and recommendation from our compiler team is to delay its support for some time due to some known issues in RISC-V. So, I am thinking to enable CLANGDWARF without lld first. Do you see any issue?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21637</commentid>
    <comment_count>2</comment_count>
    <who name="Ard Biesheuvel">ardb</who>
    <bug_when>2023-06-07 06:44:54 +0000</bug_when>
    <thetext>(In reply to Sunil V L from comment #1)
&gt; Thanks Ard.
&gt; 
&gt; I have started working on this. LLD seems to have some issue for RISC-V and
&gt; recommendation from our compiler team is to delay its support for some time
&gt; due to some known issues in RISC-V. So, I am thinking to enable CLANGDWARF
&gt; without lld first. Do you see any issue?

In that case, you&apos;d still need a cross linker, and the associated plumbing to choose the correct executable based on target triplets stored in environment variables.

Once you add support with GNU ld, switching over to LLD later may break someone&apos;s downstream build, which I think we might prefer to avoid.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21638</commentid>
    <comment_count>3</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2023-06-07 06:48:34 +0000</bug_when>
    <thetext>(In reply to ardb from comment #2)
&gt; (In reply to Sunil V L from comment #1)
&gt; &gt; Thanks Ard.
&gt; &gt; 
&gt; &gt; I have started working on this. LLD seems to have some issue for RISC-V and
&gt; &gt; recommendation from our compiler team is to delay its support for some time
&gt; &gt; due to some known issues in RISC-V. So, I am thinking to enable CLANGDWARF
&gt; &gt; without lld first. Do you see any issue?
&gt; 
&gt; In that case, you&apos;d still need a cross linker, and the associated plumbing
&gt; to choose the correct executable based on target triplets stored in
&gt; environment variables.
&gt; 
&gt; Once you add support with GNU ld, switching over to LLD later may break
&gt; someone&apos;s downstream build, which I think we might prefer to avoid.

Ahh OK. That&apos;s a good input. Thanks!. In that case, let me enable along with lld support itself.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21734</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:24:39 +0000</bug_when>
    <thetext>sunilvl@ventanamicro.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21797</commentid>
    <comment_count>5</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2023-08-02 05:11:25 +0000</bug_when>
    <thetext>Ard has merged the patch series which add this support (PR #4701). Thanks!, Ard.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21820</commentid>
    <comment_count>6</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:07:54 +0000</bug_when>
    <thetext>this is a new feature.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4335</bug_id>
          
          <creation_ts>2023-02-01 23:47:52 +0000</creation_ts>
          <short_desc>Td guest shall halt when CcMeasurement failed to be installed</short_desc>
          <delta_ts>2023-02-04 07:57:10 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SecurityPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20985</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-02-01 23:47:52 +0000</bug_when>
    <thetext>CcMeasurement protocol is installed when it is supported in a td-guest. If the installation of the protocol failed, the guest shall go into CpuDeadLoop. Because the measurement feature is crucial to a td-guest and it shall stop running immediately when it is failed to be installed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20994</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2023-02-04 07:57:10 +0000</bug_when>
    <thetext>merged https://github.com/tianocore/edk2/pull/3999</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4159</bug_id>
          
          <creation_ts>2022-11-18 02:23:04 +0000</creation_ts>
          <short_desc>Use CcExitLib instead of VmgExitLib</short_desc>
          <delta_ts>2022-11-29 21:54:43 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20058</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-11-18 02:23:04 +0000</bug_when>
    <thetext>In EDK2 master VmgExitLib is renamed as VmgExitLib. See https://bugzilla.tianocore.org/show_bug.cgi?id=4123.

This patch-set has been merged.
0cb30c3f5e 2022-10-28 Maintainers: Update the VmgExitLib to CcExitLib
765ba5bf05 2022-11-07 OvmfPkg/UefiCpuPkg: Add CcExit prefix to the APIs of CcExitLib
a89f558d3c 2022-11-07 OvmfPkg/UefiCpuPkg/UefiPayloadPkg: Rename VmgExitLib to CcExitLib

The related changes should be applied in edk2-platforms as well.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20137</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-29 21:54:43 +0000</bug_when>
    <thetext>The fix has been merged into edk2-platforms.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4810</bug_id>
          
          <creation_ts>2024-07-12 10:57:28 +0000</creation_ts>
          <short_desc>edk2-libc: add BKM document to build Python UEFI using the MSFT Visual studio tool chains on Windows</short_desc>
          <delta_ts>2024-09-03 10:26:07 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Documentation</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          <cf_documents>Other Document</cf_documents>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23221</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-12 10:57:28 +0000</bug_when>
    <thetext>There is a BKM document which provides detailed step by step instructions to build Python UEFI interpreter using GCC tool chain from Ubuntu Linux OS. But there is no complete BKM document providing the similar details to build on Windows using VS2019 tool chain. 

Please consider adding a .md or .rst formatted version of the BKM document for the same.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23222</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-12 10:58:27 +0000</bug_when>
    <thetext>Jayaprakash Nevara will be working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23332</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-08-20 11:38:56 +0000</bug_when>
    <thetext>Created the BKM document as .md file and sending a patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23333</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-08-20 11:59:01 +0000</bug_when>
    <thetext>Sent email patch for review</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23357</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-09-03 10:26:07 +0000</bug_when>
    <thetext>The BKM document has been added as wiki page and hence the patch sent to review and merge with the edk2-libc master repo is no more needed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4034</bug_id>
          
          <creation_ts>2022-08-26 03:13:43 +0000</creation_ts>
          <short_desc>MdePkg/SmmCpuRendezvousLibNull: Remove restriction that SmmCpuRendezvousLibNull only support MM_STANDALONE and DXE_SMM_DRIVER.</short_desc>
          <delta_ts>2022-12-02 03:30:07 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="zhihao">zhihao.li</reporter>
          <assigned_to name="zhihao">zhihao.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19440</commentid>
    <comment_count>0</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-08-26 03:13:43 +0000</bug_when>
    <thetext>In the implementation of SmmCpuRendezvousLib null version, there is a restriction in [LIBRARY_CLASS] section.So removing the restriction that other type driver can use SmmCpuRendezvousLib null version implemented.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19491</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-06 21:52:25 +0000</bug_when>
    <thetext>Zhihao: please take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20174</commentid>
    <comment_count>2</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2022-12-02 03:30:07 +0000</bug_when>
    <thetext>Invalid.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4657</bug_id>
          
          <creation_ts>2024-01-25 04:22:22 +0000</creation_ts>
          <short_desc>edk2 - Basetools invalid escape sequence warning from Trim.py during edk2 builds</short_desc>
          <delta_ts>2024-02-02 04:14:57 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22422</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-01-25 04:22:22 +0000</bug_when>
    <thetext>Getting the below warning messages when trying to build Hello.inf application from edk2-libc on top of the edk2 source tree.

These warnings are coming from the Trim.py in BaseTools

/AppPkg/RELEASE_GCC5/X64/MdePkg/Library/BaseLib/BaseLib/OUTPUT/inc.lst /home/jp/src/edk2/MdePkg/Library/BaseLib/X64/Lfence.nasm
/home/jp/src/edk2/BaseTools/BinWrappers/PosixLike/../../Source/Python/Trim/Trim.py:31: SyntaxWarning: invalid escape sequence &apos;\s&apos;
  gLineControlDirective = re.compile(&apos;^\s*#(?:line)?\s+([0-9]+)\s+&quot;*([^&quot;]*)&quot;&apos;)
/home/jp/src/edk2/BaseTools/BinWrappers/PosixLike/../../Source/Python/Trim/Trim.py:33: SyntaxWarning: invalid escape sequence &apos;\s&apos;
  gTypedefPattern = re.compile(&quot;^\s*typedef\s+struct(\s+\w+)?\s*[{]*$&quot;, re.MULTILINE)
/home/jp/src/edk2/BaseTools/BinWrappers/PosixLike/../../Source/Python/Trim/Trim.py:35: SyntaxWarning: invalid escape sequence &apos;\s&apos;
  gPragmaPattern = re.compile(&quot;^\s*#pragma\s+pack&quot;, re.MULTILINE)
/home/jp/src/edk2/BaseTools/BinWrappers/PosixLike/../../Source/Python/Trim/Trim.py:37: SyntaxWarning: invalid escape sequence &apos;\s&apos;
  gTypedef_SinglePattern = re.compile(&quot;^\s*typedef&quot;, re.MULTILINE)
/home/jp/src/edk2/BaseTools/BinWrappers/PosixLike/../../Source/Python/Trim/Trim.py:39: SyntaxWarning: invalid escape sequence &apos;\s&apos;
  gTypedef_MulPattern = re.compile(&quot;^\s*(typedef)?\s+(struct|union)(\s+\w+)?\s*[{]*$&quot;, re.MULTILINE)
/home/jp/src/edk2/BaseTools/BinWrappers/PosixLike/../../Source/Python/Trim/Trim.py:54: SyntaxWarning: invalid escape sequence &apos;\s&apos;
  gAslIncludePattern = re.compile(&quot;^(\s*)[iI]nclude\s*\(\&quot;?([^\&quot;\(\)]+)\&quot;\)&quot;, re.MULTILINE)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22423</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-01-25 04:28:33 +0000</bug_when>
    <thetext>Analyzed the warning messages and found that the issue is because the regular expression patters are not provided as raw strings by prefixing the strings with r / R.

For example:
/home/jp/src/edk2/BaseTools/BinWrappers/PosixLike/../../Source/Python/Trim/Trim.py:31: SyntaxWarning: invalid escape sequence &apos;\s&apos;
  gLineControlDirective = re.compile(&apos;^\s*#(?:line)?\s+([0-9]+)\s+&quot;*([^&quot;]*)&quot;&apos;)

In the above regular expression patter it could have been prefixed with r/R so that the pattern string will be interpreted by the &quot;re&quot; engine rather than by the Python interpreter. 

Since the raw string prefix is not there, python interpreter tries to interpret the string and throws this warning as it is not a valid string according to python string definitions as \s is not a valid escape sequence. 

The fix for these warnings is to enclose all the regular expression patters with in r / R

We can rewrite the above statement to eliminate the warning as below:

gLineControlDirective = re.compile(r&apos;^\s*#(?:line)?\s+([0-9]+)\s+&quot;*([^&quot;]*)&quot;&apos;)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22505</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-02-02 04:14:57 +0000</bug_when>
    <thetext>This issue has been fixed through the PR 
https://github.com/tianocore/edk2/pull/5238</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4508</bug_id>
          
          <creation_ts>2023-07-24 02:24:43 +0000</creation_ts>
          <short_desc>MinPlatformPkg: Remove IA32 in PeiFspWrapperPlatformLib</short_desc>
          <delta_ts>2023-07-26 22:42:39 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dora Hsueh">dorax.hsueh</reporter>
          <assigned_to name="Dora Hsueh">dorax.hsueh</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21764</commentid>
    <comment_count>0</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2023-07-24 02:24:43 +0000</bug_when>
    <thetext>Remove IA32 only dependency, Because we need to support both IA32 and X64.
Apply to a modern platform supporting x64.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21773</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-25 05:40:18 +0000</bug_when>
    <thetext>dorax.hsueh@intel.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21777</commentid>
    <comment_count>2</comment_count>
    <who name="Dora Hsueh">dorax.hsueh</who>
    <bug_when>2023-07-26 22:42:39 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2-platforms/pull/91 
PR merged on WW30.4</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4366</bug_id>
          
          <creation_ts>2023-03-11 14:23:22 +0000</creation_ts>
          <short_desc>Display of Loaded Image Protocol in ShellPkg uses incorrect format string data types in UNI files</short_desc>
          <delta_ts>2023-03-13 21:59:40 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>ray.ni</cc>
    
    <cc>zhichao.gao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21171</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-03-11 14:23:22 +0000</bug_when>
    <thetext>The Loaded Image Protocol contains pointer fields.
Some of the format string specifiers used to display the 
Loaded Image Protocol use %x which truncates the upper
32-bit of a 64-bit pointer when the shell is running in
a 64-bit environment.  %p should be used instead to display
the full value for 32-bit or 64-bit environments.

#string STR_LI_DUMP_MAIN          #language en-US &quot;  Revision......: %%H0x%08x%%N\r\n&quot;
                                                  &quot;  ParentHandle..: %%H%x%%N\r\n&quot;
                                                  &quot;  SystemTable...: %%H%x%%N\r\n&quot;
                                                  &quot;  DeviceHandle..: %%H%x%%N\r\n&quot;
                                                  &quot;  FilePath......: %%H%s%%N\r\n&quot;
                                                  &quot;  PdbFileName...: %%H%a%%N\r\n&quot;
                                                  &quot;  OptionsSize...: %%H%x%%N\r\n&quot;
                                                  &quot;  LoadOptions...: %%H%x%%N\r\n&quot;
                                                  &quot;  ImageBase.....: %%H%x%%N\r\n&quot;
                                                  &quot;  ImageSize.....: %%H%Lx%%N\r\n&quot;
                                                  &quot;  CodeType......: %%H%s%%N\r\n&quot;
                                                  &quot;  DataType......: %%H%s%%N\r\n&quot;
                                                  &quot;  Unload........: %%H%x%%N&quot;

Should be:

#string STR_LI_DUMP_MAIN          #language en-US &quot;  Revision......: %%H0x%08x%%N\r\n&quot;
                                                  &quot;  ParentHandle..: %%H%p%%N\r\n&quot;
                                                  &quot;  SystemTable...: %%H%p%%N\r\n&quot;
                                                  &quot;  DeviceHandle..: %%H%p%%N\r\n&quot;
                                                  &quot;  FilePath......: %%H%p%%N\r\n&quot;
                                                  &quot;  PdbFileName...: %%H%a%%N\r\n&quot;
                                                  &quot;  OptionsSize...: %%H%x%%N\r\n&quot;
                                                  &quot;  LoadOptions...: %%H%p%%N\r\n&quot;
                                                  &quot;  ImageBase.....: %%H%p%%N\r\n&quot;
                                                  &quot;  ImageSize.....: %%H%Lx%%N\r\n&quot;
                                                  &quot;  CodeType......: %%H%s%%N\r\n&quot;
                                                  &quot;  DataType......: %%H%s%%N\r\n&quot;
                                                  &quot;  Unload........: %%H%p%%N&quot;

The are other UNI strings and Shell C files that have similar issues using %x instead of %p.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21172</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-03-11 14:28:28 +0000</bug_when>
    <thetext>This issue can be easily reproduced using the EmulatorPkg for X64
because many of the memory allocations are above 4GB.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21173</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-03-11 14:29:20 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21174</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-03-11 14:40:34 +0000</bug_when>
    <thetext>This type issue is very difficult to review and resolve
because the format strings are in UNI file and the code
that passes in the parameters are in a C file.  These
2 files can easily get out of sync for their agreement
on the data types.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21183</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2023-03-13 21:59:40 +0000</bug_when>
    <thetext>EDK II patch email: https://edk2.groups.io/g/devel/message/101046

PR: https://github.com/tianocore/edk2/pull/4136

Commit: https://github.com/tianocore/edk2/commit/e4c1d8d2317984bd9cb447eba916956841063ec4</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4184</bug_id>
          
          <creation_ts>2022-12-06 00:57:01 +0000</creation_ts>
          <short_desc>Incorrect protocol and structure version in the TDX CC measurement driver</short_desc>
          <delta_ts>2022-12-17 21:08:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter>ARGU</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20188</commentid>
    <comment_count>0</comment_count>
    <who name="">ARGU</who>
    <bug_when>2022-12-06 00:57:01 +0000</bug_when>
    <thetext>The current code in TdTcgDxe.c does the following:
  mTdxDxeData.BsCap.ProtocolVersion.Major  = 1;
  mTdxDxeData.BsCap.ProtocolVersion.Minor  = 1;
  mTdxDxeData.BsCap.StructureVersion.Major = 1;
  mTdxDxeData.BsCap.StructureVersion.Minor = 1;

This is not consistent with the TDX GHCI spec:


//
// Version of the EFI_CC_BOOT_SERVICE_CAPABILITY structure.
// For this version of the protocol,
// the Major version shall be set to 1
// and the Minor version shall be set to 0.
//
EFI_CC_VERSION StructureVersion;
//
// Version of the EFI CC MEASUREMENT protocol.
// For this version of the protocol,
// the Major version shall be set to 1
// and the Minor version shall be set to 0.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20190</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-12-06 01:47:21 +0000</bug_when>
    <thetext>It should be fixed together with https://bugzilla.tianocore.org/show_bug.cgi?id=4179</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20220</commentid>
    <comment_count>2</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-12-17 21:08:03 +0000</bug_when>
    <thetext>Fixed in https://github.com/tianocore/edk2/pull/3773</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4831</bug_id>
          
          <creation_ts>2024-08-15 00:55:20 +0000</creation_ts>
          <short_desc>MdeModulePkg/Library/DxeCapsuleLibFmp: Module Variable of ESRT Table Might be Failed to Initialize due to Order of Event</short_desc>
          <delta_ts>2024-09-22 23:51:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jason Lin">jason1.lin</reporter>
          <assigned_to name="Jason Lin">jason1.lin</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23323</commentid>
    <comment_count>0</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-08-15 00:55:20 +0000</bug_when>
    <thetext>Module variable &quot;mEsrtTable&quot; migth be failed to initialize due to the order of event callback.

It would be depend on how the modules got dispatched (the order of event got registered) and how the event got triggered (In same priority, now in DXE it is FILO).


In current implementation, ESRT table would be exposed by other modules.
There have the change that ESRT table got exposed after the module variable initialized.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23325</commentid>
    <comment_count>1</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-08-15 09:19:11 +0000</bug_when>
    <thetext>Below is one of the failure scenarios,

IF the modules got dispatched as below order,
  - MdeModulePkg/Universal/EsrtFmpDxe
  - MdeModulePkg/Universal/CapsuleRuntimeDxe/CapsuleRuntimeDxe

[1] EsrtFmpDxe module

- There would register the ReadyToBoot event &quot;EsrtReadyToBootEventNotify ()&quot; in CALLBACK level.
- This callback function would install the ESRT table based on the system exposed FMP protocol.

[2] CapsuleRuntimeDxe module

- It would link to the &quot;CapsuleLib&quot; as runtime service.
- In this library, it would register the ReadyToBoot event &quot;DxeCapsuleLibReadyToBootEventNotify ()&quot;
  in CALLBACK level on the constructor of &quot;DxeRuntimeCapsuleLibConstructor&quot;


The order of event in same priority would be First-In-Last-Out (FILO).
Hence, the ESRT table might be installed after the module variable &quot;mEsrtTable&quot; had been initialized.
It would have a hidden assumption that the order of callback is well-performed.

PR: https://github.com/tianocore/edk2/pull/6076 had been raised to address this assumption.
The module variable would be initialized once the ESRT table got installed and updated the module variable in-time.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23404</commentid>
    <comment_count>2</comment_count>
    <who name="Jason Lin">jason1.lin</who>
    <bug_when>2024-09-22 23:51:45 +0000</bug_when>
    <thetext>GitHub PR: https://github.com/tianocore/edk2/pull/6076

Change had been merged into EDK-II codebase as below SHA-1 ID.
  - 03c8ec6ce29e47abca2b598bba9a05ddd87afc17
  - dadd8c7a95bab7e17aaa0d5bbd6c40eaf461d434

Introduced below changes,
[1] Add the event of system resource table installed callback.
      - Register the event in DxeRuntimeCapsuleLibConstructor ()
      - Unregister the event in DxeRuntimeCapsuleLibDestructor ()

[2] Migrate the event to update the module variable to cache ESRT table
    from ReadyToBoot to system resource table installed.

[3] Add the condition to free the pool of buffer when the &quot;mEsrtTable&quot;
    is not NULL.

[4] In this patch introduced the ExitBootService event to replace it.
    It would be better to base on the BootService status to decide
    the source of ESRT table.

[5] Based on the BootService availability to decide,
      - Exit    : Use cache ESRT table in IF-condition
      - Not Exit: Use boot service to locate protocol in ELSE-condition

Mark this Bugzilla ticket as completed and close it.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4061</bug_id>
          
          <creation_ts>2022-09-15 01:26:18 +0000</creation_ts>
          <short_desc>RISC-V build fails with GCC12</short_desc>
          <delta_ts>2023-02-24 23:13:01 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sunil V L">sunilvl</reporter>
          <assigned_to name="Sunil V L">sunilvl</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19566</commentid>
    <comment_count>0</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-15 01:26:18 +0000</bug_when>
    <thetext>RISC-V build fails with GCC12 with below error message.

RiscV64/FlushCache.iiii:16: Error: unrecognized opcode `fence.i&apos;

This blocks people to move to latest GCC12.

This issue is reported in https://github.com/tianocore/containers/pull/5 also.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19567</commentid>
    <comment_count>1</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-09-15 01:30:58 +0000</bug_when>
    <thetext>From version 2.38, binutils default to ISA spec version 20191213. This
means that the csr read/write (csrr*/csrw*) instructions and fence.i
instruction has separated from the `I` extension, become two standalone
extensions: Zicsr and Zifencei.

The fix needs -march to include zicsr_zifencei but older toolchain will not support it. So, we need to determine it dynamically.

This issue is already fixed in linux as part of the patch https://lore.kernel.org/linux-riscv/20220126171442.1338740-1-aurelien@aurel32.net/

In EDK2, we need to somehow update the -march string in tools_def.txt while copying from tools_def.template.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19778</commentid>
    <comment_count>2</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2022-10-18 01:22:10 +0000</bug_when>
    <thetext>The fix needs updating of tools_def.txt dynamically based on the binutils capability. However, it is new to EDK@ build infrastructure to update tools_def.txt after it is updated from tools_def.template.

Though I submitted a patch to automate the update of tools_def.txt (https://edk2.groups.io/g/devel/message/93831), this patch is not accepted because it can cause issues in CI. So, there is no clean solution for this.

It is also not suggested to create a new GCC12 profile just for this difference and other architectures don&apos;t have an issue with GCC12.

So, the recommendation is to support only one version of toolchain for RISC-V. Currently, it is &lt; binutils.2.38. Once the EDK2 build infrastructure move to later tool chains for other cpu architectures, we will update march string statically and support only toolchain which are &gt; 2.38.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19837</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-25 21:52:53 +0000</bug_when>
    <thetext>Sunni is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21118</commentid>
    <comment_count>4</comment_count>
    <who name="Sunil V L">sunilvl</who>
    <bug_when>2023-02-24 23:13:01 +0000</bug_when>
    <thetext>This is fixed as part of 

https://github.com/tianocore/edk2/commit/2c5961cccff1164ac7d0e34baa606d1ba1abcf43</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4680</bug_id>
          
          <creation_ts>2024-02-13 10:58:38 +0000</creation_ts>
          <short_desc>BaseTools/Scripts/PatchCheck: Validate author email</short_desc>
          <delta_ts>2024-03-08 15:20:25 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>michael.d.kinney</cc>
    
    <cc>quic_llindhol</cc>
    
    <cc>rebecca</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22563</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2024-02-13 10:58:38 +0000</bug_when>
    <thetext>Some patches have been merged to edk2 master where the author name is &quot;devel@edk2.groups.io&quot;.

This issue tracks an update to PatchCheck to fail upon that condition.

---

Existing commits can be discovered by running &apos;git log --author=&quot;devel@edk2.groups.io&quot;&apos;. Example output:

6510dcf6f71a NetworkPkg/HttpDxe: fix driver binding start issue.
4416bf338348 NetworkPkg: Correct the length of EAP Identity when in ASCII format
55b67b6950e6 MdeModulePkg/RegularExpressionDxe: Fix GCC build error
090642db7ac1 MdeModulePkg/EsrtFmpDxe: Support multiple devices with 0 HardwareInstance
7afef31b2b17 MdeModulePkg: remove garbage pixels in LaffStd glyphs
44fc90eb0ea7 UnitTestFrameworkPkg/UnitTestLib: Print expected Status on ASSERT fail
6c8dd15c4ae4 SecurityPkg: Add RPMC Index to the RpmcLib
64a228f5f893 MdeModulePkg: Use CopyMem instead of GUID assignment
4b026f0d5af3 SecurityPkg: Fix incorrect return value when File is NULL
fb92fe9e1817 MdeModulePkg/Core/Dxe: free page 0 after disabling NULL pointer detection
f9d0e5daa058 MdeModulePkg/DxeIplPeim: reserve page 0 for NULL pointer detection
034a3b4f555c MdeModulePkg/Setup: Check ConfigAccess protocol in case it&apos;s destroyed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22569</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 14:06:18 +0000</bug_when>
    <thetext>There are actually 2 patters related to the Author being incorrect.

One is the following pattern where name/email is the mailing list

  Author: devel@edk2.groups.io &lt;devel@edk2.groups.io&gt;

The second related pattern is where the name is valid, but the 
email address is from groups.io instead of a developers real
email address.  A few examples:

  Author: Doug Flick via groups.io &lt;dougflick=microsoft.com@groups.io&gt;
  Author: Jeff Brasen via groups.io &lt;jbrasen=nvidia.com@groups.io&gt;
  Author: Joey Vagedes via groups.io &lt;joeyvagedes=microsoft.com@groups.io&gt;
  Author: Jake Garver via groups.io &lt;jake=nvidia.com@groups.io&gt;
  Author: Roth, Michael via groups.io &lt;Michael.Roth=amd.com@groups.io&gt;
  Author: Mikolaj Lisik via groups.io &lt;lisik=google.com@groups.io&gt;

The common pattern here is a Author email address that end in &quot;groups.io&quot;

The more specific patterns are:
* Name contains &quot; via groups.io&quot; and email ends with &quot;@groups.io&quot;
* Name is &quot;devel@edk2.groups.io&quot; and email address is &quot;devel@edk2.groups.io&quot;

PatchCheck already has the following check:

        if &apos; via Groups.Io&apos; in name and mo.group(3).endswith(&apos;@groups.io&apos;):
            self.error(&quot;Email rewritten by lists DMARC / DKIM / SPF: &quot; +
                       email)

This check misses &quot; via groups.io&quot; because it is doing a case sensitive 
test of the name.  If this condition is updated to do a case insensitive
check for the string &quot; via groups.io&quot;, then that pattern would be caught.

Catching the devel@edk2.groups.io could be simplified to reject any
email address that ends in &quot;groups.io&quot;, but that may reject submissions
from a valid email address that matches that pattern.

Check for exactly &quot;devel@edk2.groups.io&quot; addresses the currently observed
invalid patches.

This topic can be revisited if additional patterns are observed that need
to be rejected.

Proposed change:
* Change name check for &quot; via Groups.Io&quot; to a case insensitive match
* Add email check for exactly &quot;devel@edk2.groups.io&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22570</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 14:11:54 +0000</bug_when>
    <thetext>Running this proposed change on the most recent 200 commits produces the expected results and finds only the Author email addresses that should
have been rejected by EDK II CI.

BaseTools\Scripts\PatchCheck.py HEAD~200..master | qgrep DMARC

 * Email rewritten by lists DMARC / DKIM / SPF: &quot;devel@edk2.groups.io&quot; &lt;devel@edk2.groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Doug Flick via groups.io&quot; &lt;dougflick=microsoft.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Doug Flick via groups.io&quot; &lt;dougflick=microsoft.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Doug Flick via groups.io&quot; &lt;dougflick=microsoft.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Doug Flick via groups.io&quot; &lt;dougflick=microsoft.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Doug Flick via groups.io&quot; &lt;dougflick=microsoft.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Doug Flick via groups.io&quot; &lt;dougflick=microsoft.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Doug Flick via groups.io&quot; &lt;dougflick=microsoft.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;devel@edk2.groups.io&quot; &lt;devel@edk2.groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;devel@edk2.groups.io&quot; &lt;devel@edk2.groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Jeff Brasen via groups.io&quot; &lt;jbrasen=nvidia.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Jeff Brasen via groups.io&quot; &lt;jbrasen=nvidia.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Jeff Brasen via groups.io&quot; &lt;jbrasen=nvidia.com@groups.io&gt;
 * Email rewritten by lists DMARC / DKIM / SPF: &quot;Joey Vagedes via groups.io&quot; &lt;joeyvagedes=microsoft.com@groups.io&gt;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22571</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-13 14:18:48 +0000</bug_when>
    <thetext>Patch email for review:

https://edk2.groups.io/g/devel/message/115404</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22622</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-02-18 16:03:38 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/5383

Patch Review: https://edk2.groups.io/g/devel/message/115568</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22764</commentid>
    <comment_count>5</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-03-08 15:20:25 +0000</bug_when>
    <thetext>Merged: https://github.com/tianocore/edk2/pull/5419</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4541</bug_id>
          
          <creation_ts>2023-08-28 14:25:20 +0000</creation_ts>
          <short_desc>Bug 08 - edk2/NetworkPkg: Predictable TCP ISNs</short_desc>
          <delta_ts>2024-05-26 22:07:58 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Brian Mullen">BrianM</reporter>
          <assigned_to name="Santhosh Kumar V">santhoshkumarv</assigned_to>
          <cc>dougflick</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>john.mathews</cc>
    
    <cc>louis.shen</cc>
    
    <cc>saloni.kasbekar</cc>
    
    <cc>santhoshkumarv</cc>
    
    <cc>sean.brogan</cc>
    
    <cc>sivaramann</cc>
    
    <cc>terry.lee</cc>
    
    <cc>zachary.clark-williams</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21868</commentid>
    <comment_count>0</comment_count>
      <attachid>1404</attachid>
    <who name="Brian Mullen">BrianM</who>
    <bug_when>2023-08-28 14:25:20 +0000</bug_when>
    <thetext>Created attachment 1404
Vuln details

See &quot;Bug 8&quot; description in attached &quot;Vuln details&quot; PDF. 

This is a child BZ of
https://bugzilla.tianocore.org/show_bug.cgi?id=4518</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22276</commentid>
    <comment_count>1</comment_count>
    <who name="Santhosh Kumar V">santhoshkumarv</who>
    <bug_when>2023-12-15 05:11:57 +0000</bug_when>
    <thetext>Zclarkwilliams.

If we introduce hash algorithms to generate random number, will it lead any time.eout during tcp communication?.

Can we use rnglib library function to generate random.number?

Thanks
Santhosh.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22282</commentid>
    <comment_count>2</comment_count>
    <who name="Santhosh Kumar V">santhoshkumarv</who>
    <bug_when>2023-12-20 04:53:48 +0000</bug_when>
    <thetext>Saloni:

If we introduce hash algorithms to generate random number, will it lead any timee out during tcp communication?

Can we use rnglib library function to generate random number which shall mitigate the Vlunerability?

Thanks
Santhosh.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22324</commentid>
    <comment_count>3</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-01-04 17:59:18 +0000</bug_when>
    <thetext>How long is the random number generator expected to take? I dont think it should be long enough to cause a TCP timeout.

I see we are already using NET_RANDOM () in another file to init mTcpGlobalIss. Is there a reason why we dont want to re-use the same?
  Seed            = NetRandomInitSeed ();
  mTcpGlobalIss   = NET_RANDOM (Seed) % mTcpGlobalIss;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22325</commentid>
    <comment_count>4</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-01-04 18:02:15 +0000</bug_when>
    <thetext>Nevermind, i just noticed that NetRandomInitSeed() is called out in Bug9 as another vulnerability.

Yes, i think it would be better to use the Rng Lib</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22356</commentid>
    <comment_count>5</comment_count>
      <attachid>1460</attachid>
    <who name="Santhosh Kumar V">santhoshkumarv</who>
    <bug_when>2024-01-12 10:48:18 +0000</bug_when>
    <thetext>Created attachment 1460
Patch to address the Vulnerability on predictable TCP INS

Saloni:

can you please review the patch and feedback.

Santhosh</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22371</commentid>
    <comment_count>6</comment_count>
    <who name="Santhosh Kumar V">santhoshkumarv</who>
    <bug_when>2024-01-17 01:34:26 +0000</bug_when>
    <thetext>Saloni:

Can you please review the patch and feedback.

Santhosh</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22424</commentid>
    <comment_count>7</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-01-25 18:03:26 +0000</bug_when>
    <thetext>Changes look good to me. Please fix the alignment issues to resolve uncrustify failures before sending out the patch for community review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22442</commentid>
    <comment_count>8</comment_count>
      <attachid>1465</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-01-30 15:21:49 +0000</bug_when>
    <thetext>Created attachment 1465
Alternative Patch for TCBZ4541

This is an alternative patch that implements RFC 9293 Section 3.4.1. The downsides to this patch is that a platform must provide the Hash2ServiceBinging protocol if they don&apos;t already.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22443</commentid>
    <comment_count>9</comment_count>
      <attachid>1466</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-01-30 15:25:17 +0000</bug_when>
    <thetext>Created attachment 1466
Alternative Patch for TCBZ4541

removed the MU_CHANGE tags</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22488</commentid>
    <comment_count>10</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-02-01 00:49:22 +0000</bug_when>
    <thetext>Doug,

I see fewer dependencies with Santhosh&apos;s patch. Do you have any insights to the advantages of using Hash2ServiceBinding instead?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22489</commentid>
    <comment_count>11</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-01 01:24:31 +0000</bug_when>
    <thetext>(In reply to Saloni Kasbekar from comment #10)
&gt; Doug,
&gt; 
&gt; I see fewer dependencies with Santhosh&apos;s patch. Do you have any insights to
&gt; the advantages of using Hash2ServiceBinding instead?

This is where it&apos;s completely fair to say &quot;This is not a general purpose TCP/IP Stack and if you&apos;re using it for that purpose your doing something wrong.&quot;

It is my understanding (And I&apos;m not really a networking guy - so take this with a grain of salt) that rfc9293 section-3.4.1 was trying to address preventing an attacker from guessing the ISN (Initial sequence number) while also handling the following:

1. Initial Security Number Wraparounds - where two connections may share the same ISN
2. Ambiguity in connection identification - where one connection may get dropped and when it comes back has a different isn (or a now shares an isn)
3. Lack of synchronization in the TCP three way handshake.
4. handling reincarnated connections (using a hash implementation they can recover)

Now that being said, I initially thought about doing it the way Santhosh is doing it. The limited nature of the TCP/IP Stack made me less concerned about ISN wraparounds / ambiguity and reincarnated connections. 

However every networking stack I looked did this the same way

ISN = M + F(localip, localport, remoteip, remoteport, secretkey)

Example: https://github.com/lwip-tcpip/lwip/blob/347054b329d141b858cc7180bf2aa23c672dc6d7/contrib/addons/tcp_isn/tcp_isn.c#L119

So I figured that since I&apos;m not really a networking guy I would rather implement the industry standard and intentionally break compatibility in favor of security. This is where I would really prefer if platforms provided MD5 hash since it&apos;s much faster and is an appropriate choice for this type of application.

All that being said I think for the purpose of mitigating this vulnerability and being the most compatible by deferring to the platform random number generator should be sufficient.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22496</commentid>
    <comment_count>12</comment_count>
    <who name="Saloni Kasbekar">saloni.kasbekar</who>
    <bug_when>2024-02-01 17:38:05 +0000</bug_when>
    <thetext>An option is to locate the Hash2ServiceBinding and proceed with your implementation if it exists, but imo it might be better to implement Santhosh&apos;s solution as a base solution to avoid exposing the vulnerability on platforms that don&apos;t implement the protocol.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22546</commentid>
    <comment_count>13</comment_count>
    <who name="Terry Lee">terry.lee</who>
    <bug_when>2024-02-07 18:01:29 +0000</bug_when>
    <thetext>Santosh&apos;s patch uses only random number generation.  There is concern that with relying on only random numbers, there could be sequence number overlap (likelihood is small but possible).  Doug&apos;s patch using RFC9293 is preferable.  However, Doug&apos;s patch uses MD5 hash if available on a platform.  There are still valid uses for MD5, but MD5 has been deprecated for security uses.  It&apos;d be better to bypass MD5 in favor of stronger hash algorithms.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22548</commentid>
    <comment_count>14</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-07 18:10:34 +0000</bug_when>
    <thetext>(In reply to Terry Lee from comment #13)
&gt; Santosh&apos;s patch uses only random number generation.  There is concern that
&gt; with relying on only random numbers, there could be sequence number overlap
&gt; (likelihood is small but possible).  Doug&apos;s patch using RFC9293 is
&gt; preferable.  However, Doug&apos;s patch uses MD5 hash if available on a platform.
&gt; There are still valid uses for MD5, but MD5 has been deprecated for security
&gt; uses.  It&apos;d be better to bypass MD5 in favor of stronger hash algorithms.

Terry,

I attempt to use MD5 if it exists as you mention and fallback to SHA256. I&apos;m okay with using SHA256 by default but since we need only the size of TCP_SEQNO (4 Bytes) I would prefer to use MD5 for performance but I haven&apos;t seen any issue using SHA256 in my testing.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22549</commentid>
    <comment_count>15</comment_count>
    <who name="Sean Brogan">sean.brogan</who>
    <bug_when>2024-02-07 22:42:15 +0000</bug_when>
    <thetext>@Saloni - I would also prefer to see the Alternative Patch used as it is aligned with the RFC that was mentioned in the CVE.  Not only that but RandomLib implementation also includes challenges for many platforms and thus both of these solutions require careful and knowledgeable integration by platforms.  Until the next CVE there will not be a better opportunity for platform owners to get the time and attention to integrate this patch, so expecting that at a later time edk2 would switch to a more robust solution (with dependency on hash service) because the community of platform developers would be ready is irrational.  Edk2 is full of solutions where the developers had every intention to come back and fix right, but never did.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22553</commentid>
    <comment_count>16</comment_count>
    <who name="Terry Lee">terry.lee</who>
    <bug_when>2024-02-08 17:01:51 +0000</bug_when>
    <thetext>(In reply to Doug Flick from comment #14)
&gt; (In reply to Terry Lee from comment #13)
&gt; &gt; Santosh&apos;s patch uses only random number generation.  There is concern that
&gt; &gt; with relying on only random numbers, there could be sequence number overlap
&gt; &gt; (likelihood is small but possible).  Doug&apos;s patch using RFC9293 is
&gt; &gt; preferable.  However, Doug&apos;s patch uses MD5 hash if available on a platform.
&gt; &gt; There are still valid uses for MD5, but MD5 has been deprecated for security
&gt; &gt; uses.  It&apos;d be better to bypass MD5 in favor of stronger hash algorithms.
&gt; 
&gt; Terry,
&gt; 
&gt; I attempt to use MD5 if it exists as you mention and fallback to SHA256. I&apos;m
&gt; okay with using SHA256 by default but since we need only the size of
&gt; TCP_SEQNO (4 Bytes) I would prefer to use MD5 for performance but I haven&apos;t
&gt; seen any issue using SHA256 in my testing.

I do not know the cryptographic strength implications of truncating MD5 to 4 bytes vs. truncating SHA-256 to 4 bytes.  However, since this is a security fix, it seems appropriate to follow security guidance that MD5 is unsuitable for security use.  If a platform&apos;s computational performance does not allow it to use secure implementation and achieve acceptable performance, I see it as a platform issue and not the source code implementation issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22554</commentid>
    <comment_count>17</comment_count>
      <attachid>1473</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-08 17:59:29 +0000</bug_when>
    <thetext>Created attachment 1473
Updated Alternative Patch

Removes MD5</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22555</commentid>
    <comment_count>18</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-08 18:00:49 +0000</bug_when>
    <thetext>(In reply to Terry Lee from comment #16)
&gt; (In reply to Doug Flick from comment #14)
&gt; &gt; (In reply to Terry Lee from comment #13)
&gt; &gt; &gt; Santosh&apos;s patch uses only random number generation.  There is concern that
&gt; &gt; &gt; with relying on only random numbers, there could be sequence number overlap
&gt; &gt; &gt; (likelihood is small but possible).  Doug&apos;s patch using RFC9293 is
&gt; &gt; &gt; preferable.  However, Doug&apos;s patch uses MD5 hash if available on a platform.
&gt; &gt; &gt; There are still valid uses for MD5, but MD5 has been deprecated for security
&gt; &gt; &gt; uses.  It&apos;d be better to bypass MD5 in favor of stronger hash algorithms.
&gt; &gt; 
&gt; &gt; Terry,
&gt; &gt; 
&gt; &gt; I attempt to use MD5 if it exists as you mention and fallback to SHA256. I&apos;m
&gt; &gt; okay with using SHA256 by default but since we need only the size of
&gt; &gt; TCP_SEQNO (4 Bytes) I would prefer to use MD5 for performance but I haven&apos;t
&gt; &gt; seen any issue using SHA256 in my testing.
&gt; 
&gt; I do not know the cryptographic strength implications of truncating MD5 to 4
&gt; bytes vs. truncating SHA-256 to 4 bytes.  However, since this is a security
&gt; fix, it seems appropriate to follow security guidance that MD5 is unsuitable
&gt; for security use.  If a platform&apos;s computational performance does not allow
&gt; it to use secure implementation and achieve acceptable performance, I see it
&gt; as a platform issue and not the source code implementation issue.

Fair enough, I went ahead and removed MD5. I agree with you that the platform should be providing an adequate level of security.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23059</commentid>
    <comment_count>19</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-26 22:07:58 +0000</bug_when>
    <thetext>Merge in https://github.com/tianocore/edk2/pull/5582</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1404</attachid>
            <date>2023-08-28 14:25:20 +0000</date>
            <delta_ts>2023-08-28 14:25:20 +0000</delta_ts>
            <desc>Vuln details</desc>
            <filename>Quarkslab-20230803-EDK2-ipstack-vulns.pdf</filename>
            <type>application/pdf</type>
            <size>215796</size>
            <attacher name="Brian Mullen">BrianM</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1460</attachid>
            <date>2024-01-12 10:48:18 +0000</date>
            <delta_ts>2024-01-12 10:48:18 +0000</delta_ts>
            <desc>Patch to address the Vulnerability on predictable TCP INS</desc>
            <filename>Vulnerability_Patch.patch</filename>
            <type>text/plain</type>
            <size>3681</size>
            <attacher name="Santhosh Kumar V">santhoshkumarv</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1465</attachid>
            <date>2024-01-30 15:21:49 +0000</date>
            <delta_ts>2024-01-30 15:25:17 +0000</delta_ts>
            <desc>Alternative Patch for TCBZ4541</desc>
            <filename>0001-SECURITY-PATCH-TCBZ4541-Patch.patch</filename>
            <type>text/plain</type>
            <size>24755</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1466</attachid>
            <date>2024-01-30 15:25:17 +0000</date>
            <delta_ts>2024-02-08 17:59:29 +0000</delta_ts>
            <desc>Alternative Patch for TCBZ4541</desc>
            <filename>0001-SECURITY-PATCH-TCBZ4541-Patch.patch</filename>
            <type>text/plain</type>
            <size>23764</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1473</attachid>
            <date>2024-02-08 17:59:29 +0000</date>
            <delta_ts>2024-02-08 17:59:29 +0000</delta_ts>
            <desc>Updated Alternative Patch</desc>
            <filename>0001-SECURITY-PATCH-TCBZ4541-Patch.patch</filename>
            <type>text/plain</type>
            <size>23117</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4863</bug_id>
          
          <creation_ts>2024-10-08 19:23:14 +0000</creation_ts>
          <short_desc>TDVF: TD_HOB is measured into both MRTD and RTMR0</short_desc>
          <delta_ts>2024-10-09 16:16:56 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dionna Glaze">dionnaglaze</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>erdemaktas</cc>
    
    <cc>jiewen.yao</cc>
    
    <cc>min.m.xu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202305</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23435</commentid>
    <comment_count>0</comment_count>
    <who name="Dionna Glaze">dionnaglaze</who>
    <bug_when>2024-10-08 19:23:14 +0000</bug_when>
    <thetext>From a VMM and firmware provider perspective, it is not ideal to have to release reference measurements for TDVF as it is combined with its ram banks.

The TdxHelperMeasureTdHob function (either sensibly or not) measures ram bank information into RTMR0, but it also does not consider the TDHOB memory region to be in an unencrypted state. This means the page will have to have been already measured in the init_memory_region operation and accepted on launch as private.

It would help to instead

* identify the TDHOB page as shared
* copy its contents to a private page
* change the page state to private
* validate the TDHOB contents, like it is right now, and probably add a non-overlapping check.

It&apos;s much easier to issue guidance on how to verify the TDHOB measurement event for different machine configurations than to mix that detail into the TDVF measurement itself.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23437</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2024-10-08 21:32:15 +0000</bug_when>
    <thetext>TD_HOB should NOT be measured into MRTD. It is spec violation.

Will check why this happened.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23442</commentid>
    <comment_count>2</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2024-10-09 01:05:58 +0000</bug_when>
    <thetext>Hi, Glaze
We carefully checked the code and did not find that TD_HOB was measured into MRTD. (TDVF obviously doesn&apos;t measure it to MRTD because there is no such interface. QEMU/KVM doesn&apos;t either after we check the code.)

May I know why you think TD_HOB was measured to MRTD? Or did I miss something?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23445</commentid>
    <comment_count>3</comment_count>
    <who name="Dionna Glaze">dionnaglaze</who>
    <bug_when>2024-10-09 16:16:33 +0000</bug_when>
    <thetext>I now see 

```
__u32 flags = entry-&gt;attributes &amp; TDVF_SECTION_ATTRIBUTES_MR_EXTEND ?
                      KVM_TDX_MEASURE_MEMORY_REGION : 0;
```

In Qemu, which is something I missed. This is a bug in our VMM.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23446</commentid>
    <comment_count>4</comment_count>
    <who name="Dionna Glaze">dionnaglaze</who>
    <bug_when>2024-10-09 16:16:56 +0000</bug_when>
    <thetext>Status update.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4091</bug_id>
          
          <creation_ts>2022-10-04 11:01:20 +0000</creation_ts>
          <short_desc>SourceLevelDebugPkg: Add CI YAML file</short_desc>
          <delta_ts>2022-10-12 22:18:06 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kubacki">michael.kubacki</reporter>
          <assigned_to name="Michael Kubacki">michael.kubacki</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>SourceLevelDebugPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19692</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-04 11:01:20 +0000</bug_when>
    <thetext>This package still does not have a CI YAML file. This change is tracking
a minimal CI YAML file being added so the package can take part in edk2
CI.

Since it currently has not been run against CI, some CI failures may need to
be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19752</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-11 21:48:11 +0000</bug_when>
    <thetext>michael.kubacki@microsoft.com: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19766</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kubacki">michael.kubacki</who>
    <bug_when>2022-10-12 22:18:06 +0000</bug_when>
    <thetext>Merged to edk2/master in commit d6d4a81f8ad4e41c39200a8b8e4f02fe8f97634b to 710f83b79d6eab641401c054b2f40f6c630f8cd5.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4712</bug_id>
          
          <creation_ts>2024-02-26 05:16:38 +0000</creation_ts>
          <short_desc>DevicePathFromTextBBTextCoverage.c function CreateDNSDeviceNode has a bug</short_desc>
          <delta_ts>2024-02-27 05:30:47 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chao Li">lichao</reporter>
          <assigned_to name="Chao Li">lichao</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22650</commentid>
    <comment_count>0</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-02-26 05:16:38 +0000</bug_when>
    <thetext>SctStrToIPv4Addr (&amp;IpStr1, (EFI_IPv4_ADDRESS *)(DNS + sizeof (DNS_DEVICE_PATH)));

DNS is a pointer, which is increased by a structure size and converted to EFI_IPv4_ADDRESS*, which will point to an unknown address.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22651</commentid>
    <comment_count>1</comment_count>
    <who name="Chao Li">lichao</who>
    <bug_when>2024-02-26 05:16:59 +0000</bug_when>
    <thetext>I&apos;m working on this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22652</commentid>
    <comment_count>2</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-02-26 05:21:23 +0000</bug_when>
    <thetext>Thank you Li Chao for finding issue and patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22658</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2024-02-27 05:30:47 +0000</bug_when>
    <thetext>The solution is upstreamed by the commit:

https://github.com/tianocore/edk2-test/commit/cabb98d44be94e7547605435a0be7c4946d10f8b</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4568</bug_id>
          
          <creation_ts>2023-10-16 03:28:16 +0000</creation_ts>
          <short_desc>OvmfPkg/AcpiPlatformDxe: Coverity scan flags FORWARD_NULL and UNUSED_VALUE issues</short_desc>
          <delta_ts>2023-10-25 06:11:22 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>cepingx.sun</reporter>
          <assigned_to>cepingx.sun</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>min.m.xu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21981</commentid>
    <comment_count>0</comment_count>
      <attachid>1424</attachid>
    <who name="">cepingx.sun</who>
    <bug_when>2023-10-16 03:28:16 +0000</bug_when>
    <thetext>Created attachment 1424
HTML files reflecting the issues

OvmfPkg/AcpiPlatformDxe: Coverity scan flags OVERRUN and UNUSED_VALUE issues


Coverity report OVERRUN and UNUSED_VALUE in OvmfPkg/AcpiPlatformDxe/CloudHvAcpi.c.

OVERRUN: The code had check the pointer but only assert in DEBUG mode, in Release mode, that would be error with dereferencing null pointer.
 
UNUSED_VALUE: The status of &quot;&quot;AcpiProtocol-&gt;InstallAcpiTable&quot; is overwritten before it can be used, it is better to check it before overwriting.

Coverity version: 2023.3.4 
Attached report file</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21992</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-10-18 22:39:08 +0000</bug_when>
    <thetext>cepingx.sun@intel.com : please work it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22019</commentid>
    <comment_count>2</comment_count>
    <who name="">cepingx.sun</who>
    <bug_when>2023-10-19 02:27:40 +0000</bug_when>
    <thetext>Updated the Description with the current flag name:

OvmfPkg/AcpiPlatformDxe: Coverity scan flags FORWARD_NULL and UNUSED_VALUE issues


Coverity report FORWARD_NULL and UNUSED_VALUE in OvmfPkg/AcpiPlatformDxe/CloudHvAcpi.c.

FORWARD_NULL: The code had check the pointer but only assert in DEBUG mode, in Release mode, that would be error with dereferencing null pointer.
 
UNUSED_VALUE: The status of &quot;&quot;AcpiProtocol-&gt;InstallAcpiTable&quot; is overwritten before it can be used, it is better to check it before overwriting.



And patch sent to EDK2 mail list with mail subject as -

[PATCH] OvmfPkg/AcpiPlatformDxe: Fix the coverity errors

PR link: https://github.com/tianocore/edk2/pull/4911</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22037</commentid>
    <comment_count>3</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-25 06:11:22 +0000</bug_when>
    <thetext>v2 OvmfPkg/AcpiPlatformDxe: Fix Coverity report issues
http://mid.mail-archive.com/20231023090539.1003-1-cepingx.sun@intel.com
https://edk2.groups.io/g/devel/message/109905

merged via &lt;https://github.com/tianocore/edk2/pull/4954&gt; as commit cf87fd95c1f5be4880a015c82a18e8ae12ff5e94</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1424</attachid>
            <date>2023-10-16 03:28:16 +0000</date>
            <delta_ts>2023-10-16 03:28:16 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>OvmfPkg-CloudHvAcpi-Coverity-Report.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>8362</size>
            <attacher>cepingx.sun</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4423</bug_id>
          
          <creation_ts>2023-04-25 00:15:43 +0000</creation_ts>
          <short_desc>UefiCpuPkg: Update ProcTrace feature code to support enable ProcTrace only on BSP and support enable generating  CYC, TSC  timing packets</short_desc>
          <delta_ts>2023-04-26 05:45:31 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dun Tan">dun.tan</reporter>
          <assigned_to name="Dun Tan">dun.tan</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21396</commentid>
    <comment_count>0</comment_count>
    <who name="Dun Tan">dun.tan</who>
    <bug_when>2023-04-25 00:15:43 +0000</bug_when>
    <thetext>Update ProcTrace feature code to support enable ProcTrace only on BSP and support  enable generating CYC, TSC  timing packets.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21403</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-04-25 21:40:03 +0000</bug_when>
    <thetext>Please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21432</commentid>
    <comment_count>2</comment_count>
    <who name="Dun Tan">dun.tan</who>
    <bug_when>2023-04-26 05:45:31 +0000</bug_when>
    <thetext>Resolved in these two patches:
https://github.com/tianocore/edk2/commit/ede0bd1496405f72147308b9570efba0234349b2 
https://github.com/tianocore/edk2/commit/61e2c8342443303e6e50e7ce75b5971e88413573</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4248</bug_id>
          
          <creation_ts>2023-01-04 06:24:22 +0000</creation_ts>
          <short_desc>FatPkg/EnhancedFatDxe: Coverity scan flags multiple issues</short_desc>
          <delta_ts>2023-01-04 06:29:20 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Ranbir Singh">saini.ranbirs</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>veeresh.sangolli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>FatPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20474</commentid>
    <comment_count>0</comment_count>
      <attachid>1123</attachid>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-04 06:24:22 +0000</bug_when>
    <thetext>Created attachment 1123
HTML files reflecting the issues

3 issues have been captured by Coverity scan for the FatPkg.

3 issues =&gt; 1 OVERFLOW_BEFORE_WIDEN and 2 SIGN_EXTENSION

Please see the attached zip containing the index.html for the list of issues and the hyperlinks for the details about the issues.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20475</commentid>
    <comment_count>1</comment_count>
    <who name="Ranbir Singh">saini.ranbirs</who>
    <bug_when>2023-01-04 06:29:20 +0000</bug_when>
    <thetext>To be seen later</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1123</attachid>
            <date>2023-01-04 06:24:22 +0000</date>
            <delta_ts>2023-01-04 06:24:22 +0000</delta_ts>
            <desc>HTML files reflecting the issues</desc>
            <filename>FatPkg - EnhancedFatDxe Coverity Issues.zip</filename>
            <type>application/x-zip-compressed</type>
            <size>47287</size>
            <attacher name="Ranbir Singh">saini.ranbirs</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4116</bug_id>
          
          <creation_ts>2022-10-25 04:52:36 +0000</creation_ts>
          <short_desc>The Edk2\BaseTools\Tests\GNUmakefile file cannot handle the case which PYTHON_COMMAND is not defined</short_desc>
          <delta_ts>2022-10-25 21:56:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Yanbo Huang">yanbo.huang</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19816</commentid>
    <comment_count>0</comment_count>
    <who name="Yanbo Huang">yanbo.huang</who>
    <bug_when>2022-10-25 04:52:36 +0000</bug_when>
    <thetext>The Edk2\BaseTools\Tests\GNUmakefile file cannot handle the case which PYTHON_COMMAND is not defined, and will report error: &quot;/bin/sh: 1: RunTests.py: not found&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19827</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-10-25 21:40:39 +0000</bug_when>
    <thetext>Yanbo:  please make sure acb2acccfdd34a6643e7a203e68cbe7e523a4a02 to fix this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19840</commentid>
    <comment_count>2</comment_count>
    <who name="Yanbo Huang">yanbo.huang</who>
    <bug_when>2022-10-25 21:56:14 +0000</bug_when>
    <thetext>Hi, Liming, after check, this issue can be fixed by this commit: acb2acccfdd34a6643e7a203e68cbe7e523a4a02</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4749</bug_id>
          
          <creation_ts>2024-04-10 02:27:37 +0000</creation_ts>
          <short_desc>edk2-libc : add cpuid_ex api to execute the CPUID instructions on specific CPU</short_desc>
          <delta_ts>2024-06-14 11:42:53 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Vishal">vishal.r</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22897</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-10 02:27:37 +0000</bug_when>
    <thetext>The current cpuid function in edk2module of Python interpreter is capable of executing the cpuid instructions on BSP processor only. 
Need to provide an extension API to execute the CPUID instructions on a CPU of user choice.
proposed extension api is as given below:
cpuid_ex(cpu, eax, ecx)

Where the cpu represents the input cpu on which the cpuid instructions provided through eax and ecx parameters needs to be executed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22898</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-10 02:28:04 +0000</bug_when>
    <thetext>Vishal will be working on this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23115</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-06-14 11:42:53 +0000</bug_when>
    <thetext>This feature has been enabled through commit - 0c4ca43ec3cde7d7945ea8bcb519cd0b2cba1788</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4600</bug_id>
          
          <creation_ts>2023-11-20 07:39:47 +0000</creation_ts>
          <short_desc>UIDs for ETE nodes must be unique</short_desc>
          <delta_ts>2023-11-21 11:31:13 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sami Mujawar">sami.mujawar</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>DynamicTablesPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22168</commentid>
    <comment_count>0</comment_count>
    <who name="Sami Mujawar">sami.mujawar</who>
    <bug_when>2023-11-20 07:39:47 +0000</bug_when>
    <thetext>The ACPI specification, revision 6.5, section 6.1.12 _UID (Unique ID) specifies &apos;The _UID must be unique across all devices with either a common _HID or _CID.&apos;

A recent patch series at &quot;[PATCH v3 00/11] Update MADT for ACPI 6.5, and add TRBE &amp; ETE support&quot; (https://edk2.groups.io/g/devel/message/108996) introduced support for creating ETE nodes. 

However, the &quot;[PATCH v3 10/13] DynamicTablesPkg: Add ETE device to CPU node in AML&quot; (https://edk2.groups.io/g/devel/message/108995), configures the UID for the ETE nodes using the CpuName parameter passed to the ETE node creation function. The CpuName is an index value that increments for each new CPU, but is reset to 0 for each cluster. This results in the ETE nodes having the non-unique UID values.


A fix for this issue is posted at https://edk2.groups.io/g/devel/message/111231</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22170</commentid>
    <comment_count>1</comment_count>
    <who name="Sami Mujawar">sami.mujawar</who>
    <bug_when>2023-11-20 11:06:13 +0000</bug_when>
    <thetext>Please merge this patch in edk2-stable202311.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22176</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-11-21 11:31:13 +0000</bug_when>
    <thetext>Merged as commit 23dbb8a07d108a7b8589e31639b6302b70445b9f.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4450</bug_id>
          
          <creation_ts>2023-05-06 05:49:20 +0000</creation_ts>
          <short_desc>Replace pre-standard __FUNCTION__ with C99 __func__ throughout edk2</short_desc>
          <delta_ts>2023-05-07 20:57:42 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Rebecca Cran">rebecca</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21500</commentid>
    <comment_count>0</comment_count>
    <who name="Rebecca Cran">rebecca</who>
    <bug_when>2023-05-06 05:49:20 +0000</bug_when>
    <thetext>EDK2 had many uses of __FUNCTION__ throughout the codebase. This is a macro that was introduced into many C compilers but was never part of the standard.

The C99 standard introduced __func__, and since it&apos;s standard has replaced all uses of __FUNCTION__ throughout EDK2. Use of __FUNCTION__ is now checked and disallowed in any new code.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21507</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-05-07 20:57:42 +0000</bug_when>
    <thetext>Fix at edk2 cf4af503fb61e7a942e05e61627364cad48c5781..61652efd04a7585a779226137d0f9739a75aac69</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4138</bug_id>
          
          <creation_ts>2022-11-04 17:17:44 +0000</creation_ts>
          <short_desc>Exposing SPM in SRAT</short_desc>
          <delta_ts>2023-05-04 21:18:24 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Scott Lee">scolee</reporter>
          <assigned_to name="Scott Lee">scolee</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>michael.a.rothman</cc>
          
          <cf_industrystandardspecifications>ACPI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19943</commentid>
    <comment_count>0</comment_count>
      <attachid>1047</attachid>
    <who name="Scott Lee">scolee</who>
    <bug_when>2022-11-04 17:17:44 +0000</bug_when>
    <thetext>Created attachment 1047
Code-first - Exposing SPM in SRAT v0.5

Code-first Exposing SPM in SRAT

This ECN proposes a modification to the SRAT to allow an OS or hypervisor to discover Specific Purpose Memory through an ACPI table. Currently, information about Specific Purpose Memory (see UEFI Specification for definition of Specific Purpose Memory) on a system is available only through UEFI memory map. There may be OSes or hypervisors that need to discover this information through an ACPI table-based mechanism. The ECN follows the previous precedent set by the NonVolatile attribute to report attributes of a memory range in SRAT.

While this ECN has some overlap with Bug 4062 - Describing Hot Pluggable Memory, it is distinct from that ECN. The ECN in Bug 4062 will not be proposing any SRAT changes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20033</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-11-15 21:46:41 +0000</bug_when>
    <thetext>scolee@microsoft.com: please make spec change as markdown format.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20578</commentid>
    <comment_count>2</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2023-01-10 13:45:26 +0000</bug_when>
    <thetext>Corresponding ASWG mantis:
https://mantis.uefi.org/mantis/view.php?id=2361</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20625</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-12 01:42:13 +0000</bug_when>
    <thetext>Please refer to code first process wiki https://github.com/tianocore/tianocore.github.io/wiki/EDK-II-Code-First-Process

This wiki introduces markdown.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20626</commentid>
    <comment_count>4</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-01-12 01:43:13 +0000</bug_when>
    <thetext>Please refer to code first process wiki https://github.com/tianocore/tianocore.github.io/wiki/EDK-II-Code-First-Process

This wiki introduces markdown.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20653</commentid>
    <comment_count>5</comment_count>
    <who name="Michael A. Rothman">michael.a.rothman</who>
    <bug_when>2023-01-12 18:20:34 +0000</bug_when>
    <thetext>We already describe memory attributes in NFIT, and this feels somewhat like adding similar data in a different place and I&apos;m wondering whether we are leading ourselves down a path to have multiple places to get the same data.

That&apos;s usually a recipe for bad things, but either we accept this approach or try to come up with a more generic way of reflecting memory attribute content.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20654</commentid>
    <comment_count>6</comment_count>
    <who name="Michael A. Rothman">michael.a.rothman</who>
    <bug_when>2023-01-12 18:43:52 +0000</bug_when>
    <thetext>What should an OS do if the SRAT is exposing a range as SP but the UEFI memory doesn’t?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21112</commentid>
    <comment_count>7</comment_count>
    <who name="Scott Lee">scolee</who>
    <bug_when>2023-02-23 17:26:00 +0000</bug_when>
    <thetext>(In reply to Michael A. Rothman from comment #5)
&gt; We already describe memory attributes in NFIT, and this feels somewhat like
&gt; adding similar data in a different place and I&apos;m wondering whether we are
&gt; leading ourselves down a path to have multiple places to get the same data.
&gt; 
&gt; That&apos;s usually a recipe for bad things, but either we accept this approach
&gt; or try to come up with a more generic way of reflecting memory attribute
&gt; content.

My original desire was to use NFIT but got pushback from folks in Linux who did not like reporting info about volatile memory in a table whose name includes &quot;NVDIMM&quot;. I also floated another idea using HMAT which also received pushback before the current proposal of using SRAT which didn&apos;t receive any pushbacks.

The existing NonVolatile flag in Flags field of Memory Affinity Structure has a duplicate in NFIT so my introduction of SP in SRAT is not a new issue.

With multiple places to get data, I agree that there is a chance of inconsistency. I am fine with adding new wording to state that memory attributes reported in various ACPI table has to be consistent with each other and also with info reported in UEFI.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21113</commentid>
    <comment_count>8</comment_count>
    <who name="Scott Lee">scolee</who>
    <bug_when>2023-02-23 17:31:37 +0000</bug_when>
    <thetext>(In reply to Michael A. Rothman from comment #6)
&gt; What should an OS do if the SRAT is exposing a range as SP but the UEFI
&gt; memory doesn’t?

The issue described here is not a new issue as several existing tables (e.g. NFIT, existing SRAT) already have this problem. I&apos;m fine with adding new wording to state that reporting of info in SRAT has to be consistent with UEFI. 

Behavior in this specific case would be OS-specific. I would expect OS memory manager will have some policy that can gracefully deal with this situation (e.g. OS will use memory as general purpose and forbid SP usages if UEFI memory doesn&apos;t report SP).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21478</commentid>
    <comment_count>9</comment_count>
    <who name="Scott Lee">scolee</who>
    <bug_when>2023-05-04 21:18:24 +0000</bug_when>
    <thetext>This ECN was approved in ASWG during the WW17 2023 meeting and will be in the next ACPI spec as new content.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1047</attachid>
            <date>2022-11-04 17:17:44 +0000</date>
            <delta_ts>2022-11-04 17:17:44 +0000</delta_ts>
            <desc>Code-first - Exposing SPM in SRAT v0.5</desc>
            <filename>CodeFirst_SPM_SRAT_ver0.5.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>21634</size>
            <attacher name="Scott Lee">scolee</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4782</bug_id>
          
          <creation_ts>2024-06-05 21:29:47 +0000</creation_ts>
          <short_desc>GitHub CI PatchCheck.py false positive</short_desc>
          <delta_ts>2024-09-04 20:50:49 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Test</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Dionna Glaze">dionnaglaze</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23092</commentid>
    <comment_count>0</comment_count>
    <who name="Dionna Glaze">dionnaglaze</who>
    <bug_when>2024-06-05 21:29:47 +0000</bug_when>
    <thetext>This PR changes [a single file in OvmfPkg](https://github.com/tianocore/edk2/pull/5738) and PatchCheck.py claims it changes 4 different packages https://github.com/tianocore/edk2/pull/5738/checks?check_run_id=25869747978</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23203</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-07-10 21:03:15 +0000</bug_when>
    <thetext>Dionna Glaze : please confirm that https://github.com/tianocore/edk2/pull/5752 has fixed this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23223</commentid>
    <comment_count>2</comment_count>
    <who name="Dionna Glaze">dionnaglaze</who>
    <bug_when>2024-07-12 18:18:48 +0000</bug_when>
    <thetext>I wasn&apos;t able to reproduce locally before, so it was only that PR that was a problem, and which is no longer a problem. Can close.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23373</commentid>
    <comment_count>3</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-09-04 20:50:49 +0000</bug_when>
    <thetext>it has been fixed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4012</bug_id>
          
          <creation_ts>2022-08-03 14:36:46 +0000</creation_ts>
          <short_desc>ECR PRM: Describe AArch64 as an architecture where PRM is applicable</short_desc>
          <delta_ts>2022-09-29 18:20:50 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jose Marinho">Jose.Marinho</reporter>
          <assigned_to name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>ACPI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19356</commentid>
    <comment_count>0</comment_count>
      <attachid>1014</attachid>
    <who name="Jose Marinho">Jose.Marinho</who>
    <bug_when>2022-08-03 14:36:46 +0000</bug_when>
    <thetext>Created attachment 1014
ECR_PRM_Platform_Runtime_Mechanism_v4

This ECR clarifies the Platform Runtime Mechanism (PRM) specification, stating that the PRM is useable on Arm AArch64 platforms. 

The ECR attempts to make the introduction text more architecture agnostic, by using the term &quot;privileged firmware&quot; which refers to SMM on the x86/x64 architecture.
The ECR also describes aspects of the AArch64 architecture, from a high-level, and what constitutes privileged firmware for the AArch64 arch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19372</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-09 21:41:34 +0000</bug_when>
    <thetext>Samer will work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19539</commentid>
    <comment_count>2</comment_count>
      <attachid>1022</attachid>
    <who name="Jose Marinho">Jose.Marinho</who>
    <bug_when>2022-09-09 05:17:04 +0000</bug_when>
    <thetext>Created attachment 1022
ECR_PRM_Platform_Runtime_Mechanism_v5

Correctly represent the tracked changes versus the original PRM spec.
The tracked changes listed in ECR v4 were inaccurate.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19673</commentid>
    <comment_count>3</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2022-09-29 18:20:50 +0000</bug_when>
    <thetext>ASWG ECR: https://mantis.uefi.org/mantis/view.php?id=2343

Was approved in ASWG meeting of 9/22 as new content to update web site material (PRM)</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1014</attachid>
            <date>2022-08-03 14:36:46 +0000</date>
            <delta_ts>2022-08-03 14:36:46 +0000</delta_ts>
            <desc>ECR_PRM_Platform_Runtime_Mechanism_v4</desc>
            <filename>ECR_PRM_Platform_Runtime_Mechanism_v4.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>331416</size>
            <attacher name="Jose Marinho">Jose.Marinho</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1022</attachid>
            <date>2022-09-09 05:17:04 +0000</date>
            <delta_ts>2022-09-09 05:17:04 +0000</delta_ts>
            <desc>ECR_PRM_Platform_Runtime_Mechanism_v5</desc>
            <filename>ECR_PRM_Platform_Runtime_Mechanism_v5.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>423665</size>
            <attacher name="Jose Marinho">Jose.Marinho</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4623</bug_id>
          
          <creation_ts>2023-12-15 03:42:52 +0000</creation_ts>
          <short_desc>MinPlatformPkg: SecFspWrapperPlatformSecLib doesn&apos;t support X64</short_desc>
          <delta_ts>2024-02-01 06:58:38 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Platforms</product>
          <component>MinPlatformPkg</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>ted.kuo</reporter>
          <assigned_to>ted.kuo</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22271</commentid>
    <comment_count>0</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2023-12-15 03:42:52 +0000</bug_when>
    <thetext>SecFspWrapperPlatformSecLib doesn&apos;t support X64 for 64bit PEI.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22310</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-01-02 21:50:46 +0000</bug_when>
    <thetext>ted.kuo@intel.com: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22491</commentid>
    <comment_count>2</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2024-02-01 06:58:38 +0000</bug_when>
    <thetext>SHA-1: 03a69eb9f4e2a74704a1e6ee9a2c20db275f865d

* MinPlatformPkg: Support SecFspWrapperPlatformSecLib in X64

https://bugzilla.tianocore.org/show_bug.cgi?id=4623
1.Added PeiCoreEntry.nasm, SecEntry.nasm and Stack.nasm for X64.
2.Made changes in common files to support both IA32 and X64.
3.Added the PCDs below for FSP-T UPD revisions and reset vector in FSP.
 - PcdFspWrapperResetVectorInFsp
 - PcdFspWrapperBfvforResetVectorInFsp
 - PcdFsptUpdHeaderRevision
 - PcdFsptArchUpdRevision

Reviewed-by: Sai Chaganty &lt;rangasai.v.chaganty@intel.com&gt;
Cc: Chasel Chiu &lt;chasel.chiu@intel.com&gt;
Reviewed-by: Nate DeSimone &lt;nathaniel.l.desimone@intel.com&gt;
Cc: Eric Dong &lt;eric.dong@intel.com&gt;
Reviewed-by: Ashraf Ali S &lt;ashraf.ali.s@intel.com&gt;
Cc: Chinni B Duggapu &lt;chinni.b.duggapu@intel.com&gt;
Cc: Liming Gao &lt;gaoliming@byosoft.com.cn&gt;
Signed-off-by: Ted Kuo &lt;ted.kuo@intel.com&gt;</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4479</bug_id>
          
          <creation_ts>2023-06-08 04:29:09 +0000</creation_ts>
          <short_desc>UefiPayloadPkg: To change CapsuleLib instance to null lib for CapsuleRuntimeDxe driver</short_desc>
          <delta_ts>2023-06-14 02:33:21 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>mars_cc_lin</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiPayloadPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21645</commentid>
    <comment_count>0</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-06-08 04:29:09 +0000</bug_when>
    <thetext>Plan is that CapsuleRuntimeDxe consume null CapsuleLib instance and move the driver into BDSFV. then, platform code could change it in its owned platform BDSFV.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21646</commentid>
    <comment_count>1</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-06-08 04:29:24 +0000</bug_when>
    <thetext>I&apos;m working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21652</commentid>
    <comment_count>2</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-06-11 23:41:09 +0000</bug_when>
    <thetext>Change the design: Add CAPSULE_SUPPORT in UPL and set it as FALSE in default.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21659</commentid>
    <comment_count>3</comment_count>
    <who name="">mars_cc_lin</who>
    <bug_when>2023-06-14 02:31:31 +0000</bug_when>
    <thetext>PR link: https://github.com/tianocore/edk2/pull/4542</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4161</bug_id>
          
          <creation_ts>2022-11-21 05:30:25 +0000</creation_ts>
          <short_desc>edk2-libc : merge the chipsec specific enhancements done for edk2 module to edk2-libc</short_desc>
          <delta_ts>2023-04-03 03:13:22 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Ajay Kadapathri">ajay.kadapathri</assigned_to>
          <cc>ajay.kadapathri</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20067</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2022-11-21 05:30:25 +0000</bug_when>
    <thetext>This BZ has been created to merge the edk2 module enhancements done to support chipsec tool from chipsec repo to edk2-libc to facilitate wider usage of these enhancements by other tool stacks running on UEFI shell and to facilitate more platform oriented python application development for validation and debug activities at UEFI shell. 

Chipsec team has agreed for this code merger from chipsec repo to edk2-libc repo for the edk2 module. 

edk2 module specific enhancements in chipsec repo are available at :
https://github.com/chipsec/chipsec/tree/main/chipsec_tools/edk2/PythonEFI</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20068</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2022-11-21 05:30:59 +0000</bug_when>
    <thetext>Confirming this BZ and will be working on getting the edk2 module code from chipsec to edk2-libc repo.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20069</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2022-11-21 09:09:08 +0000</bug_when>
    <thetext>Submitted the patch request for review and merger to master.


I am able to build the changes successfully for X86 and X64 binary formats with the VS2019 tool chain. Also verified the py interpreter build of x64 bits.

Besides this ensured that these changes didn&apos;t break the existing GCC build support through compiler directives (Pre-compiler macros). Verified the same by building Py interpreter for UEFI on Ubuntu system for x86 and X64 bit formats. 
For linux the full functionality of the edk2 module has not been enabled yet as it requires porting some of the assembly files to gcc assembly format. We also need to have ctypes module build support enabled for GCC tool chain. So the Linux enablement needs more holistic approach and would be looking for help from community members with GCC expertise.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21302</commentid>
    <comment_count>3</comment_count>
    <who name="Ajay Kadapathri">ajay.kadapathri</who>
    <bug_when>2023-04-03 03:13:22 +0000</bug_when>
    <thetext>Submitted the patch request for review and it&apos;s been merged to master.


I am able to build the changes successfully for X86 and X64 binary formats with the VS2019 and GCC toolchains. Also verified the py interpreter build of x64 bits, Hence moving the ticket to resolved state.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4811</bug_id>
          
          <creation_ts>2024-07-14 12:21:48 +0000</creation_ts>
          <short_desc>edk2-libc: Add support for compiling Python UEFI interpreter with VS2022</short_desc>
          <delta_ts>2024-07-22 02:18:30 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="Jayaprakash Nevara">n.jayaprakash</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>michael.d.kinney</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>N/A</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23224</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-14 12:21:48 +0000</bug_when>
    <thetext>edk2 has enabled building the codebase with VS2022 tool chain recently. Need to ensure that edk2-libc and the python projects can be built with this latest tool chain with out any errors.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23225</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-14 12:23:30 +0000</bug_when>
    <thetext>Jayaprakash Nevara will be working on this</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23231</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-17 02:43:04 +0000</bug_when>
    <thetext>While trying to compile Python UEFI 3.6.8 with VS2022, got several compiler warnings from other components within the edk2-libc project. These warnings were leading to compilation failure as they were treated as errors.

There were issues observed in the following files:

AppPkg/Applications/Enquire/Enquire.c
AppPkg/Applications/OrderedCollectionTest/OrderedCollectionTest.c
AppPkg/Applications/Sockets/DataSource/DataSource.c
AppPkg/Applications/Sockets/OobRx/OobRx.c
AppPkg/Applications/Sockets/RawIp4Rx/RawIp4Rx.c
StdLib/BsdSocketLib/getnetbyht.c
StdLib/BsdSocketLib/ns_print.c
StdLib/EfiSocketLib/Socket.c

Fixed all these warnings treated as errors to get the Python UEFI compiled with VS2022.
Submitting a patch with the changes for review and merger</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23232</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-17 03:01:22 +0000</bug_when>
    <thetext>Patch sent for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23243</commentid>
    <comment_count>4</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-17 23:53:00 +0000</bug_when>
    <thetext>The patch sent for review fixes all these errors observed while compiling Python UEFI with VS2022 compiler.

AppPkg\Applications\Enquire\Enquire.c(921): error C2220: the following warning is treated as an error
AppPkg\Applications\Enquire\Enquire.c(921): warning C4459: declaration of &apos;bugs&apos; hides global declaration
AppPkg\Applications\Enquire\Enquire.c(762): note: see declaration of &apos;bugs&apos;
AppPkg\Applications\Enquire\Enquire.c(1930): warning C4456: declaration of &apos;char_max&apos; hides previous local declaration
AppPkg\Applications\Enquire\Enquire.c(1848): note: see declaration of &apos;char_max&apos;
AppPkg\Applications\Enquire\Enquire.c(1952): warning C4456: declaration of &apos;char_max&apos; hides previous local declaration
AppPkg\Applications\Enquire\Enquire.c(1848): note: see declaration of &apos;char_max&apos;
AppPkg\Applications\Enquire\Enquire.c(1952): warning C4456: declaration of &apos;char_min&apos; hides previous local declaration
AppPkg\Applications\Enquire\Enquire.c(1848): note: see declaration of &apos;char_min&apos;


AppPkg\Applications\OrderedCollectionTest\OrderedCollectionTest.c(461): error C2220: the following warning is treated as an error
AppPkg\Applications\OrderedCollectionTest\OrderedCollectionTest.c(461): warning C4476: &apos;fprintf&apos; : unknown type field character &apos;$&apos; in format specifier
AppPkg\Applications\OrderedCollectionTest\OrderedCollectionTest.c(472): warning C4474: &apos;fprintf&apos; : too many arguments passed for format string
AppPkg\Applications\OrderedCollectionTest\OrderedCollectionTest.c(472): note: placeholders and their parameters expect 0 variadic arguments, but 1 were provided


StdLib\BsdSocketLib\getnetbyht.c(158): error C2220: the following warning is treated as an error
StdLib\BsdSocketLib\getnetbyht.c(158): warning C4459: declaration of &apos;net&apos; hides global declaration
StdLib\BsdSocketLib\getnetbyht.c(63): note: see declaration of &apos;net&apos;
Ip6Addr_LinkLocal_AllRouters.c
StdLib\EfiSocketLib\Socket.c(573): error C2220: the following warning is treated as an error
StdLib\EfiSocketLib\Socket.c(573): warning C4459: declaration of &apos;errno&apos; hides global declaration
StdLib\Include\errno.h(43): note: see declaration of &apos;errno&apos;
StdLib\EfiSocketLib\Socket.c(1337): warning C4459: declaration of &apos;errno&apos; hides global declaration
StdLib\Include\errno.h(43): note: see declaration of &apos;errno&apos;
StdLib\EfiSocketLib\Socket.c(1480): warning C4459: declaration of &apos;errno&apos; hides global declaration
StdLib\Include\errno.h(43): note: see declaration of &apos;errno&apos;
StdLib\EfiSocketLib\Socket.c(1892): warning C4459: declaration of &apos;errno&apos; hides global declaration
StdLib\Include\errno.h(43): note: see declaration of &apos;errno&apos;
StdLib\EfiSocketLib\Socket.c(2754): warning C4459: declaration of &apos;errno&apos; hides global declaration
StdLib\Include\errno.h(43): note: see declaration of &apos;errno&apos;
StdLib\EfiSocketLib\Socket.c(2974): warning C4459: declaration of &apos;errno&apos; hides global declaration
StdLib\Include\errno.h(43): note: see declaration of &apos;errno&apos;
res_mkquery.c


AppPkg\Applications\Sockets\DataSource\DataSource.c(541): error C2220: the following warning is treated as an error
AppPkg\Applications\Sockets\DataSource\DataSource.c(541): warning C4459: declaration of &apos;BytesSent&apos; hides global declaration
AppPkg\Applications\Sockets\DataSource\DataSource.c(85): note: see declaration of &apos;BytesSent&apos;


AppPkg\Applications\Sockets\OobRx\OobRx.c(153): error C2220: the following warning is treated as an error
AppPkg\Applications\Sockets\OobRx\OobRx.c(153): warning C4475: &apos;printf&apos; : length modifier &apos;L&apos; cannot be used with type field character &apos;d&apos; in format specifier
AppPkg\Applications\Sockets\OobRx\OobRx.c(186): warning C4475: &apos;printf&apos; : length modifier &apos;L&apos; cannot be used with type field character &apos;d&apos; in format specifier

AppPkg\Applications\Sockets\RawIp4Rx\RawIp4Rx.c(160): error C2220: the following warning is treated as an error
AppPkg\Applications\Sockets\RawIp4Rx\RawIp4Rx.c(160): warning C4475: &apos;printf&apos; : length modifier &apos;L&apos; cannot be used with type field character &apos;d&apos; in format specifier</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23244</commentid>
    <comment_count>5</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-18 00:00:51 +0000</bug_when>
    <thetext>This is another file where we observed the issues 
StdLib\BsdSocketLib\ns_print.c(214): error C2220: the following warning is treated as an error
StdLib\BsdSocketLib\ns_print.c(214): warning C4456: declaration of &apos;t&apos; hides previous local declaration
StdLib\BsdSocketLib\ns_print.c(145): note: see declaration of &apos;t&apos;
StdLib\BsdSocketLib\ns_print.c(279): warning C4456: declaration of &apos;t&apos; hides previous local declaration
StdLib\BsdSocketLib\ns_print.c(145): note: see declaration of &apos;t&apos;
StdLib\BsdSocketLib\ns_print.c(297): warning C4456: declaration of &apos;t&apos; hides previous local declaration
StdLib\BsdSocketLib\ns_print.c(145): note: see declaration of &apos;t&apos;
StdLib\BsdSocketLib\ns_print.c(506): warning C4457: declaration of &apos;type&apos; hides function parameter
StdLib\BsdSocketLib\ns_print.c(130): note: see declaration of &apos;type&apos;
StdLib\BsdSocketLib\ns_print.c(508): warning C4456: declaration of &apos;t&apos; hides previous local declaration
StdLib\BsdSocketLib\ns_print.c(145): note: see declaration of &apos;t&apos;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23248</commentid>
    <comment_count>6</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-07-22 02:18:30 +0000</bug_when>
    <thetext>Patch review completed and the changes merged to master branch through the following commit id
commit fefde4a00028233c5ad8f172135d63a3cf51a6bd</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4035</bug_id>
          
          <creation_ts>2022-08-26 04:21:08 +0000</creation_ts>
          <short_desc>BaseTools: 64bit FSP FV map file cannot be created correctly when using CLANG compiler</short_desc>
          <delta_ts>2022-09-21 04:57:46 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>ted.kuo</reporter>
          <assigned_to>ted.kuo</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>lee.m.hamel</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19441</commentid>
    <comment_count>0</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2022-08-26 04:21:08 +0000</bug_when>
    <thetext>64bit FSP FV map file cannot be created correctly when using CLAGN compiler. It results in failing to patch FSP binary when needed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19490</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-06 21:50:56 +0000</bug_when>
    <thetext>Ted: please take it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19604</commentid>
    <comment_count>2</comment_count>
    <who name="">ted.kuo</who>
    <bug_when>2022-09-21 04:57:46 +0000</bug_when>
    <thetext>SHA-1: 45297e6c9bd1be53b3c462adb9b37b4df2ea8681

* BaseTools: 64bit FSP FV map file cannot be created correctly

https://bugzilla.tianocore.org/show_bug.cgi?id=4035
64bit FSP FV map file cannot be created correctly when using CLANG
compiler. When compiling 64bit FSP with CLANG, there is no prefix
symbol &apos;_&apos; added to function name. Hence FSP FV map file cannot be
created properly. Updated the if condition for CLANG in GenFv to
get the issue fixed.

Cc: Bob Feng &lt;bob.c.feng@intel.com&gt;
Cc: Liming Gao &lt;gaoliming@byosoft.com.cn&gt;
Cc: Yuwei Chen &lt;yuwei.chen@intel.com&gt;
Cc: Lee Hamel &lt;lee.m.hamel@intel.com&gt;
Signed-off-by: Ted Kuo &lt;ted.kuo@intel.com&gt;
Reviewed-by: Bob Feng &lt;bob.c.feng@intel.com&gt;</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4659</bug_id>
          
          <creation_ts>2024-01-26 20:22:43 +0000</creation_ts>
          <short_desc>DXE Core system time runs faster than expected when using PcAtChipsetPkg/HpetTimerDxe</short_desc>
          <delta_ts>2024-01-29 14:59:37 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michael Kinney">michael.d.kinney</reporter>
          <assigned_to name="Michael Kinney">michael.d.kinney</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>ray.ni</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>PcAtChipsetPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22426</commentid>
    <comment_count>0</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-26 20:22:43 +0000</bug_when>
    <thetext>If the HPET timer is used in a platform as the timer interrupt source
for the Timer Architectural Protocol, the DXE Core system time sometimes
runs faster than expected.

This condition occurs when there are periodic events at TPL_CALLBACK
and or TPL_NOTIFY that execute for longer periods of time than the DXE Core
timer rate that is set in the Timer Architectural Protocol.

This condition is not observed when a Local APIC timer is used instead 
of the HPET timer.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22427</commentid>
    <comment_count>1</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-26 20:23:15 +0000</bug_when>
    <thetext>Assign to owner</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22428</commentid>
    <comment_count>2</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-27 02:31:29 +0000</bug_when>
    <thetext>
* Branch:
 
  https://github.com/mdkinney/edk2/tree/Bug_4659_PcAtChipsetPkg_HpetTimerDxe_TestApp

  * Update DXE Core to detect nested timer interrupts and count the number timer
    interrupts received at each nesting level and log the counts every 100 timer
    ticks using DEBUG().
  * Adds options to OvmfPkg for X64 to build with either the LOCAL_APIC or HPET
    timer driver
  * Mounts the FV as a file system to allow Shell command to run from Shell
  * Adds PeriodicTimer Shell Application

      PeriodicTimers -t TIME [-p callback|notify PERIOD_MS STALL_MS]*
      -t TIME
                      Total time in seconds to run the test.
      -p [callback|notify] TIMER_PERIOD_MS TIMER_STALL_MS
                      Specifies the configuration of a periodic timer event
                      with a TPL level of either notify or callback, the period
                      of the timer event in milliseconds, and the amount of
                      time to stall in the periodic timer event notification
                      fuction in milliseconds.  0 to 10 periodic timers can be
                      specified.

* Build OvmfPkg X64 with HPET timer driver

  build -a X64 -t VS2019 -p OvmfPkg\OvmfPkgX64.dsc -D SMM_REQUIRE -D DEBUG_ON_SERIAL_PORT -D TIMER=HPET

* Boot OvmfPkg X64 with HPET timer driver

  qemu-system-x86_64.exe ^
  -machine q35,smm=on ^
  -accel tcg,thread=single ^
  -cpu Nehalem ^
  -global ICH9-LPC.disable_s3=1 ^
  -drive if=pflash,format=raw,unit=0,file=%WORKSPACE%\Build\OvmfX64\DEBUG_VS2019\FV\OVMF_CODE.fd,readonly=on ^
  -drive if=pflash,format=raw,unit=1,file=%WORKSPACE%\Build\OvmfX64\DEBUG_VS2019\FV\OVMF_VARS.fd,readonly=off ^
  -serial stdio ^
  -net none

* Run PeriodicTimers for 10 seconds with one periodic timer at TPL_CALLBACK with
  a period of 40 ms and a 0 ms stall each time the timer event is dispatched and
  a second periodic timer at TPL_NOTIFY with a period of 20 ms and a 0 ms stall
  each time the timer event is dispatched.

  FS0:\&gt; PeriodicTimers.efi -t 10 -p callback 40 10 -p notify 20 5

    System timer period = 100000 (100 ns units) or 10 ms
    10 second timer started: RTC[07:13:49]
    CoreTimerTick: NumTicks =   1800  DepthCounter[  1800]
    CoreTimerTick: NumTicks =   1900  DepthCounter[  1900]
    CoreTimerTick: NumTicks =   2000  DepthCounter[  2000]
    CoreTimerTick: NumTicks =   2100  DepthCounter[  2100]
    CoreTimerTick: NumTicks =   2200  DepthCounter[  2200]
    CoreTimerTick: NumTicks =   2300  DepthCounter[  2300]
    CoreTimerTick: NumTicks =   2400  DepthCounter[  2400]
    CoreTimerTick: NumTicks =   2500  DepthCounter[  2500]
    CoreTimerTick: NumTicks =   2600  DepthCounter[  2600]
    CoreTimerTick: NumTicks =   2700  DepthCounter[  2700]
    10 second timer finished: RTC[07:13:59]
    Timer[0] Notification Count = 250
    Timer[1] Notification Count = 483
      Expected time in seconds from RTC = 10
      Elapsed time in seconds from RTC  = 10
      Expected time in ns = 10000000000
      Elapsed time in ns  = 10000865752

  This shows the expected execution time of 10 seconds from both the RTC and
  performance counters and the expected number of timer event notifications.
  The CoreTimerTick() also shows no nesting of interrupts with all interrupts
  occurring at the first level.

* Run PeriodicTimers for 10 seconds with one periodic timer at TPL_CALLBACK with
  a period of 40 ms and a 10 ms stall each time the timer event is dispatched
  and a second periodic timer at TPL_NOTIFY with a period of 20 ms and a 5 ms
  stall each time the timer event is dispatched.

  FS0:\&gt; PeriodicTimers.efi -t 10 -p callback 40 8 -p notify 20 4

    System timer period = 100000 (100 ns units) or 10 ms
    10 second timer started: RTC[07:14:12]
    CoreTimerTick: NumTicks =   4000  DepthCounter[  3979    19     2]
    CoreTimerTick: NumTicks =   4100  DepthCounter[  4022    66    12]
    CoreTimerTick: NumTicks =   4200  DepthCounter[  4069   112    19]
    CoreTimerTick: NumTicks =   4300  DepthCounter[  4117   155    28]
    CoreTimerTick: NumTicks =   4400  DepthCounter[  4162   199    39]
    10 second timer finished: RTC[07:14:16]
    Timer[0] Notification Count = 217
    Timer[1] Notification Count = 346
      Expected time in seconds from RTC = 10
      Elapsed time in seconds from RTC  = 4
      Expected time in ns = 10000000000
      Elapsed time in ns  = 4442507078

  This shows an unexpected execution time of 4 seconds from both the RTC and
  performance counters and an expected fewer number of timer event
  notifications due to the stalls.  The CoreTimerTick() now shows nesting of
  interrupts to 3 levels. This clearly demonstrates that the HPET timer nests
  interrupts when event notification function execute for an extended period
  of time and that the DXE Core internal time runs faster than expected when
  HPET nested interrupts are induced.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22429</commentid>
    <comment_count>3</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-27 02:37:16 +0000</bug_when>
    <thetext>The following is a trace of timer interrupts through the HPET
timer driver.  Starting with no nesting and then showing a single
nest level and how the TimerPeriod passed to the DXE Core are
incorrect.

NOTE: This trace assumes HPET counter runs at a rate of 1 count
      every 100ns.

UEFI Shell (TPL_APPLICATION)
  UEFI Shell Application (TPL_APPLICATION)
    mEfiSystemTime                                                     5,000,000  CORRECT
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                10,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  20,000
      Delta = MainCounter - mPreviousMainCounter;                         10,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            10,000 (1ms)
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 10,000)
        mEfiSystemTime += Duration;                                    5,010,000  CORRECT
      mPreviousMainCounter = MainCounter;                                 20,000
    mEfiSystemTime                                                     5,010,000  CORRECT
    . . .
    mEfiSystemTime                                                     5,010,000  CORRECT
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                20,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  30,000
      Delta = MainCounter - mPreviousMainCounter;                         10,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            10,000 (1ms)
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 10,000)
        mEfiSystemTime += Duration;                                    5,020,000  CORRECT
      mPreviousMainCounter = MainCounter;                                 30,000
    mEfiSystemTime                                                     5,020,000  CORRECT
    . . .
    mEfiSystemTime                                                     5,020,000  CORRECT
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                30,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  40,000
      Delta = MainCounter - mPreviousMainCounter;                         10,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            10,000 (1ms)
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 10,000)
        mEfiSystemTime += Duration;                                    5,030,000  CORRECT
          *** HPET Timer Interrupt (Nest Level 2)
          HpetTimerDxe: TimerInterruptHandler()
            mPreviousMainCounter                                          30,000 
            MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);            50,000
            Delta = MainCounter - mPreviousMainCounter;                   20,000
            TimerPeriod = ConvertTo100nsUnits(Delta)                      20,000 (2ms)
            mTimerNotifyFunction (TimerPeriod);
              DxeMain: CoreTimerTick(Duration = 20,000)
              mEfiSystemTime += Duration;                              5,050,000  NOT CORRECT.  Should be 5,040,000
            mPreviousMainCounter = MainCounter;                           50,000
          mEfiSystemTime                                               5,050,000  NOT CORRECT.  Should be 5,040,000
      mPreviousMainCounter = MainCounter;                                 40,000  Went backwards  &lt;--- Bug 
    mEfiSystemTime                                                     5,050,000  NOT CORRECT.  Should be 5,040,000
    . . .
    mEfiSystemTime                                                     5,050,000  NOT CORRECT.  Should be 5,040,000
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                40,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  60,000
      Delta = MainCounter - mPreviousMainCounter;                         20,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            20,000 (2ms)
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 20,000)
        mEfiSystemTime += Duration;                                    5,070,000  NOT CORRECT.  Should be 5,050,000
      mPreviousMainCounter = MainCounter;                                 60,000
    mEfiSystemTime                                                     5,070,000  NOT CORRECT.  Should be 5,050,000
    . . .
    mEfiSystemTime                                                     5,070,000  NOT CORRECT.  Should be 5,050,000
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                60,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  70,000
      Delta = MainCounter - mPreviousMainCounter;                         10,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            10,000 (1ms)
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 10,000)
        mEfiSystemTime += Duration;                                    5,080,000  NOT CORRECT.  Should be 5,060,000
      mPreviousMainCounter = MainCounter;                                 70,000
    mEfiSystemTime                                                     5,080,000  NOT CORRECT.  Should be 5,060,000


After 1 nesting, takes 2 timer ticks for system time to go back to increasing by
correct amount each addition timer tick.

One nested interrupt causes 2 extra timer ticks of time to be added to 
mEfiSystemTime, so the DXE Core sense of time is running faster than the 
HPET main counter indicates.

The nested interrupt case shows where mPreviousMainCounter is assigned a value 
that goes backwards.  This is because mPreviousMainCounter is updated after the
notification function is called and the notification function allows nesting
into the HPET interrupt handler again.

The correct fix is to assign mPreviousMainCounter before calling the
notification function, so in the case a nested interrupt occurs, 
mPreviousMainCounter has the correct value.

Trace the same sequence of events moving the assignment of mPreviousMainCounter
before calling the notification.

UEFI Shell (TPL_APPLICATION)
  UEFI Shell Application (TPL_APPLICATION)
    mEfiSystemTime                                                     5,000,000  CORRECT
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                10,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  20,000
      Delta = MainCounter - mPreviousMainCounter;                         10,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            10,000 (1ms)
      mPreviousMainCounter = MainCounter;                                 20,000  &lt;-- Moved
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 10,000)
        mEfiSystemTime += Duration;                                    5,010,000  CORRECT
    mEfiSystemTime                                                     5,010,000  CORRECT
    . . .
    mEfiSystemTime                                                     5,010,000  CORRECT
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                20,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  30,000
      Delta = MainCounter - mPreviousMainCounter;                         10,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            10,000 (1ms)
      mPreviousMainCounter = MainCounter;                                 30,000 &lt;-- Moved
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 10,000)
        mEfiSystemTime += Duration;                                    5,020,000  CORRECT
    mEfiSystemTime                                                     5,020,000  CORRECT
    . . .
    mEfiSystemTime                                                     5,020,000  CORRECT
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                30,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  40,000
      Delta = MainCounter - mPreviousMainCounter;                         10,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            10,000 (1ms)
      mPreviousMainCounter = MainCounter;                                 40,000  &lt;-- Moved
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 10,000)
        mEfiSystemTime += Duration;                                    5,030,000  CORRECT
          *** HPET Timer Interrupt (Nest Level 2)
          HpetTimerDxe: TimerInterruptHandler()
            mPreviousMainCounter                                          40,000 
            MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);            50,000
            Delta = MainCounter - mPreviousMainCounter;                   10,000
            TimerPeriod = ConvertTo100nsUnits(Delta)                      10,000 (1ms)
            mPreviousMainCounter = MainCounter;                           50,000 &lt;-- Moved
            mTimerNotifyFunction (TimerPeriod);
              DxeMain: CoreTimerTick(Duration = 10,000)
              mEfiSystemTime += Duration;                              5,040,000  CORRECT
          mEfiSystemTime                                               5,040,000  CORRECT
    mEfiSystemTime                                                     5,040,000  CORRECT
    . . .
    mEfiSystemTime                                                     5,040,000  CORRECT
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                50,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  60,000
      Delta = MainCounter - mPreviousMainCounter;                         10,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            10,000 (1ms)
      mPreviousMainCounter = MainCounter;                                 60,000 &lt;-- Moved
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 10,000)
        mEfiSystemTime += Duration;                                    5,050,000  CORRECT
    mEfiSystemTime                                                     5,050,000  CORRECT
    . . .
    mEfiSystemTime                                                     5,050,000  CORRECT
    *** HPET Timer Interrupt (Nest Level 1)
    HpetTimerDxe: TimerInterruptHandler()
      mPreviousMainCounter                                                60,000          
      MainCounter = HpetRead (HPET_MAIN_COUNTER_OFFSET);                  70,000
      Delta = MainCounter - mPreviousMainCounter;                         10,000
      TimerPeriod = ConvertTo100nsUnits(Delta)                            10,000 (1ms)
      mPreviousMainCounter = MainCounter;                                 70,000 &lt;-- Moved
      mTimerNotifyFunction (TimerPeriod);
        DxeMain: CoreTimerTick(Duration = 10,000)
        mEfiSystemTime += Duration;                                    5,060,000  CORRECT
    mEfiSystemTime                                                     5,060,000  CORRECT

This trace shows that a logic bug in the HpetTimerDxe causes the
DXE Core time to be incorrect and correcting the logic bug should
fix the DXE Core time.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22430</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-27 02:40:42 +0000</bug_when>
    <thetext>Current code updates mPreviousMainCounter after
calling mTimerNotifyFunction().

    TimerPeriod = DivU64x32 (
                    MultU64x32 (
                      Delta &amp; mCounterMask,
                      mHpetGeneralCapabilities.Bits.CounterClockPeriod
                      ),
                    100000000
                    );

    //
    // Call registered notification function passing in the time since the last
    // interrupt in 100 ns units.
    //
    mTimerNotifyFunction (TimerPeriod);
  }

  //
  // Save main counter value
  //
  mPreviousMainCounter = MainCounter;
}

Proposed change updates mPreviousMainCounter before
calling mTimerNotifyFunction() and returns immediatly
after mTimerNotifyFunction() returns.

    TimerPeriod = DivU64x32 (
                    MultU64x32 (
                      Delta &amp; mCounterMask,
                      mHpetGeneralCapabilities.Bits.CounterClockPeriod
                      ),
                    100000000
                    );

    //
    // Save main counter value before calling notification function
    // that may enable interrupts and allow interrupt nesting.
    //
    mPreviousMainCounter = MainCounter;

    //
    // Call registered notification function passing in the time since the last
    // interrupt in 100 ns units.
    //
    mTimerNotifyFunction (TimerPeriod);
    return;
  }

  //
  // Save main counter value
  //
  mPreviousMainCounter = MainCounter;
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22431</commentid>
    <comment_count>5</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-27 02:52:54 +0000</bug_when>
    <thetext>* Branch:

https://github.com/mdkinney/edk2/tree/Bug_4659_PcAtChipsetPkg_HpetTimerDxe_TestAppWithFix

  * HpetTimerDxe: Move update of mPreviousMainCounter before mTimerNotifyFunction().
  * Update DXE Core to detect nested timer interrupts and count the number timer
    interrupts received at each nesting level and log the counts every 100 timer
    ticks using DEBUG().
  * Adds options to OvmfPkg for X64 to build with either the LOCAL_APIC or HPET
    timer driver
  * Mounts the FV as a file system to allow Shell command to run from Shell
  * Adds PeriodicTimer Shell Application

      PeriodicTimers -t TIME [-p callback|notify PERIOD_MS STALL_MS]*
      -t TIME
                      Total time in seconds to run the test.
      -p [callback|notify] TIMER_PERIOD_MS TIMER_STALL_MS
                      Specifies the configuration of a periodic timer event
                      with a TPL level of either notify or callback, the period
                      of the timer event in milliseconds, and the amount of
                      time to stall in the periodic timer event notification
                      fuction in milliseconds.  0 to 10 periodic timers can be
                      specified.

* Build OvmfPkg X64 with HPET timer driver

  build -a X64 -t VS2019 -p OvmfPkg\OvmfPkgX64.dsc -D SMM_REQUIRE -D DEBUG_ON_SERIAL_PORT -D TIMER=HPET

* Boot OvmfPkg X64 with HPET timer driver

  qemu-system-x86_64.exe ^
  -machine q35,smm=on ^
  -accel tcg,thread=single ^
  -cpu Nehalem ^
  -global ICH9-LPC.disable_s3=1 ^
  -drive if=pflash,format=raw,unit=0,file=%WORKSPACE%\Build\OvmfX64\DEBUG_VS2019\FV\OVMF_CODE.fd,readonly=on ^
  -drive if=pflash,format=raw,unit=1,file=%WORKSPACE%\Build\OvmfX64\DEBUG_VS2019\FV\OVMF_VARS.fd,readonly=off ^
  -serial stdio ^
  -net none

* Run PeriodicTimers for 10 seconds with one periodic timer at TPL_CALLBACK with
  a period of 40 ms and a 0 ms stall each time the timer event is dispatched and
  a second periodic timer at TPL_NOTIFY with a period of 20 ms and a 0 ms stall
  each time the timer event is dispatched.

  FS0:\&gt; PeriodicTimers.efi -t 10 -p callback 40 0 -p notify 20 0

    System timer period = 100000 (100 ns units) or 10 ms
    10 second timer started: RTC[07:48:08]
    CoreTimerTick: NumTicks =   1600  DepthCounter[  1600]
    CoreTimerTick: NumTicks =   1700  DepthCounter[  1700]
    CoreTimerTick: NumTicks =   1800  DepthCounter[  1800]
    CoreTimerTick: NumTicks =   1900  DepthCounter[  1900]
    CoreTimerTick: NumTicks =   2000  DepthCounter[  2000]
    CoreTimerTick: NumTicks =   2100  DepthCounter[  2100]
    CoreTimerTick: NumTicks =   2200  DepthCounter[  2200]
    CoreTimerTick: NumTicks =   2300  DepthCounter[  2300]
    CoreTimerTick: NumTicks =   2400  DepthCounter[  2400]
    CoreTimerTick: NumTicks =   2500  DepthCounter[  2500]
    10 second timer finished: RTC[07:48:18]
    Timer[0] Notification Count = 249
    Timer[1] Notification Count = 480
      Expected time in seconds from RTC = 10
      Elapsed time in seconds from RTC  = 10
      Expected time in ns = 10000000000
      Elapsed time in ns  = 9993814297

  This shows the expected execution time of 10 seconds from both the RTC and
  performance counters and the expected number of timer event notifications.
  The CoreTimerTick() also shows no nesting of interrupts with all interrupts
  occurring at the first level.

* Run PeriodicTimers for 10 seconds with one periodic timer at TPL_CALLBACK with
  a period of 40 ms and a 8 ms stall each time the timer event is dispatched
  and a second periodic timer at TPL_NOTIFY with a period of 20 ms and a 4 ms
  stall each time the timer event is dispatched.

  FS0:\&gt; PeriodicTimers.efi -t 10 -p callback 40 8 -p notify 20 4

    System timer period = 100000 (100 ns units) or 10 ms
    10 second timer started: RTC[07:46:19]
    CoreTimerTick: NumTicks =   3300  DepthCounter[  3264    34     2]
    CoreTimerTick: NumTicks =   3400  DepthCounter[  3336    61     3]
    CoreTimerTick: NumTicks =   3500  DepthCounter[  3400    93     7]
    CoreTimerTick: NumTicks =   3600  DepthCounter[  3462   128    10]
    CoreTimerTick: NumTicks =   3700  DepthCounter[  3529   159    12]
    CoreTimerTick: NumTicks =   3800  DepthCounter[  3588   196    16]
    CoreTimerTick: NumTicks =   3900  DepthCounter[  3656   227    17]
    CoreTimerTick: NumTicks =   4000  DepthCounter[  3725   256    19]
    CoreTimerTick: NumTicks =   4100  DepthCounter[  3787   293    20]
    CoreTimerTick: NumTicks =   4200  DepthCounter[  3861   317    22]
    10 second timer finished: RTC[07:46:29]
    Timer[0] Notification Count = 250
    Timer[1] Notification Count = 488
      Expected time in seconds from RTC = 10
      Elapsed time in seconds from RTC  = 10
      Expected time in ns = 10000000000
      Elapsed time in ns  = 10000743111

  This shows the expected execution time of 10 seconds from both the RTC and
  performance counters and the expected number of timer event notifications.
  The CoreTimerTick() now shows nesting of interrupts to 3 levels.  This clearly
  demonstrates that the HPET timer nests interrupts when event notification
  function execute for an extended period of time and that the DXE Core internal
  time is now matches the expected time with the logic fix to HpetTimerDxe.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22432</commentid>
    <comment_count>6</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-27 03:02:28 +0000</bug_when>
    <thetext>Code review email: https://edk2.groups.io/g/devel/message/114648

PR: https://github.com/tianocore/edk2/pull/5309</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22437</commentid>
    <comment_count>7</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-29 12:52:55 +0000</bug_when>
    <thetext>(In reply to Michael Kinney from comment #2)
&gt; * Branch:
&gt;  
&gt;  
&gt; https://github.com/mdkinney/edk2/tree/
&gt; Bug_4659_PcAtChipsetPkg_HpetTimerDxe_TestApp
&gt; 
&gt;   * Update DXE Core to detect nested timer interrupts and count the number
&gt; timer
&gt;     interrupts received at each nesting level and log the counts every 100
&gt; timer
&gt;     ticks using DEBUG().
&gt;   * Adds options to OvmfPkg for X64 to build with either the LOCAL_APIC or
&gt; HPET
&gt;     timer driver
&gt;   * Mounts the FV as a file system to allow Shell command to run from Shell
&gt;   * Adds PeriodicTimer Shell Application
&gt; 
&gt;       PeriodicTimers -t TIME [-p callback|notify PERIOD_MS STALL_MS]*
&gt;       -t TIME
&gt;                       Total time in seconds to run the test.
&gt;       -p [callback|notify] TIMER_PERIOD_MS TIMER_STALL_MS
&gt;                       Specifies the configuration of a periodic timer event
&gt;                       with a TPL level of either notify or callback, the
&gt; period
&gt;                       of the timer event in milliseconds, and the amount of
&gt;                       time to stall in the periodic timer event notification
&gt;                       fuction in milliseconds.  0 to 10 periodic timers can
&gt; be
&gt;                       specified.
&gt; 
&gt; * Build OvmfPkg X64 with HPET timer driver
&gt; 
&gt;   build -a X64 -t VS2019 -p OvmfPkg\OvmfPkgX64.dsc -D SMM_REQUIRE -D
&gt; DEBUG_ON_SERIAL_PORT -D TIMER=HPET
&gt; 
&gt; * Boot OvmfPkg X64 with HPET timer driver
&gt; 
&gt;   qemu-system-x86_64.exe ^
&gt;   -machine q35,smm=on ^
&gt;   -accel tcg,thread=single ^
&gt;   -cpu Nehalem ^
&gt;   -global ICH9-LPC.disable_s3=1 ^
&gt;   -drive
&gt; if=pflash,format=raw,unit=0,
&gt; file=%WORKSPACE%\Build\OvmfX64\DEBUG_VS2019\FV\OVMF_CODE.fd,readonly=on ^
&gt;   -drive
&gt; if=pflash,format=raw,unit=1,
&gt; file=%WORKSPACE%\Build\OvmfX64\DEBUG_VS2019\FV\OVMF_VARS.fd,readonly=off ^
&gt;   -serial stdio ^
&gt;   -net none
&gt; 
&gt; * Run PeriodicTimers for 10 seconds with one periodic timer at TPL_CALLBACK
&gt; with
&gt;   a period of 40 ms and a 0 ms stall each time the timer event is dispatched
&gt; and
&gt;   a second periodic timer at TPL_NOTIFY with a period of 20 ms and a 0 ms
&gt; stall
&gt;   each time the timer event is dispatched.
&gt; 
&gt;   FS0:\&gt; PeriodicTimers.efi -t 10 -p callback 40 10 -p notify 20 5
&gt; 

The shell command line shown in incorrect for 0 ms stall times. The
shell command run for the results shown is:

   FS0:\&gt; PeriodicTimers.efi -t 10 -p callback 40 0 -p notify 20 0</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22438</commentid>
    <comment_count>8</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-29 12:57:22 +0000</bug_when>
    <thetext>Another important data point is that OvmfPkg built with the LOCAL_APIC
timer driver always shows the expected time with many combinations of the 
PeriodicTimers shell application.  This helped support the direction that
a the issue was isolated to the HPET timer driver.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22439</commentid>
    <comment_count>9</comment_count>
    <who name="Michael Kinney">michael.d.kinney</who>
    <bug_when>2024-01-29 14:59:37 +0000</bug_when>
    <thetext>PR: 

https://github.com/tianocore/edk2/pull/5309

Commit:

https://github.com/tianocore/edk2/commit/a6013625a3d7d949571fdc2cc4fc5905f37a0023</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4509</bug_id>
          
          <creation_ts>2023-07-24 02:28:03 +0000</creation_ts>
          <short_desc>ASN1_get_object() return value not checked</short_desc>
          <delta_ts>2024-06-03 00:02:57 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>sountharyan</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>prarthanasv</cc>
    
    <cc>sountharyan</cc>
    
    <cc>srinivasanm</cc>
    
    <cc>yi1.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>edk2-stable202305</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>CryptoPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21765</commentid>
    <comment_count>0</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2023-07-24 02:28:03 +0000</bug_when>
    <thetext>In CryptoPkg, CryptX509.c file has X509GetTBSCert() funtion and it is added Inf variable to collect the return value of this ASN1_get_object().

  Inf    = ASN1_get_object (&amp;Temp, (long *)&amp;Length, (int *)&amp;Asn1Tag, (int *)&amp;ObjClass, (long)CertSize);

  if (((Inf &amp; 0x80) == 0x00) &amp;&amp; (Asn1Tag != V_ASN1_SEQUENCE)) {
    return FALSE;
  }

  *TBSCert = (UINT8 *)Temp;

Again, they are calling ASN1_get_object() function and return value is not collected through Inf variable. But the same Inf variable is used. We need to add and then verify the condition. 

  ASN1_get_object (&amp;Temp, (long *)&amp;Length, (int *)&amp;Asn1Tag, (int *)&amp;ObjClass, (long)Length);
  //
  // Verify the parsed TBSCertificate is one correct SEQUENCE data.
  //
  if (((Inf &amp; 0x80) == 0x00) &amp;&amp; (Asn1Tag != V_ASN1_SEQUENCE)) {
    return FALSE;
  }</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21843</commentid>
    <comment_count>1</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2023-08-22 04:31:16 +0000</bug_when>
    <thetext>Jiewen.yao@intel.com, osd@smith-denny.com

In CryptoPkg, X509GetTBSCert() has ASN1_get_object() and it returns (0x80) in error case and it is compared with (0x00). If ASN1_get_object() returns 0x80 it should returns FALSE, but here it is compared with (0x00) and if it returns 0x80 it is coming out of the condition and makes the function TRUE. Kindly provide your comments.

 Inf    = ASN1_get_object (&amp;Temp, (long *)&amp;Length, (int *)&amp;Asn1Tag, (int *)&amp;ObjClass, (long)CertSize);

  if (((Inf &amp; 0x80) == 0x00) &amp;&amp; (Asn1Tag != V_ASN1_SEQUENCE)) {
    return FALSE;
  }</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22734</commentid>
    <comment_count>2</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-03-06 03:17:52 +0000</bug_when>
    <thetext>Hi @emcmillan@microsoft.com, 
@mikuback@linux.microsoft.com,
@guomin.jiang@intel.com,
@jian.j.wang@intel.com,
@jiewen.yao@intel.com,
@xiaoyu1.lu@intel.com

I have below query in X509GetTBSCert(). Kindly provide your comments ASAP.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22769</commentid>
    <comment_count>3</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-11 01:01:22 +0000</bug_when>
    <thetext>Yes, this return value check looks wrong. Would you like to submit patch to the EDK2 community to fix it?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22771</commentid>
    <comment_count>4</comment_count>
      <attachid>1481</attachid>
    <who name="">sountharyan</who>
    <bug_when>2024-03-11 01:42:25 +0000</bug_when>
    <thetext>Created attachment 1481
Added and checked ASN1_get_object() return value.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22772</commentid>
    <comment_count>5</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-03-11 01:43:59 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

Yes, I would like submit patch to the EDK2 community to fix it. Here I have attached the patch in comment#4.

We have another below query,

X509GetTBSCert() has ASN1_get_object() and it returns (0x80) in error case and it is compared with (0x00). If ASN1_get_object() returns 0x80 it should returns FALSE, but here it is compared with (0x00) and if it returns 0x80 it is coming out of the condition and makes the function TRUE. Kindly provide your comments.

 Inf    = ASN1_get_object (&amp;Temp, (long *)&amp;Length, (int *)&amp;Asn1Tag, (int *)&amp;ObjClass, (long)CertSize);

  if (((Inf &amp; 0x80) == 0x00) &amp;&amp; (Asn1Tag != V_ASN1_SEQUENCE)) {
    return FALSE;
  }

Kindly provide your comments.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22773</commentid>
    <comment_count>6</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-03-11 02:05:50 +0000</bug_when>
    <thetext>I agree, this check should be 
if (((Inf &amp; 0x80) == 0x80) || (Asn1Tag != V_ASN1_SEQUENCE)), right?

Additional comments:
1. Using existing Inf is good enough, no need for a new var Ret.
2. It would be better if you could add the test case for discovering this issue to the CryptoPkg\Test\UnitTest\Library\BaseCryptLib\X509Tests.c.

And email your patch to Edk2 community when it ready. I don&apos;t know if you have EDK2 development background, if not please refer to this link: https://github.com/tianocore/tianocore.github.io/wiki/EDK-II-Development-Process</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22775</commentid>
    <comment_count>7</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-03-11 04:22:49 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

I agree, this check should be 
if (((Inf &amp; 0x80) == 0x80) || (Asn1Tag != V_ASN1_SEQUENCE)), right?

Yes.

Thanks for your comments.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22822</commentid>
    <comment_count>8</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-03-27 07:49:41 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

We shared the patch with the EDK2 community. Kindly review the patch.

https://edk2.groups.io/g/devel/topic/patch_cryptopkg/105019593?p=,,,20,0,0,0::recentpostdate/sticky,,,20,2,200,105019593,previd%3D1710838161786052782,nextid%3D1710803791888305560&amp;previd=1710838161786052782&amp;nextid=1710803791888305560

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22900</commentid>
    <comment_count>9</comment_count>
      <attachid>1489</attachid>
    <who name="">sountharyan</who>
    <bug_when>2024-04-10 06:53:20 +0000</bug_when>
    <thetext>Created attachment 1489
Added variable and checked ASN1_get_object() return value.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22901</commentid>
    <comment_count>10</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-10 06:54:32 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

Attached &quot;PATCH_V2&quot;.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22981</commentid>
    <comment_count>11</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-04-25 09:44:35 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

Can you include these changes in next EDK2 release.Kindly provide your comments ASAP.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22995</commentid>
    <comment_count>12</comment_count>
    <who name="">sountharyan</who>
    <bug_when>2024-05-02 04:59:27 +0000</bug_when>
    <thetext>Hi @yi1.li@intel.com,

Kindly provide your comments.

Thanks,
Sountharya</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23016</commentid>
    <comment_count>13</comment_count>
      <attachid>1503</attachid>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-05-08 04:39:15 +0000</bug_when>
    <thetext>Created attachment 1503
Patch email demo</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23017</commentid>
    <comment_count>14</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-05-08 04:39:41 +0000</bug_when>
    <thetext>Hi, not sure why I haven&apos;t received reminder emails from bugzilla for a long time.
I checked your V2 patch email but there are lots of format issue such as no commit title and message.

I cannot merge your patch because format issue will block edk2 github CI, please refer attached patch email to resend your patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23086</commentid>
    <comment_count>15</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2024-06-03 00:02:57 +0000</bug_when>
    <thetext>pushed: https://github.com/tianocore/edk2/commit/7c584bb04874bb5bad16fcf3996f5a893cc81a1c</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1481</attachid>
            <date>2024-03-11 01:42:25 +0000</date>
            <delta_ts>2024-03-11 01:42:25 +0000</delta_ts>
            <desc>Added and checked ASN1_get_object() return value.</desc>
            <filename>CryptoPkg.zip</filename>
            <type>application/zip</type>
            <size>19551</size>
            <attacher>sountharyan</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1489</attachid>
            <date>2024-04-10 06:53:20 +0000</date>
            <delta_ts>2024-04-10 06:53:20 +0000</delta_ts>
            <desc>Added variable and checked ASN1_get_object() return value.</desc>
            <filename>PATCH_V2.zip</filename>
            <type>application/zip</type>
            <size>19223</size>
            <attacher>sountharyan</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1503</attachid>
            <date>2024-05-08 04:39:15 +0000</date>
            <delta_ts>2024-05-08 04:39:15 +0000</delta_ts>
            <desc>Patch email demo</desc>
            <filename>PATCH v2 Add SHA3SM3 functions with openssl for Mbedtls.msg</filename>
            <type>application/octet-stream</type>
            <size>110080</size>
            <attacher name="yi1.li@intel.com">yi1.li</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4187</bug_id>
          
          <creation_ts>2022-12-08 03:47:51 +0000</creation_ts>
          <short_desc>Enable TDVF for Cloud Hypervisor to launch an Intel TDX guest</short_desc>
          <delta_ts>2023-02-02 01:29:44 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="mxu9">min.m.xu</reporter>
          <assigned_to name="mxu9">min.m.xu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>jiewen.yao</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>OvmfPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20197</commentid>
    <comment_count>0</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2022-12-08 03:47:51 +0000</bug_when>
    <thetext>Cloud Hypervisor is a Virtual Machine Monitor that runs on top of KVM. https://github.com/cloud-hypervisor/cloud-hypervisor

Cloud Hypervisor now can launch a legacy guest with the help of OvmfPkg/CloudHv. But it cannot launch an Intel TDX guest.

Current TDVF supports QEMU/KVM to launch an Intel TDX guest. But it cannot be launched by Cloud Hypervisor.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20198</commentid>
    <comment_count>1</comment_count>
    <who name="">jiewen.yao</who>
    <bug_when>2022-12-08 04:04:39 +0000</bug_when>
    <thetext>Please describe the detail on what need to be supported.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20240</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-12-20 21:51:15 +0000</bug_when>
    <thetext>Min: please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20988</commentid>
    <comment_count>3</comment_count>
    <who name="mxu9">min.m.xu</who>
    <bug_when>2023-02-02 01:29:44 +0000</bug_when>
    <thetext>This is resolved.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4062</bug_id>
          
          <creation_ts>2022-09-15 02:13:02 +0000</creation_ts>
          <short_desc>Describing Hot Pluggable Memory</short_desc>
          <delta_ts>2023-04-30 10:02:59 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Code First</product>
          <component>Specification Update</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Thanunathan Rangarajan">thanu.rangarajan</reporter>
          <assigned_to name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>Jose.Marinho</cc>
    
    <cc>leo.duran</cc>
    
    <cc>michael.a.rothman</cc>
    
    <cc>samer.el-haj-mahmoud</cc>
    
    <cc>scolee</cc>
    
    <cc>thanu.rangarajan</cc>
          
          <cf_industrystandardspecifications>ACPI Specification</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          
          <cf_target_os>---</cf_target_os>
          
          
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19568</commentid>
    <comment_count>0</comment_count>
      <attachid>1024</attachid>
    <who name="Thanunathan Rangarajan">thanu.rangarajan</who>
    <bug_when>2022-09-15 02:13:02 +0000</bug_when>
    <thetext>Created attachment 1024
Code-first SPM in SRAT

This ECR is related to a proposal to extend the ACPI SRAT to support hot-adding memory that is intended for specific-purpose usage, aka specific-purpose memory (SPM). The UEFI specification defines a memory attribute (EFI_MEMORY_SP) for describing SPM that is present and available at boot time. However, this attribute does not cover scenarios where the memory is unavailable/absent at boot time, and then hot-added physically or logically at runtime, and then used as SPM. Such dynamically added memory cannot be described in the EFI memory map and must be declared in the ACPI SRAT or HMAT tables instead. This ECR proposes that the SPM attribute be extended to the SRAT table.

An OS that is aware of this SRAT attribute is thus able to assign the hot-added memory to the correct memory pool - SPM or conventional memory (general-purpose).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19651</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:20:10 +0000</bug_when>
    <thetext>thanu.rangarajan@arm.com, please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19652</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-09-27 22:20:18 +0000</bug_when>
    <thetext>thanu.rangarajan@arm.com, please work on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19683</commentid>
    <comment_count>3</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2022-09-30 08:12:46 +0000</bug_when>
    <thetext>ASWG mantis ECR: https://mantis.uefi.org/mantis/view.php?id=2354</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19772</commentid>
    <comment_count>4</comment_count>
      <attachid>1037</attachid>
    <who name="Thanunathan Rangarajan">thanu.rangarajan</who>
    <bug_when>2022-10-13 11:53:41 +0000</bug_when>
    <thetext>Created attachment 1037
Code-first - Hot Pluggable Memory Description</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19791</commentid>
    <comment_count>5</comment_count>
      <attachid>1038</attachid>
    <who name="Thanunathan Rangarajan">thanu.rangarajan</who>
    <bug_when>2022-10-19 10:51:43 +0000</bug_when>
    <thetext>Created attachment 1038
Code-first - Hot Pluggable Memory Description ECR v.0.65</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19792</commentid>
    <comment_count>6</comment_count>
    <who name="Michael A. Rothman">michael.a.rothman</who>
    <bug_when>2022-10-19 13:35:04 +0000</bug_when>
    <thetext>I agree with Proposal 1 in the latest attachment (0.65), but wouldn&apos;t it make sense to add a reference to SRAT? I&apos;d propose something akin to this (based on the latest 0.65 update):


9.x.1 Hot-plug Indication (Proposal 1)

If the memory device is created for the purpose of describing hot-pluggable memory, it must always carry the _STA, as well as either _EJ0 or _OST methods, or both. OS can use the presence of these methods as an indication that the memory range is hot-pluggable. In addition, there must be a matching memory affinity structure in the SRAT table that has the Hot-pluggable flag set. The expression for confirming hot-pluggable property is as follows:

Is Hot-pluggable = _STA &amp;&amp; (EJ0 || OST);



----

Also, in the SRAT section, Table 5.59 &quot;Flags - Memory Affinity Structure&quot; I would add a reference in the &quot;Hot Pluggable&quot; field description pointing back to 9.x.1 to further enforce the requirements associated with representing hot-pluggable memory.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19794</commentid>
    <comment_count>7</comment_count>
    <who name="Thanunathan Rangarajan">thanu.rangarajan</who>
    <bug_when>2022-10-20 02:11:29 +0000</bug_when>
    <thetext>@Mike: thanks for the feedback. The SRAT is mentioned in section 9.x.2, titled Proximity Domains, but your suggested alternative is much better.

Also fixed some minor typos (e.g., _EJ0 instead of EJ0).

Updated ECR (v.0.7) attached for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19795</commentid>
    <comment_count>8</comment_count>
      <attachid>1039</attachid>
    <who name="Thanunathan Rangarajan">thanu.rangarajan</who>
    <bug_when>2022-10-20 02:13:24 +0000</bug_when>
    <thetext>Created attachment 1039
Code-first - Hot Pluggable Memory Description ECR v.0.7</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19872</commentid>
    <comment_count>9</comment_count>
    <who name="Scott Lee">scolee</who>
    <bug_when>2022-10-28 20:20:56 +0000</bug_when>
    <thetext>&gt;&gt; •	Mandating the use of the ACPI memory device object for describing hot-pluggable memory, where the Extended Address Space resource descriptor is used to specify the memory attributes and memory type of the hot-pluggable address range. A reference ASL example is also provided. 

I have a question on above. Is intent for all types of hot-pluggable memory or limited to specific types of hot-pluggable memory? FYI ... the current definitions in CXL does not require the need for ACPI memory device object for hot-pluggable CXL memory. From the OS perspective, I do not want this new dependency for hot-pluggable CXL memory.

&gt;&gt; In the case of memory hot-add, the OS can then use the _ATT field information to understand how the memory must be used after it has been added. This enables hot-plug support for specific-purpose memory (SPM) and persistent memory. Since the _ATT field is optional, the OS must consider its absence to mean that the memory is by default cacheable memory with EFI attributes set to EFI_MEMORY_WB.
...
Hot-pluggable persistent memory ranges must not be described using this mechanism. They should instead be described using the NFIT table and related methods specific to persistent memory.

With the above text, I question how OS can rely on the definition given _ATT field is optional. The sentence &quot;This enables hot-plug support for specific-purpose memory (SPM) and persistent memory&quot; is incorrect as the last paragraph states that you cannot do this for persistent memory. My other concern with _ATT is that it places a dependency on availability of ASL. ASL isn&apos;t available all the time in the OS. This may result in additional work in the OS to retrieve this information and delay the processing of the hotplug event.

We have interest in being able to discover SPM from SRAT in all cases (including non-hotplug) as it simplifies the work needed to support SPM in our OS and hypervisor. We like the initial proposal of adding a new SPM bit in SRAT.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20157</commentid>
    <comment_count>10</comment_count>
      <attachid>1056</attachid>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2022-11-30 17:04:15 +0000</bug_when>
    <thetext>Created attachment 1056
Code-first - Hot Pluggable Memory Description ECR v.0.8</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20579</commentid>
    <comment_count>11</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2023-01-10 13:46:00 +0000</bug_when>
    <thetext>Following up on Scott&apos;s comment from 10/28/2022:

&quot;
We have interest in being able to discover SPM from SRAT in all cases (including non-hotplug) as it simplifies the work needed to support SPM in our OS and hypervisor. We like the initial proposal of adding a new SPM bit in SRAT.
&quot;

This is now being tracked as a separate code-first ECR from this one. The new ECR is:

Title: Exposing SPM in SRAT 
Bugzilla:  https://bugzilla.tianocore.org/show_bug.cgi?id=4138
ASWG Mantis: https://mantis.uefi.org/mantis/view.php?id=2361</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20618</commentid>
    <comment_count>12</comment_count>
    <who name="Michael A. Rothman">michael.a.rothman</who>
    <bug_when>2023-01-11 14:54:49 +0000</bug_when>
    <thetext>In the ACPI group we got a proposal on how to go about reflecting whether something is hot pluggable or not, and in the SRAT we do have one bit that claims that, but it&apos;s insufficient. One of the issues that was brought up is that when the system boots, the OS may have allocated memory in regions that are deemed hot pluggable (meaning it could be removed) and this would cause tragic situations for most OSes, especially if they&apos;d allocated any critical resources in those regions.

There&apos;s a desire to know early on what regions are deemed hotpluggable so that the OS in the future could get those hints and if possible avoid allocating critical resources in those regions.

In UEFI the current memory map always reflects the attributes associated with the memory that&apos;s been plugged in. So if you hypothetically have a region that&apos;s hotpluggable AND has memory populated it will show up in the memory map, but theoretically could go away. This could cause problems.

The only reasonable way to address this situation is an update in the memory map that&apos;s handed up to the OS, and we needed an attribute to decorate that information. This at least is backward compatible - doesn&apos;t cause any real chaos to anyone. However, in future operating systems and loaders, they could acknowledge such an attribute and judiciously do their allocations as needed without endangering themselves.

There&apos;s a proposal pending to add a new memory attribute to reflect whether a memory region reflects a hotpluggable capability.

Hope that makes sense...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20619</commentid>
    <comment_count>13</comment_count>
    <who name="LeoDuran@AMD">leo.duran</who>
    <bug_when>2023-01-11 16:50:42 +0000</bug_when>
    <thetext>Actually,
I&apos;d argue that another &quot;reasonable&quot; and perhaps &quot;safer&quot; way is to simply exclude hot-pluggable ranges from the UEFI memory, and described them to the OS by other means (e.g., via memory device objects in the ACPI namespace).

I say &quot;safer&quot; because legacy OSes would not be aware of the proposed Hot-pluggable Attribute, hence could make undesirable decisions.

But perhaps I&apos;m missing a compelling reason to include hot-pluggable ranges in the UEFI memory map that are enabled at boot-time when ranges that are not-enabled at boot-time would still need to be declared by other means.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20620</commentid>
    <comment_count>14</comment_count>
    <who name="Michael A. Rothman">michael.a.rothman</who>
    <bug_when>2023-01-11 18:21:55 +0000</bug_when>
    <thetext>There are some platforms that may have entire ranges capable of being hot plugged and in that case we cannot simply leave them out of the memory map. I believe we went over this scenario before - we have to comprehend that situation.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20621</commentid>
    <comment_count>15</comment_count>
    <who name="Michael A. Rothman">michael.a.rothman</who>
    <bug_when>2023-01-11 22:11:07 +0000</bug_when>
    <thetext>Also, the scenario associated with the possibility of something being allocated on a hotpluggable range exists today already. We can&apos;t exactly fix that problem retroactively, but looking forward - it&apos;s possible. The presumption of course would be the OSes and/or loaders get updated with knowledge of the ACPI updates and new memory attribute bit.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20623</commentid>
    <comment_count>16</comment_count>
    <who name="LeoDuran@AMD">leo.duran</who>
    <bug_when>2023-01-11 23:43:41 +0000</bug_when>
    <thetext>Nahh... (LOL)... Those platforms must have some &quot;fixed&quot; memory... I mean, it&apos;s impossible for all memory to &quot;go away&quot; during runtime, right?

So, it seems &quot;reasonable&quot; to declare some of it as &quot;fixed&quot; in the UEFI memory map, and the rest as &quot;hot-pluggable&quot; outside of the UEFI memory map.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20624</commentid>
    <comment_count>17</comment_count>
    <who name="Michael A. Rothman">michael.a.rothman</who>
    <bug_when>2023-01-12 01:06:13 +0000</bug_when>
    <thetext>(In reply to LeoDuran@AMD from comment #16)
&gt; Nahh... (LOL)... Those platforms must have some &quot;fixed&quot; memory... I mean,
&gt; it&apos;s impossible for all memory to &quot;go away&quot; during runtime, right?
&gt; 
&gt; So, it seems &quot;reasonable&quot; to declare some of it as &quot;fixed&quot; in the UEFI
&gt; memory map, and the rest as &quot;hot-pluggable&quot; outside of the UEFI memory map.

You&apos;d think so - but I was told with some level of certainty that there would be support/examples of platforms that may have everything hotpluggable. I was as surprised as you when I heard that.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20636</commentid>
    <comment_count>18</comment_count>
    <who name="LeoDuran@AMD">leo.duran</who>
    <bug_when>2023-01-12 11:33:45 +0000</bug_when>
    <thetext>Two points:
1) The OS needs fixed space for things like ISRs tables and data structures.
2) I presume that the proposed hot-pluggable attribute would serve as a hint to the OS to not use that memory for that fixed stuff.

So it seems like those 2 points are contradictory in the context of a system where all memory is tagged as hot-pluggable!

Basically, it&apos;s not clear to me the problem that the proposed hot-pluggable attribute is solving.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21111</commentid>
    <comment_count>19</comment_count>
    <who name="LeoDuran@AMD">leo.duran</who>
    <bug_when>2023-02-23 11:30:51 +0000</bug_when>
    <thetext>Mike, et al,

My previous &quot;push-back&quot; comments on including hot-plug memory in the EFI map were based on the assumption that there would be an ACPI memory device object representing that memory. However, after thinking about this some more, there may be ways to add/remove memory during OS runtime that would *not* make use of memory device objects or platform firmware interactions.

Hence, in retrospect, I can see where having a UEFI hot-plug attribute could be a useful tag for memory that is present and usable at OS boot. (of course, memory not present at boot-time would *not* be included in the EFI map).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21335</commentid>
    <comment_count>20</comment_count>
      <attachid>1352</attachid>
    <who name="Jose Marinho">Jose.Marinho</who>
    <bug_when>2023-04-06 08:02:50 +0000</bug_when>
    <thetext>Created attachment 1352
Code-first - Hot Pluggable Memory Description ECR v.0.9

Allow the hot-pluggable memory, described in the ECR, to also be present in the UEFI memory descriptors.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21457</commentid>
    <comment_count>21</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2023-04-30 10:02:09 +0000</bug_when>
    <thetext>This ECR has been approved as-submitted in the UEFI Forum ASWG working group on Apr 27, 2023. The latest version of the ECR (v0.9) will be incorporated as new content in ACPI.next future. Since this is approved, implementations can proceed with the current approved definitions.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21458</commentid>
    <comment_count>22</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2023-04-30 10:02:59 +0000</bug_when>
    <thetext>Approved for ACPI.next specification (from the &quot;code first&apos; public ECR definition in ver 0.9 of the attached document)</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1024</attachid>
            <date>2022-09-15 02:13:02 +0000</date>
            <delta_ts>2022-09-15 02:13:02 +0000</delta_ts>
            <desc>Code-first SPM in SRAT</desc>
            <filename>CodeFirst_SPM2_ver0.3.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>21629</size>
            <attacher name="Thanunathan Rangarajan">thanu.rangarajan</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1037</attachid>
            <date>2022-10-13 11:53:41 +0000</date>
            <delta_ts>2022-10-13 11:53:41 +0000</delta_ts>
            <desc>Code-first - Hot Pluggable Memory Description</desc>
            <filename>CodeFirst_Hot Pluggable Memory_ver0.3.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>29853</size>
            <attacher name="Thanunathan Rangarajan">thanu.rangarajan</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1038</attachid>
            <date>2022-10-19 10:51:43 +0000</date>
            <delta_ts>2022-10-19 10:51:43 +0000</delta_ts>
            <desc>Code-first - Hot Pluggable Memory Description ECR v.0.65</desc>
            <filename>CodeFirst_SPM2_ver0.65.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>30250</size>
            <attacher name="Thanunathan Rangarajan">thanu.rangarajan</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1039</attachid>
            <date>2022-10-20 02:13:24 +0000</date>
            <delta_ts>2022-10-20 02:13:24 +0000</delta_ts>
            <desc>Code-first - Hot Pluggable Memory Description ECR v.0.7</desc>
            <filename>CodeFirst_SPM2_ver0.7.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>32285</size>
            <attacher name="Thanunathan Rangarajan">thanu.rangarajan</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1056</attachid>
            <date>2022-11-30 17:04:15 +0000</date>
            <delta_ts>2022-11-30 17:04:15 +0000</delta_ts>
            <desc>Code-first - Hot Pluggable Memory Description ECR v.0.8</desc>
            <filename>Code-first - Hot Pluggable Memory Description ECR v.0.8.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>32904</size>
            <attacher name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1352</attachid>
            <date>2023-04-06 08:02:50 +0000</date>
            <delta_ts>2023-04-06 08:02:50 +0000</delta_ts>
            <desc>Code-first - Hot Pluggable Memory Description ECR v.0.9</desc>
            <filename>Code-first - Hot Pluggable Memory Description ECR v.0.9.docx</filename>
            <type>application/vnd.openxmlformats-officedocument.wordprocessingml.document</type>
            <size>31537</size>
            <attacher name="Jose Marinho">Jose.Marinho</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4681</bug_id>
          
          <creation_ts>2024-02-13 13:03:55 +0000</creation_ts>
          <short_desc>Packet-&gt;Length is not updated before being used by Dhcp6AppendIaAddrOption to safely know it can append.</short_desc>
          <delta_ts>2024-02-14 13:05:09 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Doug Flick">dougflick</reporter>
          <assigned_to name="Doug Flick">dougflick</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22565</commentid>
    <comment_count>0</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-13 13:03:55 +0000</bug_when>
    <thetext>Packet-&gt;Length is not updated before being used by Dhcp6AppendIaAddrOption to safely know it can append.

Adding this bug so that it can be tracked in the commit fixing this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22566</commentid>
    <comment_count>1</comment_count>
      <attachid>1475</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-13 13:04:36 +0000</bug_when>
    <thetext>Created attachment 1475
Code Fix</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22567</commentid>
    <comment_count>2</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-13 13:05:54 +0000</bug_when>
    <thetext>Already have a fix for this</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22568</commentid>
    <comment_count>3</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-13 13:06:00 +0000</bug_when>
    <thetext>Already have a fix for this</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22575</commentid>
    <comment_count>4</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-13 16:31:17 +0000</bug_when>
    <thetext>Up on the mailing list as a patch series</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22593</commentid>
    <comment_count>5</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-02-14 13:05:09 +0000</bug_when>
    <thetext>Merged into Edk2</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1475</attachid>
            <date>2024-02-13 13:04:36 +0000</date>
            <delta_ts>2024-02-13 13:04:36 +0000</delta_ts>
            <desc>Code Fix</desc>
            <filename>4681.patch</filename>
            <type>text/plain</type>
            <size>1303</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4542</bug_id>
          
          <creation_ts>2023-08-28 14:28:39 +0000</creation_ts>
          <short_desc>Bug 09 - edk2/NetworkPkg: Use of a Weak PseudoRandom Number Generator</short_desc>
          <delta_ts>2024-05-26 22:08:14 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Brian Mullen">BrianM</reporter>
          <assigned_to name="Santhosh Kumar V">santhoshkumarv</assigned_to>
          <cc>dougflick</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>john.mathews</cc>
    
    <cc>louis.shen</cc>
    
    <cc>saloni.kasbekar</cc>
    
    <cc>santhoshkumarv</cc>
    
    <cc>terry.lee</cc>
    
    <cc>zachary.clark-williams</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21869</commentid>
    <comment_count>0</comment_count>
      <attachid>1405</attachid>
    <who name="Brian Mullen">BrianM</who>
    <bug_when>2023-08-28 14:28:39 +0000</bug_when>
    <thetext>Created attachment 1405
Vuln details

See &quot;Bug 9&quot; description in attached &quot;Vuln details&quot; PDF. 

This is a child BZ of
https://bugzilla.tianocore.org/show_bug.cgi?id=4518</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22283</commentid>
    <comment_count>1</comment_count>
    <who name="Santhosh Kumar V">santhoshkumarv</who>
    <bug_when>2023-12-20 04:54:42 +0000</bug_when>
    <thetext>saloni:

Saloni:

If we introduce hash algorithms to generate random number, will it lead any time out during tcp communication?

Can we use rnglib library function to generate random number which shall mitigate the Vulnerability?

Thanks
Santhosh.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22357</commentid>
    <comment_count>2</comment_count>
      <attachid>1461</attachid>
    <who name="Santhosh Kumar V">santhoshkumarv</who>
    <bug_when>2024-01-12 10:49:41 +0000</bug_when>
    <thetext>Created attachment 1461
Patch to address the Vulnerability on Use of a Weak PseudoRandom Number

Saloni:

Please review the patch and feedback.

Santhosh</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22372</commentid>
    <comment_count>3</comment_count>
    <who name="Santhosh Kumar V">santhoshkumarv</who>
    <bug_when>2024-01-17 01:35:05 +0000</bug_when>
    <thetext>Saloni:

Can you please review the patch and feedback

Santhosh</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22440</commentid>
    <comment_count>4</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-01-30 14:55:04 +0000</bug_when>
    <thetext>(In reply to Santhosh Kumar V from comment #1)
&gt; saloni:
&gt; 
&gt; Saloni:
&gt; 
&gt; If we introduce hash algorithms to generate random number, will it lead any
&gt; time out during tcp communication?
&gt; 
&gt; Can we use rnglib library function to generate random number which shall
&gt; mitigate the Vulnerability?
&gt; 
&gt; Thanks
&gt; Santhosh.

Santhosh!

Thanks so much for putting up patches! I appreciate seeing involvement! I had the same idea to use the PseudoRandom Library as you did! In my testing I havent seen any issues with timeouts occurring.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22441</commentid>
    <comment_count>5</comment_count>
      <attachid>1464</attachid>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-01-30 14:58:26 +0000</bug_when>
    <thetext>Created attachment 1464
Alternative Patch for TCBZ4542

For comparison, this is my change. I took a stronger position on forcing the platform to choose a &quot;Secure Algorithm&quot; 

In general, I think both uses of the RngLib are correct.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22444</commentid>
    <comment_count>6</comment_count>
    <who name="Doug Flick">dougflick</who>
    <bug_when>2024-01-30 17:05:47 +0000</bug_when>
    <thetext>So just to give some context around my change I&apos;m not much of a crypto guy so take everything I say with a grain of salt.

We use NET_RANDOM throughout the NetworkPkg code and pass the &quot;seed&quot; through a LCG (Linear Congruential Generator). The general consensus on LCGs is that for embedded devices / non crypto purposes they&apos;re generally fine (again as long as the purpose isn&apos;t crypto). However we use NET_RANDOM all over pkg and I was concerned that the existence of NET_RANDOM would give someone the chance to use weak random for pseudo random. So my change intends to put the responsibility of random on the platform owner and let them make that decision and avoid any generators.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22547</commentid>
    <comment_count>7</comment_count>
    <who name="Terry Lee">terry.lee</who>
    <bug_when>2024-02-07 18:06:48 +0000</bug_when>
    <thetext>As noted in https://bugzilla.tianocore.org/show_bug.cgi?id=4541, there is the potential for sequence number overlap with Santhosh&apos;s patch.  The random number generation in Doug&apos;s patch is stronger, but neither Santhosh&apos;s patch nor Doug&apos;s patch seems to guarantee unique ID generation.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23060</commentid>
    <comment_count>8</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-05-26 22:08:14 +0000</bug_when>
    <thetext>Merge in https://github.com/tianocore/edk2/pull/5582</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1405</attachid>
            <date>2023-08-28 14:28:39 +0000</date>
            <delta_ts>2023-08-28 14:28:39 +0000</delta_ts>
            <desc>Vuln details</desc>
            <filename>Quarkslab-20230803-EDK2-ipstack-vulns.pdf</filename>
            <type>application/pdf</type>
            <size>215796</size>
            <attacher name="Brian Mullen">BrianM</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1461</attachid>
            <date>2024-01-12 10:49:41 +0000</date>
            <delta_ts>2024-01-12 10:49:41 +0000</delta_ts>
            <desc>Patch to address the Vulnerability on Use of a Weak PseudoRandom Number</desc>
            <filename>Vulnerability_Patch.patch</filename>
            <type>text/plain</type>
            <size>3681</size>
            <attacher name="Santhosh Kumar V">santhoshkumarv</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1464</attachid>
            <date>2024-01-30 14:58:26 +0000</date>
            <delta_ts>2024-01-30 14:58:26 +0000</delta_ts>
            <desc>Alternative Patch for TCBZ4542</desc>
            <filename>0001-SECURITY-PATCH-TCBZ4542-Patch.patch</filename>
            <type>text/plain</type>
            <size>34074</size>
            <attacher name="Doug Flick">dougflick</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4813</bug_id>
          
          <creation_ts>2024-07-16 01:45:14 +0000</creation_ts>
          <short_desc>Some strings do not match SMBIOS Type0 spec</short_desc>
          <delta_ts>2024-07-25 22:38:55 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Horace Lien">horacex.lien</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23229</commentid>
    <comment_count>0</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-07-16 01:45:14 +0000</bug_when>
    <thetext>We need to correct string for SMBIOS Type0.
Many of strings not follow specification definition(uppercase and lowercase, wrong characters, extra words,...etc), some examples below:

For example:
In SMBIOS Spec 3.7, Table 7 – BIOS Characteristics
Int 13h — 5.25” / 360 KB floppy services are supported
Int 13h — Japanese floppy for Toshiba 1.2 MB (3.5”, 360 RPM) is supported
Int 10h, CGA/Mono Video Services are supported

In EDKII source, SmbiosViewStrings.uni
Int 13h - 5.25&quot;/360KB Floppy Services are supported
Int 13h - Japanese Floppy for Toshiba 1.2mn (3.5&quot;, 360 RPM) is supported
Int 10h, CGA/Mono Video services are supported2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23230</commentid>
    <comment_count>1</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-07-16 02:12:31 +0000</bug_when>
    <thetext>Change status to in progress.

This is about shellpkg smbiosview source.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23266</commentid>
    <comment_count>2</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-07-25 22:38:55 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/5920
The PR already merged, close this ticket.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4065</bug_id>
          
          <creation_ts>2022-09-15 16:18:21 +0000</creation_ts>
          <short_desc>Incorrect &quot;RANDOM_NAME_PROTOCOL&quot; in RandomNumberBBTestConformance and RandomNumberBBTestFunction</short_desc>
          <delta_ts>2022-11-07 02:53:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</reporter>
          <assigned_to name="Edhay">edhaya.chandran</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>Sam.Kaynor</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19580</commentid>
    <comment_count>0</comment_count>
    <who name="Samer El-Haj-Mahmoud">samer.el-haj-mahmoud</who>
    <bug_when>2022-09-15 16:18:21 +0000</bug_when>
    <thetext>There are 4 incorrect instances of  &quot;RANDOM_NAME_PROTOCOL&quot; in RandomNumberBBTestConformance and RandomNumberBBTestFunction:

https://github.com/tianocore/edk2-test/search?q=RANDOM_NAME_PROTOCOL

These strings should be fixed to &quot;RANDOM_NUMBER_PROTOCOL&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19724</commentid>
    <comment_count>1</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-10-06 10:12:55 +0000</bug_when>
    <thetext>The string shall be corrected to RANDOM_NUMBER_PROTOCOL</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19926</commentid>
    <comment_count>2</comment_count>
      <attachid>1046</attachid>
    <who name="Sam Kaynor">Sam.Kaynor</who>
    <bug_when>2022-11-03 10:35:51 +0000</bug_when>
    <thetext>Created attachment 1046
Proposed patch containing the needed string instance changes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19928</commentid>
    <comment_count>3</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-03 10:50:41 +0000</bug_when>
    <thetext>The patch shall be upstreamed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19950</commentid>
    <comment_count>4</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-07 02:53:34 +0000</bug_when>
    <thetext>The solution is upstreamed by the commit:
https://github.com/tianocore/edk2-test/commit/18a8ca0dda79a9348157d77083ba1e1b9b18081b</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1046</attachid>
            <date>2022-11-03 10:35:51 +0000</date>
            <delta_ts>2022-11-03 10:35:51 +0000</delta_ts>
            <desc>Proposed patch containing the needed string instance changes.</desc>
            <filename>4065.patch</filename>
            <type>text/plain</type>
            <size>3740</size>
            <attacher name="Sam Kaynor">Sam.Kaynor</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4666</bug_id>
          
          <creation_ts>2024-02-02 02:51:10 +0000</creation_ts>
          <short_desc>edk2 - Basetools SyntaxWarning: invalid escape sequence &apos;\C&apos; while building EmbeddedPkg</short_desc>
          <delta_ts>2024-04-04 03:01:12 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Tools</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jayaprakash Nevara">n.jayaprakash</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>BaseTools</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22503</commentid>
    <comment_count>0</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-02-02 02:51:10 +0000</bug_when>
    <thetext>Getting the SytaxWarning message saying invalid escape sequence &apos;\C&apos; when trying to build EmbeddedPkg.

SyntaxWarning: invalid escape sequence &apos;\C&apos;


This warning message is seen with the latest edk2 code available in the main branch.



part of the build logs are copied over here for reference.

C:\Users\njayapra\github\edk2_work\edk2&gt;build -b RELEASE -t VS2019 -a X64 -p EmbeddedPkg\EmbeddedPkg.dsc
C:\Users\njayapra\github\edk2_work\edk2\BaseTools\Source\Python\Workspace\DscBuildData.py:2952: SyntaxWarning: invalid escape sequence &apos;\C&apos;
  PcdValueCommonPath = os.path.normpath(mws.join(GlobalData.gGlobalDefines[&quot;EDK_TOOLS_PATH&quot;], &quot;Source\C\Common\PcdValueCommon.c&quot;))
Build environment: Windows-11-10.0.22621-SP0
Build start time: 13:14:24, Feb.02 2024

WORKSPACE        = c:\users\njayapra\github\edk2_work\edk2
EDK_TOOLS_PATH   = c:\users\njayapra\github\edk2_work\edk2\basetools
EDK_TOOLS_BIN    = c:\users\njayapra\github\edk2_work\edk2\basetools\bin\win32
CONF_PATH        = c:\users\njayapra\github\edk2_work\edk2\conf
PYTHON_COMMAND   = py -3


Processing meta-data .
Architecture(s)  = X64
Build target     = RELEASE
Toolchain        = VS2019

Active Platform          = c:\users\njayapra\github\edk2_work\edk2\EmbeddedPkg\EmbeddedPkg.dsc
. done!
Building ... c:\users\njayapra\github\edk2_work\edk2\EmbeddedPkg\Library\PrePiLib\PrePiLib.inf [X64]
Building ... c:\users\njayapra\github\edk2_work\edk2\EmbeddedPkg\Library\AcpiLib\AcpiLib.inf [X64]
Building ... c:\users\njayapra\github\edk2_work\edk2\EmbeddedPkg\Library\NonCoherentDmaLib\NonCoherentDmaLib.inf [X64]
Building ... c:\users\njayapra\github\edk2_work\edk2\MdePkg\Library\DxeServicesTableLib\DxeServicesTableLib.inf [X64]
Building ... c:\users\njayapra\github\edk2_work\edk2\MdePkg\Library\UefiRuntimeLib\UefiRuntimeLib.inf [X64]</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22528</commentid>
    <comment_count>1</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-02-06 01:15:22 +0000</bug_when>
    <thetext>This is issue is observed always. I was able to repro this with EmbeddedPkg.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22529</commentid>
    <comment_count>2</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-02-06 02:08:24 +0000</bug_when>
    <thetext>Submitted email patch for review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22866</commentid>
    <comment_count>3</comment_count>
    <who name="Jayaprakash Nevara">n.jayaprakash</who>
    <bug_when>2024-04-04 03:01:12 +0000</bug_when>
    <thetext>Merged as 3e91e421365027ee3e655feab33c67a4f544c777</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4610</bug_id>
          
          <creation_ts>2023-11-30 17:09:35 +0000</creation_ts>
          <short_desc>Google Test tests don&apos;t support multiple source files</short_desc>
          <delta_ts>2023-12-03 07:36:29 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Pedro Falcato">pedro.falcato</reporter>
          <assigned_to name="Pedro Falcato">pedro.falcato</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UnitTestFrameworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22207</commentid>
    <comment_count>0</comment_count>
    <who name="Pedro Falcato">pedro.falcato</who>
    <bug_when>2023-11-30 17:09:35 +0000</bug_when>
    <thetext>The EDK2 build system builds modules into .lib/static libraries.
When linkers use static libraries they use them to resolve
outstanding[1] undefined symbols. They do this by opening an ar
file[2], which is essentially a collection of .o in a single file,
looking at the archive&apos;s symbol table and only processing object files
they actually need.

This actually works fine for most usage of static libraries, where you
manually pull symbols you need, or in EFI where the linker pulls in
EfiMain(), which pulls the rest of the object files in. The problem is
that Google Test, in all of its C++ glory, has the test registration
done in global constructors for global objects (that are created in
the TEST(Blah, TestSomething) macro invocation). These constructors
are not referenced elsewhere, so the linker doesn&apos;t pull those object
files; this is bad, it means none of those objects will ever be seen
by the linker, so you just drop tests.

This whole problem can be fixed by doing /WHOLEARCHIVE or
--Wl,--whole-archive on the static libraries; in that case, the linker
forcibly includes all of the static library&apos;s object files (even
unreferenced ones!) in the link. This fixes our case as then
constructors are referenced, so the tests are properly registered and
run. This is a &quot;hardcore&quot; switch that we don&apos;t want to force on most
components, so it should only be set in UnitTestFrameworkPkg/UnitTestFrameworkPkgHost.dsc.inc.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22208</commentid>
    <comment_count>1</comment_count>
    <who name="Pedro Falcato">pedro.falcato</who>
    <bug_when>2023-11-30 17:10:01 +0000</bug_when>
    <thetext>on it</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22214</commentid>
    <comment_count>2</comment_count>
    <who name="Pedro Falcato">pedro.falcato</who>
    <bug_when>2023-12-03 07:36:29 +0000</bug_when>
    <thetext>Fixed and pushed (https://github.com/tianocore/edk2/pull/5098)</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4793</bug_id>
          
          <creation_ts>2024-06-19 07:11:55 +0000</creation_ts>
          <short_desc>MCUD section data length is incorrect for 64-bit</short_desc>
          <delta_ts>2024-08-27 20:35:03 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>aravind.p.r</reporter>
          <assigned_to>aravind.p.r</assigned_to>
          <cc>chinni.b.duggapu</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>nathaniel.l.desimone</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>IntelFsp2Pkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23142</commentid>
    <comment_count>0</comment_count>
    <who name="">aravind.p.r</who>
    <bug_when>2024-06-19 07:11:55 +0000</bug_when>
    <thetext>MCUD Data Region Length(DATA_LEN_OF_MCUD) pushed to stack is incorrect for 64-bit.

This is because the size of the data pushed in case of 64-bit is more.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23179</commentid>
    <comment_count>1</comment_count>
    <who name="">aravind.p.r</who>
    <bug_when>2024-07-05 03:31:51 +0000</bug_when>
    <thetext>Confirmed the issue by analyzing the data pushed while creating the MCUD section.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23346</commentid>
    <comment_count>2</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-08-27 20:34:35 +0000</bug_when>
    <thetext>PR: https://github.com/tianocore/edk2/pull/5884</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23347</commentid>
    <comment_count>3</comment_count>
    <who name="Nathaniel L DeSimone">nathaniel.l.desimone</who>
    <bug_when>2024-08-27 20:35:03 +0000</bug_when>
    <thetext>PR has been merged. Marking as this bug as fixed.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4737</bug_id>
          
          <creation_ts>2024-03-26 04:31:51 +0000</creation_ts>
          <short_desc>Update smbiosview type4 with SMBIOS 3.6 fields</short_desc>
          <delta_ts>2024-04-09 22:18:55 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="Horace Lien">horacex.lien</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22819</commentid>
    <comment_count>0</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-03-26 04:31:51 +0000</bug_when>
    <thetext>Following SMBIOS 3.6(https://www.dmtf.org/sites/default/files/standards/documents/DSP0134_3.6.0.pdf), we should show &quot;Thread Enabled&quot; field on Type4 for smbiowview.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22895</commentid>
    <comment_count>1</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-04-09 22:18:55 +0000</bug_when>
    <thetext>The code already merged, close this ticket.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4826</bug_id>
          
          <creation_ts>2024-08-07 23:31:44 +0000</creation_ts>
          <short_desc>Some string and code logical are incorrect for SMBIOS Type9</short_desc>
          <delta_ts>2024-08-31 02:17:44 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Horace Lien">horacex.lien</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>ShellPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>23302</commentid>
    <comment_count>0</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-08-07 23:31:44 +0000</bug_when>
    <thetext>In SMBIOS Type9, some code logical and string are incorrect when print context by smbiosview.

Code logical error:
Following SMBIOS Spec v3.7, Table 49 System Slots: Slot ID.
We can see 4 errors below.
1. SlotID range is 1 to 15 for MCA. Code is 1 to 14.
2. SlotID range is 1 to 15 for EISA. Code is 1 to 14.
3. SlotType is AGP, it should be included AGP 8X(0x13). Code is not included.
4. SlotType is PCIe, it should be included EDSFF E1(0xC5) and EDSFF E3(0xC6). Code is not included.

String error:
When show slot height, &quot;Unknown&quot;(0x02) string is incorrect, code is &quot;Unkown&quot;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23303</commentid>
    <comment_count>1</comment_count>
      <attachid>1531</attachid>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-08-07 23:32:53 +0000</bug_when>
    <thetext>Created attachment 1531
SMBIOS table49</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23304</commentid>
    <comment_count>2</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-08-08 01:56:18 +0000</bug_when>
    <thetext>Code logical error:
5. U.2 and PCIe Mini (0x1F-0x25) are also belong to PCIe Type.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23313</commentid>
    <comment_count>3</comment_count>
      <attachid>1535</attachid>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-08-12 01:49:33 +0000</bug_when>
    <thetext>Created attachment 1535
Table 45 - System Slots: Slot Type field

Uploda Table 45 System Slots: Slot Type field picture</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23326</commentid>
    <comment_count>4</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-08-16 05:44:27 +0000</bug_when>
    <thetext>Sent PR to fix it</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23354</commentid>
    <comment_count>5</comment_count>
    <who name="Horace Lien">horacex.lien</who>
    <bug_when>2024-08-31 02:17:44 +0000</bug_when>
    <thetext>https://github.com/tianocore/edk2/pull/6064 already merged.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1531</attachid>
            <date>2024-08-07 23:32:53 +0000</date>
            <delta_ts>2024-08-07 23:32:53 +0000</delta_ts>
            <desc>SMBIOS table49</desc>
            <filename>Table 49 System Slots.png</filename>
            <type>image/png</type>
            <size>264902</size>
            <attacher name="Horace Lien">horacex.lien</attacher>
            

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1535</attachid>
            <date>2024-08-12 01:49:33 +0000</date>
            <delta_ts>2024-08-12 01:49:33 +0000</delta_ts>
            <desc>Table 45 - System Slots: Slot Type field</desc>
            <filename>Table 45.png</filename>
            <type>image/png</type>
            <size>99860</size>
            <attacher name="Horace Lien">horacex.lien</attacher>
            

          </attachment>
      

    </bug>
    <bug>
          <bug_id>4504</bug_id>
          
          <creation_ts>2023-07-18 07:49:18 +0000</creation_ts>
          <short_desc>Move RngLibTimer from MdePkg to MdeModulePkg</short_desc>
          <delta_ts>2023-10-26 16:31:50 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Pierre Gondois">pierre.gondois</reporter>
          <assigned_to name="Pierre Gondois">pierre.gondois</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21722</commentid>
    <comment_count>0</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2023-07-18 07:49:18 +0000</bug_when>
    <thetext>In order to identify the implementation behind the RngLib interface, a new GetRngGuid() interface is to be added. This interface returns a GUID.

A &apos;gEdkiiRngAlgorithmUnSafe&apos; is to be added to identify unsafe algorithms, but the MdePkg can only contain GUIDs defined in the UEFI specification. To solve this issue, move the RngLibTimer from the MdePkg to the MdeModulePkg.

Suggestion from Liming:
https://edk2.groups.io/g/devel/message/106958</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21726</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-18 22:15:47 +0000</bug_when>
    <thetext>pierre.gondois@arm.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21943</commentid>
    <comment_count>2</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2023-09-29 04:58:26 +0000</bug_when>
    <thetext>Merged at https://edk2.groups.io/g/devel/topic/100684678#107709</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21944</commentid>
    <comment_count>3</comment_count>
    <who name="Pierre Gondois">pierre.gondois</who>
    <bug_when>2023-09-29 04:58:50 +0000</bug_when>
    <thetext>Cf https://edk2.groups.io/g/devel/topic/100684678#107709</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22067</commentid>
    <comment_count>4</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:31:50 +0000</bug_when>
    <thetext>Apparently fixed within commit range 2ce5ae43c216..ff7ddc02b273.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4744</bug_id>
          
          <creation_ts>2024-03-28 20:23:44 +0000</creation_ts>
          <short_desc>Basetools recurses NULL includes when collecting library instances for modules</short_desc>
          <delta_ts>2024-04-24 12:07:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>tabeebe</reporter>
          <assigned_to>tabeebe</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22839</commentid>
    <comment_count>0</comment_count>
    <who name="">tabeebe</who>
    <bug_when>2024-03-28 20:23:44 +0000</bug_when>
    <thetext>When collecting the required library instances for modules and libraries, included libraries will be recursed to ensure the module is built with all the libraries directly linked to it and indirectly linked to it via included libraries.

Using the following scenario as an example:

[LibraryClasses.common.DXE_CORE]
NULL|Path/To/Library1.inf // Includes DebugLib

[LibraryClasses.common.DXE_DRIVER]
NULL|Path/To/Library2.inf // Includes DebugLib

[LibraryClasses.common.DXE_CORE, LibraryClasses.common.DXE_DRIVER]
DebugLib|MdePkg/Library/BaseDebugLibSerialPort/BaseDebugLibSerialPort.inf

[Components]
MdeModulePkg/Core/Dxe/DxeMain.inf // Includes DebugLib

The DXE_CORE NULL library will be assigned a fake library class like NULL1 and the DXE_DRIVER will be assigned NULL2. The recursion logic will see NULL1 as a directly linked and will add an instance of it to the list of libraries which need to be included in the module. When DebugLib is evaluated, the recursion logic will add the libraries DebugLib depends on to the queue which includes both NULL1 and NULL2. When NULL2 is unqueued, an instance of it will also be added to the list of libraries needed to build DxeMain which now means that both NULL1 and NULL2 have been linked.

NULL includes outside of module overrides are not supported according to the spec, but we do it anyways so this seems like a case which should be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22851</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2024-04-02 10:36:47 +0000</bug_when>
    <thetext>tabeebe takes it</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22948</commentid>
    <comment_count>2</comment_count>
    <who name="">tabeebe</who>
    <bug_when>2024-04-24 12:07:45 +0000</bug_when>
    <thetext>The fix has been committed: https://github.com/tianocore/edk2/commit/d77efa2ebef9a0feca97df787138d132393e1130</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4008</bug_id>
          
          <creation_ts>2022-07-29 01:43:50 +0000</creation_ts>
          <short_desc>Remove Unreferenced OpenProtocol in NvmeExpressDxe driver</short_desc>
          <delta_ts>2022-08-09 21:54:59 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>0</everconfirmed>
          <reporter name="karunakar">karunakar_poosapalli</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>karunakar_poosapalli</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19341</commentid>
    <comment_count>0</comment_count>
    <who name="karunakar">karunakar_poosapalli</who>
    <bug_when>2022-07-29 01:43:50 +0000</bug_when>
    <thetext>In EnumerateNvmeDevNamespace() https://github.com/tianocore/edk2/blob/master/MdeModulePkg/Bus/Pci/NvmExpressDxe/NvmExpress.c

There is OpenProtocol() is used(Line No 278) which is not referred anywhere 

.
.
      }
    }

    gBS-&gt;OpenProtocol (
           Private-&gt;ControllerHandle,
           &amp;gEfiNvmExpressPassThruProtocolGuid,
           (VOID **)&amp;DummyInterface,
           Private-&gt;DriverBindingHandle,
           Device-&gt;DeviceHandle,
           EFI_OPEN_PROTOCOL_BY_CHILD_CONTROLLER
           );

    //
    // Dump NvmExpress Identify Namespace Data
    //
.
.

1. Is there any reason for keeping this Openprotocol in the source?
2. If there are no other use cases for this OpenProtocol, Can we remove this ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19376</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2022-08-09 21:54:59 +0000</bug_when>
    <thetext>This is the necessary code. This follows uefi driver model, and check UEFI driver write guide (https://tianocore-docs.github.io/edk2-UefiDriverWritersGuide/draft/edk2-UefiDriverWritersGuide-draft.pdf). So, this is not an issue.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4505</bug_id>
          
          <creation_ts>2023-07-20 22:50:38 +0000</creation_ts>
          <short_desc>NetworkPkg: HTTP protocol throughput too small</short_desc>
          <delta_ts>2023-10-26 16:37:23 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="yi1.li@intel.com">yi1.li</reporter>
          <assigned_to name="yi1.li@intel.com">yi1.li</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
    
    <cc>laszlo.ersek</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>NetworkPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>21756</commentid>
    <comment_count>0</comment_count>
    <who name="yi1.li@intel.com">yi1.li</who>
    <bug_when>2023-07-20 22:50:38 +0000</bug_when>
    <thetext>In edk2’s HTTP protocol implementation that uses too small tcp windows, we need to increase HTTP beffer size and enable TCP window scaling to improve performance. 
I tested it locally in virtual environment and it improves the throughput almost by 300%:

-#define HTTP_BOOT_BLOCK_SIZE                   1500
+#define HTTP_BOOT_BLOCK_SIZE                   32000

+  Tcp4Option-&gt;EnableWindowScaling = TRUE;
+  Tcp6Option-&gt;EnableWindowScaling = TRUE;

-#define HTTP_BUFFER_SIZE_DEAULT   65535
+#define HTTP_BUFFER_SIZE_DEAULT   0x200000</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21771</commentid>
    <comment_count>1</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-07-25 05:38:27 +0000</bug_when>
    <thetext>yi1.li@intel.com is working on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22071</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 16:37:23 +0000</bug_when>
    <thetext>Fixed in commit b240eab03530f063ef5438497d70a731b19a201e.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4009</bug_id>
          
          <creation_ts>2022-07-29 17:36:50 +0000</creation_ts>
          <short_desc>AllocateBuffer_Func fails on QEMU sbsa-ref</short_desc>
          <delta_ts>2023-07-20 10:27:34 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2 Test</product>
          <component>UEFI-SCT</component>
          <version>Current</version>
          <rep_platform>Other</rep_platform>
          <op_sys>Other</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jeff Booher-Kaeding">Jeff.booher-kaeding</reporter>
          <assigned_to name="Jeff Booher-Kaeding">Jeff.booher-kaeding</assigned_to>
          <cc>edhaya.chandran</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaojie</cc>
    
    <cc>Jeff.booher-kaeding</cc>
    
    <cc>samer.el-haj-mahmoud</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>19342</commentid>
    <comment_count>0</comment_count>
    <who name="Jeff Booher-Kaeding">Jeff.booher-kaeding</who>
    <bug_when>2022-07-29 17:36:50 +0000</bug_when>
    <thetext>The AllocateBuffer_Func test case attempts to force PCI Root Bridge allocations in the 32-bit address space (i.e., below 4 GiB) by omitting the EFI_PCI_ATTRIBUTE_DUAL_ADDRESS_CYCLE flag in some combinations of memory attributes (https://github.com/tianocore/edk2-test/blob/4a25c3b3c79f63bd9f98b4fffcb21b5c66dd14bb/uefi-sct/SctPkg/TestCase/UEFI/EFI/Protocol/PciRootBridgeIo/BlackBoxTest/PciRootBridgeIoBBTestFunction_2.c#L4102).

On the QEMU sbsa-ref board, a PCI Root Bridge buffer allocation without the EFI_PCI_ATTRIBUTE_DUAL_ADDRESS_CYCLE returns Out of Resources. This is expected because the RAM memory of QEMU sbsa-ref begins at physical address 0x10000000000 (1 TiB), so allocations below 4 GiB will fail (https://github.com/qemu/qemu/blob/fc2cc19ffa02c86ec1471ec8fdbc39d33fcec626/hw/arm/sbsa-ref.c#L129). However, the test suite treats this as an error.

A check should be added that prevents 32-bit allocation attempts if the system does not have usable memory below 4 GiB.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>19461</commentid>
    <comment_count>1</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-09-01 10:38:03 +0000</bug_when>
    <thetext>This is a valid request:
If there is no usable memory below 4GiB, the there must be no call for memory allocation.
A Check maybe to be added. 

Jeff: Can you provide a solution patch with this check?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20065</commentid>
    <comment_count>2</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2022-11-20 23:19:29 +0000</bug_when>
    <thetext>The patch is upstreamed here
https://edk2.groups.io/g/devel/message/94859

To be reviewed by the forum.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20635</commentid>
    <comment_count>3</comment_count>
    <who name="Barton Gao">gaojie</who>
    <bug_when>2023-01-12 09:18:22 +0000</bug_when>
    <thetext>Ready for upstream, already reviewed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21136</commentid>
    <comment_count>4</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-03-02 09:06:16 +0000</bug_when>
    <thetext>The patch to be upstreamed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21754</commentid>
    <comment_count>5</comment_count>
    <who name="Edhay">edhaya.chandran</who>
    <bug_when>2023-07-20 10:27:34 +0000</bug_when>
    <thetext>The patch is upstreamed by:
https://github.com/tianocore/edk2-test/commit/315e3a56a6d9261d4fad4c1950f2d01a052eeba4</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4575</bug_id>
          
          <creation_ts>2023-10-26 08:27:49 +0000</creation_ts>
          <short_desc>Memory leak in MeasureSmbiosTable@SmbiosMeasurementDxe.c ?</short_desc>
          <delta_ts>2024-12-11 21:49:46 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>trivial</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>Peter.Liu</reporter>
          <assigned_to name="yang gang">yanggang.uefi</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>Peter.Liu</cc>
    
    <cc>yanggang.uefi</cc>
    
    <cc>yizihong</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22045</commentid>
    <comment_count>0</comment_count>
    <who name="">Peter.Liu</who>
    <bug_when>2023-10-26 08:27:49 +0000</bug_when>
    <thetext>File: MdeModulePkg\Universal\SmbiosMeasurementDxe\SmbiosMeasurementDxe.c
Func: MeasureSmbiosTable

Seems there is a leak on following allocation:
  TableAddress = AllocateCopyPool ((UINTN)TableLength, (VOID *)(UINTN)SmbiosTableAddress);


It should be freed after usage (TpmnMeasureAndLogData).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22056</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2023-10-26 12:50:34 +0000</bug_when>
    <thetext>I think I agree. The copy is made so that it can be &quot;filtered&quot; (parts of it can be nulled) for the purpose of measuring the modified copy into the TPM. But, after measurement, the modified copy is never released.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23539</commentid>
    <comment_count>2</comment_count>
    <who name="Zihong Yi">yizihong</who>
    <bug_when>2024-11-22 02:42:37 +0000</bug_when>
    <thetext>When will this problem be fixed in the master branch? 

It&apos;s really simple. Add the following code to line 639 of the SmbiosMeasurementDxe.c file 

 Status = TpmMeasureAndLogData (
 1, PCRIndex
 EventType, EventType
 EventLog, EventLog
 EventLogSize, LogLen
 TableAddress, HashData
 TableLength HashDataLen
);
 if (!EFI_ERROR (Status)) {
 gBS-&gt;CloseEvent (Event);
}
 
+ if (TableAddress != NULL) {
+ FreePool (TableAddress);
+}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23555</commentid>
    <comment_count>3</comment_count>
    <who name="yang gang">yanggang.uefi</who>
    <bug_when>2024-12-06 03:55:12 +0000</bug_when>
    <thetext>yanggang take this, and PR created: https://github.com/tianocore/edk2/pull/6513</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>23562</commentid>
    <comment_count>4</comment_count>
    <who name="yang gang">yanggang.uefi</who>
    <bug_when>2024-12-11 21:49:46 +0000</bug_when>
    <thetext>PR merged into tianocore:master branch, close this.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4304</bug_id>
          
          <creation_ts>2023-01-16 03:11:51 +0000</creation_ts>
          <short_desc>Add NVMe boot partition header definition</short_desc>
          <delta_ts>2023-02-10 00:32:45 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Weipu Zhu">weipu.zhu</reporter>
          <assigned_to name="Weipu Zhu">weipu.zhu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>hao.a.wu</cc>
    
    <cc>weipu.zhu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20678</commentid>
    <comment_count>0</comment_count>
    <who name="Weipu Zhu">weipu.zhu</who>
    <bug_when>2023-01-16 03:11:51 +0000</bug_when>
    <thetext>Add NVMe boot partition header definition to NVMe.h according to NVMe spec 2.0.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21019</commentid>
    <comment_count>1</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2023-02-10 00:32:04 +0000</bug_when>
    <thetext>V1 patch sent at: https://edk2.groups.io/g/devel/message/99417
V2 patch sent at: https://edk2.groups.io/g/devel/message/99439</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21020</commentid>
    <comment_count>2</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2023-02-10 00:32:45 +0000</bug_when>
    <thetext>Resolved via:
PR - https://github.com/tianocore/edk2/pull/4026
Commit - https://github.com/tianocore/edk2/commit/93a21b465bda44cecdd6347ad481ca6f55286547</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4697</bug_id>
          
          <creation_ts>2024-02-23 03:20:01 +0000</creation_ts>
          <short_desc>Improve the performance of copying the context from temporary memory to the raw pages in permanent memory</short_desc>
          <delta_ts>2024-03-01 13:51:47 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>EDK2</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="zhihao">zhihao.li</reporter>
          <assigned_to name="unassigned">unassigned</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>laszlo.ersek</cc>
    
    <cc>zhihao.li</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdeModulePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>22631</commentid>
    <comment_count>0</comment_count>
    <who name="zhihao">zhihao.li</who>
    <bug_when>2024-02-23 03:20:01 +0000</bug_when>
    <thetext>In MdeModulePkg\Core\Pei\Dispatcher\Dispatcher.c, EvacuateTempRam function will copy the temporary memory context to the rebased pages and raw pages. Rebased PEIMs will get dispatched later. Raw PEIMs is used to keep consistent context across multiple boot. Migrations of rebased PEIMs is from cache to memory, while raw PEIMs is from memory to memory. So the migrations of raw PEIMs is slower than rebased PEIMs. 
According to the test result, changing the source address of raw PEIMs migration will improve performance by 35%.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22682</commentid>
    <comment_count>1</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2024-03-01 13:13:40 +0000</bug_when>
    <thetext>[PATCH v1] MdeModulePkg/Core/Pei: Improve the copy performance
msgid &lt;20240301071147.519-1-zhihao.li@intel.com&gt;
https://edk2.groups.io/g/devel/message/116212</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>22684</commentid>
    <comment_count>2</comment_count>
    <who name="Laszlo Ersek">laszlo.ersek</who>
    <bug_when>2024-03-01 13:51:47 +0000</bug_when>
    <thetext>(In reply to Laszlo Ersek from comment #1)
&gt; [PATCH v1] MdeModulePkg/Core/Pei: Improve the copy performance
&gt; msgid &lt;20240301071147.519-1-zhihao.li@intel.com&gt;
&gt; https://edk2.groups.io/g/devel/message/116212

Merged as

     7  371940932d29 MdeModulePkg/Core/Pei: Improve the copy performance

via &lt;https://github.com/tianocore/edk2/pull/5432&gt;.</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4182</bug_id>
          
          <creation_ts>2022-12-05 02:24:12 +0000</creation_ts>
          <short_desc>Need SmmCpuFeaturesLib implementation for AMD Processor family</short_desc>
          <delta_ts>2023-08-16 01:30:20 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>Other</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="AbdulLateef Atta">AbdulLateef.Attar</reporter>
          <assigned_to name="AbdulLateef Atta">AbdulLateef.Attar</assigned_to>
          <cc>AbdulLateef.Attar</cc>
    
    <cc>abner.chang</cc>
    
    <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>gaoliming</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>UefiCpuPkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20183</commentid>
    <comment_count>0</comment_count>
    <who name="AbdulLateef Atta">AbdulLateef.Attar</who>
    <bug_when>2022-12-05 02:24:12 +0000</bug_when>
    <thetext>AMD Processor family as different save state registers which are different from Intel.
Hence need SmmCpuFeaturesLib Library implementation for AMD Processor family.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20184</commentid>
    <comment_count>1</comment_count>
    <who name="Chang, Abner">abner.chang</who>
    <bug_when>2022-12-05 06:11:37 +0000</bug_when>
    <thetext>@Liming, Abdul is working on the upstream. I just changed the status to confirmed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21826</commentid>
    <comment_count>2</comment_count>
    <who name="">gaoliming</who>
    <bug_when>2023-08-16 01:30:20 +0000</bug_when>
    <thetext>The feature has been done at ad7d3ace..f2188fe</thetext>
  </long_desc>
      
      

    </bug>
    <bug>
          <bug_id>4303</bug_id>
          
          <creation_ts>2023-01-16 03:01:57 +0000</creation_ts>
          <short_desc>Add RPMB related commands and DCB definition for NVMe</short_desc>
          <delta_ts>2023-02-10 00:30:58 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Tianocore Feature Requests</product>
          <component>Code</component>
          <version>Current</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>Lowest</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Weipu Zhu">weipu.zhu</reporter>
          <assigned_to name="Weipu Zhu">weipu.zhu</assigned_to>
          <cc>edk2+bugs+int+994+563148131503455288</cc>
    
    <cc>hao.a.wu</cc>
    
    <cc>weipu.zhu</cc>
          
          <cf_industrystandardspecifications>---</cf_industrystandardspecifications>
          <cf_branch></cf_branch>
          <cf_release_observed>EDK II Master</cf_release_observed>
          <cf_target_os>---</cf_target_os>
          <cf_package>MdePkg</cf_package>
          <cf_releases_to_fix>EDK II Master</cf_releases_to_fix>
          

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>20677</commentid>
    <comment_count>0</comment_count>
    <who name="Weipu Zhu">weipu.zhu</who>
    <bug_when>2023-01-16 03:01:57 +0000</bug_when>
    <thetext>Add RPMB(Replay Protected Memory Block) access commands, result and DCB(Data Configuration Block) definition for NVMe according to the NVMe spec 2.0.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>20679</commentid>
    <comment_count>1</comment_count>
    <who name="Weipu Zhu">weipu.zhu</who>
    <bug_when>2023-01-16 03:44:36 +0000</bug_when>
    <thetext>Correction: DCB is Device Configuration Block</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21017</commentid>
    <comment_count>2</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2023-02-10 00:29:34 +0000</bug_when>
    <thetext>V1 patch sent at: https://edk2.groups.io/g/devel/message/99416
V2 patch sent at: https://edk2.groups.io/g/devel/message/99438</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>21018</commentid>
    <comment_count>3</comment_count>
    <who name="Hao Wu">hao.a.wu</who>
    <bug_when>2023-02-10 00:30:58 +0000</bug_when>
    <thetext>Resolved via:
PR - https://github.com/tianocore/edk2/pull/4026
Commit - https://github.com/tianocore/edk2/commit/069703228cfe6ba128a20e770af831699eae79b7</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>